<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CnosDB</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="content/cnosdb/latest/about.html"><strong aria-hidden="true">1.</strong> å…³äºCnosDB</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/introduction/index.html"><strong aria-hidden="true">2.</strong> å¿«é€Ÿä¸Šæ‰‹</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/introduction/download.html"><strong aria-hidden="true">2.1.</strong> ä¸‹è½½ä¸å®‰è£…</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/introduction/install.html"><strong aria-hidden="true">2.2.</strong> å‘½ä»¤è¡Œç»ˆç«¯</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> åº”ç”¨ç¼–ç¨‹æ¥å£</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/protocol/line_protocol.html"><strong aria-hidden="true">3.1.</strong> CnosDB Line Protocol</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/protocol/write_api.html"><strong aria-hidden="true">3.2.</strong> CnosDB Write API</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/protocol/query_api.html"><strong aria-hidden="true">3.3.</strong> CnosDB Query API</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/protocol/prometheus.html"><strong aria-hidden="true">3.4.</strong> Prometheus</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/protocol/telegraf.html"><strong aria-hidden="true">3.5.</strong> Telegraf</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.</strong> Golang</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.</strong> Java</div></li></ol></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/managerment/index.html"><strong aria-hidden="true">4.</strong> è¿ç»´ç®¡ç†</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/managerment/export_import.html"><strong aria-hidden="true">4.1.</strong> å¯¼å…¥å’Œå¯¼å‡º</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/managerment/backup_restore.html"><strong aria-hidden="true">4.2.</strong> å¤‡ä»½å’Œè¿˜åŸ</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/managerment/configuration.html"><strong aria-hidden="true">4.3.</strong> CnosDBé…ç½® TODO</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/sandboxmanagement.html"><strong aria-hidden="true">4.4.</strong> é›†ç¾¤ç®¡ç†</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.5.</strong> è¿ç»´å·¥å…·ä»‹ç»</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosdb_tools/cnosdb.html"><strong aria-hidden="true">4.5.1.</strong> cnosdb</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-cli.html"><strong aria-hidden="true">4.5.2.</strong> cnosdb-cli</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html"><strong aria-hidden="true">4.5.3.</strong> cnosdb-inspect</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/index.html"><strong aria-hidden="true">5.</strong> è®¾è®¡åŸç†</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/cnosql_vs_sql.html"><strong aria-hidden="true">5.1.</strong> CnosDB VS SQL</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/design_insights.html"><strong aria-hidden="true">5.2.</strong> è®¾è®¡åŸåˆ™</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/storage_engine.html"><strong aria-hidden="true">5.3.</strong> å­˜å‚¨å¼•æ“</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/tsi_design.html"><strong aria-hidden="true">5.4.</strong> TSIçš„è®¾è®¡</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/concept/file_system_layout.html"><strong aria-hidden="true">5.5.</strong> æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> è¯­æ³•å‚è€ƒæ‰‹å†Œ</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/cnosql_sample.html"><strong aria-hidden="true">6.1.</strong> æŸ¥è¯¢å…¥é—¨ TODO</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/cnosql_syntax.html"><strong aria-hidden="true">6.2.</strong> æ•°æ®æŸ¥è¯¢ TODO</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/management_database.html"><strong aria-hidden="true">6.3.</strong> æ•°æ®åº“ç®¡ç†</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/cnosql_schema.html"><strong aria-hidden="true">6.4.</strong> æ¨¡å¼æŸ¥è¯¢</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/cnosql_function.html"><strong aria-hidden="true">6.5.</strong> å‡½æ•°</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/continuous_queries.html"><strong aria-hidden="true">6.6.</strong> è¿ç»­æŸ¥è¯¢</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/math_operators.html"><strong aria-hidden="true">6.7.</strong> æ•°å­¦è¿ç®—ç¬¦</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/cnosql_spect.html"><strong aria-hidden="true">6.8.</strong> è¯­æ³•çº¦å®š</a></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/cnosql/other.html"><strong aria-hidden="true">6.9.</strong> å…¶ä»–</a></li></ol></li><li class="chapter-item expanded "><a href="content/cnosdb/latest/frequently_asked_questions.html"><strong aria-hidden="true">7.</strong> å¸¸è§é—®é¢˜</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CnosDB</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cnosdb"><a class="header" href="#cnosdb">CnosDB</a></h1>
<p>CnosDBæ˜¯ä¸€ä¸ªç”±ç¤¾åŒºé©±åŠ¨çš„å¼€æºæ—¶é—´åºåˆ—æ•°æ®åº“ã€‚</p>
<h2 id="äº§å“ç‰¹æ€§"><a class="header" href="#äº§å“ç‰¹æ€§">äº§å“ç‰¹æ€§</a></h2>
<ul>
<li>å…¨é¢ä¸InfluxDB 1.X ç¨³å®šç‰ˆå…¼å®¹ã€‚</li>
<li>å¼€æºåˆ†å¸ƒå¼é›†ç¾¤ï¼Œäº§å“æ°¸ä¹…å…è´¹ã€‚</li>
<li>24*7å…¨çƒå¼€æºç¤¾åŒºæ”¯æŒã€‚</li>
<li>å®æ—¶æ—¶åºæ•°æ®åº“ï¼šå¯å°†æ‚¨çš„ç¦»çº¿ç›‘æ§å¹³å°ï¼Œæå‡ä¸ºä¸€ä¸ªå®æ—¶å†³ç­–ç³»ç»Ÿ</li>
<li>æ”¯æŒæµ·é‡æ—¶é—´åºåˆ—çº¿ï¼šåœ¨æµ·é‡æ ‡ç­¾ã€æµ·é‡æ—¶é—´åºåˆ—çº¿çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶èƒ½å¤Ÿé«˜æ•ˆå®ç°åˆ†å¸ƒå¼è¿­ä»£å™¨åŠæŸ¥è¯¢ä¼˜åŒ–</li>
<li>ä½æˆæœ¬/ç¢³ä¸­å’Œï¼šé«˜æ•ˆçš„å­˜å‚¨å¼•æ“å¯å……åˆ†å‘æŒ¥ç¡¬ä»¶æ€§èƒ½ï¼Œå¹¶åœ¨é«˜æ•ˆå‹ç¼©å­˜å‚¨çš„åŒæ—¶ä¿éšœæŸ¥è¯¢æ•ˆç‡</li>
<li>å¼ºå¤§å®Œæ•´çš„ç”Ÿæ€ï¼šå¯é›†æˆå¸‚é¢ä¸Šä¸»æµçš„é‡‡é›†ã€å­˜å‚¨ã€åˆ†æã€å¯è§†åŒ–ç­‰å·¥å…·</li>
</ul>
<h2 id="ä½¿ç”¨åœºæ™¯"><a class="header" href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></h2>
<blockquote>
<p>CnosDBæ˜¯ä¸€ä¸ªä¸“æ³¨äºæ—¶åºæ•°æ®åœºæ™¯çš„æ—¶åºå‹æ•°æ®åº“ï¼Œé€‚ç”¨äºå„ç§æ—¶åºåœºæ™¯ï¼Œå¦‚æœåŠ¡å™¨æŒ‡æ ‡ã€åº”ç”¨ç¨‹åºæŒ‡æ ‡ã€æ€§èƒ½æŒ‡æ ‡ã€å‡½æ•°æ¥å£è°ƒç”¨æŒ‡æ ‡ã€ç½‘ç»œæµé‡æ•°æ®ã€æ¢æµ‹å™¨æ•°æ®ã€æ—¥å¿—ã€å¸‚åœºäº¤æ˜“è®°å½•ç­‰ã€‚</p>
</blockquote>
<h3 id="devopsç›‘æ§"><a class="header" href="#devopsç›‘æ§">DevOpsç›‘æ§</a></h3>
<p>é€šè¿‡ç›‘æ§åŸºç¡€è®¾æ–½ï¼ˆæœåŠ¡å™¨ã€å®¹å™¨ã€æ•°æ®åº“ã€å¾®æœåŠ¡ã€äº‘æœåŠ¡ç­‰ï¼‰çš„æ ¸å¿ƒæŒ‡æ ‡æ¥åŠæ—¶å‘ç°é—®é¢˜å¹¶åœ¨å½±å“å…³é”®ä¸šåŠ¡ä¹‹å‰è§£å†³é—®é¢˜ï¼Œå°½ç®¡ä¸€äº›æ–°å…´æŠ€æœ¯æå‡äº†åŸºç¡€è®¾æ–½çš„DevOpsç›‘æ§çš„å¤æ‚æ€§ï¼Œä½†CnosDBéƒ½èƒ½å¾ˆå¥½çš„é€‚åº”ã€‚CnosDBé€šè¿‡çµæ´»çš„æ’ä»¶çš„å½¢å¼ï¼Œé‡‡é›†æŒ‡æ ‡æˆ–è€…ä»ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆå¦‚StatsDæˆ–Kafkaï¼‰æ‹‰å–æ•°æ®ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰é…ç½®æŒ‰éœ€ä¸ŠæŠ¥ç»™å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿã€‚</p>
<h3 id="iotç›‘æ§"><a class="header" href="#iotç›‘æ§">IoTç›‘æ§</a></h3>
<p>ä¸»è¦ç”¨äºæ¥æ”¶å’Œå¤„ç†æ¥è‡ªIoTè®¾å¤‡çš„æµ·é‡æ•°æ®ï¼Œå¹¶è¿›è¡Œå®æ—¶åˆ†æï¼Œåœ¨æ— äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œé¢„å®šä¹‰æ“ä½œï¼ŒIoTè®¾å¤‡æ— å¤„ä¸åœ¨ï¼Œå…¬è·¯æ‘„åƒå¤´ï¼Œæ™ºèƒ½ç½‘è”è½¦ã€æ‰‹æœºã€å†°ç®±éƒ½æœ‰å®ƒçš„èº«å½±ï¼Œä¸è¿‡IoTè®¾å¤‡çš„ç¡¬ä»¶æ€§èƒ½å’Œç¼“å­˜èƒ½åŠ›æœ‰é™ï¼Œæ•°æ®å¾€å¾€æ˜¯ä»¥æµå¼æ–¹å¼å®æ—¶ä¸ŠæŠ¥ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªå¼¹æ€§ã€æ‰©å±•æ€§å¼ºçš„é«˜æ€§èƒ½æ—¶åºåå°æ¥åº”å¯¹çªå‘æµé‡çš„æŒ‘æˆ˜ã€‚CnosDBçš„æ°´å¹³æ‰©å±•ã€å®æ—¶åˆ†æç­‰èƒ½åŠ›ï¼Œæ˜¯ä¸“é—¨é’ˆå¯¹è¿™ç±»åœºæ™¯æ¥è®¾è®¡çš„ï¼Œå…·æœ‰è¶³å¤Ÿçš„è¯»å†™æ€§èƒ½å’Œå®¹é‡å¼¹æ€§ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å¿«é€Ÿä¸Šæ‰‹"><a class="header" href="#å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h2 id="ä¸‹è½½"><a class="header" href="#ä¸‹è½½">ä¸‹è½½</a></h2>
<ul>
<li>
<h3 id="ubuntu--debian"><a class="header" href="#ubuntu--debian">Ubuntu &amp; Debian</a></h3>
<blockquote>
<p>MD5: 3aa8049d784487f6aeeab21a4e8f7c1c</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb_0.10.3_amd64.deb
sudo dpkg -i cnosdb_0.10.3_amd64.deb
</code></pre>
</li>
<li>
<h3 id="docker-image"><a class="header" href="#docker-image">Docker Image</a></h3>
<pre><code class="language-shell">docker pull cnosdb:0.10.3
</code></pre>
</li>
<li>
<h3 id="redhat--centos"><a class="header" href="#redhat--centos">RedHat &amp; CentOS</a></h3>
<blockquote>
<p>MD5: 0d3c00abdb34764dcbd79eee33ea1c0f</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3.x86_64.rpm
sudo yum localinstall cnosdb-0.10.3.x86_64.rpm
</code></pre>
</li>
<li>
<h3 id="macos"><a class="header" href="#macos">macOS</a></h3>
<blockquote>
<p>MD5: 7711a3167255ee015f1f62f53d0e38cd</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_darwin_amd64.tar.gz
tar zxvf cnosdb-0.10.3_darwin_amd64.tar.gz
</code></pre>
</li>
<li>
<h3 id="windows-binaries64-bit---using-powershell"><a class="header" href="#windows-binaries64-bit---using-powershell">Windows Binaries(64-bit) - using PowerShell</a></h3>
<blockquote>
<p>MD5: 62ea309b3edd8fe9c4b98d10f9bc7dcf</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_windows_amd64.zip -UseBasicParsing -OutFile cnosdb-0.10.3_windows_amd64.zip
Expand-Archive .\cnosdb-0.10.3_windows_amd64.zip -DestinationPath 'C:\Program Files\CnosDB\cnosdb\'
</code></pre>
</li>
<li>
<h3 id="linux-binaries64-bit"><a class="header" href="#linux-binaries64-bit">Linux Binaries(64-bit)</a></h3>
<blockquote>
<p>MD5: 64c763c917030134971d21e54c21a59d</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_linux_amd64.tar.gz
tar xvfz cnosdb-0.10.3_linux_amd64.tar.gz
</code></pre>
</li>
<li>
<h3 id="linux-binaries64-bit-static"><a class="header" href="#linux-binaries64-bit-static">Linux Binaries(64-bit, static)</a></h3>
<blockquote>
<p>MD5: eebb5665fcc4f540de488567caec187d</p>
</blockquote>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3-static_linux_amd64.tar.gz
tar xvfz cnosdb-0.10.3-static_linux_amd64.tar.gz
</code></pre>
</li>
<li>
<h3 id="linux-binaries32-bit"><a class="header" href="#linux-binaries32-bit">Linux Binaries(32-bit)</a></h3>
<p>MD5: 3ed72382eb79d664baeac3b71d744b4b</p>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_linux_i386.tar.gz
tar xvfz cnosdb-0.10.3_linux_i386.tar.gz
</code></pre>
</li>
<li>
<h3 id="linux-binariesarmv7"><a class="header" href="#linux-binariesarmv7">Linux Binaries(ARMv7)</a></h3>
<p>MD5: 90b2b8c72404e1835988325b3ea05f3d</p>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_linux_armhf.tar.gz
tar xvfz cnosdb-0.10.3_linux_armhf.tar.gz
</code></pre>
</li>
<li>
<h3 id="linux-binariesarmv8"><a class="header" href="#linux-binariesarmv8">Linux Binaries(ARMv8)</a></h3>
<p>MD5: 631ef2e05b2d0f5a310422d1871bb003</p>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_linux_arm64.tar.gz
tar xvfz cnosdb-0.10.3_linux_arm64.tar.gz
</code></pre>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å®‰è£…"><a class="header" href="#å®‰è£…">å®‰è£…</a></h1>
<blockquote>
<p>å†å²ç‰ˆæœ¬å’Œå…¶ä»–æ“ä½œç³»ç»Ÿè½¯ä»¶å®‰è£…åŒ…ï¼Œè¯·è®¿é—®<a href="https://github.com/cnosdb/cnosdb/releases">Github Releases</a></p>
</blockquote>
<h2 id="docker"><a class="header" href="#docker">Docker</a></h2>
<ol>
<li>
<p>æ‹‰å–é•œåƒ</p>
<pre><code class="language-shell">docker pull cnosdb/cnosdb:latest
</code></pre>
</li>
<li>
<p>å¯åŠ¨å®¹å™¨</p>
<pre><code class="language-shell">docker run -itd -p 8086:8086 cnosdb/cnosdb:latest
</code></pre>
</li>
</ol>
<h2 id="ubuntu--debian-1"><a class="header" href="#ubuntu--debian-1">Ubuntu &amp; Debian</a></h2>
<ol>
<li>
<p>ä¸‹è½½</p>
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb_0.10.3_amd64.deb
sudo dpkg -i cnosdb_0.10.3_amd64.deb
</code></pre>
</li>
<li>
<p>å¯åŠ¨</p>
<pre><code class="language-shell">sudo systemctl start cnosdb
</code></pre>
</li>
</ol>
<h2 id="red-hat--centos"><a class="header" href="#red-hat--centos">Red Hat &amp; CentOS</a></h2>
<ol>
<li>ä¸‹è½½
<pre><code class="language-shell">wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3.x86_64.rpm
sudo yum localinstall cnosdb-0.10.3.x86_64.rpm
</code></pre>
</li>
<li>å¯åŠ¨
<pre><code class="language-shell">sudo systemctl start cnosdb
</code></pre>
</li>
</ol>
<h2 id="éªŒè¯ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶çš„çœŸå®æ€§å¯é€‰"><a class="header" href="#éªŒè¯ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶çš„çœŸå®æ€§å¯é€‰">éªŒè¯ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶çš„çœŸå®æ€§ï¼ˆå¯é€‰ï¼‰</a></h2>
<p>ä¸ºäº†éªŒè¯å®‰å…¨æ€§ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤éªŒè¯æ‚¨ä¸‹è½½çš„CnosDBçš„<code>gpg</code>ç­¾åï¼ˆå¤§å¤šæ•°ç³»ç»Ÿé»˜è®¤åŒ…å«<code>gpg</code>å‘½ä»¤ï¼Œå¦‚æœ<code>gpg</code>ä¸å¯ç”¨ï¼Œè¯·å‚é˜…<a href="https://gnupg.org/download">Gunä¸»é¡µ</a>è·å–å®‰è£…è¯´æ˜ã€‚</p>
<ol>
<li>ä¸‹è½½å¹¶å¯¼å…¥CnosDBå…¬é’¥</li>
</ol>
<pre><code>curl -s https://www.cnosdb.com/cnosdb.key | gpg --import
</code></pre>
<ol start="2">
<li>é€šè¿‡åœ¨URLä¸Šæ·»åŠ <code>.asc</code>æ¥ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„ç­¾åæ–‡ä»¶</li>
</ol>
<pre><code class="language-shell"> wget https://github.com/cnosdb/cnosdb/releases/download/v0.10.3/cnosdb-0.10.3_linux_amd64.tar.gz
</code></pre>
<ol start="3">
<li>éªŒè¯ç­¾å <code>gpg --verify</code></li>
</ol>
<pre><code class="language-shell"> gpg --verify cnosdb-0.10.3_linux_amd64.tar.gz.asc cnosdb-0.10.3_linux_amd64.tar.gz
</code></pre>
<p>æ­¤å‘½ä»¤åº”è¯¥è¾“å‡ºï¼š</p>
<pre><code class="language-shell">gpg: Good signature from &quot;CnosDB &lt;contact@cnosdb.com&gt;&quot; [unknown]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb-line-protocol"><a class="header" href="#cnosdb-line-protocol">CnosDB line Protocol</a></h1>
<p>CnosDBè¡Œåè®®æ˜¯ä¸€ç§åŸºäºæ–‡æœ¬æ ¼å¼å°†ç‚¹å†™å…¥CnosDBçš„è¡Œåè®®ã€‚</p>
<h2 id="cnosdbè¡Œåè®®å‚è€ƒ"><a class="header" href="#cnosdbè¡Œåè®®å‚è€ƒ">CnosDBè¡Œåè®®å‚è€ƒ</a></h2>
<h3 id="è¯­æ³•"><a class="header" href="#è¯­æ³•">è¯­æ³•</a></h3>
<pre><code class="language-sql">&lt;measurement&gt;[,&lt;tag_key&gt;=&lt;tag_value&gt;[,&lt;tag_key&gt;=&lt;tag_value&gt;]] &lt;field_key&gt;=&lt;field_value&gt;[,&lt;field_key&gt;=&lt;field_value&gt;] [&lt;timestamp&gt;]
</code></pre>
<p>è¡Œåè®®æ¥å—æ¢è¡Œç¬¦<code>\n</code>ï¼Œå¯¹ç©ºæ ¼æ•æ„Ÿã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šè¡Œåè®®ä¸æ”¯æŒåœ¨æ ‡ç­¾å€¼æˆ–å­—æ®µå€¼ä¸­ä½¿ç”¨æ¢è¡Œç¬¦<code>\n</code>ã€‚</p>
</blockquote>
<h3 id="è¯­æ³•æè¿°"><a class="header" href="#è¯­æ³•æè¿°">è¯­æ³•æè¿°</a></h3>
<ul>
<li>
<p><code>measurement</code>- å¿…é¡»ã€‚æ˜¯measurementé¡¹çš„åå­—ã€‚CnosDBæ¥å—æ¯ä¸€ä¸ªç‚¹çš„measurementå€¼ã€‚ä¸ºstringç±»å‹ã€‚</p>
</li>
<li>
<p><code>tag set</code> - å¯é€‰ã€‚ä¸ºè¯¥ç‚¹æ‰€æœ‰çš„æ ‡è®°é”®å€¼å¯¹ã€‚tag keyså’Œtag valueséƒ½æ˜¯stringç±»å‹ã€‚</p>
</li>
<li>
<p><code>field set</code> - å¿…é¡»ã€‚æ¯ä¸€ä¸ªç‚¹å¿…é¡»è¦æœ‰ä¸€ä¸ªfieldã€‚æ˜¯è¯¥ç‚¹æ‰€æœ‰çš„å­—æ®µé”®å€¼å¯¹ã€‚å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚</p>
</li>
<li>
<p><code>timestamp</code> - å¯é€‰ã€‚å¦‚æœæ—¶é—´æˆ³æ²¡æœ‰åŒ…å«åœ¨ç‚¹ä¸­ï¼Œåˆ™CnosDBå°†åœ¨UTCä¸­ä½¿ç”¨æœåŠ¡å™¨çš„æœ¬åœ°çº³ç§’æ—¶é—´æˆ³ã€‚</p>
</li>
</ul>
<h3 id="æ€§èƒ½å°æç¤º"><a class="header" href="#æ€§èƒ½å°æç¤º">æ€§èƒ½å°æç¤º</a></h3>
<ul>
<li>å°†æ•°æ®å‘é€åˆ°CnosDBä¹‹å‰ï¼Œè¯·ä½¿ç”¨<a href="https://pkg.go.dev/bytes#Compare">Go bytes.Compare function</a>å¯¹æ•°æ®æ ¹æ®tag keyæ’åºã€‚</li>
<li>è¦æ˜¾è‘—æ”¹å–„å‹ç¼©ï¼Œè¯·å¯¹æ—¶é—´æˆ³ä½¿ç”¨å°½å¯èƒ½ç²—ç³™çš„ç²¾åº¦ã€‚</li>
<li>ä½¿ç”¨NTP (Network Time Protocol)åŒæ­¥ä¸»æœºæ—¶é—´ã€‚CnosDBä½¿ç”¨UTCæ ¼å¼çš„ä¸»æœºæœ¬åœ°æ—¶é—´ä¸ºæ•°æ®åˆ†é…æ—¶é—´æˆ³ã€‚å¦‚æœä¸»æœºçš„æ—¶é’Ÿæ²¡æœ‰ä¸NTPåŒæ­¥ï¼Œåˆ™ä¸»æœºå†™å…¥åˆ°CnosDBçš„æ•°æ®å¯èƒ½æœ‰ä¸å‡†ç¡®çš„æ—¶é—´æˆ³ã€‚</li>
</ul>
<h3 id="ä¾‹å­"><a class="header" href="#ä¾‹å­">ä¾‹å­</a></h3>
<ul>
<li>
<p>å°†fieldå€¼<code>-1.234456e+78</code>ä½œä¸ºæµ®ç‚¹æ•°å†™å…¥CnosDB</p>
<pre><code>INSERT mydb value=-1.234456e+78
</code></pre>
</li>
</ul>
<p>CnosDBæ”¯æŒç”¨ç§‘å­¦ç¬¦å·æŒ‡å®šçš„å­—æ®µå€¼ã€‚</p>
<ul>
<li>
<p>å°†fieldå€¼<code>1.0</code>ä½œä¸ºæµ®ç‚¹æ•°å†™å…¥CnosDB</p>
<p><code>INSERT mydb value=1.0</code></p>
</li>
<li>
<p>å°†fieldå€¼<code>1</code>ä½œä¸ºæµ®ç‚¹æ•°å†™å…¥CnosDB</p>
<p><code>INSERT mydb value=1</code></p>
</li>
<li>
<p>å°†fieldå€¼<code>1.0</code>ä½œä¸ºæ•´æ•°å†™å…¥CnosDBï¼Œåœ¨å­—æ®µå€¼åé™„åŠ iï¼Œå‘Šè¯‰CnosDBå°†æ•°å­—å­˜å‚¨ä¸ºæ•´æ•°ã€‚</p>
<p><code>INSERT mydb value=1i</code></p>
</li>
<li>
<p>å°†fieldå€¼<code>string exapmple</code>ä½œä¸ºå­—ç¬¦ä¸²å†™å…¥CnosDB</p>
<p><code>INSERT mydb value=&quot;stringing along&quot;</code></p>
</li>
<li>
<p>å°†fieldå€¼<code>true</code>ä½œä¸ºå¸ƒå°”å€¼å†™å…¥CnosDB</p>
<p><code>INSERT mydb value=true</code></p>
</li>
<li>
<p>å°è¯•å°†å­—ç¬¦ä¸²å†™å…¥å…ˆå‰æ¥æ”¶æµ®ç‚¹æ•°çš„å­—æ®µ</p>
<p>å¦‚æœfloatå’Œstringçš„æ—¶é—´æˆ³å­˜å‚¨åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ä¸­:</p>
<pre><code>INSERT mydb value=3 1465934559000000000
INSERT mydb value=&quot;stringing example&quot; 1465934559000000001
ERR: {&quot;error&quot;:&quot;field type conflict: input field \&quot;value\&quot; on measurement \&quot;mymeas\&quot; is type string, already exists as type float&quot;}
</code></pre>
<p>å¦‚æœfloatå’Œstringçš„æ—¶é—´æˆ³æ²¡æœ‰å­˜å‚¨åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ä¸­:</p>
<pre><code>INSERT mymeas value=3 1465934559000000000
INSERT mymeas value=&quot;stringing example&quot; 1466625759000000000
</code></pre>
</li>
</ul>
<h2 id="cnosdbè¡Œåè®®æ•™ç¨‹"><a class="header" href="#cnosdbè¡Œåè®®æ•™ç¨‹">CnosDBè¡Œåè®®æ•™ç¨‹</a></h2>
<pre><code>CnosDBè¡Œåè®®æ˜¯ä¸€ç§å°†ç‚¹å†™å…¥æ•°æ®åº“çš„åŸºäºæ–‡æœ¬çš„æ ¼å¼ã€‚ç‚¹å¿…é¡»æ˜¯è¡Œåè®®æ ¼å¼ï¼Œä»¥ä¾¿CnosDBæˆåŠŸè§£æå’Œå†™å…¥ç‚¹ã€‚
</code></pre>
<h3 id="è¯­æ³•-1"><a class="header" href="#è¯­æ³•-1">è¯­æ³•</a></h3>
<blockquote>
<p>è¡Œåè®®æ ¼å¼ä¸­çš„ä¸€è¡Œæ–‡æœ¬è¡¨ç¤ºCnosDBä¸­çš„ä¸€ä¸ªæ•°æ®ç‚¹ã€‚å®ƒå°†ç‚¹çš„measurement valueã€tag setã€field setå’Œtimestampå‘ŠçŸ¥CnosDBã€‚ä¸‹é¢çš„ä»£ç å—æ˜¾ç¤ºäº†ä¸€ä¸ªè¡Œåè®®çš„ç¤ºä¾‹ï¼Œå¹¶å°†å…¶åˆ†è§£ä¸ºç‹¬ç«‹çš„ç»„ä»¶:</p>
</blockquote>
<pre><code>    air,station=LianYunGang temperature=74 1642176540000000000
    |    -------------------- -----------------  |
    |              |              |              |
    |              |              |              |
    +-----------+--------+-+---------+-+---------+
    |measurement|,tag_set| |field_set| |timestamp|
    +-----------+--------+-+---------+-+---------+
</code></pre>
<p><strong><code>measurement</code></strong></p>
<ul>
<li><code>measurement</code> - è¦å°†æ•°æ®å†™å…¥çš„measurementçš„åå­—ã€‚measurementéœ€ç¬¦åˆçº¿è·¯åè®®ã€‚åœ¨æœ¬ä¾‹å­ä¸­ï¼Œmeasurementä¸ºweatherã€‚</li>
<li><code>tag set</code> - æ ‡è®°é›†ã€‚åŒ…å«åœ¨æ•°æ®ç‚¹ä¸­çš„æ ‡è®°ã€‚tagåœ¨è¡Œåè®®ä¸­æ˜¯å¯é€‰çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œtag setå’Œmeasurementä¹‹é—´ç”±é€—å·åˆ†éš”ï¼Œæ²¡æœ‰ç©ºæ ¼ã€‚ç”¨ç­‰å·<code>=</code>åˆ†éš”æ ‡ç­¾çš„é”®å€¼å¯¹æ—¶ï¼Œä¸éœ€è¦æ’å…¥ç©ºæ ¼ï¼Œå¦‚:<code>&lt;tag_key&gt;=&lt;tag_value&gt;</code>ã€‚å¤šä¸ªæ ‡è®°å€¼å¯¹ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼Œä¸èƒ½æœ‰ç©ºæ ¼ã€‚åœ¨æœ¬ä¾‹å­ä¸­ï¼Œæ ‡è®°é›†ç”±æ ‡è®°<code>station=LianYunGang</code>ç»„æˆã€‚ 
å½“åœ¨æ ‡è®°é›†ä¸­ä½¿ç”¨å¼•å·æ—¶ï¼Œè¡Œåè®®æ”¯æŒå•å¼•å·å’ŒåŒå¼•å·ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤º:</li>
<li><code>ç©ºæ ¼ I</code> - å°†åº¦é‡å’Œå­—æ®µé›†åˆ†å¼€ï¼Œæˆ–è€…ï¼Œå¦‚æœæ‚¨åœ¨æ•°æ®ç‚¹ä¸­åŒ…å«ä¸€ä¸ªæ ‡è®°é›†ï¼Œåˆ™ä½¿ç”¨ç©ºæ ¼å°†æ ‡è®°é›†å’Œå­—æ®µé›†åˆ†å¼€ã€‚åœ¨è¡Œåè®®ä¸­éœ€è¦ç©ºæ ¼ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰tag setçš„æœ‰æ•ˆè¡Œåè®®<code>air temperature=75 1642176360000000000</code>ã€‚</li>
<li><code>field set</code> - æ‚¨çš„æ•°æ®ç‚¹çš„å­—æ®µã€‚æ¯ä¸ªè¡Œåè®®ä¸­çš„æ•°æ®ç‚¹è‡³å°‘éœ€è¦ä¸€ä¸ªå­—æ®µã€‚ç”¨ç­‰å·=åˆ†éš”å­—æ®µçš„é”®å€¼å¯¹ï¼Œå¹¶ä¸”æ²¡æœ‰ç©ºæ ¼ï¼Œæ¯”å¦‚ï¼š<code>&lt;field_key&gt;=&lt;field_value&gt;</code>ã€‚å¤šä¸ªå­—æ®µå€¼å¯¹ç”¨é€—å·åˆ†éš”ï¼Œä¸èƒ½ç”¨ç©ºæ ¼ï¼Œå¦‚ï¼š<code>&lt;field_key&gt;=&lt;field_value&gt;,&lt;field_key&gt;=&lt;field_value&gt;</code>ã€‚</li>
<li><code>ç©ºæ ¼ II</code> - ç”¨ç©ºæ ¼åˆ†éš”field setå’Œæ—¶é—´æˆ³ã€‚å¦‚æœåŒ…å«æ—¶é—´æˆ³ï¼Œåˆ™è¡Œåè®®ä¸­éœ€è¦ç©ºæ ¼ã€‚</li>
<li><code>timestamp</code> - æ•°æ®ç‚¹çš„æ—¶é—´æˆ³ï¼Œä»¥çº³ç§’çº§Unixæ—¶é—´ä¸ºå•ä½ã€‚æ—¶é—´æˆ³åœ¨è¡Œåè®®ä¸­æ˜¯å¯é€‰çš„ã€‚å¦‚æœæ²¡æœ‰ä¸ºæ•°æ®ç‚¹æŒ‡å®šæ—¶é—´æˆ³ï¼Œåˆ™CnosDBå°†åœ¨UTCä¸­ä½¿ç”¨æœåŠ¡å™¨çš„æœ¬åœ°çº³ç§’æ—¶é—´æˆ³ã€‚</li>
</ul>
<h3 id="æ•°æ®ç±»å‹"><a class="header" href="#æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></h3>
<ul>
<li>measurements, tag keys, tag valueså’Œfield keysæ€»æ˜¯å­—ç¬¦ä¸²ã€‚</li>
<li>æ—¶é—´æˆ³ä¸ºUNIXæ—¶é—´æˆ³ã€‚æœ€å°æ—¶é—´æˆ³ä¸º<code>-9223372036854775806</code>æˆ–<code>1677-09-21T00:12:43.145224194Z</code>ã€‚æœ€å¤§æ—¶é—´æˆ³ä¸º<code>9223372036854775806</code>æˆ–<code>2262-04-11T23:47:16.854775806Z</code>ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæ ¹æ®é»˜è®¤é…ç½®ï¼ŒCnosDBå‡è®¾æ—¶é—´æˆ³å…·æœ‰çº³ç§’ç²¾åº¦ã€‚</li>
<li>field valueå¯ä»¥æ˜¯æµ®ç‚¹æ•°ã€æ•´æ•°ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒCnosDBå‡è®¾æ‰€æœ‰çš„field valueéƒ½æ˜¯æµ®ç‚¹æ•°ã€‚</li>
<li>åœ¨ä¸€ä¸ªmeasurementä¸­ï¼Œä¸€ä¸ªåˆ†ç‰‡ä¸­çš„å­—æ®µç±»å‹ä¸èƒ½ä¸åŒã€‚ä½†å¤šä¸ªåˆ†ç‰‡ä¸­çš„å­—æ®µç±»å‹å¯ä»¥ä¸åŒã€‚ä¾‹å¦‚ï¼Œå¦‚æœInfluxDBè¯•å›¾å°†æ•´æ•°å­˜å‚¨åœ¨ä¸æµ®ç‚¹æ•°ç›¸åŒçš„åˆ†ç‰‡ä¸­ï¼Œåˆ™å°†æ•´æ•°å†™å…¥ä¹‹å‰æ¥å—çš„æµ®ç‚¹æ•°å­—æ®µå°†å¤±è´¥:
<pre><code>&gt; INSERT air,station=LianYunGang temperature=72 1642176180000000000
&gt; INSERT air,station=LianYunGang temperature=79i 1642176540000000000
ERR: {&quot;error&quot;:&quot;field type conflict: input field \&quot;temperature\&quot; on measurement \&quot;air\&quot; is type int64, already exists as type float&quot;}
</code></pre>
</li>
</ul>
<h3 id="å¼•å·"><a class="header" href="#å¼•å·">å¼•å·</a></h3>
<ul>
<li>ä¸è¦å¯¹æ—¶é—´æˆ³ä½¿ç”¨åŒå¼•å·æˆ–å•å¼•å·ã€‚è¿™ä¸æ˜¯æœ‰æ•ˆçš„çº¿è·¯åè®®ã€‚ä¾‹å¦‚ï¼š
<pre><code>&gt; INSERT air,station=LianYunGang temperature=72 &quot;1642176180000000000&quot;
ERR: {&quot;error&quot;:&quot;unable to parse 'air,station=LianYunGang temperature=72 \&quot;1642176180000000000\&quot;': bad timestamp&quot;}
</code></pre>
</li>
<li>æ°¸è¿œä¸è¦ç»™å­—æ®µå€¼(å³ä½¿å®ƒä»¬æ˜¯å­—ç¬¦ä¸²)åŠ å•å¼•å·ï¼Œè¿™ä¹Ÿä¸æ˜¯æœ‰æ•ˆçš„çº¿è·¯åè®®ã€‚ä¾‹å¦‚ï¼š
<pre><code>&gt; INSERT air,station=LianYunGang temperature='72' 1642176180000000000
ERR: {&quot;error&quot;:&quot;unable to parse 'air,station=LianYunGang temperature='72'': invalid boolean&quot;} 
</code></pre>
</li>
<li>ä¸è¦ç”¨åŒå¼•å·æˆ–å•å¼•å·å¼•ç”¨measurementåç§°ã€tag keyã€tag valueå’Œfield keyã€‚è¿™æ˜¯æœ‰æ•ˆçš„è¡Œåè®®ï¼Œä½†CnosDBå‡å®šå¼•ç”¨æ˜¯åç§°çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼š
<pre><code>&gt; INSERT air,station=LianYunGang temperature=72 1642176180000000000
&gt; INSERT &quot;air&quot;,station=LianYunGang temperature=79 1642176540000000000
&gt; SHOW MEASUREMENTS
name: measurements
------------------
name
&quot;air&quot;
air
</code></pre>
</li>
<li>è¦æŸ¥è¯¢&quot;air&quot;ä¸­çš„æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨åŒå¼•å·ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„è½¬ä¹‰å­—ç¬¦ã€‚
<pre><code>&gt; SELECT * FROM &quot;\&quot;air\&quot;&quot;
name: &quot;air&quot;
time                 station     temperature
----                 -------     -----------
2022-01-14T16:09:00Z LianYunGang 79

</code></pre>
</li>
<li>ä¸è¦å¯¹æµ®ç‚¹å‹ã€æ•´å‹æˆ–å¸ƒå°”å‹å­—æ®µå€¼ä½¿ç”¨åŒå¼•å·ã€‚CnosDBå°†å‡å®šè¿™äº›å€¼æ˜¯å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š
<pre><code>&gt; INSERT air,station=LianYunGang temperature=&quot;72&quot;
&gt; SELECT * FROM air WHERE temperature &gt;= 70
&gt;
</code></pre>
å¯¹ç±»å‹ä¸ºå­—ç¬¦ä¸²çš„å­—æ®µå€¼ä½¿ç”¨åŒå¼•å·ã€‚
<pre><code>&gt; INSERT air,station=LianYunGang temperature=&quot;too warm&quot;
&gt; SELECT * FROM air
name: air
-------------
time				            station	 temperature
2022-01-14T16:09:00Z	LianYunGang	 too warm
</code></pre>
</li>
</ul>
<h3 id="ç‰¹æ®Šå­—ç¬¦å’Œå…³é”®å­—"><a class="header" href="#ç‰¹æ®Šå­—ç¬¦å’Œå…³é”®å­—">ç‰¹æ®Šå­—ç¬¦å’Œå…³é”®å­—</a></h3>
<p>å¯¹äºtag keys,tag values,measurement,å­—ç¬¦ä¸²ç±»å‹çš„field valuesä»¥åŠfield keysæ€»æ˜¯ä½¿ç”¨åæ–œæ å­—ç¬¦<code>\</code>è¿›è¡Œè½¬ä¹‰ã€‚</p>
<ul>
<li>é€—å·<code>,</code>ï¼š
<pre><code>wind,station=Lian\,YunGang visibility=59,temperature=59,pressure=56 1649664217071649000
</code></pre>
</li>
<li>ç­‰å·<code>=</code>ï¼š
<pre><code>wind,station=LianYunGang vis\=ibility=59,temperature=59,pressure=56 1649664217071649000
</code></pre>
</li>
<li>ç©ºæ ¼<code> </code>ï¼š
<pre><code>wind,stat\ ion=LianYunGang visibility=59,temperature=59,pressure=56 1649664217071649000
</code></pre>
</li>
<li>emojis ğŸ¥°ï¼š CnosDBçš„è¡Œåè®®æ”¯æŒemojisè¡¨æƒ…çš„è¾“å…¥ï¼Œå¹¶ä¸”æ— éœ€ä½¿ç”¨è½¬ä¹‰å­—ç¬¦è½¬ä¹‰ã€‚ä¾‹å¦‚ï¼š
<pre><code>&gt; INSERT ğŸŒ¤,â›ªï¸=LianYunGang ğŸŒ¡=23
&gt; SELECT * FROM &quot;ğŸŒ¤&quot;
name: ğŸŒ¤
time                        â›ªï¸          ğŸŒ¡
----                        ------      ----
2022-04-14T03:50:01.705037Z LianYunGang 23

</code></pre>
</li>
<li>å…³é”®å­—:è¡Œåè®®æ¥å—CnosQLå…³é”®å­—ä½œä¸ºæ ‡è¯†ç¬¦åç§°ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å»ºè®®é¿å…åœ¨æ¨¡å¼ä¸­ä½¿ç”¨CnosQLå…³é”®å­—ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šåœ¨æŸ¥è¯¢æ•°æ®æ—¶é€ æˆæ··ä¹±ã€‚ å…³é”®å­—<code>time</code>æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚<code>time</code>å¯ä»¥æ˜¯è¿ç»­æŸ¥è¯¢åç§°ã€æ•°æ®åº“åç§°ã€measurementåç§°ã€ä¿ç•™ç­–ç•¥åç§°å’Œç”¨æˆ·åç§°ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œ<code>time</code>ä¸éœ€è¦åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨åŒå¼•å·ã€‚<code>time</code>ä¸èƒ½æ˜¯å­—æ®µé”®æˆ–æ ‡è®°é”®;CnosDBæ‹’ç»ä»¥<code>time</code>ä½œä¸ºå­—æ®µé”®æˆ–æ ‡è®°é”®çš„å†™æ“ä½œï¼Œå¹¶è¿”å›é”™è¯¯ã€‚</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb-write-api"><a class="header" href="#cnosdb-write-api">CnosDB Write API</a></h1>
<h2 id="ä½¿ç”¨cnosdb-apiåˆ›å»ºæ•°æ®åº“"><a class="header" href="#ä½¿ç”¨cnosdb-apiåˆ›å»ºæ•°æ®åº“">ä½¿ç”¨CnosDB APIåˆ›å»ºæ•°æ®åº“</a></h2>
<p>è¦åˆ›å»ºæ•°æ®åº“ï¼Œå…ˆå‘<code>/query</code>ç«¯ç‚¹å‘é€<code>POST</code>è¯·æ±‚ï¼Œå¹¶å°†URLå‚æ•°ä¸­çš„<code>q</code>è®¾ç½®ä¸º<code>CREATE DATABASE &lt;new_database_name&gt;</code>ã€‚ä¾‹å¦‚,åœ¨CnosDBä¸­åˆ›å»ºä¸€ä¸ªåä¸º&quot;weather_data&quot;çš„æ•°æ®åº“ã€‚</p>
<pre><code>curl -i -XPOST http://localhost:8086/query --data-urlencode &quot;q=CREATE DATABASE weather_data&quot;
</code></pre>
<h2 id="ä½¿ç”¨cnosdb-apiå†™å…¥æ•°æ®"><a class="header" href="#ä½¿ç”¨cnosdb-apiå†™å…¥æ•°æ®">ä½¿ç”¨CnosDB APIå†™å…¥æ•°æ®</a></h2>
<blockquote>
<p><code>measurement</code>ä¸<code>tag</code>ä¹‹é—´ä½¿ç”¨<code>,</code>åˆ†éš”</p>
<p><code>tag</code>ç»„åˆå¯ä»¥æœ‰å¤šä¸ªï¼Œ<code>tag</code>ä¹‹é—´ä½¿ç”¨<code>,</code>åˆ†éš”</p>
<p><code>tag</code>ä¸<code>field</code>ä¹‹é—´ä½¿ç”¨ç©ºæ ¼åˆ†éš”</p>
<p><code>field</code>ç»„åˆå¯ä»¥æœ‰å¤šä¸ªï¼Œ<code>field</code>ä¹‹é—´ä½¿ç”¨<code>,</code>åˆ†éš”</p>
<p><code>field</code>ä¸æ—¶é—´æˆ³ä½¿ç”¨ç©ºæ ¼åˆ†éš”</p>
</blockquote>
<p>ä½¿ç”¨CnosDB APIå†™å…¥æ•°æ®ï¼Œå‘/writeç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œå‘&quot;weather_data&quot;å†™å…¥ä¸€ä¸ªç‚¹ã€‚æ­¤æ•°æ®çš„ç»„æˆä¸ºï¼šmeasurementä¸º<code>wind</code>ï¼Œfield keyä¸º<code>speed</code>å’Œ<code>direction</code>ï¼Œfield valuesåˆ†åˆ«ä¸º<code>75</code>å’Œ<code>65</code>ï¼Œtimestampä¸º<code>1649664217085031000</code>ã€‚</p>
<pre><code>curl -i -XPOST 'http://localhost:8086/write?db=weather_data' --data-binary 'wind,station=LianYunGang speed=75,direction=65 1649664217085031000'
</code></pre>
<p>å†™å…¥ç‚¹æ—¶ï¼Œå¿…é¡»åœ¨<code>db</code>æŸ¥è¯¢å‚æ•°ä¸­æŒ‡å®šä¸€ä¸ªå·²å­˜åœ¨çš„æ•°æ®åº“ã€‚å¦‚æœä½ ä¸é€šè¿‡<code>rp</code>æŸ¥è¯¢å‚æ•°æä¾›ä¿ç•™ç­–ç•¥ï¼Œç‚¹å°†è¢«å†™å…¥æ•°æ®åº“çš„é»˜è®¤ä¿ç•™ç­–ç•¥ã€‚</p>
<h2 id="å†™å…¥å¤šç‚¹"><a class="header" href="#å†™å…¥å¤šç‚¹">å†™å…¥å¤šç‚¹</a></h2>
<p>å°†å¤šä¸ªç‚¹åŒæ—¶Poståˆ°å¤šä¸ªåºåˆ—ï¼Œæ¯ä¸ªç‚¹ç”¨ä¸€ä¸ªæ–°è¡Œåˆ†å¼€ã€‚ä»¥è¿™ç§æ–¹å¼å¯¹ç‚¹è¿›è¡Œæ‰¹å¤„ç†å¯ä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚</p>
<p>é€šè¿‡ç”¨æ¢è¡Œåˆ†éš”æ¯ä¸ª<code>Points</code>ï¼Œå°†å¤šä¸ª<code>Points</code>åŒæ—¶å†™å…¥åˆ°å¤šä¸ª<code>series</code>ä¸­ï¼Œä»¥è¿™ç§æ–¹å¼æ‰¹å¤„ç†<code>Points</code>å¯ä»¥æé«˜æ€§èƒ½ã€‚</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä¸‰ä¸ª<code>Points</code>å†™å…¥æ•°æ®åº“<code>mydb</code>:</p>
<pre><code class="language-bash">curl -i -XPOST 'http://localhost:8086/write?db=weather_data' --data-binary 'wind,station=LianYunGang speed=75,direction=65 1649664217085027000
wind,station=LianYunGang speed=75,direction=65 1649664217085031000
wind,station=XiaoMaiDao speed=70,direction=63 1649664217085036000'
</code></pre>
<h2 id="é…ç½®gzipå‹ç¼©"><a class="header" href="#é…ç½®gzipå‹ç¼©">é…ç½®gzipå‹ç¼©</a></h2>
<p>cnosdbæ”¯æŒgzipå‹ç¼©ï¼Œè¦å‡å°‘ç½‘ç»œæµé‡ï¼Œéœ€ä¼˜å…ˆè€ƒè™‘ä¸€ä¸‹é€‰é¡¹</p>
<ul>
<li>
<p>è¦æ¥å—æ¥è‡ªcnosdbçš„å‹ç¼©æ•°æ®ï¼Œè¯·å°†<code>Accept-Encodingï¼šgzip</code>headeä¿¡æ¯æ·»åŠ åˆ°cnosdb APIè¯·æ±‚ä¸­</p>
</li>
<li>
<p>è¦åœ¨å°†æ•°æ®å‘é€åˆ°cnosdbä¹‹å‰å‹ç¼©æ•°æ®ï¼Œå°†<code>Content-Encoding:gzip</code>headeä¿¡æ¯æ·»åŠ åˆ°cnosdb APIè¯·æ±‚ä¸­</p>
</li>
</ul>
<h2 id="ä»æ–‡ä»¶å†™å…¥points"><a class="header" href="#ä»æ–‡ä»¶å†™å…¥points">ä»æ–‡ä»¶å†™å…¥Points</a></h2>
<p>é€šè¿‡ä¼ é€’<code>@filename</code>åˆ°æ–‡ä»¶æ¥å†™å…¥æ–‡ä»¶ä¸­çš„æ•°æ®</p>
<p>æ ¼å¼æ­£ç¡®çš„æ–‡ä»¶ï¼ˆ<code>data.txt</code>ï¼‰çš„ç¤ºä¾‹ï¼š</p>
<p>å†™å…¥æ•°æ®data.txtåˆ°weather_dataæ•°æ®åº“</p>
<pre><code class="language-bash">curl -i -XPOST 'http://localhost:8086/write?weather_data' --data-binary @data.txt
</code></pre>
<p>æ³¨æ„ï¼šå¦‚æœæ‚¨çš„æ•°æ®æ–‡ä»¶å…·æœ‰è¶…è¿‡5000ä¸ªPointsï¼Œåˆ™å¯èƒ½æœ‰å¿…è¦å°†è¯¥æ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿å°†æ•°æ®æ‰¹é‡å†™å…¥cnosdbï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTPè¯·æ±‚åœ¨äº”ç§’åè¶…æ—¶ï¼Œè¶…æ—¶åï¼Œcnosdbä»ç„¶å°†å°è¯•å†™å…¥è¿™äº›ç‚¹ï¼Œä½†æ˜¯ä¸ä¼šç¡®è®¤å®ƒä»¬å·²ç»æˆåŠŸå†™å…¥</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb-query-api"><a class="header" href="#cnosdb-query-api">CnosDB Query API</a></h1>
<h2 id="å•æ¡æŸ¥è¯¢è¯­å¥"><a class="header" href="#å•æ¡æŸ¥è¯¢è¯­å¥">å•æ¡æŸ¥è¯¢è¯­å¥</a></h2>
<p>CnosDB API æ˜¯åœ¨ CnosDBä¸­æŸ¥è¯¢æ•°æ®çš„ä¸»è¦æ–¹å¼ã€‚</p>
<p>å¦‚æœéœ€è¦æ‰§è¡ŒæŸ¥è¯¢è¯·æ±‚ï¼Œéœ€è¦å°†GETè¯·æ±‚å‘é€åˆ°/queryç«¯ç‚¹ï¼Œå°†URLå‚æ•°dbè®¾ç½®ä¸ºç›®æ ‡æ•°æ®åº“ï¼Œå¹¶å°†å‚æ•°qè®¾ç½®ä¸ºæŸ¥è¯¢è¯­å¥ã€‚è¿˜å¯ä»¥é€šè¿‡å‘é€ç›¸åŒçš„å‚æ•°ä½œä¸ºURLå‚æ•°æˆ–ä½œä¸ºå¸¦æœ‰<code>application/x-www-form-urlencoded</code>çš„æ­£æ–‡çš„ä¸€éƒ¨åˆ†æ¥ä½¿ç”¨POSTè¯·æ±‚ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code>curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode &quot;db=weather_data&quot; --data-urlencode &quot;q=SELECT \&quot;speed\&quot; FROM \&quot;wind\&quot; WHERE \&quot;station\&quot;='LianYunGang'&quot;
</code></pre>
<p>å…¶ç»“æœä¸ºï¼š</p>
<pre><code>{
&quot;results&quot;: [
    {_
        &quot;statement_id&quot;: 0,
        &quot;series&quot;: [
            {
                &quot;name&quot;: &quot;wind&quot;,
                &quot;columns&quot;: [
                    &quot;time&quot;,
                    &quot;speed&quot;
                ],
                &quot;values&quot;: [
                    [
                        &quot;2022-04-11T08:03:37.085027Z&quot;,
                        75
                    ],
                    [
                        &quot;2022-04-11T08:03:37.085031Z&quot;,
                        75
                    ]
                  ]  
                }
            ]
        }
    ]
}

</code></pre>
<h2 id="è¿”å›é”™è¯¯"><a class="header" href="#è¿”å›é”™è¯¯">è¿”å›é”™è¯¯</a></h2>
<p>CnosDBè¿”å›JSONï¼ŒæŸ¥è¯¢çš„ç»“æœä¼šåœ¨<code>rusults</code>æ•°ç»„ä¸­ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼ŒCnosDBä¼šè®¾ç½®ä¸€ä¸ªå¸¦æœ‰<code>error</code>çš„key</p>
<h2 id="å¤šæ¡æŸ¥è¯¢è¯­å¥"><a class="header" href="#å¤šæ¡æŸ¥è¯¢è¯­å¥">å¤šæ¡æŸ¥è¯¢è¯­å¥</a></h2>
<p>å¤šæ¡æŸ¥è¯¢è¯­å¥éœ€è¦ç”¨<code>;</code>åˆ†éš”</p>
<pre><code class="language-shell">curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode &quot;db=weather_data&quot; --data-urlencode &quot;q=SELECT speed FROM wind WHERE station = 'XiaoMaiDao';SELECT temperature FROM air WHERE station = 'XiaoMaiDao'&quot;
</code></pre>
<h2 id="æ—¶é—´ç²¾åº¦"><a class="header" href="#æ—¶é—´ç²¾åº¦">æ—¶é—´ç²¾åº¦</a></h2>
<p>CnosDBä¸­çš„æ‰€æœ‰å†…å®¹éƒ½ä»¥UTCå­˜å‚¨å’Œè¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—¶é—´æˆ³ä»¥RFC3339æ ¼å¼è¿”å›ï¼Œä¾‹å¦‚ 2015-08-04T19:05:00Zï¼Œå¦‚æœæƒ³è¦Unixçºªå…ƒæ ¼å¼çš„æ—¶é—´æˆ³ï¼Œåˆ™éœ€è¦åœ¨è¯·æ±‚ä¸­åŒ…å«å­—ç¬¦ä¸²å‚æ•°ï¼šepoch=[h, m, s, ms, u, ns]</p>
<pre><code class="language-shell">curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode &quot;db=oceanic_station&quot; --data-urlencode &quot;epoch=s&quot; --data-urlencode &quot;q=SELECT temperature FROM air WHERE station = 'XiaoMaiDao'&quot;
</code></pre>
<h2 id="æœ€å¤§è¡Œé™åˆ¶"><a class="header" href="#æœ€å¤§è¡Œé™åˆ¶">æœ€å¤§è¡Œé™åˆ¶</a></h2>
<p><code>max-row-limit</code>é…ç½®é€‰é¡¹å…è®¸ç”¨äºé™åˆ¶è¿”å›ç»“æœæœ€å¤§æ•°é‡ï¼Œä»¥é˜²æ­¢CnosDBåœ¨èšåˆç»“æœæ—¶è€—å°½å†…å­˜ï¼Œ<code>max-row-limit</code>é…ç½®é€‰é¡¹é»˜è®¤è®¾ç½®ä¸º0ï¼Œè¯¥é»˜è®¤è®¾ç½®å…è®¸æ¯ä¸ªè¯·æ±‚è¿”å›æ— é™æ•°é‡çš„è¡Œã€‚
æœ€å¤§è¡Œé™åˆ¶é€‚ç”¨äºéå—æŸ¥è¯¢ï¼Œåˆ†å—æŸ¥è¯¢å¯ä»¥è¿”å›æ— é™æ•°é‡çš„pointsã€‚</p>
<h2 id="chunking"><a class="header" href="#chunking">Chunking</a></h2>
<p>é€šè¿‡è®¾ç½®æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°chunked=trueï¼Œå¯ä»¥ä½¿ç”¨åˆ†å—ä»¥æµå¼æ‰¹å¤„ç†è€Œä¸æ˜¯ä½œä¸ºå•ä¸ªå“åº”è¿”å›ç»“æœã€‚å“åº”å°†æŒ‰seriesæˆ–æ¯10000pointåˆ†å—ï¼Œä»¥å…ˆå‘ç”Ÿè€…ä¸ºå‡†ã€‚è¦å°†æœ€å¤§å—å¤§å°æ›´æ”¹ä¸ºä¸åŒçš„å€¼ï¼Œéœ€è¦å°†æŸ¥è¯¢å­—ç¬¦ä¸²chunk_sizeè®¾ç½®ä¸ºä¸åŒçš„å€¼</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prometheus"><a class="header" href="#prometheus">Prometheus</a></h1>
<p>CnosDBå¯¹Prometheusè¿œç¨‹è¯»å†™çš„æ”¯æŒæ˜¯å°†ä»¥ä¸‹HTTPç«¯ç‚¹æ·»åŠ åˆ°CnosDBã€‚</p>
<ul>
<li>/api/v1/prom/read</li>
<li>/api/v1/prom/write</li>
</ul>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>/metrics</code>ç«¯ç‚¹è¢«é…ç½®ä¸ºä»¥Prometheusåº¦é‡æ ¼å¼ç”Ÿæˆé»˜è®¤çš„Goåº¦é‡ã€‚</p>
<h2 id="åˆ›å»ºç›®æ ‡æ•°æ®åº“"><a class="header" href="#åˆ›å»ºç›®æ ‡æ•°æ®åº“">åˆ›å»ºç›®æ ‡æ•°æ®åº“</a></h2>
<p>åœ¨æ‚¨çš„CnosDBä¸­åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ¥å­˜æ”¾ä»Prometheuså‘é€çš„æ•°æ®ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨prometheusä½œä¸ºæ•°æ®åº“åã€‚</p>
<p><code>CREATE DATABASE &quot;prometheus&quot;</code></p>
<h2 id="é…ç½®"><a class="header" href="#é…ç½®">é…ç½®</a></h2>
<p>è‹¥è¦åœ¨CnosDBä¸­ä½¿ç”¨Prometheusè¿œç¨‹è¯»å†™APIï¼Œè¯·åœ¨Prometheusé…ç½®æ–‡ä»¶ä¸­çš„ä»¥ä¸‹è®¾ç½®ä¸­æ·»åŠ URLå€¼:</p>
<ul>
<li><code>remote_write</code></li>
<li><code>remote_read</code></li>
</ul>
<p>è¿™äº›URLå¿…é¡»å¯ä»¥ä»è¿è¡Œçš„PrometheusæœåŠ¡å™¨è§£æï¼Œå¹¶ä½¿ç”¨è¿è¡ŒCnosDBçš„ç«¯å£(é»˜è®¤æƒ…å†µä¸‹ä¸º8086)ã€‚è¿˜è¦ä½¿ç”¨åŒ…å«æ•°æ®åº“åç§°çš„<code>db= </code>æŸ¥è¯¢å‚æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code>remote_write:
- url: &quot;http://localhost:8086/api/v1/prom/write?db=prometheus&quot;

remote_read:
- url: &quot;http://localhost:8086/api/v1/prom/read?db=prometheus&quot;
</code></pre>
<h2 id="å¦‚ä½•åœ¨cnosdbä¸­è§£æprometheusåº¦é‡"><a class="header" href="#å¦‚ä½•åœ¨cnosdbä¸­è§£æprometheusåº¦é‡">å¦‚ä½•åœ¨CnosDBä¸­è§£æPrometheusåº¦é‡</a></h2>
<ul>
<li>Prometheusåº¦é‡åç§°æˆä¸ºCnosDBçš„measurementåç§°ã€‚</li>
<li>Prometheusçš„æ ·æœ¬å€¼æˆä¸ºCnosDBçš„å­—æ®µé”®åŠå­—æ®µå€¼ã€‚é€šå¸¸æ˜¯æµ®ç‚¹æ•°å½¢å¼ã€‚</li>
<li>Prometheusçš„æ ‡ç­¾æˆä¸ºCnosDBçš„tagsã€‚</li>
<li>æ‰€æœ‰çš„<code># HELP </code>å’Œ<code># TYPE </code>è¡Œè¢«å¿½ç•¥ã€‚</li>
</ul>
<pre><code>  # Prometheus 
  example_metric{queue=&quot;0:http://example:8086/api/v1/prom/write?db=prometheus&quot;,le=&quot;0.005&quot;} 308
  
  # CnosDB
  measurement
  example_metric
  tags
  queue = &quot;0:http://example:8086/api/v1/prom/write?db=prometheus&quot;
  le = &quot;0.005&quot;
  job = &quot;prometheus&quot;
  instance = &quot;localhost:9090&quot;
  __name__ = &quot;example_metric&quot;
  fields
  value = 308
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="telegraf"><a class="header" href="#telegraf">Telegraf</a></h1>
<p>Telegrafæ˜¯CnosDBçš„æ•°æ®æ”¶é›†ä»£ç†ï¼Œç”¨äºæ”¶é›†å’ŒæŠ¥å‘ŠæŒ‡æ ‡ã€‚å®ƒåºå¤§çš„è¾“å…¥æ’ä»¶åº“å’Œâ€œå³æ’å³ç”¨â€çš„æ¶æ„å¯ä»¥è®©æ‚¨å¿«é€Ÿã€è½»æ¾åœ°ä»è®¸å¤šä¸åŒçš„æ¥æºæ”¶é›†æŒ‡æ ‡ã€‚</p>
<h2 id="é…ç½®-telegraf"><a class="header" href="#é…ç½®-telegraf">é…ç½® Telegraf</a></h2>
<p>Telegrafçš„è¾“å…¥å’Œè¾“å‡ºæ’ä»¶åœ¨Telegrafçš„é…ç½®æ–‡ä»¶(<code>Telegraf .conf</code>)ä¸­å¯ç”¨å’Œé…ç½®ã€‚æ‚¨æœ‰ä»¥ä¸‹é…ç½®Telegrafçš„é€‰é¡¹:</p>
<h3 id="è‡ªåŠ¨é…ç½®-telegraf"><a class="header" href="#è‡ªåŠ¨é…ç½®-telegraf">è‡ªåŠ¨é…ç½® Telegraf</a></h3>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="å¯¼å…¥å’Œå¯¼å‡º"><a class="header" href="#å¯¼å…¥å’Œå¯¼å‡º">å¯¼å…¥å’Œå¯¼å‡º</a></h1>
<h2 id="å¯¼å…¥"><a class="header" href="#å¯¼å…¥">å¯¼å…¥</a></h2>
<pre><code>cnosdb-cli import --path &lt;path&gt; [arguments]
</code></pre>
<!--TODO -->
<h2 id="å¯¼å‡º"><a class="header" href="#å¯¼å‡º">å¯¼å‡º</a></h2>
<pre><code>cnosdb-inspect export [arguments]
</code></pre>
<!--TODO --><div style="break-before: page; page-break-before: always;"></div><h1 id="å¤‡ä»½å’Œè¿˜åŸ"><a class="header" href="#å¤‡ä»½å’Œè¿˜åŸ">å¤‡ä»½å’Œè¿˜åŸ</a></h1>
<h2 id="å¤‡ä»½-cnosdb-backup"><a class="header" href="#å¤‡ä»½-cnosdb-backup">å¤‡ä»½ <code>cnosdb backup</code></a></h2>
<p>ä»æŒ‡å®šæ•°æ®èŠ‚ç‚¹åˆ›å»ºæ•°æ®åº“å¿«ç…§ï¼Œå¹¶ä¿å­˜åˆ° PATH å¯¹åº”ç›®å½•ã€‚</p>
<pre><code class="language-shell">cnosdb backup [flags] PATH
</code></pre>
<h3 id="å‚æ•°ä»‹ç»"><a class="header" href="#å‚æ•°ä»‹ç»">å‚æ•°ä»‹ç»</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--host</code></td><td>åœ°å€ï¼›å¯é€‰ï¼›é»˜è®¤å€¼ä¸º 127.0.0.1:8088 ã€‚</td></tr>
<tr><td><code>--db</code></td><td>æ•°æ®åº“åç§°ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šåˆ™å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ã€‚</td></tr>
<tr><td><code>--rp</code></td><td>æ•°æ®ä¿ç•™ç­–ç•¥ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šåˆ™å¤‡ä»½æ‰€æœ‰æ•°æ®ä¿ç•™ç­–ç•¥ã€‚</td></tr>
<tr><td><code>--shard</code></td><td>åˆ†ç‰‡ç¼–å·ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>-rp</code> å‚æ•°ã€‚</td></tr>
<tr><td><code>--start</code></td><td>å¤‡ä»½ä¸­åŒ…å«çš„æ•°æ®çš„æœ€å°æ—¶é—´æˆ³ (RFC3339 format) ã€‚</td></tr>
<tr><td><code>--end</code></td><td>å¤‡ä»½ä¸­åŒ…å«çš„æ•°æ®çš„æœ€å¤§æ—¶é—´æˆ³ (RFC3339 format) ã€‚</td></tr>
<tr><td><code>--skip-errors</code></td><td>åˆ›å»ºæŸåˆ†ç‰‡çš„å¤‡ä»½æ—¶ï¼Œè‹¥å‘ç”Ÿé”™è¯¯ï¼Œç»§ç»­åˆ›å»ºå‰©ä½™åˆ†ç‰‡çš„å¤‡ä»½ã€‚</td></tr>
</tbody></table>
<h2 id="è¿˜åŸ-cnosdb-restore"><a class="header" href="#è¿˜åŸ-cnosdb-restore">è¿˜åŸ <code>cnosdb restore</code></a></h2>
<p>ä»æŒ‡å®šçš„å¤‡ä»½ç›®å½•ä¸­æ¢å¤æ•°æ®å’Œå…ƒæ•°æ®ã€‚æ¢å¤å¼€å§‹æ—¶ï¼ŒæœåŠ¡å°†è¢«å…³é—­ã€‚</p>
<pre><code>cnosdb restore [flags]
</code></pre>
<h3 id="å‚æ•°ä»‹ç»-1"><a class="header" href="#å‚æ•°ä»‹ç»-1">å‚æ•°ä»‹ç»</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--host</code></td><td>åœ°å€ï¼›å¯é€‰ï¼›é»˜è®¤å€¼ä¸º 127.0.0.1:8088 ã€‚</td></tr>
<tr><td><code>--db</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„æ•°æ®åº“åç§°ã€‚</td></tr>
<tr><td><code>--newdb</code></td><td>åˆ›å»ºæ–°æ•°æ®åº“ä»¥å¯¼å…¥å¤‡ä»½æ•°æ®ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨ <code>--db &lt;db_name&gt;</code> ä¸­æŒ‡å®šçš„æ•°æ®åº“åç§°ã€‚è¯¥å‚æ•°æŒ‡å®šçš„æ•°æ®åº“åç§°åœ¨ç›®æ ‡ç³»ç»Ÿä¸­ä¸èƒ½é‡å¤ã€‚</td></tr>
<tr><td><code>--rp</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„æ•°æ®åº“ä¿ç•™ç­–ç•¥åç§°ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>--db</code> å‚æ•°ã€‚</td></tr>
<tr><td><code>--newrp</code></td><td>å°†å¤‡ä»½æ•°æ®å¯¼å…¥å…¶ä»–çš„æ•°æ®ä¿ç•™ç­–ç•¥ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨ <code>--rp</code> ä¸­æŒ‡å®šçš„æ•°æ®ä¿ç•™ç­–ç•¥åç§°ã€‚</td></tr>
<tr><td><code>--shard</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„åˆ†ç‰‡ç¼–å·ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>--db</code> å’Œ <code>--rp</code> å‚æ•°ã€‚</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdbé…ç½®"><a class="header" href="#cnosdbé…ç½®">CnosDBé…ç½®</a></h1>
<h2 id="æ¦‚è¿°"><a class="header" href="#æ¦‚è¿°">æ¦‚è¿°</a></h2>
<h3 id="é…ç½®æ¦‚è¿°"><a class="header" href="#é…ç½®æ¦‚è¿°">é…ç½®æ¦‚è¿°</a></h3>
<p>é€šè¿‡é…ç½®æ–‡ä»¶(<code>cnosdb.conf</code>)å’Œç¯å¢ƒå˜é‡é…ç½®CnosDBã€‚å¦‚æœä¸å–æ¶ˆæ³¨é‡Šé…ç½®é€‰é¡¹ï¼Œç³»ç»Ÿå°†ä½¿ç”¨å…¶é»˜è®¤è®¾ç½®ã€‚æœ¬æ–‡æ¡£ä¸­çš„é…ç½®å‡ä¸ºç³»ç»Ÿé»˜è®¤é…ç½®ã€‚</p>
<h3 id="ç¯å¢ƒå˜é‡"><a class="header" href="#ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</a></h3>
<p>é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰é…ç½®è®¾ç½®å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼Œä¹Ÿå¯ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­æŒ‡å®šã€‚ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„ç­‰æ•ˆé€‰é¡¹ã€‚å¦‚æœé…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­æ²¡æœ‰æŒ‡å®šé…ç½®é€‰é¡¹ï¼Œåˆ™CnosDBä½¿ç”¨å…¶å†…éƒ¨é»˜è®¤é…ç½®ã€‚</p>
<h3 id="ä½¿ç”¨é…ç½®æ–‡ä»¶"><a class="header" href="#ä½¿ç”¨é…ç½®æ–‡ä»¶">ä½¿ç”¨é…ç½®æ–‡ä»¶</a></h3>
<p>CnosDBç³»ç»Ÿå¯¹é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰è®¾ç½®éƒ½æœ‰å†…éƒ¨é»˜è®¤å€¼ã€‚å¦‚æœéœ€è¦æŸ¥çœ‹é»˜è®¤é…ç½®ï¼Œä½¿ç”¨å‘½ä»¤cnosdb configã€‚</p>
<p>æœ¬åœ°CnosDBé…ç½®æ–‡ä»¶ä½äºè¿™é‡Œ:
- Linux: /etc/cnosdb/cnosdb.conf
- macOS: /usr/local/etc/cnosdb.conf</p>
<p>æ³¨é‡Šæ‰çš„è®¾ç½®è®¾ç½®ä¸ºç³»ç»Ÿå†…éƒ¨é»˜è®¤å€¼ã€‚æœªåŠ æ³¨é‡Šçš„è®¾ç½®è¦†ç›–å†…éƒ¨é»˜è®¤å€¼ã€‚æ³¨æ„ï¼Œæœ¬åœ°é…ç½®æ–‡ä»¶ä¸éœ€è¦åŒ…å«æ¯ä¸ªé…ç½®è®¾ç½®ã€‚</p>
<p>ä½¿ç”¨<code>--config</code>æŒ‡ä»¤å°†é…ç½®æ–‡ä»¶å¯¼å…¥CnosDB</p>
<p><code>cnosdb --config /etc/cnosdb/cnosdb.conf</code></p>
<p>å°†ç¯å¢ƒå˜é‡CNOSDB_CONFIG_PATHè®¾ç½®ä¸ºé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œå¹¶å¯åŠ¨è¿›ç¨‹ã€‚ä¾‹å¦‚:</p>
<pre><code>echo $CNOSDB_CONFIG_PATH
/etc/cnosdb/cnosdb.conf

cnosdb
</code></pre>
<h3 id="å…¨å±€é…ç½®"><a class="header" href="#å…¨å±€é…ç½®">å…¨å±€é…ç½®</a></h3>
<h4 id="bind-address--1270018088"><a class="header" href="#bind-address--1270018088">bind-address = &quot;127.0.0.1:8088&quot;</a></h4>
<p>ç”¨äºå¤‡ä»½å’Œæ¢å¤çš„RPCæœåŠ¡çš„ç»‘å®šåœ°å€ã€‚ç¯å¢ƒå˜é‡ä¸ºï¼š<code>CNOSDB_BIND_ADDRESS</code></p>
<h3 id="port"><a class="header" href="#port">Port</a></h3>
<h4 id="å¯ç”¨ç«¯å£"><a class="header" href="#å¯ç”¨ç«¯å£">å¯ç”¨ç«¯å£ï¼š</a></h4>
<p><code>8086</code>ï¼šæä¾›cnosdb httpæœåŠ¡çš„é»˜è®¤ç«¯å£</p>
<p><code>8088</code>ï¼šæä¾›cnosdb å†…éƒ¨RPCæœåŠ¡ä»¥åŠå¤‡ä»½æ¢å¤çš„é»˜è®¤ç«¯å£</p>
<h3 id="meta"><a class="header" href="#meta">meta</a></h3>
<h4 id="dir--varlibcnosdbmeta"><a class="header" href="#dir--varlibcnosdbmeta">dir = &quot;/var/lib/cnosdb/meta&quot;</a></h4>
<p>å…ƒæ•°æ®/raftæ•°æ®åº“æ‰€åœ¨çš„ç›®å½•ã€‚metaç›®å½•ä¸­çš„æ–‡ä»¶åŒ…æ‹¬meta.dbã€CnosDB metastoreæ–‡ä»¶ã€‚ç¯å¢ƒå˜é‡ä¸º:<code>CNOSDB_META_DIR</code></p>
<h4 id="retention-autocreate--true"><a class="header" href="#retention-autocreate--true">retention-autocreate = true</a></h4>
<p>å¯ç”¨åœ¨åˆ›å»ºæ•°æ®åº“æ—¶è‡ªåŠ¨åˆ›å»ºDEFAULTä¿ç•™ç­–ç•¥autogenã€‚ä¿ç•™ç­–ç•¥autogenå…·æœ‰æ— é™çš„æŒç»­æ—¶é—´ï¼Œä¹Ÿè¢«è®¾ç½®ä¸ºæ•°æ®åº“çš„DEFAULTä¿ç•™ç­–ç•¥ï¼Œå½“å†™å…¥æˆ–æŸ¥è¯¢æ²¡æœ‰æŒ‡å®šä¿ç•™ç­–ç•¥æ—¶ä½¿ç”¨è¯¥ä¿ç•™ç­–ç•¥ã€‚ç¦ç”¨æ­¤è®¾ç½®ï¼Œä»¥é˜²æ­¢åœ¨åˆ›å»ºæ•°æ®åº“æ—¶åˆ›å»ºæ­¤ä¿ç•™ç­–ç•¥ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_META_RETENTION_AUTOCREATE</code></p>
<h4 id="logging-enabled--true"><a class="header" href="#logging-enabled--true">logging-enabled = true</a></h4>
<p>å¯ç”¨è®°å½•æ¥è‡ªå…ƒæœåŠ¡çš„æ¶ˆæ¯ã€‚ ç¯å¢ƒå˜é‡:<code>CNOSDB_META_LOGGING_ENABLED</code></p>
<h3 id="æ•°æ®èŠ‚ç‚¹"><a class="header" href="#æ•°æ®èŠ‚ç‚¹">æ•°æ®èŠ‚ç‚¹</a></h3>
<h4 id="dir--varlibcnosdbdata"><a class="header" href="#dir--varlibcnosdbdata">dir = &quot;/var/lib/cnosdb/data&quot;</a></h4>
<p>TSMå¼•æ“å­˜å‚¨TSMæ–‡ä»¶çš„CnosDBç›®å½•ã€‚è¯¥ç›®å½•å¯ä»¥è¢«ä¿®æ”¹ã€‚ç¯å¢ƒå˜é‡:CNOSDB_DATA_DIR</p>
<h4 id="wal-dir--varlibcnosdbwal"><a class="header" href="#wal-dir--varlibcnosdbwal">wal-dir = &quot;/var/lib/cnosdb/wal&quot;</a></h4>
<p>å­˜æ”¾é¢„å†™æ—¥å¿—(WAL)æ–‡ä»¶çš„ç›®å½•ä½ç½®ã€‚ ç¯å¢ƒå˜é‡:CNOSDB_DATA_WAL_DIR</p>
<h4 id="wal-fsync-delay--0s"><a class="header" href="#wal-fsync-delay--0s">wal-fsync-delay = &quot;0s&quot;</a></h4>
<p>åŒæ­¥ä¹‹å‰å†™æ“ä½œç­‰å¾…çš„æ—¶é—´ã€‚ä½¿ç”¨å¤§äº0çš„æŒç»­æ—¶é—´æ‰¹é‡å¤„ç†å¤šä¸ªfsyncè°ƒç”¨ã€‚è¿™å¯¹äºè¾ƒæ…¢çš„ç£ç›˜æˆ–é‡åˆ°WALå†™äº‰ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚0çš„é»˜è®¤å€¼ä¸ºæ¯æ¬¡å†™å…¥WALæ—¶åŒæ­¥ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_WAL_FSYNC_DELAY</code></p>
<h4 id="index-version--inmem"><a class="header" href="#index-version--inmem">index-version = &quot;inmem&quot;</a></h4>
<p><code>tsi1. </code>ç”¨äºæ–°åˆ†ç‰‡çš„åˆ†ç‰‡ç´¢å¼•ç±»å‹ã€‚é»˜è®¤çš„(<code>inmem</code>)ç´¢å¼•æ˜¯åœ¨å¯åŠ¨æ—¶é‡æ–°åˆ›å»ºçš„å†…å­˜ç´¢å¼•ã€‚å¦‚æœéœ€è¦å¯ç”¨åŸºäºç£ç›˜çš„TSI (Time Series Index)ç´¢å¼•ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º<code>tsi1</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_INDEX_VERSION</code></p>
<h4 id="trace-logging-enabled--false"><a class="header" href="#trace-logging-enabled--false">trace-logging-enabled = false</a></h4>
<p>åœ¨TSMå¼•æ“å’ŒWALä¸­å¯ç”¨é™„åŠ è°ƒè¯•ä¿¡æ¯çš„è¯¦ç»†æ—¥å¿—è®°å½•ã€‚è·Ÿè¸ªæ—¥å¿—ä¸ºè°ƒè¯•TSMå¼•æ“é—®é¢˜æä¾›äº†æ›´æœ‰ç”¨çš„è¾“å‡ºã€‚ ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_TRACE_LOGGING_ENABLED</code></p>
<h4 id="query-log-enabled--true"><a class="header" href="#query-log-enabled--true">query-log-enabled = true</a></h4>
<p>åœ¨æ‰§è¡Œä¹‹å‰å¯ç”¨è§£ææŸ¥è¯¢çš„æ—¥å¿—è®°å½•ã€‚æŸ¥è¯¢æ—¥å¿—å¯¹äºæ•…éšœæ’é™¤å¾ˆæœ‰ç”¨ï¼Œä½†ä¼šè®°å½•æŸ¥è¯¢ä¸­åŒ…å«çš„ä»»ä½•æ•æ„Ÿæ•°æ®ã€‚ ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_QUERY_LOG_ENABLED</code></p>
<h4 id="query-log-enabled--true-1"><a class="header" href="#query-log-enabled--true-1">query-log-enabled = true</a></h4>
<p>åœ¨æ‰§è¡Œä¹‹å‰å¯ç”¨è§£ææŸ¥è¯¢çš„æ—¥å¿—è®°å½•ã€‚æŸ¥è¯¢æ—¥å¿—å¯¹äºæ•…éšœæ’é™¤å¾ˆæœ‰ç”¨ï¼Œä½†ä¼šè®°å½•æŸ¥è¯¢ä¸­åŒ…å«çš„ä»»ä½•æ•æ„Ÿæ•°æ®ã€‚ ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_QUERY_LOG_ENABLED</code></p>
<h4 id="validate-keys--false"><a class="header" href="#validate-keys--false">validate-keys = false</a></h4>
<p>éªŒè¯ä¼ å…¥çš„å†™å…¥ä»¥ç¡®ä¿é”®åªæœ‰æœ‰æ•ˆçš„Unicodeå­—ç¬¦ã€‚è¿™ä¸ªè®¾ç½®å°†äº§ç”Ÿä¸€ä¸ªå°å¼€é”€ï¼Œå› ä¸ºå¿…é¡»æ£€æŸ¥æ¯ä¸ªé”®ã€‚</p>
<h4 id="cache-max-memory-size--1g"><a class="header" href="#cache-max-memory-size--1g">cache-max-memory-size = &quot;1g&quot;</a></h4>
<p>åˆ†ç‰‡ç¼“å­˜åœ¨å¼€å§‹æ‹’ç»å†™æ“ä½œä¹‹å‰æ‰€èƒ½è¾¾åˆ°çš„æœ€å¤§å¤§å°ã€‚æœ‰æ•ˆçš„å†…å­˜å¤§å°åç¼€æ˜¯:kã€mæˆ–gã€‚æ²¡æœ‰å¤§å°åç¼€çš„å€¼ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_CACHE_MAX_MEMORY_SIZE</code></p>
<h4 id="cache-snapshot-memory-size--25m"><a class="header" href="#cache-snapshot-memory-size--25m">cache-snapshot-memory-size = &quot;25m&quot;</a></h4>
<p>å¼•æ“å¿«ç…§ç¼“å­˜å¹¶å°†å…¶å†™å…¥TSMæ–‡ä»¶çš„å¤§å°ï¼Œä»¥é‡Šæ”¾å†…å­˜ã€‚æœ‰æ•ˆçš„å†…å­˜å¤§å°åç¼€æ˜¯:kã€mæˆ–gã€‚æ²¡æœ‰å¤§å°åç¼€çš„å€¼ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_CACHE_SNAPSHOT_MEMORY_SIZE</code></p>
<h4 id="cache-snapshot-write-cold-duration--10m"><a class="header" href="#cache-snapshot-write-cold-duration--10m">cache-snapshot-write-cold-duration = &quot;10m&quot;</a></h4>
<p>å¦‚æœåˆ†ç‰‡è¿˜æ²¡æœ‰æ”¶åˆ°å†™æˆ–åˆ é™¤ï¼Œå¼•æ“å°†å¿«ç…§ç¼“å­˜å¹¶å°†å…¶å†™å…¥æ–°çš„TSMæ–‡ä»¶çš„æ—¶é—´é—´éš”ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_CACHE_SNAPSHOT_WRITE_COLD_DURATION</code></p>
<h4 id="compact-full-write-cold-duration--4h"><a class="header" href="#compact-full-write-cold-duration--4h">compact-full-write-cold-duration = &quot;4h&quot;</a></h4>
<p>å¦‚æœæ²¡æœ‰æ”¶åˆ°å†™æˆ–åˆ é™¤ï¼ŒTSMå¼•æ“å°†åœ¨ä¸€ä¸ªåˆ†ç‰‡ä¸­å‹ç¼©æ‰€æœ‰TSMæ–‡ä»¶çš„æ—¶é—´é—´éš”ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_COMPACT_FULL_WRITE_COLD_DURATION</code></p>
<h4 id="max-concurrent-compactions--0"><a class="header" href="#max-concurrent-compactions--0">max-concurrent-compactions = 0</a></h4>
<p>ä¸€æ¬¡å¯ä»¥è¿è¡Œçš„å¹¶å‘å…¨é‡å’Œçº§åˆ«å‹ç¼©çš„æœ€å¤§æ•°ç›®ã€‚é»˜è®¤å€¼0ä¼šå¯¼è‡´è¿è¡Œæ—¶å°†50%çš„CPUå†…æ ¸ç”¨äºå‹ç¼©ã€‚å¦‚æœæ˜¾å¼è®¾ç½®ï¼Œåˆ™ç”¨äºå‹ç¼©çš„å†…æ ¸æ•°é‡å°†è¢«é™åˆ¶ä¸ºæŒ‡å®šçš„å€¼ã€‚è¯¥è®¾ç½®ä¸é€‚ç”¨äºç¼“å­˜å¿«ç…§ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_MAX_CONCURRENT_COMPACTIONS</code></p>
<h4 id="compact-throughput--48m"><a class="header" href="#compact-throughput--48m">compact-throughput = &quot;48m&quot;</a></h4>
<p>å…è®¸TSMå‹ç¼©å†™å…¥ç£ç›˜çš„é€Ÿç‡é™åˆ¶(ä»¥æ¯ç§’å­—èŠ‚ä¸ºå•ä½)ã€‚è¯·æ³¨æ„ï¼Œå…è®¸çŸ­çªå‘ä»¥ä¸€ä¸ªå¯èƒ½æ›´å¤§çš„å€¼å‘ç”Ÿï¼Œè¯¥å€¼ç”±<code>compact-throughput-burst</code>è®¾ç½®ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_COMPACT_THROUGHPUT</code></p>
<h4 id="compact-throughput-burst--48m"><a class="header" href="#compact-throughput-burst--48m">compact-throughput-burst = &quot;48m&quot;</a></h4>
<p>å…è®¸TSMå‹ç¼©å†™å…¥ç£ç›˜çš„é€Ÿç‡é™åˆ¶(ä»¥æ¯ç§’å­—èŠ‚ä¸ºå•ä½)ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_COMPACT_THROUGHPUT_BURST</code></p>
<h4 id="tsm-use-madv-willneed--false"><a class="header" href="#tsm-use-madv-willneed--false">tsm-use-madv-willneed = false</a></h4>
<p>å¦‚æœä¸º<code>true</code>ï¼Œé‚£ä¹ˆMMap Adviseå€¼<code>MADV_WILLNEED</code>å°±è¾“å…¥/è¾“å‡ºåˆ†é¡µæ–¹é¢å‘å†…æ ¸å»ºè®®å¦‚ä½•å¤„ç†æ˜ å°„å†…å­˜åŒºåŸŸï¼Œä»¥åŠå¦‚ä½•æœŸæœ›åœ¨ä¸ä¹…çš„å°†æ¥è®¿é—®æ˜ å°„å†…å­˜åŒºåŸŸ(ä¸TSMæ–‡ä»¶æœ‰å…³)ã€‚å› ä¸ºè¿™ä¸ªè®¾ç½®åœ¨ä¸€äº›å†…æ ¸(åŒ…æ‹¬CentOSå’ŒRHEL)ä¸Šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥é»˜è®¤å€¼æ˜¯<code>false</code>ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°†è¯¥å€¼æ›´æ”¹ä¸º<code>true</code>å¯èƒ½å¯¹ç£ç›˜é€Ÿåº¦è¾ƒæ…¢çš„ç”¨æˆ·æœ‰æ‰€å¸®åŠ©ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_TSM_USE_MADV_WILLNEED</code></p>
<h3 id="ç´¢å¼•"><a class="header" href="#ç´¢å¼•">ç´¢å¼•</a></h3>
<h4 id="max-series-per-database--1000000"><a class="header" href="#max-series-per-database--1000000">max-series-per-database = 1000000</a></h4>
<p>åœ¨åˆ é™¤å†™æ“ä½œä¹‹å‰ï¼Œæ¯ä¸ªæ•°æ®åº“å…è®¸çš„æœ€å¤§åºåˆ—æ•°ã€‚é»˜è®¤è®¾ç½®ä¸º1000000(100ä¸‡)ã€‚å°†è¯¥è®¾ç½®æ›´æ”¹ä¸º0ï¼Œä»¥å…è®¸æ¯ä¸ªæ•°æ®åº“æ— é™æ•°é‡çš„åºåˆ—ã€‚å¦‚æœæŸä¸ªç‚¹å¯¼è‡´æ•°æ®åº“ä¸­åºåˆ—çš„æ•°é‡è¶…è¿‡max-series-per-databaseï¼Œåˆ™CnosDBå°†ä¸ä¼šå†™å…¥è¯¥ç‚¹ï¼Œå¹¶è¿”å›500ï¼Œå¹¶å‡ºç°ä»¥ä¸‹é”™è¯¯:</p>
<p><code>{&quot;error&quot;:&quot;max series per database exceeded: &lt;series&gt;&quot;}</code></p>
<p>ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_MAX_SERIES_PER_DATABASE</code></p>
<h4 id="max-values-per-tag--100000"><a class="header" href="#max-values-per-tag--100000">max-values-per-tag = 100000</a></h4>
<p>æ¯ä¸ªæ ‡è®°é”®å…è®¸çš„æ ‡è®°å€¼çš„æœ€å¤§æ•°ç›®ã€‚ç¼ºçœå€¼ä¸º100000(100,000)ã€‚å°†è®¾ç½®æ›´æ”¹ä¸º0ï¼Œä»¥å…è®¸æ¯ä¸ªæ ‡è®°é”®çš„æ ‡è®°å€¼æ•°é‡ä¸é™ã€‚å¦‚æœæ ‡è®°å€¼å¯¼è‡´æ ‡è®°é”®çš„æ ‡è®°å€¼æ•°é‡è¶…è¿‡<code>max-values-per-tag</code>ï¼Œåˆ™CnosDBå°†ä¸å†™å…¥è¯¥ç‚¹ï¼Œå¹¶è¿”å›éƒ¨åˆ†å†™å…¥é”™è¯¯ã€‚</p>
<p>ä»»ä½•æ ‡ç­¾å€¼è¶…è¿‡<code>max-values-per-tag</code>çš„ç°æœ‰æ ‡ç­¾é”®å°†ç»§ç»­æ¥å—å†™æ“ä½œï¼Œä½†åˆ›å»ºæ–°æ ‡ç­¾å€¼çš„å†™æ“ä½œå°†å¤±è´¥ã€‚</p>
<p>ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_MAX_VALUES_PER_TAG</code></p>
<h4 id="max-index-log-file-size--1m"><a class="header" href="#max-index-log-file-size--1m">max-index-log-file-size = &quot;1m&quot;</a></h4>
<p>å½“ç´¢å¼•æå‰å†™æ—¥å¿—(WAL)æ–‡ä»¶å‹ç¼©ä¸ºç´¢å¼•æ–‡ä»¶æ—¶ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½çš„é˜ˆå€¼ã€‚è¾ƒå°çš„å¤§å°å°†å¯¼è‡´æ—¥å¿—æ–‡ä»¶è¢«æ›´å¿«åœ°å‹ç¼©ï¼Œå¹¶ä»¥å†™ååé‡ä¸ºä»£ä»·å‡å°‘å †çš„ä½¿ç”¨ã€‚æ›´é«˜çš„å¤§å°å°†æ›´å°‘åœ°è¢«å‹ç¼©ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨æ›´å¤šçš„ç³»åˆ—ï¼Œå¹¶æä¾›æ›´é«˜çš„å†™ååé‡ã€‚æœ‰æ•ˆçš„å¤§å°åç¼€æ˜¯kã€mæˆ–g(ä¸åŒºåˆ†å¤§å°å†™ï¼Œ1024 = 1k)ã€‚æ²¡æœ‰å¤§å°åç¼€çš„å€¼ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_MAX_INDEX_LOG_FILE_SIZE</code></p>
<h4 id="series-id-set-cache-size--100"><a class="header" href="#series-id-set-cache-size--100">series-id-set-cache-size = 100</a></h4>
<p>æŒ‡å®šè¦ä¸ºTSIç´¢å¼•ç¼“å­˜çš„ç³»åˆ—IDé›†çš„æ•°é‡(é»˜è®¤ä¸º100)ã€‚é›†åˆä¸­çš„ç³»åˆ—idæŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªç´¢å¼•è°“è¯(æ ‡è®°è¿‡æ»¤å™¨)ä¸ŠåŒ¹é…çš„åºåˆ—ã€‚åºåˆ—IDé›†æ˜¯ä¸€ä¸ªLRUç¼“å­˜ï¼Œæ‰€ä»¥ä¸€æ—¦ç¼“å­˜æ»¡äº†ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é›†å°±ä¼šè¢«é©±é€ã€‚ç¼“å­˜çš„ç»“æœå¯ä»¥å¿«é€Ÿè¿”å›ï¼Œå› ä¸ºå½“æ‰§è¡Œå¸¦æœ‰åŒ¹é…æ ‡è®°è¿‡æ»¤å™¨çš„åç»­æŸ¥è¯¢æ—¶ï¼Œå®ƒä»¬ä¸éœ€è¦é‡æ–°è®¡ç®—ã€‚</p>
<p>æˆ‘ä»¬å»ºè®®ä½¿ç”¨é»˜è®¤è®¾ç½®ã€‚å°†æ­¤å€¼æ›´æ”¹ä¸º0å°†ç¦ç”¨ç¼“å­˜ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æŸ¥è¯¢æ€§èƒ½é—®é¢˜ã€‚åªæœ‰å½“æ‚¨çŸ¥é“æ•°æ®åº“çš„æ‰€æœ‰åº¦é‡çš„æ ‡è®°é”®å€¼å¤§äº100æ—¶ï¼Œæ‰ä¼šå¢åŠ è¿™ä¸ªå€¼ã€‚å¢åŠ ç¼“å­˜å¤§å°å¯èƒ½ä¼šå¯¼è‡´å †ä½¿ç”¨çš„å¢åŠ ã€‚</p>
<p>ç¯å¢ƒå˜é‡:<code>CNOSDB_DATA_SERIES_ID_SET_CACHE_SIZE</code></p>
<h3 id="æŸ¥è¯¢ç®¡ç†"><a class="header" href="#æŸ¥è¯¢ç®¡ç†">æŸ¥è¯¢ç®¡ç†</a></h3>
<h4 id="write-timeout--10s"><a class="header" href="#write-timeout--10s">write-timeout = &quot;10s&quot;</a></h4>
<p>å†™è¯·æ±‚ç­‰å¾…çš„æ—¶é—´ï¼Œç›´åˆ°ä¸€ä¸ªâ€œè¶…æ—¶â€é”™è¯¯è¿”å›ç»™è°ƒç”¨è€…ã€‚é»˜è®¤å€¼æ˜¯10ç§’ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_WRITE_TIMEOUT</code></p>
<h4 id="max-concurrent-queries--0"><a class="header" href="#max-concurrent-queries--0">max-concurrent-queries = 0</a></h4>
<p>åœ¨æ‚¨çš„å®ä¾‹ä¸Šå…è®¸è¿è¡ŒæŸ¥è¯¢çš„æœ€å¤§æ•°é‡ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸æ— é™æ¬¡æŸ¥è¯¢ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_MAX_CONCURRENT_QUERIES</code></p>
<h4 id="query-timeout--0s"><a class="header" href="#query-timeout--0s">query-timeout = &quot;0s&quot;</a></h4>
<p>åœ¨CnosDBç»ˆæ­¢æŸ¥è¯¢ä¹‹å‰ï¼Œå…è®¸æ‰§è¡ŒæŸ¥è¯¢çš„æœ€å¤§æŒç»­æ—¶é—´ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸æŸ¥è¯¢åœ¨æ²¡æœ‰æ—¶é—´é™åˆ¶çš„æƒ…å†µä¸‹è¿è¡Œã€‚æ­¤è®¾ç½®æ˜¯ä¸€ä¸ªæŒç»­æ—¶é—´ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_QUERY_TIMEOUT</code></p>
<h4 id="log-queries-after--0s"><a class="header" href="#log-queries-after--0s">log-queries-after = &quot;0s&quot;</a></h4>
<p>åœ¨CnosDBç”¨æ£€æµ‹åˆ°çš„æ…¢é€ŸæŸ¥è¯¢æ¶ˆæ¯è®°å½•æŸ¥è¯¢ä¹‹å‰ï¼ŒæŸ¥è¯¢æ‰€èƒ½æŒç»­çš„æœ€é•¿æ—¶é—´ã€‚é»˜è®¤è®¾ç½®(â€œ0â€)å°†æ°¸è¿œä¸ä¼šå‘Šè¯‰CnosDBè®°å½•æŸ¥è¯¢ã€‚æ­¤è®¾ç½®æ˜¯ä¸€ä¸ªæŒç»­æ—¶é—´ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_LOG_QUERIES_AFTER</code></p>
<h4 id="max-select-point--0"><a class="header" href="#max-select-point--0">max-select-point = 0</a></h4>
<p>ä¸€ä¸ªSELECTè¯­å¥å¯ä»¥å¤„ç†çš„æœ€å¤§ç‚¹æ•°ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸SELECTè¯­å¥å¤„ç†æ— é™æ•°é‡çš„ç‚¹ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_MAX_SELECT_POINT</code></p>
<h3 id="max-select-series--0"><a class="header" href="#max-select-series--0">max-select-series = 0</a></h3>
<p>ä¸€ä¸ªSELECTè¯­å¥å¯ä»¥å¤„ç†çš„æœ€å¤§åºåˆ—æ•°ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸SELECTè¯­å¥å¤„ç†æ— é™æ•°é‡çš„åºåˆ—ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_MAX_SELECT_SERIES</code></p>
<h4 id="max-select-buckets--0"><a class="header" href="#max-select-buckets--0">max-select-buckets = 0</a></h4>
<p>ä¸€ä¸ªæŸ¥è¯¢å¯ä»¥å¤„ç†çš„GROUP BY time()æ¡¶çš„æœ€å¤§æ•°é‡ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸æŸ¥è¯¢å¤„ç†æ— é™æ•°é‡çš„æ¡¶ã€‚ ç¯å¢ƒå˜é‡:<code>CNOSDB_COORDINATOR_MAX_SELECT_BUCKETS</code></p>
<h3 id="ä¿ç•™ç­–ç•¥"><a class="header" href="#ä¿ç•™ç­–ç•¥">ä¿ç•™ç­–ç•¥</a></h3>
<h4 id="enabled--true"><a class="header" href="#enabled--true">enabled = true</a></h4>
<p>è®¾ç½®ä¸º<code>false</code>å¯é˜²æ­¢CnosDBå¼ºåˆ¶æ‰§è¡Œä¿ç•™ç­–ç•¥ã€‚ç¯å¢ƒå˜é‡ï¼š<code>CNOSDB_RETENTION_ENABLED</code></p>
<h4 id="check-interval--30m0s"><a class="header" href="#check-interval--30m0s">check-interval = &quot;30m0s&quot;</a></h4>
<p>CnosDBæ£€æŸ¥ä»¥å¼ºåˆ¶æ‰§è¡Œä¿ç•™ç­–ç•¥çš„æ—¶é—´é—´éš”ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_RETENTION_CHECK_INTERVAL</code></p>
<h3 id="åˆ†ç‰‡"><a class="header" href="#åˆ†ç‰‡">åˆ†ç‰‡</a></h3>
<h4 id="enabled--true-1"><a class="header" href="#enabled--true-1">enabled = true</a></h4>
<p>åˆ¤æ–­æ˜¯å¦å¼€å¯åˆ†ç‰‡é¢„åˆ›å»ºæœåŠ¡ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SHARD_PRECREATION_ENABLED</code></p>
<h4 id="check-interval--10m"><a class="header" href="#check-interval--10m">check-interval = &quot;10m&quot;</a></h4>
<p>è¿è¡Œé¢„åˆ›å»ºæ–°åˆ†ç‰‡æ£€æŸ¥çš„æ—¶é—´é—´éš”ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SHARD_PRECREATION_CHECK_INTERVAL</code></p>
<h4 id="advance-period--30m"><a class="header" href="#advance-period--30m">advance-period = &quot;30m&quot;</a></h4>
<p>æœªæ¥CnosDBé¢„å…ˆåˆ›å»ºåˆ†ç‰‡çš„æœ€é•¿æ—¶é—´ã€‚30mçš„é»˜è®¤å€¼åº”è¯¥é€‚ç”¨äºå¤§å¤šæ•°ç³»ç»Ÿã€‚åœ¨æœªæ¥å°†æ­¤è®¾ç½®å¢åŠ å¾—å¤ªä¹…å¯èƒ½ä¼šå¯¼è‡´æ•ˆç‡ä½ä¸‹ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SHARD_PRECREATION_ADVANCE_PERIOD</code></p>
<h3 id="ç›‘æ§"><a class="header" href="#ç›‘æ§">ç›‘æ§</a></h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCnosDBå°†æ•°æ®å†™å…¥_internalæ•°æ®åº“ã€‚å¦‚æœè¯¥æ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™CnosDBè‡ªåŠ¨åˆ›å»ºå®ƒã€‚_internalæ•°æ®åº“çš„é»˜è®¤ä¿ç•™ç­–ç•¥æ˜¯7å¤©ã€‚å¦‚æœéœ€è¦ä½¿ç”¨7å¤©ä¿ç•™ç­–ç•¥ä»¥å¤–çš„å…¶ä»–ç­–ç•¥ï¼Œå¿…é¡»å…ˆåˆ›å»ºè¯¥ç­–ç•¥ã€‚</p>
<h4 id="store-enabled--true"><a class="header" href="#store-enabled--true">store-enabled = true</a></h4>
<p>è®¾ç½®ä¸º<code>false</code>åœ¨å†…éƒ¨ç¦ç”¨è®°å½•ç»Ÿè®¡ã€‚å¦‚æœè®¾ç½®ä¸º<code>false</code>ï¼Œå®ƒå°†å¤§å¤§å¢åŠ è¯Šæ–­å®‰è£…é—®é¢˜çš„éš¾åº¦ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_MONITOR_STORE_ENABLED</code></p>
<h4 id="store-database--_internal"><a class="header" href="#store-database--_internal">store-database = &quot;_internal&quot;</a></h4>
<p>ç”¨äºè®°å½•ç»Ÿè®¡ä¿¡æ¯çš„ç›®æ ‡æ•°æ®åº“ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_MONITOR_STORE_DATABASE</code></p>
<h4 id="store-interval--10s"><a class="header" href="#store-interval--10s">store-interval = &quot;10s&quot;</a></h4>
<p>CnosDBè®°å½•ç»Ÿè®¡ä¿¡æ¯çš„æ—¶é—´é—´éš”ã€‚é»˜è®¤å€¼æ˜¯æ¯10ç§’ä¸€æ¬¡ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_MONITOR_STORE_INTERVAL</code></p>
<h3 id="httpç«¯ç‚¹"><a class="header" href="#httpç«¯ç‚¹">HTTPç«¯ç‚¹</a></h3>
<p>[http]éƒ¨åˆ†è®¾ç½®æ§åˆ¶CnosDBå¦‚ä½•é…ç½®httpç«¯ç‚¹ã€‚è¿™äº›æ˜¯è¿›å‡ºCnosDBçš„ä¸»è¦æœºåˆ¶ã€‚ç¼–è¾‘æ­¤éƒ¨åˆ†ä¸­çš„è®¾ç½®ä»¥å¯ç”¨HTTPSå’Œèº«ä»½éªŒè¯ã€‚</p>
<h4 id="enabled--true-2"><a class="header" href="#enabled--true-2">enabled = true</a></h4>
<p>ç¡®å®šæ˜¯å¦å¯ç”¨HTTPç«¯ç‚¹ã€‚å¦‚æœè¦ç¦ç”¨å¯¹HTTPç«¯ç‚¹çš„è®¿é—®ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸ºfalseã€‚è¯·æ³¨æ„ï¼ŒCnosDBå‘½ä»¤è¡Œæ¥å£(CLI)ä½¿ç”¨CnosDB APIè¿æ¥åˆ°æ•°æ®åº“ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_ENABLED</code></p>
<h4 id="bind-address--8086"><a class="header" href="#bind-address--8086">bind-address = &quot;:8086&quot;</a></h4>
<p>HTTPæœåŠ¡ä½¿ç”¨çš„ç»‘å®šåœ°å€(ç«¯å£)ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_BIND_ADDRESS</code></p>
<h4 id="auth-enabled--false"><a class="header" href="#auth-enabled--false">auth-enabled = false</a></h4>
<p>ç¡®å®šæ˜¯å¦é€šè¿‡HTTPå’ŒHTTPSå¯ç”¨ç”¨æˆ·è®¤è¯ã€‚å¦‚æœéœ€è¦èº«ä»½éªŒè¯ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º<code>true</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_AUTH_ENABLED</code></p>
<h4 id="log-enabled--true"><a class="header" href="#log-enabled--true">log-enabled = true</a></h4>
<p>ç¡®å®šæ˜¯å¦å¯ç”¨HTTPè¯·æ±‚æ—¥å¿—è®°å½•ã€‚è‹¥è¦ç¦ç”¨æ—¥å¿—è®°å½•ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º<code>false</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_LOG_ENABLED</code></p>
<h4 id="suppress-write-log--false"><a class="header" href="#suppress-write-log--false">suppress-write-log = false</a></h4>
<p>ç¡®å®šå¯ç”¨æ—¥å¿—æ—¶æ˜¯å¦åº”è¯¥æŠ‘åˆ¶HTTPå†™è¯·æ±‚æ—¥å¿—ã€‚</p>
<h4 id="access-log-path-"><a class="header" href="#access-log-path-">access-log-path = &quot;&quot;</a></h4>
<p>è®¿é—®æ—¥å¿—çš„è·¯å¾„ï¼Œå®ƒå†³å®šæ˜¯å¦ä½¿ç”¨<code>log-enabled = true</code>å¯ç”¨è¯¦ç»†çš„å†™æ—¥å¿—è®°å½•ã€‚æŒ‡å®šå¯ç”¨æ—¶æ˜¯å¦å°†HTTPè¯·æ±‚æ—¥å¿—å†™å…¥æŒ‡å®šçš„è·¯å¾„ã€‚å¦‚æœcnosdbæ— æ³•è®¿é—®æŒ‡å®šçš„è·¯å¾„ï¼Œå®ƒå°†è®°å½•é”™è¯¯å¹¶é€€å›åˆ°stderrã€‚å½“å¯ç”¨HTTPè¯·æ±‚æ—¥å¿—è®°å½•æ—¶ï¼Œæ­¤é€‰é¡¹æŒ‡å®šåº”è¯¥å†™å…¥æ—¥å¿—æ¡ç›®çš„è·¯å¾„ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤å€¼æ˜¯å†™å…¥stderrï¼Œè¿™ä¼šå°†HTTPæ—¥å¿—ä¸å†…éƒ¨çš„CnosDBæ—¥å¿—æ··åˆåœ¨ä¸€èµ·ã€‚å¦‚æœcnosdbæ— æ³•è®¿é—®æŒ‡å®šçš„è·¯å¾„ï¼Œå®ƒå°†è®°å½•ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶é€€å›åˆ°å°†è¯·æ±‚æ—¥å¿—å†™å…¥stderrã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_ACCESS_LOG_PATH</code></p>
<h4 id="access-log-status-filters--"><a class="header" href="#access-log-status-filters--">access-log-status-filters = []</a></h4>
<p>ç­›é€‰åº”è¯¥è®°å½•çš„è¯·æ±‚ã€‚æ¯ä¸ªè¿‡æ»¤å™¨çš„æ¨¡å¼ä¸ºnnnã€nnxæˆ–nxxï¼Œå…¶ä¸­næ˜¯ä¸€ä¸ªæ•°å­—ï¼Œxæ˜¯ä»»ä½•æ•°å­—çš„é€šé…ç¬¦ã€‚è¦è¿‡æ»¤æ‰€æœ‰5xxå“åº”ï¼Œè¯·ä½¿ç”¨å­—ç¬¦ä¸²5xxã€‚å¦‚æœä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œåˆ™åªéœ€è¦åŒ¹é…ä¸€ä¸ªã€‚é»˜è®¤å€¼æ˜¯æ²¡æœ‰è¿‡æ»¤å™¨ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_ACCESS_LOG_STATUS_FILTERS_x</code></p>
<h4 id="write-tracing--false"><a class="header" href="#write-tracing--false">write-tracing = false</a></h4>
<p>ç¡®å®šæ˜¯å¦å¯ç”¨è¯¦ç»†çš„å†™æ—¥å¿—è®°å½•ã€‚è®¾ç½®ä¸º<code>true</code>ä¸ºå†™è´Ÿè½½å¯ç”¨æ—¥å¿—è®°å½•ã€‚å¦‚æœè®¾ç½®ä¸º<code>true</code>ï¼Œè¿™å°†å¤åˆ¶æ—¥å¿—ä¸­çš„æ¯ä¸ªå†™è¯­å¥ï¼Œå› æ­¤ä¸å»ºè®®åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_WRITE_TRACING</code></p>
<h4 id="pprof-enabled--true"><a class="header" href="#pprof-enabled--true">pprof-enabled = true</a></h4>
<p>ç¡®å®šæ˜¯å¦å¯ç”¨/net/http/pprof HTTPç«¯ç‚¹ã€‚ç”¨äºæ•…éšœæ’é™¤å’Œç›‘è§†ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_PPROF_ENABLED</code></p>
<h4 id="pprof-auth-enabled--false"><a class="header" href="#pprof-auth-enabled--false">pprof-auth-enabled = false</a></h4>
<pre><code>- /debug/pprof
- /debug/requests
- /debug/vars
</code></pre>
<p>å¦‚æœ<code>auth-enabled</code>æˆ–<code>pprofessor -enabled</code>è®¾ç½®ä¸º<code>false</code>ï¼Œåˆ™æ­¤è®¾ç½®æ— æ•ˆã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_PPROF_AUTH_ENABLED</code></p>
<h4 id="debug-pprof-enabled--false"><a class="header" href="#debug-pprof-enabled--false">debug-pprof-enabled = false</a></h4>
<p>å¯ç”¨é»˜è®¤<code>/pprof</code>ç«¯ç‚¹å¹¶ç»‘å®šåˆ°<code>localhost:6060</code>ã€‚ç”¨äºè°ƒè¯•å¯åŠ¨æ€§èƒ½é—®é¢˜ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_DEBUG_PPROF_ENABLED</code></p>
<h4 id="ping-auth-enabled--false"><a class="header" href="#ping-auth-enabled--false">ping-auth-enabled = false</a></h4>
<p>å¯ç”¨<code>/ping</code>ã€<code>/metrics</code>å’Œ<code>/status</code>ç«¯ç‚¹çš„èº«ä»½éªŒè¯ã€‚å¦‚æœ<code>auth-enabled</code>è®¾ç½®ä¸º<code>false</code>ï¼Œåˆ™æ­¤è®¾ç½®æ— æ•ˆã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_PING_AUTH_ENABLED</code></p>
<h4 id="https-enabled--false"><a class="header" href="#https-enabled--false">https-enabled = false</a></h4>
<p>HTTPSæ˜¯å¦å¯ç”¨ã€‚å¦‚æœå¯ç”¨HTTPSåè®®ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º<code>true</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_HTTPS_ENABLED</code></p>
<h4 id="https-certificate--etcsslcnosdbpem"><a class="header" href="#https-certificate--etcsslcnosdbpem">https-certificate = &quot;/etc/ssl/cnosdb.pem&quot;</a></h4>
<p>å¯ç”¨HTTPSæ—¶ä½¿ç”¨çš„SSLè¯ä¹¦æ–‡ä»¶çš„è·¯å¾„ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_HTTPS_CERTIFICATE</code></p>
<h4 id="https-private-key-"><a class="header" href="#https-private-key-">https-private-key = &quot;&quot;</a></h4>
<p>ä½¿ç”¨å•ç‹¬çš„ç§é’¥ä½ç½®ã€‚å¦‚æœåªæŒ‡å®šäº†<code>https-certificate</code>, httpdæœåŠ¡å°†å°è¯•ä»<code>https-certificate</code>æ–‡ä»¶ä¸­åŠ è½½ç§é’¥ã€‚å¦‚æœæŒ‡å®šäº†ä¸€ä¸ªå•ç‹¬çš„<code>https-private-key</code>æ–‡ä»¶ï¼ŒhttpdæœåŠ¡å°†ä»<code>https-private-key</code>æ–‡ä»¶åŠ è½½ç§é’¥ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_HTTPS_PRIVATE_KEY</code></p>
<h4 id="shared-secret-"><a class="header" href="#shared-secret-">shared-secret = &quot;&quot;</a></h4>
<p>ç”¨äºä½¿ç”¨JWTä»¤ç‰ŒéªŒè¯å…¬å…±APIè¯·æ±‚çš„å…±äº«ç§˜å¯†ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_SHARED_SECRET</code></p>
<h4 id="max-row-limit--0"><a class="header" href="#max-row-limit--0">max-row-limit = 0</a></h4>
<p>ç³»ç»Ÿåœ¨éåˆ†å—æŸ¥è¯¢ä¸­å¯ä»¥è¿”å›çš„æœ€å¤§è¡Œæ•°ã€‚é»˜è®¤è®¾ç½®(0)å…è®¸æ— é™çš„è¡Œæ•°ã€‚å¦‚æœæŸ¥è¯¢ç»“æœè¶…è¿‡æŒ‡å®šå€¼ï¼Œåˆ™CnosDBåœ¨å“åº”ä½“ä¸­åŒ…å«ä¸€ä¸ªâ€œpartialâ€:trueæ ‡è®°ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_MAX_ROW_LIMIT</code></p>
<h4 id="max-connection-limit--0"><a class="header" href="#max-connection-limit--0">max-connection-limit = 0</a></h4>
<p>å¯ä»¥åŒæ—¶æ‰“å¼€çš„æœ€å¤§è¿æ¥æ•°ã€‚è¶…è¿‡é™åˆ¶çš„æ–°è¿æ¥å°†è¢«åˆ é™¤ã€‚é»˜è®¤å€¼<code>0</code>ç¦ç”¨é™åˆ¶ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_MAX_CONNECTION_LIMIT</code></p>
<h4 id="unix-socket-enabled--false"><a class="header" href="#unix-socket-enabled--false">unix-socket-enabled = false</a></h4>
<p>é€šè¿‡UNIXåŸŸå¥—æ¥å­—å¯ç”¨HTTPæœåŠ¡ã€‚å¦‚æœéœ€è¦é€šè¿‡UNIXåŸŸå¥—æ¥å­—å¼€å¯HTTPæœåŠ¡ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸ºtrueã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_UNIX_SOCKET_ENABLED</code></p>
<h4 id="bind-socket--varruncnosdbsock"><a class="header" href="#bind-socket--varruncnosdbsock">bind-socket = &quot;/var/run/cnosdb.sock&quot;</a></h4>
<p>UNIXåŸŸå¥—æ¥å­—çš„è·¯å¾„ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_UNIX_BIND_SOCKET</code></p>
<h4 id="max-body-size--25000000"><a class="header" href="#max-body-size--25000000">max-body-size = 25000000</a></h4>
<p>å®¢æˆ·ç«¯è¯·æ±‚ä½“çš„æœ€å¤§å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)ã€‚å½“HTTPå®¢æˆ·ç«¯å‘é€çš„æ•°æ®è¶…è¿‡é…ç½®çš„æœ€å¤§å¤§å°æ—¶ï¼Œä¼šè¿”å›<code>413 Request Entity Too Large HTTP</code>å“åº”ã€‚è‹¥è¦ç¦ç”¨è¯¥é™åˆ¶ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º0ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_MAX_BODY_SIZE</code></p>
<h4 id="max-concurrent-write-limit--0"><a class="header" href="#max-concurrent-write-limit--0">max-concurrent-write-limit = 0</a></h4>
<p>å¹¶å‘å¤„ç†çš„æœ€å¤§å†™æ“ä½œæ•°ã€‚è‹¥è¦ç¦ç”¨è¯¥é™åˆ¶ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º0ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_MAX_CONCURRENT_WRITE_LIMIT</code></p>
<h4 id="max-enqueued-write-limit--0"><a class="header" href="#max-enqueued-write-limit--0">max-enqueued-write-limit = 0</a></h4>
<p>æ’é˜Ÿç­‰å¾…å¤„ç†çš„æœ€å¤§å†™æ“ä½œæ•°ã€‚è‹¥è¦ç¦ç”¨è¯¥é™åˆ¶ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º0ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_MAX_ENQUEUED_WRITE_LIMIT</code></p>
<h4 id="enqueued-write-timeout--0"><a class="header" href="#enqueued-write-timeout--0">enqueued-write-timeout = 0</a></h4>
<p>åœ¨ç­‰å¾…å¤„ç†çš„é˜Ÿåˆ—ä¸­ç­‰å¾…å†™æ“ä½œçš„æœ€å¤§æŒç»­æ—¶é—´ã€‚å¦‚æœè¦ç¦ç”¨è¯¥é™åˆ¶ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º0æˆ–å°†<code>max-concurrent-write-limit</code>å€¼è®¾ç½®ä¸º0ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_HTTP_ENQUEUED_WRITE_TIMEOUT</code></p>
<h3 id="æ—¥å¿—"><a class="header" href="#æ—¥å¿—">æ—¥å¿—</a></h3>
<h4 id="format--auto"><a class="header" href="#format--auto">format = &quot;auto&quot;</a></h4>
<p>ç¡®å®šè¦ä¸ºæ—¥å¿—ä½¿ç”¨å“ªä¸ªæ—¥å¿—ç¼–ç å™¨ã€‚æœ‰æ•ˆå€¼ä¸º<code>auto</code>(é»˜è®¤å€¼)ã€<code>logfmt</code>å’Œ<code>json</code>ã€‚ä½¿ç”¨é»˜è®¤çš„è‡ªåŠ¨é€‰é¡¹ï¼Œå¦‚æœè¾“å‡ºåˆ°TTYè®¾å¤‡(ä¾‹å¦‚ï¼Œç»ˆç«¯)ï¼Œåˆ™ä½¿ç”¨æ›´å‹å¥½çš„æ§åˆ¶å°ç¼–ç ã€‚å¦‚æœè¾“å‡ºæ˜¯<code>files</code>ï¼Œåˆ™<code>auto</code>é€‰é¡¹ä½¿ç”¨<code>logfmt</code>ç¼–ç ã€‚<code>logfmt</code>å’Œ<code>json</code>é€‰é¡¹å¯¹äºä¸å¤–éƒ¨å·¥å…·é›†æˆéå¸¸æœ‰ç”¨ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_LOGGING_FORMAT</code></p>
<h4 id="level--info"><a class="header" href="#level--info">level = &quot;info&quot;</a></h4>
<p>è¦å‘å‡ºçš„æ—¥å¿—çº§åˆ«ã€‚æœ‰æ•ˆå€¼ä¸º<code>error</code>ã€<code>warn</code>ã€<code>info</code>(é»˜è®¤å€¼)å’Œ<code>debug</code>ã€‚ç­‰äºæˆ–é«˜äºæŒ‡å®šçº§åˆ«çš„æ—¥å¿—å°†è¢«è§¦å‘ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_LOGGING_LEVEL</code></p>
<h4 id="suppress-logo--false"><a class="header" href="#suppress-logo--false">suppress-logo = false</a></h4>
<p>æŠ‘åˆ¶ç¨‹åºå¯åŠ¨æ—¶æ‰“å°çš„æ ‡å¿—è¾“å‡ºã€‚å¦‚æœSTDOUTä¸æ˜¯TTYï¼Œåˆ™æ ‡è¯†æ€»æ˜¯è¢«æŠ‘åˆ¶çš„ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_LOGGING_SUPPRESS_LOGO</code></p>
<h3 id="è®¢é˜…"><a class="header" href="#è®¢é˜…">è®¢é˜…</a></h3>
<h4 id="enabled--true-3"><a class="header" href="#enabled--true-3">enabled = true</a></h4>
<p>ç¡®å®šæ˜¯å¦å¯ç”¨ç”¨æˆ·æœåŠ¡ã€‚å¦‚æœéœ€è¦å…³é—­ç”¨æˆ·æœåŠ¡ï¼Œè¯·å°†è¯¥å€¼è®¾ç½®ä¸º<code>false</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_ENABLED</code></p>
<h4 id="http-timeout--30s"><a class="header" href="#http-timeout--30s">http-timeout = &quot;30s&quot;</a></h4>
<p>HTTPå†™å…¥åˆ°è®¢é˜…æœåŠ¡å™¨ç›´è‡³è¶…æ—¶çš„æŒç»­æ—¶é—´ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_HTTP_TIMEOUT</code></p>
<h4 id="insecure-skip-verify--false"><a class="header" href="#insecure-skip-verify--false">insecure-skip-verify = false</a></h4>
<p>ç¡®å®šæ˜¯å¦å…è®¸åˆ°è®¢é˜…è€…çš„ä¸å®‰å…¨çš„HTTPSè¿æ¥ã€‚è¿™åœ¨æµ‹è¯•è‡ªç­¾åè¯ä¹¦æ—¶éå¸¸æœ‰ç”¨ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_INSECURE_SKIP_VERIFY</code></p>
<h4 id="ca-certs-"><a class="header" href="#ca-certs-">ca-certs = &quot;&quot;</a></h4>
<p>pemç¼–ç çš„CA certsæ–‡ä»¶çš„è·¯å¾„ã€‚å¦‚æœä¸ºç©ºå­—ç¬¦ä¸²<code>â€œâ€</code>ï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è¯ä¹¦ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_CA_CERTS</code></p>
<h4 id="write-concurrency--40"><a class="header" href="#write-concurrency--40">write-concurrency = 40</a></h4>
<p>å¤„ç†å†™é€šé“çš„å†™å…¥ç¨‹åºçš„æ•°é‡ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_WRITE_CONCURRENCY</code></p>
<h4 id="write-buffer-size--1000"><a class="header" href="#write-buffer-size--1000">write-buffer-size = 1000</a></h4>
<p>å†™é€šé“ä¸­ç¼“å†²çš„æ­£åœ¨å†™çš„æ¬¡æ•°ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_SUBSCRIBER_WRITE_BUFFER_SIZE</code></p>
<h3 id="è¿ç»­æŸ¥è¯¢"><a class="header" href="#è¿ç»­æŸ¥è¯¢">è¿ç»­æŸ¥è¯¢</a></h3>
<h4 id="enabled--true-4"><a class="header" href="#enabled--true-4">enabled = true</a></h4>
<p>è®¾ç½®ä¸º<code>false</code>ï¼Œç¦ç”¨CQsã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_CONTINUOUS_QUERIES_ENABLED</code></p>
<h4 id="log-enabled--true-1"><a class="header" href="#log-enabled--true-1">log-enabled = true</a></h4>
<p>è®¾ç½®ä¸º<code>false</code>ï¼Œç¦ç”¨CQäº‹ä»¶çš„æ—¥å¿—è®°å½•ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_CONTINUOUS_QUERIES_LOG_ENABLED</code></p>
<h4 id="query-stats-enabled--false"><a class="header" href="#query-stats-enabled--false">query-stats-enabled = false</a></h4>
<p>å½“è®¾ç½®ä¸º<code>true</code>æ—¶ï¼Œè¿ç»­æŸ¥è¯¢æ‰§è¡Œç»Ÿè®¡ä¿¡æ¯å°†è¢«å†™å…¥é»˜è®¤ç›‘è§†å­˜å‚¨åŒºã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_CONTINUOUS_QUERIES_QUERY_STATS_ENABLED</code></p>
<h4 id="run-interval--1s"><a class="header" href="#run-interval--1s">run-interval = &quot;1s&quot;</a></h4>
<p>CnosDBæ£€æŸ¥CQæ˜¯å¦éœ€è¦è¿è¡Œçš„æ—¶é—´é—´éš”ã€‚å°†æ­¤é€‰é¡¹è®¾ç½®ä¸ºCQsè¿è¡Œçš„æœ€ä½æ—¶é—´é—´éš”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ€é¢‘ç¹çš„CQæ¯åˆ†é’Ÿè¿è¡Œï¼Œè®¾ç½®è¿è¡Œé—´éš”ä¸º1ç±³ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_CONTINUOUS_QUERIES_RUN_INTERVAL</code></p>
<h3 id="ä¼ è¾“å±‚å®‰å…¨"><a class="header" href="#ä¼ è¾“å±‚å®‰å…¨">ä¼ è¾“å±‚å®‰å…¨</a></h3>
<p>å¦‚æœæ²¡æœ‰æŒ‡å®šTLSé…ç½®è®¾ç½®ï¼Œåˆ™æ ¹æ®ç”¨äºæ„å»ºCnosDBçš„Go<code>crypto/tls</code>åŒ…æ–‡æ¡£ä¸­çš„å¸¸é‡éƒ¨åˆ†ï¼ŒCnosDBæ”¯æŒåˆ—å‡ºçš„æ‰€æœ‰åŠ å¯†å¥—ä»¶idå’Œå®ç°çš„æ‰€æœ‰TLSç‰ˆæœ¬ã€‚ä½¿ç”¨<code>SHOW DIAGNOSTICS</code>å‘½ä»¤æŸ¥çœ‹ç”¨äºæ„å»ºCnosDBçš„Goç‰ˆæœ¬ã€‚</p>
<h4 id="min-version--tls10"><a class="header" href="#min-version--tls10">min-version = &quot;tls1.0&quot;</a></h4>
<p>å³å°†åå•†çš„TLSåè®®çš„æœ€å°ç‰ˆæœ¬ã€‚æœ‰æ•ˆå€¼åŒ…æ‹¬:<code>tls1.0</code>ã€<code>tls1.1</code>ã€<code>tls1.2</code>ã€‚å¦‚æœä¸æŒ‡å®šï¼Œåˆ™<code>min-version</code>ä¸ºGo<code>crypto/TLS</code>åŒ…ä¸­æŒ‡å®šçš„TLSæœ€å°ç‰ˆæœ¬ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ<code>tls1.0</code>å°†æœ€å°ç‰ˆæœ¬æŒ‡å®šä¸º<code>tls1.0</code>ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_TLS_MIN_VERSION</code></p>
<h4 id="max-version--tls12"><a class="header" href="#max-version--tls12">max-version = &quot;tls1.2&quot;</a></h4>
<p>å³å°†åå•†çš„TLSåè®®çš„æœ€å¤§ç‰ˆæœ¬ã€‚æœ‰æ•ˆå€¼åŒ…æ‹¬:<code>tls1.0</code>ã€<code>tls1.1</code>ã€<code>tls1.2</code>ã€‚<code>max-version</code>ä¸ºGo<code>crypto/TLS</code>åŒ…ä¸­æŒ‡å®šçš„æœ€å¤§TLSç‰ˆæœ¬å·ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œtls1.2å°†æœ€å¤§ç‰ˆæœ¬æŒ‡å®šä¸ºTLS 1.2ã€‚ç¯å¢ƒå˜é‡:<code>CNOSDB_TLS_MAX_VERSION</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="é›†ç¾¤ç®¡ç†"><a class="header" href="#é›†ç¾¤ç®¡ç†">é›†ç¾¤ç®¡ç†</a></h1>
<h2 id="ä»‹ç»"><a class="header" href="#ä»‹ç»">ä»‹ç»</a></h2>
<p>CnosDBç”±ä¸¤ç»„è½¯ä»¶ç»„æˆï¼Œ<code>data</code>èŠ‚ç‚¹å’Œ<code>meta</code>èŠ‚ç‚¹ï¼Œé›†ç¾¤å†…çš„é€šè®¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><code>meta</code>èŠ‚ç‚¹ä½¿ç”¨<code>tcp</code>å’Œ<code>raft</code>åè®®è¿›è¡Œé€šä¿¡ï¼Œ<code>meta</code>èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨é»˜è®¤ç«¯å£<code>8091</code>é€šä¿¡ï¼Œå¤šä¸ª<code>meta</code>èŠ‚ç‚¹éœ€è¦äº’ç›¸èƒ½å¤Ÿè®¿é—®ï¼Œç”¨æ¥ç»´æŒ<code>meta</code>é›†ç¾¤çš„ä¸€è‡´æ€§ã€‚åŒæ—¶<code>8091</code>ç«¯å£ä¹Ÿç”¨æ¥å’Œå¤–ç•Œé€šä¿¡ï¼Œæ¯”å¦‚<code>cnosd-ctl</code>æˆ–<code>data</code>èŠ‚ç‚¹ç­‰ã€‚</p>
<p><code>data</code>èŠ‚ç‚¹é€šè¿‡<code>tcp</code>çš„8088ç«¯å£äº’ç›¸é€šä¿¡ï¼Œå¹¶ä¸”é€šè¿‡<code>8091</code>è®¿é—®<code>meta</code>èŠ‚ç‚¹çš„APIï¼Œä½¿çŠ¶æ€ä¿æŒåŒæ­¥ã€‚</p>
<p><code>meta</code>èŠ‚ç‚¹æ•°é‡å¿…é¡»ä¸ºå¤§äºç­‰äº3çš„å¥‡æ•°ï¼Œè¿™æ ·å¯ä»¥ä¿è¯é›†ç¾¤èƒ½å¤Ÿä¿æŒé€‰ä¸¾ç¨³å®šã€‚</p>
<h2 id="å®‰è£…-1"><a class="header" href="#å®‰è£…-1">å®‰è£…</a></h2>
<p>é…ç½®æ–‡ä»¶çš„<code>hostname</code>éœ€è¦å…¶ä»–çš„<code>meta node</code>å’Œ<code>data node</code>èŠ‚ç‚¹éƒ½èƒ½å¤Ÿè®¿é—®ã€‚</p>
<p>é…ç½®æ–‡ä»¶å¯ä»¥é€šè¿‡<code>cnosdb-meta config &gt; config_path</code>è·å¾—ã€‚</p>
<h3 id="å¯åŠ¨metaèŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨metaèŠ‚ç‚¹">å¯åŠ¨<code>meta</code>èŠ‚ç‚¹</a></h3>
<pre><code>./cnosdb-meta --config [cnosdb_meta_config_path]
</code></pre>
<h3 id="å°†metaåŠ å…¥åˆ°é›†ç¾¤"><a class="header" href="#å°†metaåŠ å…¥åˆ°é›†ç¾¤">å°†<code>meta</code>åŠ å…¥åˆ°é›†ç¾¤</a></h3>
<blockquote>
<p>æ·»åŠ å®Œåä¼šæç¤ºï¼šAdded meta node x at cnosdb-meta-0x:8091</p>
</blockquote>
<pre><code>cnosdb-ctl --bind cnosdb-meta-01:8091 add-meta cnosdb-meta-01:8091
cnosdb-ctl --bind cnosdb-meta-01:8091 add-meta cnosdb-meta-02:8091
cnosdb-ctl --bind cnosdb-meta-01:8091 add-meta cnosdb-meta-03:8091
</code></pre>
<p>3ä¸ªèŠ‚ç‚¹éƒ½æ·»åŠ å®Œè¾“å…¥<code>cnosdb-ctl show</code>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p>
<pre><code>Data Nodes:
==========


Meta Nodes:
==========

1      cnosdb-meta-01:8091
2      cnosdb-meta-02:8091
3      cnosdb-meta-03:8091
</code></pre>
<p>è¯·æ³¨æ„ï¼Œä¸€ä½†æ²¡æœ‰å‡ºç°3ä¸ªèŠ‚ç‚¹ï¼Œä¸è¦è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>
<h3 id="å¯åŠ¨dataèŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨dataèŠ‚ç‚¹">å¯åŠ¨<code>data</code>èŠ‚ç‚¹</a></h3>
<blockquote>
<p>å¯åŠ¨å‰å°†é…ç½®æ–‡ä»¶ä¸­çš„<code>cluster</code>æ”¹ä¸º<code>true</code></p>
</blockquote>
<pre><code> cnosdb --config [cnosdb_config_path]
</code></pre>
<h3 id="å°†dataèŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤"><a class="header" href="#å°†dataèŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤">å°†<code>data</code>èŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤</a></h3>
<blockquote>
<p>æ·»åŠ å®Œåä¼šæç¤ºï¼šAdded data node x at cnosdb-data-0x:8088</p>
</blockquote>
<pre><code>cnosdb-ctl --bind cnosdb-data-01:8091 add-data cnosdb-data-01:8088
cnosdb-ctl --bind cnosdb-data-01:8091 add-data cnosdb-data-02:8088
</code></pre>
<p>2ä¸ªèŠ‚ç‚¹éƒ½æ·»åŠ å®Œè¾“å…¥<code>cnosdb-ctl show</code>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p>
<pre><code>Data Nodes:
==========

4      cnosdb-data-01:8088
5      cnosdb-data-02:8088
Meta Nodes:
==========

1      cnosdb-meta-01:8091
2      cnosdb-meta-02:8091
3      cnosdb-meta-03:8091
</code></pre>
<h2 id="distributed-sandbox"><a class="header" href="#distributed-sandbox">Distributed-sandbox</a></h2>
<p>å¯ä»¥ä½¿ç”¨<code>Distributed-sandbox</code>å·¥å…·å¿«é€Ÿç”Ÿäº§åˆ†å¸ƒå¼é›†ç¾¤</p>
<h3 id="è¦æ±‚"><a class="header" href="#è¦æ±‚">è¦æ±‚</a></h3>
<p>æœ¬åœ°ä¸Šè¦æœ‰<code>Docker</code></p>
<h3 id="å…‹éš†é¡¹ç›®"><a class="header" href="#å…‹éš†é¡¹ç›®">å…‹éš†é¡¹ç›®</a></h3>
<pre><code>git clone https://github.com/IvanGao01/distributed-sandbox.git
</code></pre>
<h3 id="è¿è¡Œ"><a class="header" href="#è¿è¡Œ">è¿è¡Œ</a></h3>
<pre><code>docker-compose up -d
chmod 777 cluster.sh
./cluster.sh
</code></pre>
<p>è¿è¡ŒæˆåŠŸåå¯çœ‹åˆ°å¦‚ä¸‹ç»“æœ</p>
<pre><code>Joining meta nodes to cluster...
Added meta node 1 at cnosdb-meta-01:8091
Added meta node 2 at cnosdb-meta-02:8091
Added meta node 3 at cnosdb-meta-03:8091
Data Nodes:
==========
4      cnosdb-data-01:8088
5      cnosdb-data-02:8088

Meta Nodes:
==========
1      cnosdb-meta-01:8091
2      cnosdb-meta-02:8091
3      cnosdb-meta-03:8091

Joining data nodes to cluster...
EOF
EOF
Cluster successfully created
Data Nodes:
==========
4      cnosdb-data-01:8088
5      cnosdb-data-02:8088

Meta Nodes:
==========
1      cnosdb-meta-01:8091
2      cnosdb-meta-02:8091
3      cnosdb-meta-03:8091
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb-1"><a class="header" href="#cnosdb-1">cnosdb</a></h1>
<p><code>cnosdb</code>å‘½ä»¤ç”¨äºå¯åŠ¨ CnosDB æœåŠ¡æˆ–ç›¸å…³åŠŸèƒ½ã€‚</p>
<h2 id="å‘½ä»¤ä»‹ç»"><a class="header" href="#å‘½ä»¤ä»‹ç»">å‘½ä»¤ä»‹ç»</a></h2>
<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody>
<tr><td>backup</td><td>åˆ›å»ºæ•°æ®èŠ‚ç‚¹çš„å¤‡ä»½</td></tr>
<tr><td>config</td><td>æ˜¾ç¤ºé»˜è®¤é…ç½®é¡¹</td></tr>
<tr><td>help</td><td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</td></tr>
<tr><td>restore</td><td>ä½¿ç”¨æ•°æ®èŠ‚ç‚¹çš„å¤‡ä»½è¿›è¡Œæ¢å¤</td></tr>
<tr><td>run</td><td>å¯åŠ¨æœåŠ¡</td></tr>
<tr><td>version</td><td>æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</td></tr>
</tbody></table>
<h3 id="cnosdb-run"><a class="header" href="#cnosdb-run"><code>cnosdb [run]</code></a></h3>
<p>å¯åŠ¨æœåŠ¡ã€‚</p>
<pre><code>cnosdb [run] [flags]
</code></pre>
<h3 id="å‚æ•°ä»‹ç»-2"><a class="header" href="#å‚æ•°ä»‹ç»-2"><em>å‚æ•°ä»‹ç»</em></a></h3>
<table><thead><tr><th>å‚æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody>
<tr><td><code>--config</code></td><td>é…ç½®æ–‡ä»¶è·¯å¾„</td></tr>
<tr><td><code>--pidfile</code></td><td>å°†è¿›ç¨‹ ID å†™å…¥æŒ‡å®šæ–‡ä»¶</td></tr>
<tr><td><code>--cpuprofile</code></td><td>å°† CPU ä¿¡æ¯å†™å…¥æŒ‡å®šæ–‡ä»¶</td></tr>
<tr><td><code>--memprofile</code></td><td>å°†å†…å­˜ä½¿ç”¨è®°å½•å†™å…¥æŒ‡å®šæ–‡ä»¶</td></tr>
</tbody></table>
<h3 id="cnosdb-backup"><a class="header" href="#cnosdb-backup"><code>cnosdb backup</code></a></h3>
<p>ä»æŒ‡å®šæ•°æ®èŠ‚ç‚¹åˆ›å»ºæ•°æ®åº“å¿«ç…§ï¼Œå¹¶ä¿å­˜åˆ° PATH å¯¹åº”ç›®å½•ã€‚</p>
<pre><code>cnosdb backup [flags] PATH
</code></pre>
<h3 id="å‚æ•°ä»‹ç»-3"><a class="header" href="#å‚æ•°ä»‹ç»-3">å‚æ•°ä»‹ç»</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--host</code></td><td>åœ°å€ï¼›å¯é€‰ï¼›é»˜è®¤å€¼ä¸º 127.0.0.1:8088 ã€‚</td></tr>
<tr><td><code>--db</code></td><td>æ•°æ®åº“åç§°ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šåˆ™å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ã€‚</td></tr>
<tr><td><code>--rp</code></td><td>æ•°æ®ä¿ç•™ç­–ç•¥ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šåˆ™å¤‡ä»½æ‰€æœ‰æ•°æ®ä¿ç•™ç­–ç•¥ã€‚</td></tr>
<tr><td><code>--shard</code></td><td>åˆ†ç‰‡ç¼–å·ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>-rp</code> å‚æ•°ã€‚</td></tr>
<tr><td><code>--start</code></td><td>å¤‡ä»½ä¸­åŒ…å«çš„æ•°æ®çš„æœ€å°æ—¶é—´æˆ³ (RFC3339 format) ã€‚</td></tr>
<tr><td><code>--end</code></td><td>å¤‡ä»½ä¸­åŒ…å«çš„æ•°æ®çš„æœ€å¤§æ—¶é—´æˆ³ (RFC3339 format) ã€‚</td></tr>
<tr><td><code>--skip-errors</code></td><td>åˆ›å»ºæŸåˆ†ç‰‡çš„å¤‡ä»½æ—¶ï¼Œè‹¥å‘ç”Ÿé”™è¯¯ï¼Œç»§ç»­åˆ›å»ºå‰©ä½™åˆ†ç‰‡çš„å¤‡ä»½ã€‚</td></tr>
</tbody></table>
<h3 id="cnosdb-restore"><a class="header" href="#cnosdb-restore"><code>cnosdb restore</code></a></h3>
<p>ä»æŒ‡å®šçš„å¤‡ä»½ç›®å½•ä¸­æ¢å¤æ•°æ®å’Œå…ƒæ•°æ®ã€‚æ¢å¤å¼€å§‹æ—¶ï¼ŒæœåŠ¡å°†è¢«å…³é—­ã€‚</p>
<pre><code>cnosdb restore [flags]
</code></pre>
<h3 id="å‚æ•°ä»‹ç»-4"><a class="header" href="#å‚æ•°ä»‹ç»-4">å‚æ•°ä»‹ç»</a></h3>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--host</code></td><td>åœ°å€ï¼›å¯é€‰ï¼›é»˜è®¤å€¼ä¸º 127.0.0.1:8088 ã€‚</td></tr>
<tr><td><code>--db</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„æ•°æ®åº“åç§°ã€‚</td></tr>
<tr><td><code>--newdb</code></td><td>åˆ›å»ºæ–°æ•°æ®åº“ä»¥å¯¼å…¥å¤‡ä»½æ•°æ®ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨ <code>--db &lt;db_name&gt;</code> ä¸­æŒ‡å®šçš„æ•°æ®åº“åç§°ã€‚è¯¥å‚æ•°æŒ‡å®šçš„æ•°æ®åº“åç§°åœ¨ç›®æ ‡ç³»ç»Ÿä¸­ä¸èƒ½é‡å¤ã€‚</td></tr>
<tr><td><code>--rp</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„æ•°æ®åº“ä¿ç•™ç­–ç•¥åç§°ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>--db</code> å‚æ•°ã€‚</td></tr>
<tr><td><code>--newrp</code></td><td>å°†å¤‡ä»½æ•°æ®å¯¼å…¥å…¶ä»–çš„æ•°æ®ä¿ç•™ç­–ç•¥ï¼›å¯é€‰ï¼›å¦‚æœæœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨ <code>--rp</code> ä¸­æŒ‡å®šçš„æ•°æ®ä¿ç•™ç­–ç•¥åç§°ã€‚</td></tr>
<tr><td><code>--shard</code></td><td>ä»å¤‡ä»½æ•°æ®ä¸­æ¢å¤çš„åˆ†ç‰‡ç¼–å·ï¼›å¯é€‰ï¼›å¦‚æœéœ€è¦ä½¿ç”¨è¯¥å‚æ•°ï¼Œåˆ™éœ€è¦åŒæ—¶ä½¿ç”¨ <code>--db</code> å’Œ <code>--rp</code> å‚æ•°ã€‚</td></tr>
</tbody></table>
<h3 id="cnosdb-config"><a class="header" href="#cnosdb-config"><code>cnosdb config</code></a></h3>
<p>æ˜¾ç¤ºæœåŠ¡è¿è¡Œæ—¶çš„é»˜è®¤é…ç½®ã€‚</p>
<pre><code>cnosdb config [flags]
</code></pre>
<h3 id="å‚æ•°ä»‹ç»-5"><a class="header" href="#å‚æ•°ä»‹ç»-5">å‚æ•°ä»‹ç»</a></h3>
<table><thead><tr><th style="text-align: left">Flag</th><th style="text-align: left"></th><th>Description</th></tr></thead><tbody>
<tr><td style="text-align: left"></td><td style="text-align: left"><code>--config</code></td><td>æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ã€‚è‹¥éœ€è¦ç¦æ­¢ä»æ–‡ä»¶ä¸­åŠ è½½é…ç½®é¡¹ï¼Œå¯å°†è¯¥å€¼è®¾ä¸º <code>/dev/null</code> ã€‚</td></tr>
<tr><td style="text-align: left"><code>-h</code></td><td style="text-align: left"><code>--help</code></td><td>æ˜¾ç¤º <code>cnosdb config</code> çš„å¸®åŠ©ä¿¡æ¯ã€‚</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb-cli"><a class="header" href="#cnosdb-cli"><strong>cnosdb-cli</strong></a></h1>
<p>å¯åŠ¨äº¤äº’å¼å‘½ä»¤è¡Œç¨‹åºå¹¶è¿æ¥ <code>cnosdb</code> æœåŠ¡ï¼Œä»¥å®ç°æ•°æ®çš„å†™å…¥ã€æŸ¥è¯¢ã€‚</p>
<pre><code>cnosdb-cli [flags]
</code></pre>
<h2 id="å‚æ•°ä»‹ç»-6"><a class="header" href="#å‚æ•°ä»‹ç»-6">å‚æ•°ä»‹ç»</a></h2>
<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>--host</code></td><td>è¿æ¥çš„ cnosdb HTTP åè®®åœ°å€ (default: <code>http://localhost:8086</code>)</td></tr>
<tr><td><code>--port</code></td><td>è¿æ¥çš„ cnosdb çš„ç«¯å£å·</td></tr>
<tr><td><code>--password</code></td><td>è¿æ¥æœåŠ¡æ—¶ä½¿ç”¨çš„å¯†ç </td></tr>
<tr><td><code>--username</code></td><td>è¿æ¥æœåŠ¡æ—¶ä½¿ç”¨çš„ç”¨æˆ·å</td></tr>
<tr><td><code>--ssl</code></td><td>è¿æ¥æ—¶ä½¿ç”¨ HTTPS åè®®</td></tr>
<tr><td><code>--format</code></td><td>æŒ‡å®šæ‰“å° cnosdb æœåŠ¡çš„å“åº”å†…å®¹çš„æ ¼å¼: json, csv, or column</td></tr>
<tr><td><code>--precision</code></td><td>æŒ‡å®šæ—¶é—´æˆ³çš„æ ¼å¼: rfc3339, h, m, s, ms, u or ns</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosdb_inspect"><a class="header" href="#cnosdb_inspect">cnosdb_inspect</a></h1>
<p>CnosDB Inspect æ˜¯ä¸€ä¸ª CnosDB ç£ç›˜å®ç”¨ç¨‹åºï¼Œå¯ç”¨äºï¼š</p>
<ul>
<li>æŸ¥çœ‹æœ‰å…³ç£ç›˜åˆ†ç‰‡çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>
<li>å°†æ•°æ®ä»åˆ†ç‰‡å¯¼å‡ºåˆ°å¯ä»¥æ’å…¥å›æ•°æ®åº“çš„CnosDB çº¿è·¯åè®®ã€‚</li>
<li>å°† TSM ç´¢å¼•åˆ†ç‰‡è½¬æ¢ä¸º TSI ç´¢å¼•åˆ†ç‰‡ã€‚</li>
</ul>
<p><strong>è¯­æ³•</strong></p>
<pre><code>cnosdb_inspect [ [ command ] [ options ] ]
</code></pre>
<ul>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#deletetsm">deletetsm</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#dumptsm">dumptsm</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#dumptsi">dumptsi</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#buildtsi">buildtsi</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#dumptsmwal">dumptsmwal</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#report-disk">report-disk</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#report">report</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#reporttsi">reporttsi</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#verify">verify</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#verify-seriesfile">verify-seriesfile</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#verify-tombstone">verify-tombstone</a></li>
<li><a href="content/cnosdb/latest/cnosdb_tools/cnosdb-inspect.html#export">export</a></li>
</ul>
<h2 id="deletetsm"><a class="header" href="#deletetsm"><code>deletetsm</code></a></h2>
<h3 id="cnosdb_inspect-deletetsm"><a class="header" href="#cnosdb_inspect-deletetsm"><code>cnosdb_inspect deletetsm</code></a></h3>
<p>æ‰¹é‡ä»åŸå§‹ <code>TSM</code> æ–‡ä»¶ä¸­åˆ é™¤<code>measurement</code>æ•°æ®</p>
<h3 id="æ³¨æ„ä»…å½“æ‚¨çš„cnosdbç¦»çº¿cnosdbæœåŠ¡æœªè¿è¡Œ-æ—¶æ‰ä½¿ç”¨deletetsm"><a class="header" href="#æ³¨æ„ä»…å½“æ‚¨çš„cnosdbç¦»çº¿cnosdbæœåŠ¡æœªè¿è¡Œ-æ—¶æ‰ä½¿ç”¨deletetsm">æ³¨æ„ï¼šä»…å½“æ‚¨çš„<code>CnosDB</code>ç¦»çº¿ï¼ˆ<code>CnosDB</code>æœåŠ¡æœªè¿è¡Œï¼‰ æ—¶æ‰ä½¿ç”¨<code>deletetsm</code>ã€‚</a></h3>
<h3 id="è¯­æ³•-2"><a class="header" href="#è¯­æ³•-2">è¯­æ³•</a></h3>
<pre><code>cnosdb_inspect deletetsm --measurement &lt;measurement_name&gt; [ arguments ] &lt;path&gt;
</code></pre>
<p><code>&lt;path&gt;</code></p>
<p>æ–‡ä»¶çš„è·¯å¾„<code>.tsm</code>ï¼Œé»˜è®¤ä½äº<code>data</code>ç›®å½•ä¸­ã€‚</p>
<p>æŒ‡å®šè·¯å¾„æ—¶ï¼Œé€šé…ç¬¦ (<code>*</code>) å¯ä»¥æ›¿æ¢ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚</p>
<h3 id="é€‰é¡¹"><a class="header" href="#é€‰é¡¹">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>--measurement</code></p>
<p>è¦ä» TSM æ–‡ä»¶ä¸­åˆ é™¤çš„<code>measurement</code>çš„åç§°ã€‚</p>
<p><code>[ --sanitize]</code></p>
<p>æ ‡è®°ä»¥åˆ é™¤åŒ…å«ä¸å¯æ‰“å°çš„ <code>Unicode </code>å­—ç¬¦çš„æ‰€æœ‰é”®ã€‚</p>
<p><code>[--v]</code></p>
<p>æ ‡è®°ä»¥å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•ã€‚</p>
<h3 id="ä¾‹å­-1"><a class="header" href="#ä¾‹å­-1">ä¾‹å­</a></h3>
<p>ä»å•ä¸ª<code>shard</code>ä¸­åˆ é™¤ä¸€ä¸ª<code>measurement</code></p>
<pre><code>./cnosdb_inspect deletetsm --sanitize /cnosdb/data/location/autogen/1384/*.tsm
</code></pre>
<p>ä»æ•°æ®åº“ä¸­çš„æ‰€æœ‰<code>shard</code>ä¸­åˆ é™¤<code>measurement</code></p>
<pre><code>./cnosdb_inspect deletetsm --sanitize /cnosdb/data/location/autogen/*/*.tsm
</code></pre>
<h2 id="dumptsm"><a class="header" href="#dumptsm"><code>dumptsm</code></a></h2>
<h3 id="cnosdb_inspect-dumptsm"><a class="header" href="#cnosdb_inspect-dumptsm"><code>cnosdb_inspect dumptsm</code></a></h3>
<p>è½¬å‚¨<code>tsm1</code>æ–‡ä»¶çš„åº•å±‚ç»†èŠ‚ï¼ŒåŒ…æ‹¬<code>TSM</code>æ–‡ä»¶å’Œ<code>WAL</code>æ–‡ä»¶</p>
<h3 id="è¯­æ³•-3"><a class="header" href="#è¯­æ³•-3">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect dumptsm [ options ] &lt;path&gt;</code></p>
<p><code>&lt;path&gt;</code></p>
<p>æ–‡ä»¶çš„è·¯å¾„<code>.tsm</code>ï¼Œé»˜è®¤ä½äº<code>data</code>ç›®å½•ä¸­ã€‚</p>
<h3 id="é€‰é¡¹-1"><a class="header" href="#é€‰é¡¹-1">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --index ]</code></p>
<p>ç”¨äºè½¬å‚¨åŸå§‹ç´¢å¼•æ•°æ®çš„æ ‡å¿—ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</p>
<p><code>[ --blocks ]</code></p>
<p>è½¬å‚¨åŸå§‹å—æ•°æ®çš„æ ‡å¿—ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</p>
<p><code>[ --all ]</code></p>
<p>æ ‡å¿—è½¬å‚¨æ‰€æœ‰æ•°æ®ã€‚æ³¨æ„ï¼šè¿™å¯èƒ½ä¼šæ‰“å°å¾ˆå¤šä¿¡æ¯ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</p>
<p><code>[ --filter-key &lt;key_name&gt; ]</code></p>
<p>ä»…æ˜¾ç¤ºä¸æ­¤é”®å­å­—ç¬¦ä¸²åŒ¹é…çš„ç´¢å¼•æ•°æ®å’Œå—æ•°æ®ã€‚é»˜è®¤å€¼ä¸º<code>&quot;&quot;</code>ã€‚</p>
<h2 id="dumptsi"><a class="header" href="#dumptsi"><code>dumptsi</code></a></h2>
<h3 id="cnosdb_inspect-dumptsi"><a class="header" href="#cnosdb_inspect-dumptsi"><code>cnosdb_inspect dumptsi</code></a></h3>
<p>è½¬å‚¨æœ‰å…³<code>TSI</code>æ–‡ä»¶çš„åº•å±‚ä¿¡æ¯ï¼ŒåŒ…æ‹¬<code>.tsl</code>æ—¥å¿—æ–‡ä»¶å’Œ<code>.tsi</code>æ–‡ä»¶</p>
<h3 id="è¯­æ³•-4"><a class="header" href="#è¯­æ³•-4">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect dumptsi [ options ] &lt;index_path&gt;</code></p>
<p>è‹¥æœªæŒ‡å®šä»»ä½•é€‰é¡¹ï¼Œåˆ™ä¼šä¸ºæ¯ä¸ªæ–‡ä»¶æä¾›æ±‡æ€»ä¿¡æ¯ã€‚</p>
<h3 id="é€‰é¡¹-2"><a class="header" href="#é€‰é¡¹-2">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>--series-file &lt;series_path&gt;</code></p>
<p><code>_series</code>æ•°æ®åº“ç›®å½•ä¸‹çš„ç›®å½•è·¯å¾„<code>data</code>ã€‚å¿…é¡»è¦æœ‰ã€‚</p>
<p><code>[ --series]</code></p>
<p>è½¬å‚¨åŸå§‹ç³»åˆ—æ•°æ®ã€‚</p>
<p><code>[ --measurements]</code></p>
<p>è½¬å‚¨åŸå§‹æµ‹é‡æ•°æ®ã€‚
<code> [ --tag-keys]</code></p>
<p>è½¬å‚¨åŸå§‹æ ‡ç­¾é”®ã€‚</p>
<p><code>[ --tag-values]</code></p>
<p>è½¬å‚¨åŸå§‹æ ‡ç­¾å€¼ã€‚</p>
<p><code>[ --tag-value-series]</code></p>
<p>ä¸ºæ¯ä¸ªæ ‡ç­¾å€¼è½¬å‚¨åŸå§‹ç³»åˆ—ã€‚</p>
<p><code>[ --measurement-filter &lt;regular_expression&gt;]</code></p>
<p>é€šè¿‡æµ‹é‡æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤æ•°æ®ã€‚</p>
<p><code>[ --tag-key-filter &lt;regular_expression&gt;]</code></p>
<p>æŒ‰æ ‡ç­¾é”®æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤æ•°æ®ã€‚</p>
<p><code>[ --tag-value-filter &lt;regular_expresssion&gt;]</code></p>
<p>æŒ‰æ ‡ç­¾å€¼æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤æ•°æ®ã€‚</p>
<h3 id="ä¾‹å­-2"><a class="header" href="#ä¾‹å­-2">ä¾‹å­</a></h3>
<p>æŒ‡å®š_serieså’Œindexç›®å½•çš„è·¯å¾„</p>
<p><code>cnsodb_inspect dumptsi --series-file /path/to/db/_series /path/to/index</code></p>
<p>æŒ‡å®š_seriesç›®å½•å’Œindexæ–‡ä»¶çš„è·¯å¾„</p>
<p><code>cnosdb_inspect dumptsi --series-file /path/to/db/_series /path/to/index/file0</code></p>
<p>æŒ‡å®š_seriesç›®å½•å’Œå¤šä¸ªindexæ–‡ä»¶çš„è·¯å¾„</p>
<pre><code>cnosdb_inspect dumptsi --series-file /path/to/db/_series /path/to/index/file0 /path/to/index/file1 ...
</code></pre>
<h2 id="buildtsi"><a class="header" href="#buildtsi"><code>buildtsi</code></a></h2>
<h3 id="cnosdb_inspect-buildtsi"><a class="header" href="#cnosdb_inspect-buildtsi"><code>cnosdb_inspect buildtsi</code></a></h3>
<p>æ„å»ºåŸºäº TSIï¼ˆæ—¶é—´åºåˆ—ç´¢å¼•ï¼‰ç£ç›˜çš„åˆ†ç‰‡ç´¢å¼•æ–‡ä»¶å’Œå…³è”çš„åºåˆ—æ–‡ä»¶ã€‚ç´¢å¼•è¢«å†™å…¥ä¸€ä¸ªä¸´æ—¶ä½ç½®ç›´åˆ°å®Œæˆï¼Œç„¶åç§»åŠ¨åˆ°ä¸€ä¸ªæ°¸ä¹…ä½ç½®ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™æ­¤æ“ä½œå°†å›é€€åˆ°åŸå§‹å†…å­˜ç´¢å¼•ã€‚</p>
<h3 id="æ³¨æ„-ä»…é€‚ç”¨äºç¦»çº¿è½¬æ¢-å¯ç”¨-tsi-åæ–°åˆ†ç‰‡ä½¿ç”¨-tsi-ç´¢å¼•ç°æœ‰åˆ†ç‰‡ç»§ç»­ä½œä¸ºåŸºäº-tsm-çš„åˆ†ç‰‡ç›´åˆ°ç¦»çº¿è½¬æ¢"><a class="header" href="#æ³¨æ„-ä»…é€‚ç”¨äºç¦»çº¿è½¬æ¢-å¯ç”¨-tsi-åæ–°åˆ†ç‰‡ä½¿ç”¨-tsi-ç´¢å¼•ç°æœ‰åˆ†ç‰‡ç»§ç»­ä½œä¸ºåŸºäº-tsm-çš„åˆ†ç‰‡ç›´åˆ°ç¦»çº¿è½¬æ¢">æ³¨æ„ï¼š ä»…é€‚ç”¨äºç¦»çº¿è½¬æ¢ã€‚ å¯ç”¨ TSI åï¼Œæ–°åˆ†ç‰‡ä½¿ç”¨ TSI ç´¢å¼•ã€‚ç°æœ‰åˆ†ç‰‡ç»§ç»­ä½œä¸ºåŸºäº TSM çš„åˆ†ç‰‡ï¼Œç›´åˆ°ç¦»çº¿è½¬æ¢ã€‚</a></h3>
<h3 id="è¯­æ³•-5"><a class="header" href="#è¯­æ³•-5">è¯­æ³•</a></h3>
<pre><code>cnosdb_inspect buildtsi [ options ] -datadir &lt;data_dir&gt; -waldir &lt;wal_dir&gt; [ options ]
</code></pre>
<h4 id="æ³¨æ„å°†buildtsiå‘½ä»¤ä¸æ‚¨è¦è¿è¡Œæ•°æ®åº“çš„ç”¨æˆ·å¸æˆ·ä¸€èµ·ä½¿ç”¨æˆ–è€…åœ¨è¿è¡Œå‘½ä»¤åç¡®ä¿æƒé™åŒ¹é…"><a class="header" href="#æ³¨æ„å°†buildtsiå‘½ä»¤ä¸æ‚¨è¦è¿è¡Œæ•°æ®åº“çš„ç”¨æˆ·å¸æˆ·ä¸€èµ·ä½¿ç”¨æˆ–è€…åœ¨è¿è¡Œå‘½ä»¤åç¡®ä¿æƒé™åŒ¹é…">æ³¨æ„ï¼šå°†buildtsiå‘½ä»¤ä¸æ‚¨è¦è¿è¡Œæ•°æ®åº“çš„ç”¨æˆ·å¸æˆ·ä¸€èµ·ä½¿ç”¨ï¼Œæˆ–è€…åœ¨è¿è¡Œå‘½ä»¤åç¡®ä¿æƒé™åŒ¹é…ã€‚</a></h4>
<h3 id="é€‰é¡¹-3"><a class="header" href="#é€‰é¡¹-3">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --batch-size ]</code></p>
<p>å†™å…¥ç´¢å¼•çš„æ‰¹æ¬¡å¤§å°ã€‚é»˜è®¤å€¼ä¸º<code>10000</code>ã€‚è®¾ç½®æ­¤å€¼ä¼šå¯¹æ€§èƒ½å’Œå †å¤§å°äº§ç”Ÿä¸åˆ©å½±å“ã€‚</p>
<p><code>[ --compact-series-file]</code></p>
<p>å‹ç¼©ç°æœ‰<code>series</code>æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¦»çº¿<code>series</code>ã€‚è¿­ä»£æ¯ä¸ª<code>segment</code>ä¸­çš„<code>series</code>å¹¶å°†<code>Index</code>ä¸­çš„<code>non-tombstoned series</code>é‡å†™åˆ°æ—è¾¹çš„æ–° <code>.tmp </code>æ–‡ä»¶ã€‚è½¬æ¢æ‰€æœ‰<code>segment</code>åï¼Œä¸´æ—¶æ–‡ä»¶å°†è¦†ç›–åŸå§‹æ®µã€‚</p>
<p><code>[ --concurrency ]</code></p>
<p>ä¸“ç”¨äºåˆ†ç‰‡ç´¢å¼•çš„å·¥ä½œäººå‘˜æ•°é‡ã€‚é»˜è®¤å€¼ä¸º<code>GOMAXPROCS</code>ã€‚</p>
<p><code>[ --database &lt;db_name&gt; ]</code></p>
<p>æ•°æ®åº“çš„åç§°ã€‚</p>
<p><code>--datadir &lt;data_dir&gt;</code></p>
<p><code>data</code>çš„æ–‡ä»¶è·¯å¾„ã€‚</p>
<p><code>[ --max-cache-size ]</code></p>
<p>å¼€å§‹æ‹’ç»å†™å…¥ä¹‹å‰ç¼“å­˜çš„æœ€å¤§å¤§å°ã€‚æ­¤å€¼è¦†ç›–çš„é…ç½®è®¾ç½® <code>[data] cache-max-memory-size</code>ã€‚é»˜è®¤å€¼ä¸º<code>1073741824</code>ã€‚</p>
<p><code>[ --max-log-file-size ]</code></p>
<p>æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å¤§å°ã€‚é»˜è®¤å€¼ä¸º<code>1048576</code>ã€‚</p>
<p><code>[ --retention &lt;rp_name&gt; ]</code></p>
<p>ä¿ç•™ç­–ç•¥çš„åç§°ã€‚</p>
<p><code>[ --shard &lt;shard_ID&gt; ]</code></p>
<p>åˆ†ç‰‡çš„æ ‡è¯†ç¬¦ã€‚</p>
<p><code>[ --v ]</code></p>
<p>ä»¥è¯¦ç»†æ¨¡å¼å¯ç”¨è¾“å‡ºçš„æ ‡å¿—ã€‚
<code> --waldir &lt;wal_dir&gt;</code></p>
<p><code>WAL</code>ï¼ˆé¢„å†™æ—¥å¿—ï¼‰æ–‡ä»¶çš„ç›®å½•ã€‚</p>
<h3 id="ä¾‹å­-3"><a class="header" href="#ä¾‹å­-3">ä¾‹å­</a></h3>
<p>è½¬æ¢èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰<code>shard</code></p>
<p><code>cnosdb_inspect buildtsi --datadir ~/.cnosdb/data --waldir ~/.cnosdb/wal</code></p>
<p>è½¬æ¢æ•°æ®åº“çš„æ‰€æœ‰<code>shard</code></p>
<p><code>cnosdb_inspect buildtsi --database mydb --datadir ~/.cnosdb/data --waldir ~/.cnosdb/wal</code></p>
<p>è½¬æ¢ç‰¹å®š<code>shard</code></p>
<pre><code>cnodb_inspect buildtsi --database stress -shard 1 --datadir ~/.cnosdb/data --waldir ~/.cnosdb/wal
</code></pre>
<h2 id="dumptsmwal"><a class="header" href="#dumptsmwal"><code>dumptsmwal</code></a></h2>
<h3 id="cnosdb_inspect-dumptsmwal"><a class="header" href="#cnosdb_inspect-dumptsmwal"><code>cnosdb_inspect dumptsmwal</code></a></h3>
<p>ä»…è½¬å‚¨ä¸€ä¸ªæˆ–å¤šä¸ª WAL ( <code>.wal</code>) æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ¡ç›®ï¼Œå¹¶æ’é™¤ TSM ( <code>.tsm</code>) æ–‡ä»¶</p>
<h3 id="è¯­æ³•-6"><a class="header" href="#è¯­æ³•-6">è¯­æ³•</a></h3>
<pre><code>cnosdb_inspect dumptsmwal [ options ] &lt;wal_dir&gt;
</code></pre>
<h3 id="é€‰é¡¹-4"><a class="header" href="#é€‰é¡¹-4">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --show-duplicates]</code></p>
<p>æ ‡è®°ä»¥æ˜¾ç¤ºå…·æœ‰é‡å¤æˆ–æ— åº<code>timestamp</code>çš„<code>key</code>ã€‚å¦‚æœç”¨æˆ·ä½¿ç”¨å®¢æˆ·ç«¯è®¾ç½®çš„<code>timestamp</code>å†™å…¥ç‚¹ï¼Œåˆ™å¯ä»¥å†™å…¥å…·æœ‰ç›¸åŒ<code>timestamp</code>ï¼ˆæˆ–å…·æœ‰æ—¶é—´é™åº<code>timestamp</code>ï¼‰çš„å¤šä¸ªç‚¹ã€‚</p>
<h2 id="report-disk"><a class="header" href="#report-disk"><code>report-disk</code></a></h2>
<h3 id="cnosdb_inspect-report"><a class="header" href="#cnosdb_inspect-report"><code>cnosdb_inspect report</code></a></h3>
<p>ä½¿ç”¨<code>report-disk</code>å‘½ä»¤æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„<code>TSM</code>æ–‡ä»¶çš„<code>shards</code>å’Œ<code>measurements</code>çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚</p>
<h3 id="è¯­æ³•-7"><a class="header" href="#è¯­æ³•-7">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect report-disk [ options ]</code></p>
<h3 id="é€‰é¡¹-5"><a class="header" href="#é€‰é¡¹-5">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --detailed]</code></p>
<p>åŒ…æ‹¬<code>flag</code>æ¥æŠ¥å‘Š<code>measurements</code>çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚</p>
<h2 id="report"><a class="header" href="#report"><code>report</code></a></h2>
<h3 id="cnosdb_inspect-report-1"><a class="header" href="#cnosdb_inspect-report-1"><code>cnosdb_inspect report</code></a></h3>
<p>æ˜¾ç¤ºæ‰€æœ‰<code>shard</code>çš„ç³»åˆ—å…ƒæ•°æ®ã€‚é»˜è®¤ä½ç½®æ˜¯<code>$HOME/.cnosdb</code>ã€‚</p>
<h3 id="è¯­æ³•-8"><a class="header" href="#è¯­æ³•-8">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect report [ options ]</code></p>
<h3 id="é€‰é¡¹-6"><a class="header" href="#é€‰é¡¹-6">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --pattern &quot;&lt;regular expression/wildcard&gt;&quot;]</code></p>
<p>åŒ¹é…åŒ…å«æ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼æˆ–é€šé…ç¬¦æ¨¡å¼ã€‚é»˜è®¤å€¼ä¸º<code>&quot;&quot;</code>ã€‚</p>
<p><code>[ --detailed]</code></p>
<p>æŠ¥å‘Šè¯¦ç»†åŸºæ•°ä¼°è®¡çš„æ ‡å¿—ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</p>
<p><code>[ --exact]</code></p>
<p>æŠ¥å‘Šç¡®åˆ‡åŸºæ•°è€Œä¸æ˜¯ä¼°è®¡å€¼çš„æ ‡å¿—ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚æ³¨æ„ï¼šè¿™ä¼šå ç”¨å¤§é‡å†…å­˜ã€‚</p>
<h2 id="reporttsi"><a class="header" href="#reporttsi"><code>reporttsi</code></a></h2>
<h3 id="cnosdb_inspect-reporttsi"><a class="header" href="#cnosdb_inspect-reporttsi"><code>cnosdb_inspect reporttsi</code></a></h3>
<ul>
<li>è®¡ç®—æ•°æ®åº“ä¸­çš„æ€»ç²¾ç¡®<code>series</code>åŸºæ•°ã€‚</li>
<li>é€šè¿‡<code>measurements</code>åˆ†å‰²<code>series</code>ï¼Œå¹¶å‘å‡ºè¿™äº›<code>series</code>å€¼ã€‚</li>
<li>ä¸ºæ•°æ®åº“ä¸­çš„æ¯ä¸ª<code>shard</code>å‘å‡ºæ€»çš„ç²¾ç¡®åŸºæ•°ã€‚</li>
<li>æ¯ä¸ª<code>shard</code>çš„<code>segment</code>æ˜¯<code>shard</code>ä¸­æ¯ä¸ª<code>measurement</code>çš„ç¡®åˆ‡åŸºæ•°ã€‚</li>
<li>å¯ä»¥é€‰æ‹©å°†æ¯ä¸ª<code>shard</code>ä¸­çš„ç»“æœé™åˆ¶ä¸ºâ€œå‰ n ä¸ªâ€ã€‚</li>
</ul>
<h3 id="è¯­æ³•-9"><a class="header" href="#è¯­æ³•-9">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect reporttsi --db-path &lt;path-to-db&gt; [ options ]</code></p>
<h3 id="é€‰é¡¹-7"><a class="header" href="#é€‰é¡¹-7">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>-db-path &lt;path-to-db&gt;</code></p>
<p>æ•°æ®åº“çš„è·¯å¾„ã€‚</p>
<p><code>[ -top &lt;n&gt;]</code></p>
<p>å°†ç»“æœé™åˆ¶ä¸ºæ¯ä¸ª<code>shard</code>ä¸­æŒ‡å®šçš„æ•°å­—ã€‚</p>
<h2 id="verify"><a class="header" href="#verify"><code>verify</code></a></h2>
<h3 id="cnosdb_inspect-verify"><a class="header" href="#cnosdb_inspect-verify"><code>cnosdb_inspect verify</code></a></h3>
<p>éªŒè¯ <code>TSM</code>æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</p>
<h3 id="è¯­æ³•-10"><a class="header" href="#è¯­æ³•-10">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect verify [ options ]</code></p>
<h3 id="é€‰é¡¹-8"><a class="header" href="#é€‰é¡¹-8">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>--dir &lt;storage_root&gt;</code>
å­˜å‚¨æ ¹ç›®å½•çš„è·¯å¾„ã€‚é»˜è®¤å€¼ä¸º&quot;<code>/root/.cnosdb</code>&quot;.</p>
<h2 id="verify-seriesfile"><a class="header" href="#verify-seriesfile"><code>verify-seriesfile</code></a></h2>
<h3 id="cnosdb_inspect-verify-seriesfile"><a class="header" href="#cnosdb_inspect-verify-seriesfile"><code>cnosdb_inspect verify-seriesfile</code></a></h3>
<p>éªŒè¯ <code>series</code>æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</p>
<h3 id="è¯­æ³•-11"><a class="header" href="#è¯­æ³•-11">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect verify-series [ options ]</code></p>
<h3 id="é€‰é¡¹-9"><a class="header" href="#é€‰é¡¹-9">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --c &lt;number&gt;]</code></p>
<p>æŒ‡å®šè¦ä¸ºæ­¤å‘½ä»¤è¿è¡Œçš„å¹¶å‘å·¥ä½œäººå‘˜çš„æ•°é‡ã€‚é»˜è®¤å€¼ç­‰äº GOMAXPROCS çš„å€¼ã€‚å¦‚æœæ€§èƒ½å—åˆ°ä¸åˆ©å½±å“ï¼Œæ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªè¾ƒä½çš„å€¼ã€‚</p>
<p><code>[ --dir &lt;path&gt;]</code></p>
<p>æŒ‡å®šæ ¹æ•°æ®è·¯å¾„ã€‚é»˜è®¤ä¸º<code>~/.cnosdb/data</code>.</p>
<p><code>[ --db &lt;db_name&gt;]</code></p>
<p>å°†éªŒè¯ç³»åˆ—æ–‡ä»¶é™åˆ¶ä¸ºæ•°æ®ç›®å½•ä¸­çš„æŒ‡å®šæ•°æ®åº“ã€‚</p>
<p><code>[ --series-file &lt;path&gt;]</code></p>
<p>ç‰¹å®šç³»åˆ—æ–‡ä»¶çš„è·¯å¾„ï¼›è¦†ç›–-<code>db</code>å’Œ<code>-dir</code>.</p>
<p><code>[ --v]</code></p>
<p>å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•ã€‚</p>
<h2 id="verify-tombstone"><a class="header" href="#verify-tombstone"><code>verify-tombstone</code></a></h2>
<h3 id="cnosdb_inspect-verify-tombstone"><a class="header" href="#cnosdb_inspect-verify-tombstone"><code>cnosdb_inspect verify-tombstone</code></a></h3>
<p>éªŒè¯ <code>tombstone</code>æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚</p>
<h3 id="è¯­æ³•-12"><a class="header" href="#è¯­æ³•-12">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect verify-tombstone [ options ]</code></p>
<h3 id="é€‰é¡¹-10"><a class="header" href="#é€‰é¡¹-10">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ -dir &lt;path&gt;]</code></p>
<p>æŒ‡å®šæ ¹æ•°æ®è·¯å¾„ã€‚é»˜è®¤ä¸º<code>~/.cnosdb/data</code>. è¯¥è·¯å¾„å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œä¾‹å¦‚ï¼Œå®ƒä¸éœ€è¦æ˜¯<code>CnosDB</code>æ•°æ®ç›®å½•ã€‚</p>
<p><code>[ --v]</code></p>
<p>å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•ã€‚ç¡®è®¤æ­£åœ¨éªŒè¯æ–‡ä»¶å¹¶æ¯500ä¸‡æ¡<code>tombstone</code>æ¡ç›®æ˜¾ç¤ºè¿›åº¦ã€‚</p>
<p><code>[ --vv]</code></p>
<p>å¯ç”¨éå¸¸è¯¦ç»†çš„æ—¥å¿—è®°å½•ã€‚æ˜¾ç¤º<code>tombstone</code>æ–‡ä»¶ä¸­æ¯ä¸ª<code>series key</code>å’Œæ—¶é—´èŒƒå›´ã€‚è‡ª(1970-01-01T00:00:00Z)ä»¥æ¥çš„æ—¶é—´æˆ³ä»¥çº³ç§’ä¸ºå•ä½æ˜¾ç¤ºã€‚</p>
<p><code>[ --vvv]</code></p>
<p>å¯ç”¨éå¸¸éå¸¸è¯¦ç»†çš„æ—¥å¿—è®°å½•ã€‚æ˜¾ç¤º<code>tombstone</code>æ–‡ä»¶ä¸­æ¯ä¸ª<code>series key</code>å’Œæ—¶é—´èŒƒå›´ã€‚æ—¶é—´æˆ³ä»¥<code>RFC3339</code>æ ¼å¼æ˜¾ç¤ºï¼Œç²¾åº¦ä¸ºçº³ç§’ã€‚</p>
<h2 id="export"><a class="header" href="#export"><code>export</code></a></h2>
<h3 id="cnosdb_inspect-export"><a class="header" href="#cnosdb_inspect-export"><code>cnosdb_inspect export</code></a></h3>
<p>ä»¥ <code>CnosDB</code> çº¿è·¯åè®®æ•°æ®æ ¼å¼å¯¼å‡ºæ‰€æœ‰ <code>TSM</code> æ–‡ä»¶ã€‚ä¸ºæ‰€æœ‰ <code>WAL</code> æ–‡ä»¶å†™å…¥æ•°æ®<code>_internal/monitor</code>ã€‚å¯ä»¥ä½¿ç”¨<code>cnosdb</code>å‘½ä»¤å¯¼å…¥æ­¤è¾“å‡ºæ–‡ä»¶ã€‚</p>
<h3 id="è¯­æ³•-13"><a class="header" href="#è¯­æ³•-13">è¯­æ³•</a></h3>
<p><code>cnosdb_inspect export [ options ]</code></p>
<h3 id="é€‰é¡¹-11"><a class="header" href="#é€‰é¡¹-11">é€‰é¡¹</a></h3>
<p>å¯é€‰å‚æ•°åœ¨æ‹¬å·ä¸­</p>
<p><code>[ --compress]</code></p>
<p>ä½¿ç”¨ gzip å‹ç¼©æ¥å‹ç¼©è¾“å‡ºçš„æ ‡å¿—ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</p>
<p><code>[ --database &lt;db_name&gt;]</code></p>
<p>è¦å¯¼å‡ºçš„æ•°æ®åº“çš„åç§°ã€‚é»˜è®¤å€¼ä¸º<code>&quot;&quot;</code>.</p>
<p><code>--datadir &lt;data_dir&gt;</code></p>
<p>ç›®å½•çš„è·¯å¾„<code>data</code>ã€‚é»˜è®¤å€¼ä¸º&quot;<code>$HOME/.cnosdb/data</code>&quot;ã€‚</p>
<p><code>[ --end &lt;timestamp&gt;]</code></p>
<p>æ—¶é—´èŒƒå›´ç»“æŸçš„æ—¶é—´æˆ³ã€‚å¿…é¡»æ˜¯<code>RFC3339 </code>æ ¼å¼ã€‚</p>
<p>RFC3339 éœ€è¦éå¸¸å…·ä½“çš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œè¦æŒ‡ç¤ºæ²¡æœ‰æ—¶åŒºåç§» (UTC+0)ï¼Œæ‚¨å¿…é¡»åœ¨ç§’ååŒ…å« Z æˆ– +00:00ã€‚æœ‰æ•ˆ RFC3339 æ ¼å¼çš„ç¤ºä¾‹åŒ…æ‹¬ï¼š</p>
<h3 id="æ— åç§»"><a class="header" href="#æ— åç§»"><code>æ— åç§»</code></a></h3>
<blockquote>
<p>YYYY-MM-DDTHH:MM:SS+00:00</p>
<p>YYYY-MM-DDTHH:MM:SSZ</p>
<p>YYYY-MM-DDTHH:MM:SS.nnnnnnZ (fractional seconds (.nnnnnn) are optional)</p>
</blockquote>
<h3 id="å¸¦åç§»"><a class="header" href="#å¸¦åç§»"><code>å¸¦åç§»</code></a></h3>
<blockquote>
<p>YYYY-MM-DDTHH:MM:SS-08:00</p>
<p>YYYY-MM-DDTHH:MM:SS+07:00</p>
</blockquote>
<p><code>[ --out &lt;export_dir&gt;]</code>
å¯¼å‡ºæ–‡ä»¶çš„ä½ç½®ã€‚é»˜è®¤å€¼ä¸º&quot;<code>$HOME/.cnosdb/export</code>&quot;ã€‚</p>
<p><code>[ --retention &lt;rp_name&gt; ]</code>
è¦å¯¼å‡ºçš„ä¿ç•™ç­–ç•¥çš„åç§°ã€‚é»˜è®¤å€¼ä¸º<code>&quot;&quot;</code>ã€‚</p>
<p><code>[ --start &lt;timestamp&gt;]</code>
æ—¶é—´èŒƒå›´å¼€å§‹çš„æ—¶é—´æˆ³ã€‚æ—¶é—´æˆ³å­—ç¬¦ä¸²å¿…é¡»é‡‡ç”¨<code>RFC3339 </code>æ ¼å¼ã€‚</p>
<p><code>[ --waldir &lt;wal_dir&gt;]</code>
<code>WAL</code>ç›®å½•çš„è·¯å¾„ã€‚é»˜è®¤å€¼ä¸º&quot;<code>$HOME/.cnosdb/wal</code>&quot;ã€‚</p>
<h3 id="ä¾‹å­-4"><a class="header" href="#ä¾‹å­-4">ä¾‹å­</a></h3>
<p>å¯¼å‡ºæ‰€æœ‰æ•°æ®åº“å¹¶å‹ç¼©è¾“å‡º</p>
<p><code>cnosdb_inspect export --compress</code></p>
<p>ä»ç‰¹å®šæ•°æ®åº“å’Œä¿ç•™ç­–ç•¥ä¸­å¯¼å‡ºæ•°æ®</p>
<p><code>cnosdb_inspect export --database mydb -retention autogen</code></p>
<p>è¾“å‡ºæ–‡ä»¶</p>
<pre><code>#DDL
CREATE DATABASE MY_DB_NAME

CREATE RETENTION POLICY autogen ON MY_DB_NAME DURATION inf REPLICATION 1

# DML

# CONTEXT-DATABASE:MY_DB_NAME

# CONTEXT-RETENTION-POLICY:autogen

randset value=97.9296104805 1439856000000000000

randset value=25.3849066842 1439856100000000000

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="è®¾è®¡åŸç†"><a class="header" href="#è®¾è®¡åŸç†">è®¾è®¡åŸç†</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cnosdb-vs-sql"><a class="header" href="#cnosdb-vs-sql">CnosDB VS SQL</a></h2>
<ul>
<li>
<h3 id="æ¦‚å¿µ"><a class="header" href="#æ¦‚å¿µ">æ¦‚å¿µ</a></h3>
<p>CnosDBç±»ä¼¼äºSQLæ•°æ®åº“ï¼Œä½†åœ¨è®¸å¤šæ–¹é¢æœ‰æ‰€ä¸åŒã€‚CnosDBæ˜¯ä¸“é—¨ä¸ºæ—¶é—´åºåˆ—æ•°æ®æ„å»ºçš„ã€‚å…³ç³»æ•°æ®åº“å¯ä»¥å¤„ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œä½†å¯¹å¸¸è§çš„æ—¶é—´åºåˆ—å·¥ä½œè´Ÿè½½æ²¡æœ‰è¿›è¡Œä¼˜åŒ–ã€‚CnosDBæ—¨åœ¨å­˜å‚¨å¤§é‡æ—¶é—´åºåˆ—æ•°æ®ï¼Œå¹¶å¿«é€Ÿå¯¹è¿™äº›æ•°æ®æ‰§è¡Œå®æ—¶åˆ†æã€‚</p>
<p>åœ¨CnosDBä¸­ï¼Œæ—¶é—´æˆ³æ ‡è¯†ä»»ä½•ç»™å®šæ•°æ®ç³»åˆ—ä¸­çš„å•ä¸ªç‚¹ã€‚è¿™å°±åƒä¸€ä¸ªSQLæ•°æ®åº“è¡¨ï¼Œå…¶ä¸­çš„ä¸»é”®æ˜¯ç”±ç³»ç»Ÿé¢„å…ˆè®¾ç½®çš„ï¼Œå¹¶ä¸”æ€»æ˜¯æ—¶é—´ã€‚</p>
<p>CnosDBè¿˜è®¤è¯†åˆ°ï¼Œæ‚¨çš„æ¨¡å¼é¦–é€‰é¡¹å¯èƒ½ä¼šéšç€æ—¶é—´è€Œæ”¹å˜ã€‚åœ¨CnosDBä¸­ï¼Œæ‚¨ä¸å¿…é¢„å…ˆå®šä¹‰æ¨¡å¼ã€‚æ•°æ®ç‚¹å¯ä»¥å…·æœ‰measurementsä¸Šçš„ä¸€ä¸ªå­—æ®µã€measurementsä¸Šçš„æ‰€æœ‰å­—æ®µæˆ–ä¸­é—´çš„ä»»ä½•æ•°å­—ã€‚åªéœ€ä¸ºæ–°å­—æ®µç¼–å†™ä¸€ä¸ªç‚¹ï¼Œå°±å¯ä»¥å‘measurementsæ·»åŠ æ–°å­—æ®µã€‚å¦‚æœæ‚¨éœ€è¦äº†è§£ç›¸å…³æœ¯è¯­ï¼Œå¦‚measurementã€tagå’Œfieldç­‰ï¼Œè¯·é˜…è¯»æœ¬èŠ‚å†…å®¹ï¼Œäº†è§£SQLæ•°æ®åº“åˆ°CnosDBæœ¯è¯­äº¤å‰ã€‚</p>
</li>
<li>
<h3 id="æœ¯è¯­"><a class="header" href="#æœ¯è¯­">æœ¯è¯­</a></h3>
<p>ä¸‹é¢çš„è¡¨æ˜¯ä¸€ä¸ª(éå¸¸)ç®€å•çš„ä¾‹å­ï¼Œå®ƒæ˜¯ä¸€ä¸ªSQLæ•°æ®åº“ä¸­åä¸º<code>wind_speed</code>çš„è¡¨ï¼Œå…¶ä¸­æ²¡æœ‰ç´¢å¼•çš„åˆ—æ˜¯<code>#wind_speed</code>ï¼Œç´¢å¼•çš„åˆ—æ˜¯<code>station_id</code>ã€<code>station</code>å’Œ<code>time</code>ã€‚</p>
<pre><code>+------------+---------------+---------------------+--------------+
| station_id |   station     |       time          |  #wind_speed |
+------------+---------------+---------------------+--------------+
|       1    | LianYunGang   | 1429185600000000000 |       63     |
|       1    | LianYunGang   | 1429185601000000000 |       74     |
|       1    | LianYunGang   | 1429185602000000000 |       51     |
|       1    | LianYunGang   | 1429185603000000000 |       15     |
|       2    | XiaoMaiDao    | 1429185600000000000 |       104    |
|       2    | XiaoMaiDao    | 1429185601000000000 |       20     |
|       2    | XiaoMaiDao    | 1429185602000000000 |       21     |
|       2    | XiaoMaiDao    | 1429185603000000000 |       34     |
+------------+---------------+---------------------+--------------+
</code></pre>
<p>åŒæ ·çš„æ•°æ®åœ¨ CnosDB ä¸­çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code>name: wind_speed
tags: station_id=1, station=LianYunGang
time			               #wind_speed
----			               ------------
2015-04-16T12:00:00Z	 63
2015-04-16T12:00:01Z	 74
2015-04-16T12:00:02Z	 51
2015-04-16T12:00:03Z	 15

name: wind_speed
tags: station_id=2, station=XiaoMaiDao
time			               #wind_speed
----			               ------------
2015-04-16T12:00:00Z	 104
2015-04-16T12:00:01Z	 20
2015-04-16T12:00:02Z	 21
2015-04-16T12:00:03Z	 34
</code></pre>
<ul>
<li>æ—¶é—´åºåˆ—æ•°æ®åœ¨èšåˆåœºæ™¯ä¸­æœ€æœ‰ç”¨</li>
<li>CnosDB ä¸­çš„<code>measurement</code>ç±»ä¼¼äºSQLæ•°æ®åº“<code>table</code>ã€‚</li>
<li>CnosDB ä¸­çš„<code>tags</code>ç±»ä¼¼äºSQLæ•°æ®åº“ä¸­çš„æœ‰ç´¢å¼•çš„åˆ—ã€‚</li>
<li>CnosDB ä¸­çš„<code>fields</code>ç±»ä¼¼SQLæ•°æ®åº“ä¸­æ²¡æœ‰ç´¢å¼•çš„åˆ—ã€‚</li>
<li>CnosDB ä¸­çš„<code>points</code>ç±»ä¼¼äºSQLè¡Œã€‚</li>
<li>CnosDB ä¸­ä¸éœ€è¦é¢„å®šä¹‰<code>schema</code></li>
</ul>
<p>åŸºäºå¯¹æ•°æ®åº“æœ¯è¯­çš„è¿™ç§æ¯”è¾ƒï¼ŒCnosDBè¿ç»­æŸ¥è¯¢å’Œä¿ç•™ç­–ç•¥ç±»ä¼¼äºSQLæ•°æ®åº“ä¸­çš„å­˜å‚¨è¿‡ç¨‹ã€‚å®ƒä»¬åªæŒ‡å®šä¸€æ¬¡ï¼Œç„¶åå®šæœŸè‡ªåŠ¨æ‰§è¡Œã€‚</p>
<p>å½“ç„¶ï¼ŒSQLæ•°æ®åº“å’ŒCnosDBä¹‹é—´å­˜åœ¨ä¸€äº›ä¸»è¦å·®å¼‚ã€‚SQL joinä¸èƒ½ç”¨äºCnosDBçš„<code>measurements</code>; æ‚¨çš„æ¨¡å¼è®¾è®¡åº”è¯¥åæ˜ è¿™ç§å·®å¼‚ã€‚è€Œä¸”ï¼Œæ­£å¦‚æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œ<code>measurements</code>å°±åƒä¸€ä¸ªSQLè¡¨ï¼Œå…¶ä¸­çš„ä¸»ç´¢å¼•æ€»æ˜¯é¢„å…ˆè®¾ç½®ä¸ºtimeã€‚CnosDBæ—¶é—´æˆ³å¿…é¡»åœ¨U<code>NIX epoch (GMT)</code>æˆ–æ ¼å¼åŒ–ä¸º<code>RFC3339</code>ä¸‹æœ‰æ•ˆçš„æ—¥æœŸ-æ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
</li>
<li>
<h3 id="cnosql"><a class="header" href="#cnosql">CnosQL</a></h3>
<p>CnosDBæ”¯æŒçš„æŸ¥è¯¢è¯­è¨€ä¸»è¦æ˜¯CnosQLã€‚</p>
<p>CnosQLæ˜¯ä¸€ç§ç±»ä¼¼sqlçš„æŸ¥è¯¢è¯­è¨€ï¼Œç”¨äºä¸CnosDBäº¤äº’ã€‚å®ƒç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œä½¿ä¹‹ä¸å…¶ä»–SQLæˆ–ç±»ä¼¼SQLçš„ç¯å¢ƒä¸­çš„SQLç›¸ä¼¼ï¼ŒåŒæ—¶è¿˜æä¾›äº†ç‰¹å®šäºå­˜å‚¨å’Œåˆ†ææ—¶é—´åºåˆ—æ•°æ®çš„ç‰¹æ€§ã€‚ç„¶è€Œï¼ŒCnosQLä¸æ˜¯SQLï¼Œç¼ºä¹å¯¹SQLé«˜çº§ç”¨æˆ·ä¹ æƒ¯çš„æ›´é«˜çº§æ“ä½œï¼Œå¦‚UNIONã€JOINå’ŒHAVINGçš„æ”¯æŒã€‚</p>
<p>CnosQLçš„SELECTè¯­å¥éµå¾ªSQL SELECTè¯­å¥çš„å½¢å¼:</p>
<p><code>SELECT &lt;stuff&gt; FROM &lt;measurement_name&gt; WHERE &lt;some_conditions&gt;</code></p>
<p><code>WHERE</code>æ˜¯å¯é€‰çš„</p>
<p>è¦è·å¾—ä¸Šé¢éƒ¨åˆ†çš„CnosDBè¾“å‡ºï¼Œæ‚¨éœ€è¦è¾“å…¥:</p>
<p><code>SELECT * FROM &quot;wind_speed&quot;</code></p>
<p>å¦‚æœä½ åªæƒ³çœ‹åˆ°LianYunGangçš„æ•°æ®ï¼Œä½ å¯ä»¥è¾“å…¥:</p>
<p><code>SELECT * FROM &quot;wind_speed&quot; WHERE &quot;station&quot; = 'LianYunGang'</code></p>
<p>å¦‚æœä½ æƒ³æŸ¥çœ‹2015å¹´4æœˆ16æ—¥12:00:01 UTCä¹‹åLianYunGangçš„æ•°æ®ï¼Œä½ å¯ä»¥è¾“å…¥:</p>
<p><code>SELECT * FROM &quot;wind_speed&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt; '2015-04-16 12:00:01'</code></p>
<p>å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼ŒCnosQLå…è®¸æ‚¨åœ¨<code>WHERE</code>è¯­å¥ä¸­æŒ‡å®šæŸ¥è¯¢çš„æ—¶é—´èŒƒå›´ã€‚å¯ä»¥ä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥çš„æ—¥æœŸ-æ—¶é—´å­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸ºY<code>YYY-MM-DD HH:MM:SS.MMM </code>(<code>MMM</code>æ˜¯å¯é€‰çš„æ¯«ç§’æ•°ï¼Œæ‚¨è¿˜å¯ä»¥æŒ‡å®šå¾®ç§’æˆ–çº³ç§’)ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨<code>now()</code>ä¸­ä½¿ç”¨ç›¸å¯¹æ—¶é—´ï¼Œå®ƒæŒ‡çš„æ˜¯æœåŠ¡å™¨çš„å½“å‰æ—¶é—´æˆ³:</p>
<p><code>SELECT * FROM &quot;wind_speed&quot; WHERE time &gt; now() - 1h</code></p>
<p>è¯¥æŸ¥è¯¢è¾“å‡ºwind_speedçš„measurementsä¸­çš„æ•°æ®ï¼Œå…¶ä¸­æ—¶é—´æˆ³æ¯”æœåŠ¡å™¨å½“å‰æ—¶é—´æ—©1å°æ—¶ã€‚ä½¿ç”¨now()æŒ‡å®šæŒç»­æ—¶é—´çš„é€‰é¡¹æœ‰:ns(çº³ç§’)ã€uæˆ–Âµ(å¾®ç§’)ã€ms(æ¯«ç§’)ã€s(ç§’)ã€m(åˆ†é’Ÿ)ã€h(å°æ—¶)ã€d(å¤©)å’Œw(å‘¨)ã€‚</p>
</li>
<li>
<h3 id="cnosdb-å¹¶é-crud"><a class="header" href="#cnosdb-å¹¶é-crud">CnosDB å¹¶é CRUD</a></h3>
<p>CnosDBæ˜¯ä¸€ä¸ªé’ˆå¯¹æ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œäº†ä¼˜åŒ–çš„æ•°æ®åº“ã€‚è¿™äº›æ•°æ®é€šå¸¸æ¥è‡ªåˆ†å¸ƒå¼ä¼ æ„Ÿå™¨ç»„ã€å¤§å‹ç½‘ç«™çš„ç‚¹å‡»æ•°æ®æˆ–é‡‘èäº¤æ˜“åˆ—è¡¨ã€‚</p>
<p>è¿™äº›æ•°æ®çš„ä¸€ä¸ªå…±åŒä¹‹å¤„æ˜¯ï¼Œå®ƒä»¬åœ¨æ€»ä½“ä¸Šæ›´æœ‰ç”¨ã€‚æœ‰ä¸€ç¯‡æ–‡ç« è¯´ï¼Œä½ çš„ç”µè„‘åœ¨UTCæ—¶é—´å‘¨äºŒ12:38:35çš„æ—¶å€™CPUåˆ©ç”¨ç‡ä¸º12%ï¼Œè¿™å¾ˆéš¾ä»ä¸­å¾—å‡ºç»“è®ºã€‚å½“ä¸æœ¬åºåˆ—çš„å…¶ä»–éƒ¨åˆ†ç»“åˆä½¿ç”¨æ—¶ï¼Œå®ƒå°†å˜å¾—æ›´åŠ æœ‰ç”¨ã€‚è¿™æ˜¯éšç€æ—¶é—´çš„æ¨ç§»è¶‹åŠ¿å¼€å§‹æ˜¾ç°çš„åœ°æ–¹ï¼Œå¯ä»¥ä»æ•°æ®ä¸­å¾—å‡ºå¯æ“ä½œçš„è§è§£ã€‚æ­¤å¤–ï¼Œæ—¶é—´åºåˆ—æ•°æ®é€šå¸¸åªå†™å…¥ä¸€æ¬¡ï¼Œå¾ˆå°‘æ›´æ–°ã€‚</p>
<p>å…¶ç»“æœæ˜¯ï¼ŒCnosDBä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„CRUDæ•°æ®åº“ï¼Œè€Œæ˜¯æ›´åƒä¸€ä¸ªCR-udï¼Œä¼˜å…ˆè€ƒè™‘åˆ›å»ºå’Œè¯»å–æ•°æ®çš„æ€§èƒ½ï¼Œè€Œä¸æ˜¯æ›´æ–°å’Œé”€æ¯ï¼Œå¹¶é˜²æ­¢ä¸€äº›æ›´æ–°å’Œé”€æ¯è¡Œä¸ºï¼Œä»¥ä½¿åˆ›å»ºå’Œè¯»å–æ€§èƒ½æ›´é«˜:</p>
<ul>
<li>è¦æ›´æ–°ä¸€ä¸ªç‚¹ï¼Œè¯·æ’å…¥ä¸€ä¸ªå…·æœ‰ç›¸åŒmeasurementsã€tag setå’Œtimestampçš„ç‚¹ã€‚</li>
<li>æ‚¨å¯ä»¥åˆ é™¤æˆ–åˆ é™¤åºåˆ—ï¼Œä½†ä¸èƒ½åŸºäºå­—æ®µå€¼åˆ é™¤å•ä¸ªç‚¹ã€‚ä½œä¸ºä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥æœç´¢å­—æ®µå€¼ï¼Œæ£€ç´¢æ—¶é—´ï¼Œç„¶ååŸºäºæ—¶é—´å­—æ®µè¿›è¡ŒDELETEæ“ä½œã€‚</li>
<li>æ‚¨è¿˜ä¸èƒ½æ›´æ–°æˆ–é‡å‘½åtagsã€‚è¦ä¿®æ”¹ä¸€ç³»åˆ—ç‚¹çš„tagsï¼Œè¯·æ‰¾åˆ°æœ‰é—®é¢˜æ ‡è®°å€¼çš„ç‚¹ï¼Œå°†å€¼æ›´æ”¹ä¸ºæ‰€éœ€çš„å€¼ï¼Œå°†è¿™äº›ç‚¹å†™å›ï¼Œç„¶ååˆ é™¤å¸¦æœ‰æ—§tag valuesçš„åºåˆ—ã€‚</li>
<li>ä½ ä¸èƒ½é€šè¿‡tag keysæ¥åˆ é™¤tagsã€‚</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="è®¾è®¡åŸåˆ™"><a class="header" href="#è®¾è®¡åŸåˆ™">è®¾è®¡åŸåˆ™</a></h1>
<p>CnosDBåº”ç”¨æ—¶é—´åºåˆ—æ•°æ®çš„ä¼˜åŒ–è®¾è®¡åŸåˆ™ã€‚å…¶ä¸­ä¸€äº›è®¾è®¡åŸåˆ™å¯èƒ½ä¸æ€§èƒ½æ–¹é¢çš„æƒè¡¡æœ‰å…³ã€‚ä¸»è¦è®¾è®¡åŸåˆ™åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä»¥æ—¶é—´ä¸ºé¡ºåºçš„æ•°æ®</li>
<li>ä¸¥æ ¼çš„æ›´æ–°å’Œåˆ é™¤æƒé™</li>
<li>é¢„å¤„ç†è¯»å†™æŸ¥è¯¢</li>
<li>æ— Schemaè®¾è®¡</li>
<li>å•ä¸ªPointä¸Šçš„æ•°æ®é›†</li>
<li>é‡å¤æ•°æ®</li>
</ul>
<h3 id="ä»¥æ—¶é—´ä¸ºé¡ºåºçš„æ•°æ®"><a class="header" href="#ä»¥æ—¶é—´ä¸ºé¡ºåºçš„æ•°æ®">ä»¥æ—¶é—´ä¸ºé¡ºåºçš„æ•°æ®</a></h3>
<p>ä¸ºäº†æé«˜æ€§èƒ½ï¼Œæ•°æ®æŒ‰æ—¶é—´å‡åºå†™å…¥ã€‚</p>
<h3 id="ä¸¥æ ¼çš„æ›´æ–°å’Œåˆ é™¤æƒé™"><a class="header" href="#ä¸¥æ ¼çš„æ›´æ–°å’Œåˆ é™¤æƒé™">ä¸¥æ ¼çš„æ›´æ–°å’Œåˆ é™¤æƒé™</a></h3>
<p>ä¸ºäº†æé«˜æŸ¥è¯¢å’Œå†™æ€§èƒ½ï¼ŒCnosDBä¸¥æ ¼é™åˆ¶æ›´æ–°å’Œåˆ é™¤æƒé™ã€‚æ—¶é—´åºåˆ—æ•°æ®ä¸»è¦æ˜¯ä»æœªæ›´æ–°çš„æ–°æ•°æ®ã€‚é™åˆ¶åˆ é™¤å¯ä»¥æœ‰æ•ˆæé«˜æŸ¥è¯¢å’Œå†™å…¥æ€§èƒ½ã€‚</p>
<h3 id="ä¼˜å…ˆå¤„ç†è¯»å†™æŸ¥è¯¢"><a class="header" href="#ä¼˜å…ˆå¤„ç†è¯»å†™æŸ¥è¯¢">ä¼˜å…ˆå¤„ç†è¯»å†™æŸ¥è¯¢</a></h3>
<p>CnosDBä¼˜å…ˆè€ƒè™‘è¯»å’Œå†™è¯·æ±‚ï¼Œè€Œä¸æ˜¯å¼ºä¸€è‡´æ€§ã€‚CnosDBåœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶è¿”å›ç»“æœã€‚æ‰€æœ‰å½±å“æŸ¥è¯¢æ•°æ®çš„äº‹åŠ¡éšåéƒ½ä¼šè¢«å¤„ç†ï¼Œä»¥ç¡®ä¿æ•°æ®æœ€ç»ˆæ˜¯ä¸€è‡´çš„ã€‚å› æ­¤ï¼Œå¦‚æœæ‘„å–é€Ÿç‡å¾ˆé«˜(æ¯æ¯«ç§’å¤šä¸ªå†™æ“ä½œ)ï¼ŒæŸ¥è¯¢ç»“æœå¯èƒ½ä¸åŒ…æ‹¬æœ€è¿‘çš„æ•°æ®ã€‚</p>
<h3 id="æ— schemaè®¾è®¡"><a class="header" href="#æ— schemaè®¾è®¡">æ— Schemaè®¾è®¡</a></h3>
<p>CnosDBä½¿ç”¨æ— Schemaè®¾è®¡æ¥æ›´å¥½åœ°ç®¡ç†ä¸è¿ç»­æ•°æ®ã€‚æ—¶é—´åºåˆ—æ•°æ®é€šå¸¸æ˜¯çŸ­æš‚çš„ï¼Œè¿™æ„å‘³ç€æ•°æ®å‡ºç°ä¸€æ®µæ—¶é—´ï¼Œç„¶åå°±æ¶ˆå¤±äº†ã€‚</p>
<h3 id="å•ä¸ªpointæ˜¯ä¸é‡è¦çš„"><a class="header" href="#å•ä¸ªpointæ˜¯ä¸é‡è¦çš„">å•ä¸ªPointæ˜¯ä¸é‡è¦çš„</a></h3>
<p>ç”±äºæ•°æ®é›†æ¯”å•ä¸ªPointæ›´é‡è¦ï¼Œå› æ­¤CnosDBå®ç°äº†å¼ºå¤§çš„å·¥å…·æ¥èšåˆæ•°æ®å’Œå¤„ç†å¤§å‹æ•°æ®é›†ã€‚Pointé€šè¿‡æ—¶é—´æˆ³å’Œåºåˆ—æ¥åŒºåˆ†ï¼Œæ‰€ä»¥æ²¡æœ‰ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„IDã€‚</p>
<h3 id="é‡å¤æ•°æ®"><a class="header" href="#é‡å¤æ•°æ®">é‡å¤æ•°æ®</a></h3>
<p>ä¸ºäº†ç®€åŒ–å†²çªè§£å†³å’Œæé«˜å†™æ€§èƒ½ï¼ŒCnosDBå‡è®¾å‘é€å¤šæ¬¡çš„æ•°æ®æ˜¯é‡å¤æ•°æ®ã€‚ç›¸åŒçš„ç‚¹ä¸ä¼šå­˜å‚¨ä¸¤æ¬¡ã€‚å¦‚æœä¸ºæŸä¸ªç‚¹æäº¤äº†æ–°çš„å­—æ®µå€¼ï¼Œåˆ™CnosDBä½¿ç”¨æœ€æ–°çš„å­—æ®µå€¼æ›´æ–°è¯¥ç‚¹ã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œæ•°æ®å¯èƒ½ä¼šè¢«è¦†ç›–ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tsmæ¶æ„è®¾è®¡"><a class="header" href="#tsmæ¶æ„è®¾è®¡">TSMæ¶æ„è®¾è®¡</a></h2>
<h3 id="è®¾è®¡æ¶æ„"><a class="header" href="#è®¾è®¡æ¶æ„">è®¾è®¡æ¶æ„</a></h3>
<p>æ¯ä¸ªCnosDBç”¨ä¾‹éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ‚¨çš„æ¨¡å¼åæ˜ äº†è¿™ç§å”¯ä¸€æ€§ã€‚é€šå¸¸ï¼Œä¸ºæŸ¥è¯¢è€Œè®¾è®¡çš„æ¨¡å¼å¯ä»¥å®ç°æ›´ç®€å•ã€æ›´é«˜æ•ˆçš„æŸ¥è¯¢ã€‚å¯¹äºå¤§å¤šæ•°ç”¨ä¾‹ï¼Œæˆ‘ä»¬æ¨èä»¥ä¸‹è®¾è®¡æ¶æ„:</p>
<ul>
<li>åœ¨ä½•å¤„å­˜å‚¨æ•°æ®(æ ‡ç­¾æˆ–å­—æ®µ)</li>
<li>é¿å…è¿‡å¤šçš„series</li>
<li>ä½¿ç”¨æ¨èçš„å‘½åçº¦å®š</li>
<li>åˆ†ç‰‡æ—¶é•¿ç®¡ç†</li>
</ul>
<h4 id="åœ¨ä½•å¤„å­˜å‚¨æ•°æ®æ ‡ç­¾æˆ–å­—æ®µ"><a class="header" href="#åœ¨ä½•å¤„å­˜å‚¨æ•°æ®æ ‡ç­¾æˆ–å­—æ®µ">åœ¨ä½•å¤„å­˜å‚¨æ•°æ®(æ ‡ç­¾æˆ–å­—æ®µ)</a></h4>
<ul>
<li>å°†å¸¸ç”¨æŸ¥è¯¢å’Œåˆ†ç»„å…ƒæ•°æ®å­˜å‚¨åœ¨æ ‡ç­¾ä¸­ã€‚</li>
<li>å¦‚æœæ¯ä¸ªæ•°æ®ç‚¹åŒ…å«ä¸åŒçš„å€¼ï¼Œåˆ™å°†æ•°æ®å­˜å‚¨åœ¨å­—æ®µä¸­ã€‚</li>
<li>å°†æ•°å­—å€¼å­˜å‚¨ä¸ºfields(tag valuesåªæ”¯æŒå­—ç¬¦ä¸²å€¼)ã€‚</li>
</ul>
<h4 id="é¿å…è¿‡å¤šçš„series"><a class="header" href="#é¿å…è¿‡å¤šçš„series">é¿å…è¿‡å¤šçš„series</a></h4>
<p>æŒ‰tagsæŸ¥è¯¢æ¯”æŒ‰fieldsæŸ¥è¯¢æ€§èƒ½æ›´å¥½ã€‚ä½†æ˜¯ï¼Œå½“åˆ›å»ºè¿‡å¤šçš„ç´¢å¼•æ—¶ï¼Œå†™å’Œè¯»éƒ½å¯èƒ½å¼€å§‹å˜æ…¢ã€‚</p>
<p>æ¯ä¸€ç»„ç´¢å¼•æ•°æ®å…ƒç´ å½¢æˆä¸€ä¸ªseries keyã€‚åŒ…å«é«˜åº¦å¯å˜ä¿¡æ¯(å¦‚å”¯ä¸€idã€å“ˆå¸Œå€¼å’Œéšæœºå­—ç¬¦ä¸²)çš„æ ‡è®°å°†å¯¼è‡´å¤§é‡çš„seriesï¼Œä¹Ÿç§°ä¸ºé«˜seriesåŸºæ•°ã€‚å¯¹äºè®¸å¤šæ•°æ®åº“å·¥ä½œè´Ÿè½½æ¥è¯´ï¼Œé«˜seriesåŸºæ•°æ˜¯é«˜å†…å­˜ä½¿ç”¨é‡çš„ä¸»è¦é©±åŠ¨å› ç´ ã€‚å› æ­¤ï¼Œä¸ºäº†å‡å°‘å†…å­˜æ¶ˆè€—ï¼Œå¯ä»¥è€ƒè™‘å°†é«˜åŸºæ•°å€¼å­˜å‚¨åœ¨field valuesä¸­ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨tag keysæˆ–field keysä¸­ã€‚</p>
<h4 id="ä½¿ç”¨æ¨èçš„å‘½åçº¦å®š"><a class="header" href="#ä½¿ç”¨æ¨èçš„å‘½åçº¦å®š">ä½¿ç”¨æ¨èçš„å‘½åçº¦å®š</a></h4>
<ul>
<li>é¿å…åœ¨tagå’Œfield keysä¸­ä¿ç•™å…³é”®å­—</li>
<li>å¦‚æœæ¯ä¸ªæ•°æ®ç‚¹åŒ…å«ä¸åŒçš„å€¼ï¼Œåˆ™å°†æ•°æ®å­˜å‚¨åœ¨fieldä¸­ã€‚</li>
<li>å°†æ•°å­—å€¼å­˜å‚¨ä¸ºfields(tag valuesåªæ”¯æŒå­—ç¬¦ä¸²å€¼)ã€‚</li>
</ul>
<h3 id="tsm-æ ‘"><a class="header" href="#tsm-æ ‘">TSM æ ‘</a></h3>
<p>æ—¶é—´ç»“æ„åˆå¹¶æ ‘(TSM)å¼•æ“è§£å†³äº†è·å¾—æœ€å¤§ååé‡ã€å‹ç¼©å’ŒåŸå§‹æ—¶é—´åºåˆ—æ•°æ®æŸ¥è¯¢é€Ÿåº¦çš„é—®é¢˜ã€‚åœ¨TSIä¹‹å‰ï¼Œå€’æ’ç´¢å¼•æ˜¯ä¸€ç§å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œæ˜¯åœ¨åŸºäºTSMä¸­çš„æ•°æ®å¯åŠ¨æ•°æ®åº“æ—¶æ„å»ºçš„ã€‚è¿™æ„å‘³ç€å¯¹äºæ¯ä¸ªåº¦é‡ã€æ ‡è®°é”®å€¼å¯¹å’Œå­—æ®µåï¼Œå†…å­˜ä¸­éƒ½æœ‰ä¸€ä¸ªæŸ¥è¯¢è¡¨æ¥å°†è¿™äº›å…ƒæ•°æ®ä½æ˜ å°„åˆ°åº•å±‚çš„æ—¶é—´åºåˆ—ã€‚å¯¹äºå…·æœ‰å¤§é‡ä¸´æ—¶åºåˆ—çš„ç”¨æˆ·ï¼Œå†…å­˜åˆ©ç”¨ç‡éšç€æ–°çš„æ—¶é—´åºåˆ—çš„åˆ›å»ºè€Œä¸æ–­å¢åŠ ã€‚è€Œä¸”ï¼Œå¯åŠ¨æ—¶é—´å¢åŠ äº†ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½å¿…é¡»åœ¨å¯åŠ¨æ—¶åŠ è½½åˆ°å †ä¸Šã€‚</p>
<h3 id="tsm-ç›¸å…³æ¦‚å¿µ"><a class="header" href="#tsm-ç›¸å…³æ¦‚å¿µ">TSM ç›¸å…³æ¦‚å¿µ</a></h3>
<p>CnosDBå­˜å‚¨å¼•æ“çœ‹èµ·æ¥éå¸¸ç±»ä¼¼äºLSMæ ‘ã€‚å®ƒæœ‰ä¸€ä¸ªé¢„å†™æ—¥å¿—å’Œä¸€ç»„åªè¯»æ•°æ®æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åœ¨æ¦‚å¿µä¸Šç±»ä¼¼äºLSMæ ‘ä¸­çš„sstableã€‚TSMæ–‡ä»¶åŒ…å«æ’åºã€å‹ç¼©çš„ç³»åˆ—æ•°æ®ã€‚</p>
<p>CnosDBå°†ä¸ºæ¯ä¸ªæ—¶é—´å—åˆ›å»ºä¸€ä¸ªåˆ†ç‰‡ï¼ˆå³shardï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªæ— é™æŒç»­æ—¶é—´çš„ä¿ç•™ç­–ç•¥ï¼Œé‚£ä¹ˆå°†ä¸ºæ¯7å¤©çš„æ—¶é—´å—åˆ›å»ºåˆ†ç‰‡ã€‚æ¯ä¸ªåˆ†ç‰‡éƒ½æ˜ å°„åˆ°åº•å±‚å­˜å‚¨å¼•æ“æ•°æ®åº“ã€‚æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰è‡ªå·±çš„WALå’ŒTSMæ–‡ä»¶ã€‚</p>
<h3 id="å­˜å‚¨å¼•æ“"><a class="header" href="#å­˜å‚¨å¼•æ“">å­˜å‚¨å¼•æ“</a></h3>
<p>å­˜å‚¨å¼•æ“å°†å¤šä¸ªç»„ä»¶æ†ç»‘åœ¨ä¸€èµ·ï¼Œæä¾›å­˜å‚¨å’ŒæŸ¥è¯¢ç³»åˆ—æ•°æ®çš„å¤–éƒ¨æ¥å£ã€‚å®ƒç”±å¤šä¸ªç»„ä»¶ç»„æˆï¼Œæ¯ä¸ªç»„ä»¶éƒ½æ‰®æ¼”ä¸€ä¸ªç‰¹å®šçš„è§’è‰²:</p>
<ul>
<li>
<p><code>å†…å­˜ç´¢å¼•</code>- å†…å­˜ç´¢å¼•æ˜¯è·¨åˆ†ç‰‡çš„å…±äº«ç´¢å¼•ï¼Œæä¾›å¯¹<code>measurement</code>ã€<code>tags</code>å’Œ<code>series</code>çš„å¿«é€Ÿè®¿é—®ã€‚ç´¢å¼•ç”±å¼•æ“ä½¿ç”¨ï¼Œä½†å¹¶ä¸ç‰¹å®šäºå­˜å‚¨å¼•æ“æœ¬èº«ã€‚</p>
</li>
<li>
<p><code>WAL</code> - <code>WAL</code>æ˜¯ä¸€ç§å†™å…¥ä¼˜åŒ–çš„å­˜å‚¨æ ¼å¼ï¼Œå®ƒå…è®¸å†™å…¥æ˜¯æŒä¹…çš„ï¼Œä½†ä¸å®¹æ˜“æŸ¥è¯¢ã€‚å¯¹<code>WAL</code>çš„å†™å…¥é™„åŠ åˆ°å›ºå®šå¤§å°çš„æ®µã€‚</p>
</li>
<li>
<p><code>ç¼“å­˜</code> - ç¼“å­˜æ˜¯å­˜å‚¨åœ¨<code>WAL</code>ä¸­çš„æ•°æ®çš„å†…å­˜è¡¨ç¤ºã€‚å®ƒåœ¨è¿è¡Œæ—¶è¢«æŸ¥è¯¢å¹¶ä¸å­˜å‚¨åœ¨<code>TSM</code>æ–‡ä»¶ä¸­çš„æ•°æ®åˆå¹¶ã€‚</p>
</li>
<li>
<p><code>TSM æ–‡ä»¶</code> - <code>TSM</code>æ–‡ä»¶ä»¥åˆ—æ ¼å¼å­˜å‚¨å‹ç¼©çš„ç³»åˆ—æ•°æ®ã€‚</p>
</li>
<li>
<p><code>FileStore</code>- <code>FileStore</code>è°ƒè§£å¯¹ç£ç›˜ä¸Šæ‰€æœ‰<code>TSM</code>æ–‡ä»¶çš„è®¿é—®ã€‚å®ƒç¡®ä¿åœ¨æ›¿æ¢ç°æœ‰æ–‡ä»¶ä»¥åŠåˆ é™¤ä¸å†ä½¿ç”¨çš„<code>TSM</code>æ–‡ä»¶æ—¶è‡ªåŠ¨å®‰è£…<code>TSM</code>æ–‡ä»¶ã€‚</p>
</li>
<li>
<p><code>Compactor</code> - <code>Compactor</code>è´Ÿè´£å°†ä¼˜åŒ–ç¨‹åº¦è¾ƒä½çš„<code>Cache</code>å’Œ<code>TSM</code>æ•°æ®è½¬æ¢ä¸ºè¯»å–ä¼˜åŒ–ç¨‹åº¦æ›´é«˜çš„æ ¼å¼ã€‚å®ƒé€šè¿‡å‹ç¼©ç³»åˆ—ã€åˆ é™¤å·²åˆ é™¤çš„æ•°æ®ã€ä¼˜åŒ–ç´¢å¼•ä»¥åŠå°†è¾ƒå°çš„æ–‡ä»¶ç»„åˆæˆè¾ƒå¤§çš„æ–‡ä»¶æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
</li>
<li>
<p><code>Compaction Planner</code> - <code>Compaction Planner</code>ç¡®å®šå“ªäº›<code>TSM</code>æ–‡ä»¶å·²å‡†å¤‡å¥½è¿›è¡Œå‹ç¼©ï¼Œå¹¶ç¡®ä¿å¤šä¸ªå¹¶å‘å‹ç¼©ä¸ä¼šç›¸äº’å¹²æ‰°ã€‚</p>
</li>
<li>
<p><code>Compression</code>- <code>Compression</code>ç”±å„ç§ç¼–ç å™¨å’Œè§£ç å™¨å¤„ç†ç‰¹å®šæ•°æ®ç±»å‹ã€‚ä¸€äº›ç¼–ç å™¨æ˜¯ç›¸å½“é™æ€çš„ï¼Œå¹¶ä¸”æ€»æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼ç¼–ç ç›¸åŒçš„ç±»å‹ï¼›å…¶ä»–äººæ ¹æ®æ•°æ®çš„å½¢çŠ¶åˆ‡æ¢å‹ç¼©ç­–ç•¥ã€‚</p>
</li>
<li>
<p><code>Writers/Readers</code> - æ¯ç§æ–‡ä»¶ç±»å‹ï¼ˆ<code>WAL</code>æ®µã€<code>TSM</code>æ–‡ä»¶ã€<code>tombstones</code>ç­‰ï¼‰éƒ½æœ‰ç”¨äºå¤„ç†æ ¼å¼çš„<code>Writers</code>å’Œ<code>Readers</code>ã€‚</p>
</li>
</ul>
<h3 id="é¢„å†™æ—¥å¿—-wal"><a class="header" href="#é¢„å†™æ—¥å¿—-wal">é¢„å†™æ—¥å¿— WAL</a></h3>
<p>WALè¢«ç»„ç»‡æˆä¸€ç»„ç±»ä¼¼äº<code>_000001.wal</code>çš„æ–‡ä»¶ã€‚æ–‡ä»¶ç¼–å·æ˜¯å•è°ƒé€’å¢çš„ï¼Œç§°ä¸ºWALæ®µã€‚å½“ä¸€ä¸ªæ®µçš„å¤§å°è¾¾åˆ°10MBæ—¶ï¼Œå®ƒè¢«å…³é—­å¹¶æ‰“å¼€ä¸€ä¸ªæ–°çš„æ®µã€‚æ¯ä¸ªWALæ®µå­˜å‚¨å¤šä¸ªå‹ç¼©çš„å†™å’Œåˆ é™¤å—ã€‚</p>
<p>å½“å†™å…¥æ—¶ï¼Œæ–°çš„ç‚¹è¢«åºåˆ—åŒ–ï¼Œä½¿ç”¨Snappyå‹ç¼©ï¼Œå¹¶å†™å…¥WALæ–‡ä»¶ã€‚åœ¨æˆåŠŸè¿”å›ä¹‹å‰ï¼Œæ–‡ä»¶è¢«fsyncå¹¶å°†æ•°æ®æ·»åŠ åˆ°å†…å­˜ç´¢å¼•ä¸­ã€‚è¿™æ„å‘³ç€éœ€è¦å°†ç‚¹æ‰¹å¤„ç†åœ¨ä¸€èµ·ä»¥å®ç°é«˜ååé‡æ€§èƒ½ã€‚(å¯¹äºè®¸å¤šç”¨ä¾‹æ¥è¯´ï¼Œæœ€ä½³æ‰¹é‡å¤§å°ä¼¼ä¹æ˜¯æ¯æ‰¹5000 - 10000ä¸ªç‚¹ã€‚)</p>
<p>WALä¸­çš„æ¯ä¸ªè¡¨é¡¹éƒ½éµå¾ª<code>TLVæ ‡å‡†</code>ï¼Œä¸€ä¸ªå­—èŠ‚ä»£è¡¨è¡¨é¡¹çš„ç±»å‹(å†™æˆ–åˆ é™¤)ï¼Œä¸€ä¸ª4å­—èŠ‚çš„<code>uint32</code>å‹ç¼©å—çš„é•¿åº¦ï¼Œç„¶åæ˜¯å‹ç¼©å—ã€‚</p>
<h3 id="ç¼“å­˜"><a class="header" href="#ç¼“å­˜">ç¼“å­˜</a></h3>
<p>ç¼“å­˜æ˜¯å½“å‰å­˜å‚¨åœ¨WALä¸­çš„æ‰€æœ‰æ•°æ®ç‚¹çš„å†…å­˜å‰¯æœ¬ã€‚è¿™äº›ç‚¹ç”±keyç»„ç»‡ï¼Œkeyæ˜¯measurementã€tag setå’Œfieldã€‚æ¯ä¸ªfieldä¿å­˜ä¸ºè‡ªå·±çš„æ—¶é—´é¡ºåºèŒƒå›´ã€‚ç¼“å­˜æ•°æ®åœ¨å†…å­˜ä¸­æ²¡æœ‰è¢«å‹ç¼©ã€‚</p>
<p>å¯¹å­˜å‚¨å¼•æ“çš„æŸ¥è¯¢å°†æŠŠæ¥è‡ªç¼“å­˜çš„æ•°æ®ä¸æ¥è‡ªTSMæ–‡ä»¶çš„æ•°æ®åˆå¹¶ã€‚åœ¨æŸ¥è¯¢å¤„ç†æ—¶ï¼Œå¯¹ä»ç¼“å­˜ä¸­è·å–çš„æ•°æ®çš„å‰¯æœ¬æ‰§è¡ŒæŸ¥è¯¢ã€‚è¿™æ ·ï¼Œåœ¨æŸ¥è¯¢è¿è¡Œæ—¶è¾“å…¥çš„å†™æ“ä½œä¸ä¼šå½±å“ç»“æœã€‚</p>
<p>å‘é€åˆ°ç¼“å­˜çš„åˆ é™¤æ“ä½œå°†æ¸…é™¤ç»™å®škeyæˆ–ç»™å®škeyçš„ç‰¹å®šæ—¶é—´èŒƒå›´ã€‚</p>
<p>ç¼“å­˜ä¸ºå¿«ç…§è¡Œä¸ºæä¾›äº†ä¸€äº›æ§åˆ¶ã€‚æœ€é‡è¦çš„æ§åˆ¶æ˜¯å†…å­˜é™åˆ¶ã€‚æœ‰ä¸€ä¸ªä¸‹ç•Œï¼Œå³<code>cache-snapshot-memory-size</code>ï¼Œè¶…è¿‡è¿™ä¸ªä¸‹ç•Œå°†è§¦å‘å¯¹TSMæ–‡ä»¶çš„å¿«ç…§ï¼Œå¹¶åˆ é™¤ç›¸åº”çš„WALæ®µã€‚è¿˜æœ‰ä¸€ä¸ªä¸Šé™ï¼Œ<code>cache-max-memory-size</code>ï¼Œè¶…è¿‡è¿™ä¸ªä¸Šé™ä¼šå¯¼è‡´ç¼“å­˜æ‹’ç»æ–°çš„å†™æ“ä½œã€‚è¿™äº›é…ç½®å¯¹äºé˜²æ­¢å†…å­˜ä¸è¶³çš„æƒ…å†µä»¥åŠå¯¹å®¢æˆ·æœºæ–½åŠ åå‹åŠ›éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå†™å…¥æ•°æ®çš„é€Ÿåº¦æ¯”å®ä¾‹æŒä¹…åŒ–æ•°æ®çš„é€Ÿåº¦è¦å¿«ã€‚æ¯æ¬¡å†™æ“ä½œæ—¶éƒ½ä¼šæ£€æŸ¥å†…å­˜é˜ˆå€¼ã€‚</p>
<p>å…¶ä»–å¿«ç…§æ§åˆ¶æ˜¯åŸºäºæ—¶é—´çš„ã€‚ç©ºé—²é˜ˆå€¼<code>cache -snapshot-write-cold-duration</code>åœ¨åˆ¶å®šæ—¶é—´é—´éš”å†…æ²¡æœ‰æ”¶åˆ°å†™è¯·æ±‚æ—¶ï¼Œå¼ºåˆ¶ç¼“å­˜å¿«ç…§TSMæ–‡ä»¶ã€‚</p>
<p>é€šè¿‡é‡æ–°è¯»å–ç£ç›˜ä¸Šçš„WALæ–‡ä»¶ï¼Œåœ¨é‡æ–°å¯åŠ¨æ—¶é‡æ–°åˆ›å»ºå†…å­˜ç¼“å­˜ã€‚</p>
<h3 id="tsm-æ–‡ä»¶"><a class="header" href="#tsm-æ–‡ä»¶">TSM æ–‡ä»¶</a></h3>
<p>TSMæ–‡ä»¶æ˜¯å†…å­˜æ˜ å°„çš„åªè¯»æ–‡ä»¶çš„é›†åˆã€‚è¿™äº›æ–‡ä»¶çš„ç»“æ„çœ‹èµ·æ¥éå¸¸ç±»ä¼¼äºLevelDBæˆ–å…¶ä»–LSMæ ‘å˜ä½“ä¸­çš„SSTableã€‚</p>
<p>TSMæ–‡ä»¶ç”±å››éƒ¨åˆ†ç»„æˆï¼šheader, blocks, index, footer.</p>
<h4 id="header"><a class="header" href="#header">Header</a></h4>
<pre><code>+--------+------------------------------------+-------------+--------------+
| Header |               Blocks               |    Index    |    Footer    |
|5 bytes |              N bytes               |   N bytes   |   4 bytes    |
+--------+------------------------------------+-------------+--------------+
</code></pre>
<p><code>Header</code>ç”¨äºæ ‡è¯†æ–‡ä»¶ç±»å‹å’Œç‰ˆæœ¬å·ã€‚</p>
<pre><code>  +-------------------+
  |      Header       |
  +-------------------+
  |  Magic  â”‚ Version |
  | 4 bytes â”‚ 1 byte  |
  +-------------------+
</code></pre>
<h4 id="blocks"><a class="header" href="#blocks">Blocks</a></h4>
<p><code>Blocks</code> æ˜¯æˆå¯¹çš„ CRC32 æ ¡éªŒå’Œå’Œæ•°æ®çš„åºåˆ—ã€‚blockæ•°æ®å¯¹æ–‡ä»¶æ˜¯ä¸é€æ˜çš„ã€‚CRC32 ç”¨äºblockçº§é”™è¯¯æ£€æµ‹ã€‚blockçš„é•¿åº¦å­˜å‚¨åœ¨ç´¢å¼•ä¸­ã€‚</p>
<pre><code>  +--------------------------------------------------------------------+
  â”‚                           Blocks                                   â”‚
  +---------------------+-----------------------+----------------------+
  |       Block 1       |        Block 2        |       Block N        |
  +---------------------+-----------------------+----------------------+
  |   CRC    |  Data    |    CRC    |   Data    |   CRC    |   Data    |
  | 4 bytes  | N bytes  |  4 bytes  | N bytes   | 4 bytes  |  N bytes  |
  +---------------------+-----------------------+----------------------+
</code></pre>
<h4 id="index"><a class="header" href="#index">Index</a></h4>
<p>blockä¹‹åæ˜¯æ–‡ä»¶ä¸­blockçš„Indexã€‚Indexç”±ä¸€ç³»åˆ—Indexæ¡ç›®ç»„æˆï¼Œè¿™äº›æ¡ç›®æŒ‰å­—å…¸é¡ºåºæŒ‰keyæ’åºï¼Œç„¶åæŒ‰æ—¶é—´æ’åºã€‚keyåŒ…æ‹¬measurement nameã€tag setå’Œone fieldã€‚æ¯ä¸ªç‚¹çš„å¤šä¸ªå­—æ®µåœ¨ TSM æ–‡ä»¶ä¸­åˆ›å»ºå¤šä¸ªIndexæ¡ç›®ã€‚æ¯ä¸ªIndexæ¡ç›®ä»¥keyé•¿åº¦å’Œkeyå¼€å¤´ï¼Œç„¶åæ˜¯blockç±»å‹ï¼ˆfloatã€intã€boolã€stringï¼‰å’Œkeyåé¢çš„block Indexæ¡ç›®æ•°ã€‚æ¯ä¸ªblock Indexæ¡ç›®ç”±blockçš„æœ€å°å’Œæœ€å¤§æ—¶é—´ã€blockæ‰€åœ¨æ–‡ä»¶çš„åç§»é‡å’Œblockçš„å¤§å°ç»„æˆã€‚TSM æ–‡ä»¶ä¸­åŒ…å«å¯†é’¥çš„æ¯ä¸ªblockéƒ½æœ‰ä¸€ä¸ªblock Indexæ¡ç›®ã€‚</p>
<p>Indexç»“æ„å¯ä»¥æä¾›å¯¹æ‰€æœ‰blockçš„æœ‰æ•ˆè®¿é—®ä»¥åŠç¡®å®šä¸è®¿é—®ç»™å®škeyç›¸å…³çš„æˆæœ¬çš„èƒ½åŠ›ã€‚ç»™å®šä¸€ä¸ªkeyå’Œtimestampï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šä¸€ä¸ªæ–‡ä»¶æ˜¯å¦åŒ…å«è¯¥æ—¶é—´æˆ³çš„å—ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ç¡®å®šè¯¥blockæ‰€åœ¨çš„ä½ç½®ä»¥åŠå¿…é¡»è¯»å–å¤šå°‘æ•°æ®æ‰èƒ½æ£€ç´¢è¯¥blockã€‚çŸ¥é“blockçš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåœ°é…ç½®æˆ‘ä»¬çš„ IO è¯­å¥ã€‚</p>
<pre><code>  +-----------------------------------------------------------------------------+
  â”‚                                   Index                                     â”‚
  +-----------------------------------------------------------------------------+
  â”‚ Key Len â”‚   Key   â”‚ Type â”‚ Count â”‚Min Time â”‚Max Time â”‚ Offset â”‚  Size  â”‚....â”‚
  â”‚ 2 bytes â”‚ N bytes â”‚1 byteâ”‚2 bytesâ”‚ 8 bytes â”‚ 8 bytes â”‚8 bytes â”‚4 bytes â”‚    â”‚
  +-----------------------------------------------------------------------------+
</code></pre>
<h4 id="footer"><a class="header" href="#footer">Footer</a></h4>
<p>æœ€åä¸€éƒ¨åˆ†æ˜¯å­˜å‚¨ç´¢å¼•å¼€å§‹çš„åç§»é‡çš„é¡µè„šã€‚</p>
<pre><code>  +---------+
  â”‚ Footer  â”‚
  +---------+
  â”‚Index Ofsâ”‚
  â”‚ 8 bytes â”‚
  +---------+
</code></pre>
<h3 id="å‹ç¼©"><a class="header" href="#å‹ç¼©">å‹ç¼©</a></h3>
<p>å‹ç¼©æ˜¯å°†ä»¥å†™ä¼˜åŒ–æ ¼å¼å­˜å‚¨çš„æ•°æ®è¿ç§»åˆ°è¯»ä¼˜åŒ–æ ¼å¼çš„å¾ªç¯è¿‡ç¨‹ã€‚å½“å†™ä¸€ä¸ªshardæ—¶ï¼Œæœ‰å‡ ä¸ªå‹ç¼©é˜¶æ®µ:</p>
<p>1.å¿«ç…§ â€”â€” å¿…é¡»å°†Cacheå’ŒWALä¸­çš„å€¼è½¬æ¢ä¸ºTSMæ–‡ä»¶ï¼Œä»¥é‡Šæ”¾WALæ®µæ‰€ä½¿ç”¨çš„å†…å­˜å’Œç£ç›˜ç©ºé—´ã€‚è¿™äº›å‹ç¼©æ˜¯åŸºäºç¼“å­˜å†…å­˜å’Œæ—¶é—´é˜ˆå€¼è¿›è¡Œçš„ã€‚</p>
<p>2.çº§åˆ«å‹ç¼© â€”â€” çº§åˆ«å‹ç¼©(çº§åˆ«1-4)å‘ç”Ÿåœ¨TSMæ–‡ä»¶ç”Ÿæˆæ—¶ã€‚TSMæ–‡ä»¶ä»å¿«ç…§æ–‡ä»¶å‹ç¼©åˆ°ä¸€çº§æ–‡ä»¶ã€‚å¤šä¸ª1çº§æ–‡ä»¶è¢«å‹ç¼©ä»¥ç”Ÿæˆ2çº§æ–‡ä»¶ã€‚è¿™ä¸ªè¿‡ç¨‹ç»§ç»­è¿›è¡Œï¼Œç›´åˆ°æ–‡ä»¶è¾¾åˆ°TSMæ–‡ä»¶çš„æœ€å¤§å¤§å°4çº§(å®Œå…¨å‹ç¼©)ã€‚é™¤ééœ€è¦è¿è¡Œåˆ é™¤ã€ç´¢å¼•ä¼˜åŒ–å‹ç¼©æˆ–å®Œå…¨å‹ç¼©ï¼Œå¦åˆ™ä¸ä¼šè¿›ä¸€æ­¥å‹ç¼©å®ƒä»¬ã€‚è¾ƒä½çº§åˆ«çš„å‹ç¼©ä½¿ç”¨çš„ç­–ç•¥é¿å…äº†cpuå¯†é›†å‹æ´»åŠ¨ï¼Œå¦‚è§£å‹ç¼©å’Œç»„åˆå—ã€‚æ›´é«˜çº§åˆ«(å› æ­¤æ›´å°‘é¢‘ç‡)çš„å‹ç¼©å°†é‡æ–°ç»„åˆå—ï¼Œä»¥å®Œå…¨å‹ç¼©å®ƒä»¬ï¼Œå¹¶å¢åŠ å‹ç¼©æ¯”ã€‚</p>
<p>3.ç´¢å¼•ä¼˜åŒ– â€”â€” å½“è®¸å¤š4çº§TSMæ–‡ä»¶ç´¯ç§¯æ—¶ï¼Œå†…éƒ¨ç´¢å¼•å°†å˜å¾—æ›´å¤§ï¼Œè®¿é—®æˆæœ¬ä¹Ÿæ›´é«˜ã€‚ç´¢å¼•ä¼˜åŒ–å‹ç¼©åœ¨ä¸€ç»„æ–°çš„TSMæ–‡ä»¶ä¸­åˆ†å‰²åºåˆ—å’Œç´¢å¼•ï¼Œå°†ç»™å®šåºåˆ—çš„æ‰€æœ‰ç‚¹æ’åºåˆ°ä¸€ä¸ªTSMæ–‡ä»¶ä¸­ã€‚åœ¨è¿›è¡Œç´¢å¼•ä¼˜åŒ–ä¹‹å‰ï¼Œæ¯ä¸ªTSMæ–‡ä»¶åŒ…å«å¤§å¤šæ•°æˆ–æ‰€æœ‰ç³»åˆ—çš„ç‚¹ï¼Œå› æ­¤æ¯ä¸ªæ–‡ä»¶åŒ…å«ç›¸åŒçš„ç³»åˆ—ç´¢å¼•ã€‚åœ¨ç´¢å¼•ä¼˜åŒ–ä¹‹åï¼Œæ¯ä¸ªTSMæ–‡ä»¶åŒ…å«æ¥è‡ªæœ€å°åºåˆ—çš„ç‚¹ï¼Œå¹¶ä¸”æ–‡ä»¶ä¹‹é—´çš„åºåˆ—é‡å å¾ˆå°‘ã€‚å› æ­¤ï¼Œæ¯ä¸ªTSMæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªè¾ƒå°çš„æƒŸä¸€ç³»åˆ—ç´¢å¼•ï¼Œè€Œä¸æ˜¯å®Œæ•´ç³»åˆ—åˆ—è¡¨çš„å‰¯æœ¬ã€‚æ­¤å¤–ï¼Œæ¥è‡ªç‰¹å®šç³»åˆ—çš„æ‰€æœ‰ç‚¹åœ¨TSMæ–‡ä»¶ä¸­æ˜¯è¿ç»­çš„ï¼Œè€Œä¸æ˜¯åˆ†å¸ƒåœ¨å¤šä¸ªTSMæ–‡ä»¶ä¸­ã€‚</p>
<p>4.å®Œå…¨å‹ç¼©(4çº§å‹ç¼©) â€”â€” å½“ç¢ç‰‡é•¿æ—¶é—´å¤„äºå†·çŠ¶æ€ï¼Œæˆ–è€…ç¢ç‰‡ä¸Šå‘ç”Ÿåˆ é™¤æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå®Œå…¨å‹ç¼©ã€‚å®Œå…¨å‹ç¼©ç”Ÿæˆä¸€ç»„æœ€ä¼˜çš„TSMæ–‡ä»¶ï¼Œå¹¶åŒ…æ‹¬æ¥è‡ªçº§åˆ«å’Œç´¢å¼•ä¼˜åŒ–å‹ç¼©çš„æ‰€æœ‰ä¼˜åŒ–ã€‚ä¸€æ—¦ç¢ç‰‡è¢«å®Œå…¨å‹ç¼©ï¼Œé™¤éå­˜å‚¨äº†æ–°çš„å†™æˆ–åˆ é™¤æ“ä½œï¼Œå¦åˆ™ä¸ä¼šåœ¨å…¶ä¸Šè¿è¡Œå…¶ä»–å‹ç¼©æ“ä½œã€‚</p>
<p>æ¯ä¸ªå—éƒ½è¢«å‹ç¼©ï¼Œä»¥å‡å°‘æŸ¥è¯¢æ—¶çš„å­˜å‚¨ç©ºé—´å’Œç£ç›˜IOã€‚ä¸€ä¸ªå—åŒ…å«ç»™å®šåºåˆ—å’Œå­—æ®µçš„æ—¶é—´æˆ³å’Œå€¼ã€‚æ¯ä¸ªå—æœ‰ä¸€ä¸ªå­—èŠ‚å¤´ï¼Œåé¢æ˜¯å‹ç¼©æ—¶é—´æˆ³å’Œå‹ç¼©å€¼ã€‚</p>
<pre><code>  +--------------------------------------------------+
  | Type  |  Len  |   Timestamps    |      Values    |
  |1 Byte | VByte |     N Bytes     |    N Bytes     â”‚
  +--------------------------------------------------+
</code></pre>
<p>æ ¹æ®æ•°æ®ç±»å‹åŠå…¶å½¢çŠ¶ï¼Œä½¿ç”¨ç¼–ç å¯¹æ—¶é—´æˆ³å’Œå€¼è¿›è¡Œå‹ç¼©å’Œå•ç‹¬å­˜å‚¨ã€‚ç‹¬ç«‹å­˜å‚¨å®ƒä»¬å…è®¸å¯¹æ‰€æœ‰æ—¶é—´æˆ³ä½¿ç”¨æ—¶é—´æˆ³ç¼–ç ï¼ŒåŒæ—¶å…è®¸å¯¹ä¸åŒçš„å­—æ®µç±»å‹ä½¿ç”¨ä¸åŒçš„ç¼–ç ã€‚ä¾‹å¦‚ï¼Œæœ‰äº›ç‚¹å¯ä»¥ä½¿ç”¨æ¸¸ç¨‹ç¼–ç ï¼Œè€Œå…¶ä»–ç‚¹åˆ™ä¸èƒ½ã€‚</p>
<p>æ¯ä¸ªå€¼ç±»å‹è¿˜åŒ…å«ä¸€ä¸ª1å­—èŠ‚çš„å¤´ï¼ŒæŒ‡ç¤ºå‰©ä½™å­—èŠ‚çš„å‹ç¼©ç±»å‹ã€‚å››ä¸ªé«˜ä½å­˜å‚¨å‹ç¼©ç±»å‹ï¼Œå››ä¸ªä½ä½åœ¨éœ€è¦æ—¶ç”±ç¼–ç å™¨ä½¿ç”¨ã€‚</p>
<h4 id="æ—¶é—´æˆ³"><a class="header" href="#æ—¶é—´æˆ³">æ—¶é—´æˆ³</a></h4>
<p>æ—¶é—´æˆ³ç¼–ç æ˜¯è‡ªé€‚åº”çš„ï¼Œå¹¶åŸºäºæ‰€ç¼–ç çš„æ—¶é—´æˆ³çš„ç»“æ„ã€‚å®ƒç»“åˆä½¿ç”¨å¢é‡ç¼–ç ã€ç¼©æ”¾å’Œä½¿ç”¨simple8bæ¸¸ç¨‹ç¼–ç çš„å‹ç¼©ï¼Œå¹¶åœ¨éœ€è¦æ—¶é€€å›åˆ°æ— å‹ç¼©ã€‚</p>
<p>æ—¶é—´æˆ³çš„åˆ†è¾¨ç‡æ˜¯å¯å˜çš„ï¼Œä½†å¯ä»¥æ˜¯çº³ç§’çº§çš„ç²’åº¦ï¼Œéœ€è¦8ä¸ªå­—èŠ‚æ¥å­˜å‚¨æœªå‹ç¼©çš„æ•°æ®ã€‚åœ¨ç¼–ç æœŸé—´ï¼Œå€¼é¦–å…ˆè¿›è¡Œå¢é‡ç¼–ç ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯èµ·å§‹æ—¶é—´æˆ³ï¼Œéšåçš„å€¼æ˜¯ä¸å‰ä¸€ä¸ªå€¼çš„å·®å€¼ã€‚è¿™é€šå¸¸å°†å€¼è½¬æ¢æˆæ›´å°çš„æ•´æ•°ï¼Œæ›´å®¹æ˜“å‹ç¼©ã€‚è®¸å¤šæ—¶é—´æˆ³ä¹Ÿæ˜¯å•è°ƒå¢åŠ çš„ï¼Œå¹¶è½åœ¨æ—¶é—´çš„å¶æ•°è¾¹ç•Œä¸Šï¼Œä¾‹å¦‚æ¯10ç§’ã€‚å½“æ—¶é—´æˆ³å…·æœ‰è¿™ç§ç»“æ„æ—¶ï¼Œå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°ä¹Ÿæ˜¯10çš„å€æ•°ã€‚è¿™å¯ä»¥å°†éå¸¸å¤§çš„æ•´æ•°deltaè½¬æ¢ä¸ºæ›´å°çš„æ•´æ•°deltaï¼Œä»è€Œæ›´å¥½åœ°å‹ç¼©ã€‚</p>
<p>ä½¿ç”¨è¿™äº›è°ƒæ•´åçš„å€¼ï¼Œå¦‚æœæ‰€æœ‰å¢é‡ç›¸åŒï¼Œåˆ™ä½¿ç”¨æ¸¸ç¨‹ç¼–ç å­˜å‚¨æ—¶é—´èŒƒå›´ã€‚å¦‚æœä¸èƒ½è¿›è¡Œæ¸¸ç¨‹ç¼–ç ï¼Œå¹¶ä¸”æ‰€æœ‰å€¼éƒ½å°äº(1Â«60)- 1(åœ¨çº³ç§’åˆ†è¾¨ç‡ä¸‹~36.5å¹´)ï¼Œåˆ™ä½¿ç”¨simple8bç¼–ç å¯¹æ—¶é—´æˆ³è¿›è¡Œç¼–ç ã€‚Simple8bç¼–ç æ˜¯ä¸€ç§64ä½å­—å¯¹é½æ•´æ•°ç¼–ç ï¼Œå®ƒå°†å¤šä¸ªæ•´æ•°æ‰“åŒ…æˆä¸€ä¸ª64ä½å­—ã€‚å¦‚æœä»»ä½•å€¼è¶…è¿‡äº†æœ€å¤§å€¼ï¼Œå¢é‡å°†ä¸å‹ç¼©åœ°å­˜å‚¨ï¼Œæ¯ä¸ªå—ä½¿ç”¨8ä¸ªå­—èŠ‚ã€‚æœªæ¥çš„ç¼–ç å¯èƒ½ä½¿ç”¨è¡¥ä¸æ–¹æ¡ˆï¼Œå¦‚PFORï¼Œä»¥æ›´æœ‰æ•ˆåœ°å¤„ç†å¼‚å¸¸å€¼ã€‚</p>
<h4 id="æµ®ç‚¹æ•°"><a class="header" href="#æµ®ç‚¹æ•°">æµ®ç‚¹æ•°</a></h4>
<p>æµ®ç‚¹æ˜¯ä½¿ç”¨<code>Facebook Gorilla paper</code>çš„å®ç°è¿›è¡Œç¼–ç çš„ã€‚å°†XORSè¿ç»­çš„å€¼ç¼–ç åœ¨ä¸€èµ·ï¼Œå½“è¿™äº›å€¼å¾ˆæ¥è¿‘æ—¶äº§ç”Ÿä¸€ä¸ªå°ç»“æœã€‚ç„¶åä½¿ç”¨æ§åˆ¶ä½å­˜å‚¨å¢é‡ï¼Œä»¥æŒ‡ç¤ºå¼‚æˆ–å€¼ä¸­æœ‰å¤šå°‘å‰å¯¼å’Œå°¾é›¶ã€‚æˆ‘ä»¬çš„å®ç°åˆ é™¤äº†è®ºæ–‡ä¸­æè¿°çš„æ—¶é—´æˆ³ç¼–ç ï¼Œåªå¯¹æµ®ç‚¹å€¼è¿›è¡Œç¼–ç ã€‚</p>
<h4 id="æ•´æ•°"><a class="header" href="#æ•´æ•°">æ•´æ•°</a></h4>
<p>æ•´æ•°ç¼–ç æ ¹æ®æœªå‹ç¼©æ•°æ®ä¸­çš„å€¼èŒƒå›´ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç­–ç•¥ã€‚ç¼–ç åçš„å€¼é¦–å…ˆä½¿ç”¨ZigZagç¼–ç ã€‚å®ƒä½¿æ­£æ•´æ•°å’Œè´Ÿæ•´æ•°åœ¨ä¸€ä¸ªæ­£æ•´æ•°èŒƒå›´å†…äº¤å‰ã€‚</p>
<p>å¦‚æœæ‰€æœ‰ZigZagç¼–ç çš„å€¼éƒ½å°äº(1Â«60)- 1ï¼Œåˆ™ä½¿ç”¨simple8bç¼–ç å¯¹å®ƒä»¬è¿›è¡Œå‹ç¼©ã€‚å¦‚æœä»»ä½•å€¼å¤§äºæœ€å¤§å€¼ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å€¼éƒ½è¢«ä¸å‹ç¼©åœ°å­˜å‚¨åœ¨å—ä¸­ã€‚å¦‚æœæ‰€æœ‰å€¼éƒ½ç›¸åŒï¼Œåˆ™ä½¿ç”¨æ¸¸ç¨‹ç¼–ç ã€‚å¯¹äºç»å¸¸æ˜¯å¸¸é‡çš„å€¼ï¼Œè¿™ç§æ–¹æ³•éå¸¸æœ‰æ•ˆã€‚</p>
<h4 id="å¸ƒå°”å€¼"><a class="header" href="#å¸ƒå°”å€¼">å¸ƒå°”å€¼</a></h4>
<p>å¸ƒå°”å€¼ä½¿ç”¨ç®€å•çš„ä½æ‰“åŒ…ç­–ç•¥è¿›è¡Œç¼–ç ï¼Œæ¯ä¸ªå¸ƒå°”å€¼ä½¿ç”¨1ä½ã€‚ç¼–ç çš„å¸ƒå°”å€¼çš„æ•°é‡ä½¿ç”¨å¯å˜å­—èŠ‚ç¼–ç å­˜å‚¨åœ¨å—çš„å¼€å¤´ã€‚</p>
<h4 id="å­—ç¬¦ä¸²"><a class="header" href="#å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</a></h4>
<p>å­—ç¬¦ä¸²ä½¿ç”¨<code>Snappy</code>å‹ç¼©è¿›è¡Œç¼–ç ã€‚æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯è¿ç»­æ‰“åŒ…çš„ï¼Œå®ƒä»¬è¢«å‹ç¼©ä¸ºä¸€ä¸ªæ›´å¤§çš„å—ã€‚</p>
<h3 id="å†™"><a class="header" href="#å†™">å†™</a></h3>
<p>å†™æ“ä½œè¢«æ·»åŠ åˆ°å½“å‰çš„WALæ®µï¼ŒåŒæ—¶ä¹Ÿè¢«æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚æ¯ä¸ªWALæ®µéƒ½æœ‰ä¸€ä¸ªæœ€å¤§å°ºå¯¸ã€‚å½“å‰æ–‡ä»¶å†™æ»¡æ—¶ï¼Œå†™å…¥æ»šåŠ¨åˆ°æ–°æ–‡ä»¶ã€‚ç¼“å­˜ä¹Ÿæ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼›å½“ç¼“å­˜å¤ªæ»¡æ—¶ï¼Œä¼šè¿›è¡Œsnapshotå’ŒWALå‹ç¼©ã€‚å¦‚æœå†™é€Ÿç‡åœ¨ä¸€æ®µæŒç»­æ—¶é—´å†…è¶…è¿‡WALå‹ç¼©é€Ÿç‡ï¼Œé‚£ä¹ˆç¼“å­˜å¯èƒ½ä¼šå˜å¾—å¤ªæ»¡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–°çš„å†™æ“ä½œå°†ä¼šå¤±è´¥ï¼Œç›´åˆ°snapshotè¿›ç¨‹èµ¶ä¸Šã€‚</p>
<p>å½“WALæ®µè¢«å¡«æ»¡å¹¶å…³é—­æ—¶ï¼ŒCompactorä¼šsnapshotç¼“å­˜å¹¶å°†æ•°æ®å†™å…¥ä¸€ä¸ªæ–°çš„TSMæ–‡ä»¶ã€‚å½“æˆåŠŸå†™å…¥TSMæ–‡ä»¶å¹¶è¿›è¡Œfsyncæ—¶ï¼Œæ–‡ä»¶å­˜å‚¨å°±ä¼šåŠ è½½å¹¶å¼•ç”¨å®ƒã€‚</p>
<h3 id="æ›´æ–°"><a class="header" href="#æ›´æ–°">æ›´æ–°</a></h3>
<p>æ›´æ–°(ä¸ºä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç‚¹å†™ä¸€ä¸ªæ–°çš„å€¼)ä¸æ­£å¸¸å†™æ“ä½œä¸€æ ·å‘ç”Ÿã€‚å› ä¸ºç¼“å­˜çš„å€¼ä¼šè¦†ç›–ç°æœ‰çš„å€¼ï¼Œæ‰€ä»¥æ–°çš„å†™æ“ä½œä¼˜å…ˆã€‚å¦‚æœå†™å…¥å°†è¦†ç›–ä»¥å‰çš„TSMæ–‡ä»¶ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆè¿™äº›ç‚¹å°†åœ¨æŸ¥è¯¢è¿è¡Œæ—¶åˆå¹¶ï¼Œæ–°çš„å†™å…¥ä¼˜å…ˆã€‚</p>
<h3 id="åˆ é™¤"><a class="header" href="#åˆ é™¤">åˆ é™¤</a></h3>
<p>åˆ é™¤æ˜¯é€šè¿‡å‘WALå†™å…¥ä¸€ä¸ªåˆ é™¤æ¡ç›®æ¥è¿›è¡Œçš„ï¼Œè¯¥æ¡ç›®ç”¨äºæµ‹é‡æˆ–åºåˆ—ï¼Œç„¶åæ›´æ–°Cacheå’ŒFileStoreã€‚Cacheå°†æ”¶å›æ‰€æœ‰ç›¸å…³æ¡ç›®ã€‚FileStoreä¸ºæ¯ä¸ªåŒ…å«ç›¸å…³æ•°æ®çš„TSMæ–‡ä»¶å†™ä¸€ä¸ªtombstoneæ–‡ä»¶ã€‚è¿™äº›tombstoneæ–‡ä»¶åœ¨å¯åŠ¨æ—¶ç”¨äºå¿½ç•¥å—ä»¥åŠåœ¨å‹ç¼©æœŸé—´ç”¨äºåˆ é™¤å·²åˆ é™¤çš„æ¡ç›®ã€‚</p>
<p>å¯¹éƒ¨åˆ†åˆ é™¤çš„ç³»åˆ—çš„æŸ¥è¯¢åœ¨æŸ¥è¯¢æ—¶è¿›è¡Œå¤„ç†ï¼Œç›´åˆ°å‹ç¼©ä»TSMæ–‡ä»¶ä¸­å®Œå…¨åˆ é™¤æ•°æ®ã€‚</p>
<h3 id="æŸ¥è¯¢"><a class="header" href="#æŸ¥è¯¢">æŸ¥è¯¢</a></h3>
<p>å½“å­˜å‚¨å¼•æ“æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å¯¹ä¸ç‰¹å®šseries keyå’Œfieldç›¸å…³çš„ç»™å®šæ—¶é—´çš„æœç´¢ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹æ•°æ®æ–‡ä»¶è¿›è¡Œæœç´¢ï¼Œä»¥æ‰¾åˆ°åŒ…å«ä¸æŸ¥è¯¢åŒ¹é…çš„æ—¶é—´èŒƒå›´ä»¥åŠåŒ…å«åŒ¹é…åºåˆ—çš„æ–‡ä»¶ã€‚</p>
<p>é€‰ä¸­æ•°æ®æ–‡ä»¶åï¼Œæ¥ä¸‹æ¥éœ€è¦æ‰¾åˆ°series keyç´¢å¼•æ¡ç›®åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚æˆ‘ä»¬å¯¹æ¯ä¸ªTSMç´¢å¼•æ‰§è¡ŒäºŒè¿›åˆ¶æœç´¢ï¼Œä»¥æ‰¾åˆ°å…¶ç´¢å¼•å—çš„ä½ç½®ã€‚</p>
<p>åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤šä¸ªTSMæ–‡ä»¶ä¹‹é—´çš„å—ä¸ä¼šé‡å ï¼Œæˆ‘ä»¬å¯ä»¥çº¿æ€§æœç´¢ç´¢å¼•æ¡ç›®ï¼Œä»¥æ‰¾åˆ°è¦è¯»å–çš„èµ·å§‹å—ã€‚å¦‚æœæœ‰é‡å çš„æ—¶é—´å—ï¼Œåˆ™å¯¹ç´¢å¼•é¡¹è¿›è¡Œæ’åºï¼Œä»¥ç¡®ä¿è¾ƒæ–°çš„å†™æ“ä½œä¼˜å…ˆï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢æ‰§è¡ŒæœŸé—´å¯ä»¥æŒ‰é¡ºåºå¤„ç†è¿™äº›å—ã€‚</p>
<p>å½“éå†ç´¢å¼•é¡¹æ—¶ï¼Œå—é¡ºåºåœ°ä»å—éƒ¨åˆ†è¯»å–ã€‚å—è¢«è§£å‹ç¼©ï¼Œæˆ‘ä»¬å¯»æ‰¾ç‰¹å®šçš„ç‚¹ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tsiçš„è®¾è®¡"><a class="header" href="#tsiçš„è®¾è®¡">TSIçš„è®¾è®¡</a></h1>
<h2 id="æ–‡ä»¶ç»“æ„"><a class="header" href="#æ–‡ä»¶ç»“æ„">æ–‡ä»¶ç»“æ„</a></h2>
<p>TSI ç”±å¦‚ä¸‹å‡ éƒ¨åˆ†æ„æˆ
- ç´¢å¼•:åŒ…å«å•ä¸ªåˆ†ç‰‡çš„æ•´ä¸ªç´¢å¼•æ•°æ®é›†ã€‚
- åˆ†åŒº:åŒ…å«ç”¨äºåˆ†ç‰‡çš„æ•°æ®çš„åˆ†ç‰‡åˆ†åŒºã€‚
- æ—¥å¿—æ–‡ä»¶:ä»¥å†…å­˜ç´¢å¼•çš„å½¢å¼åŒ…å«æ–°å†™å…¥çš„seriesï¼Œå¹¶æŒä¹…åŒ–ä¸ºWALã€‚
- ç´¢å¼•æ–‡ä»¶:åŒ…å«ä¸€ä¸ªä¸å¯å˜çš„ã€å†…å­˜æ˜ å°„çš„ç´¢å¼•ï¼Œç”±ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶æ„å»ºæˆ–ç”±ä¸¤ä¸ªè¿ç»­çš„ç´¢å¼•æ–‡ä»¶åˆå¹¶è€Œæˆã€‚
- åºåˆ—æ–‡ä»¶ï¼šå®ƒåŒ…å«æ•´ä¸ªæ•°æ®åº“ä¸­æ‰€æœ‰series keysçš„é›†åˆã€‚æ•°æ®åº“ä¸­çš„æ¯ä¸ªåˆ†ç‰‡å…±äº«ç›¸åŒçš„åºåˆ—æ–‡ä»¶ã€‚</p>
<h2 id="å†™å…¥"><a class="header" href="#å†™å…¥">å†™å…¥</a></h2>
<p>å½“å†™å…¥æ“ä½œç³»ç»Ÿæ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µã€‚</p>
<ol>
<li>Seriesè¢«æ·»åŠ åˆ°Seriesæ–‡ä»¶ä¸­ï¼Œå¦‚æœSeriesæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™æŸ¥æ‰¾å®ƒã€‚è¿™å°†è¿”å›ä¸€ä¸ªè‡ªåŠ¨é€’å¢çš„åºåˆ—IDã€‚</li>
<li>seriesè¢«å‘é€åˆ°ç´¢å¼•ã€‚ç´¢å¼•ç»´æŠ¤ç°æœ‰ç³»åˆ—idçš„å’†å“®ä½å›¾ï¼Œå¹¶å¿½ç•¥å·²ç»åˆ›å»ºçš„seriesã€‚</li>
<li>è¯¥seriesè¢«hashå¹¶å‘é€åˆ°é€‚å½“çš„åˆ†åŒºã€‚</li>
<li>åˆ†åŒºå°†seriesä½œä¸ºä¸€ä¸ªæ¡ç›®å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚</li>
<li>æ—¥å¿—æ–‡ä»¶å°†è¯¥serieså†™å…¥ç£ç›˜ä¸Šçš„é¢„å†™æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å°†è¯¥seriesæ·»åŠ åˆ°ä¸€ç»„å†…å­˜ç´¢å¼•ä¸­ã€‚</li>
</ol>
<h2 id="å‹ç¼©-1"><a class="header" href="#å‹ç¼©-1">å‹ç¼©</a></h2>
<p>ä¸€æ—¦æ—¥å¿—æ–‡ä»¶å¤§å°è¶…è¿‡é˜ˆå€¼(5MB)ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ´»è·ƒæ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å°†å‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å‹ç¼©åˆ°ä¸€ä¸ªç´¢å¼•æ–‡ä»¶ä¸­ã€‚ç¬¬ä¸€ä¸ªç´¢å¼•æ–‡ä»¶çš„çº§åˆ«ä¸ºL1ã€‚æ—¥å¿—æ–‡ä»¶è¢«è®¤ä¸ºæ˜¯çº§åˆ«L0ã€‚</p>
<p>ç´¢å¼•æ–‡ä»¶ä¹Ÿå¯ä»¥é€šè¿‡åˆå¹¶ä¸¤ä¸ªè¾ƒå°çš„ç´¢å¼•æ–‡ä»¶æ¥åˆ›å»ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªç›¸é‚»çš„L1ç´¢å¼•æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™å¯ä»¥å°†å®ƒä»¬åˆå¹¶åˆ°L2ç´¢å¼•æ–‡ä»¶ä¸­ã€‚</p>
<h2 id="è¯»å–"><a class="header" href="#è¯»å–">è¯»å–</a></h2>
<p>ç´¢å¼•æä¾›äº†å‡ ä¸ªAPIè°ƒç”¨æ¥æ£€ç´¢æ•°æ®é›†ï¼Œä¾‹å¦‚:</p>
<p><code>MeasurementIterator ()</code>: è¿”å›å·²æ’åºçš„<code>measurement</code>åç§°åˆ—è¡¨ã€‚</p>
<p><code>TagKeyIterator() </code>: è¿”å›<code>measurements</code>ä¸­å·²æ’åºçš„<code>tag keys</code>åˆ—è¡¨ã€‚</p>
<p><code>TagValueIterator()</code>: è¿”å›<code>tag keys</code>çš„<code>tag values</code>çš„æ’åºåˆ—è¡¨ã€‚</p>
<p><code>MeasurementSeriesIDIterator()</code>: è¿”å›measurementsçš„æ‰€æœ‰series idçš„æ’åºåˆ—è¡¨ã€‚</p>
<p><code>TagKeySeriesIDIterator()</code>: è¿”å›<code>tag keys</code>çš„æ‰€æœ‰<code>series id</code>çš„æ’åºåˆ—è¡¨ã€‚</p>
<p><code>TagValueSeriesIDIterator() </code>: è¿”å›ä¸€ä¸ª<code>tag values</code>çš„æ‰€æœ‰<code>series id</code>çš„æ’åºåˆ—è¡¨ã€‚</p>
<h2 id="æ—¥å¿—æ–‡ä»¶ç»“æ„"><a class="header" href="#æ—¥å¿—æ–‡ä»¶ç»“æ„">æ—¥å¿—æ–‡ä»¶ç»“æ„</a></h2>
<p>æ—¥å¿—æ–‡ä»¶çš„ç»“æ„å¾ˆç®€å•ï¼Œå®ƒæ˜¯æŒ‰é¡ºåºå†™å…¥ç£ç›˜çš„LogEntryå¯¹è±¡åˆ—è¡¨ã€‚æ—¥å¿—æ–‡ä»¶ä¸€ç›´å†™åˆ°5MBï¼Œç„¶åå‹ç¼©æˆç´¢å¼•æ–‡ä»¶ã€‚æ—¥å¿—ä¸­çš„æ¡ç›®å¯¹è±¡å¯ä»¥æ˜¯ä»¥ä¸‹ä»»ä½•ä¸€ç§ç±»å‹:</p>
<ul>
<li>AddSeries</li>
<li>DeleteSeries</li>
<li>DeleteMeasurement</li>
<li>DeleteTagKey</li>
<li>DeleteTagValue</li>
</ul>
<p>æ—¥å¿—æ–‡ä»¶çš„å†…å­˜ç´¢å¼•è·Ÿè¸ªä»¥ä¸‹å†…å®¹:</p>
<ul>
<li><code>measurements</code>çš„åå­—</li>
<li><code>measurements</code>çš„<code>tag keys</code></li>
<li><code>tag keys</code>çš„<code>tag values</code></li>
<li><code>series</code>çš„<code>measurements</code></li>
<li><code>series</code>çš„<code>tag values</code></li>
<li><code>series</code>, <code>measurements</code>, <code>tag keys</code>å’Œ<code>tag values</code>çš„<code>tombstones</code>æ–‡ä»¶</li>
</ul>
<h2 id="ç´¢å¼•æ–‡ä»¶ç»“æ„"><a class="header" href="#ç´¢å¼•æ–‡ä»¶ç»“æ„">ç´¢å¼•æ–‡ä»¶ç»“æ„</a></h2>
<p>ç´¢å¼•æ–‡ä»¶æ˜¯ä¸€ä¸ªä¸å¯å˜çš„æ–‡ä»¶ï¼Œå®ƒè·Ÿè¸ªä¸æ—¥å¿—æ–‡ä»¶ç±»ä¼¼çš„ä¿¡æ¯ï¼Œä½†æ‰€æœ‰æ•°æ®éƒ½è¢«ç´¢å¼•å¹¶å†™å…¥ç£ç›˜ï¼Œä»¥ä¾¿å¯ä»¥ç›´æ¥ä»å†…å­˜æ˜ å°„ä¸­è®¿é—®å®ƒã€‚</p>
<p>ç´¢å¼•æ–‡ä»¶åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š</p>
<ul>
<li><code>TagBlocks</code>: ä¸ºå•ä¸ª<code>tag key</code>ç»´æŠ¤<code>tag value</code>çš„ç´¢å¼•ã€‚</li>
<li><code>MeasurementBlock</code>: ç»´æŠ¤<code>measurements</code>å€¼åŠå…¶<code>tag keys</code>çš„ç´¢å¼•ã€‚</li>
<li><code>Trailer</code>: å­˜å‚¨æ–‡ä»¶çš„åç§»é‡ä¿¡æ¯ï¼Œä»¥åŠç”¨äºåŸºæ•°ä¼°è®¡çš„<code>HyperLogLog</code>è‰å›¾ã€‚</li>
</ul>
<h2 id="manifestæ–‡ä»¶"><a class="header" href="#manifestæ–‡ä»¶">MANIFESTæ–‡ä»¶</a></h2>
<p>MANIFESTæ–‡ä»¶å­˜å‚¨åœ¨ç´¢å¼•ç›®å½•ä¸­ï¼Œå¹¶åˆ—å‡ºå±äºè¯¥ç´¢å¼•çš„æ‰€æœ‰æ–‡ä»¶ä»¥åŠè®¿é—®å®ƒä»¬çš„é¡ºåºã€‚æ¯æ¬¡å‘ç”Ÿå‹ç¼©æ—¶ï¼Œéƒ½ä¼šæ›´æ–°æ­¤æ–‡ä»¶ã€‚ç›®å½•ä¸­ä»»ä½•ä¸åœ¨ç´¢å¼•æ–‡ä»¶ä¸­çš„æ–‡ä»¶éƒ½æ˜¯æ­£åœ¨å‹ç¼©è¿‡ç¨‹ä¸­çš„ç´¢å¼•æ–‡ä»¶ã€‚</p>
<h2 id="æ–‡ä»¶é›†"><a class="header" href="#æ–‡ä»¶é›†">æ–‡ä»¶é›†</a></h2>
<p>æ–‡ä»¶é›†æ˜¯åœ¨CnosDBè¿›ç¨‹è¿è¡Œæ—¶è·å¾—çš„æ¸…å•çš„å†…å­˜å¿«ç…§ã€‚è¿™éœ€è¦æä¾›ç´¢å¼•åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„ä¸€è‡´è§†å›¾ã€‚è¯¥æ–‡ä»¶é›†è¿˜ä¿ƒè¿›äº†å¯¹å…¶æ‰€æœ‰æ–‡ä»¶çš„å¼•ç”¨è®¡æ•°ï¼Œä»¥ä¾¿åœ¨æ–‡ä»¶çš„æ‰€æœ‰è¯»å–å™¨å®Œæˆå¯¹æ–‡ä»¶çš„æ“ä½œä¹‹å‰ï¼Œä¸ä¼šé€šè¿‡å‹ç¼©åˆ é™¤ä»»ä½•æ–‡ä»¶ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€"><a class="header" href="#æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€">æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€</a></h2>
<ul>
<li>
<h3 id="cnosdb-æ–‡ä»¶ç»“æ„"><a class="header" href="#cnosdb-æ–‡ä»¶ç»“æ„">CnosDB æ–‡ä»¶ç»“æ„</a></h3>
<h4 id="data-ç›®å½•"><a class="header" href="#data-ç›®å½•">Data ç›®å½•</a></h4>
<p>CnosDBå­˜å‚¨æ—¶é—´åºåˆ—æ•°æ®(TSMæ–‡ä»¶)çš„ç›®å½•è·¯å¾„ã€‚è¦å®šåˆ¶æ­¤è·¯å¾„ï¼Œè¯·ä½¿ç”¨<code>[data].dir</code>é…ç½®é€‰é¡¹ã€‚</p>
<h4 id="wal-ç›®å½•"><a class="header" href="#wal-ç›®å½•">WAL ç›®å½•</a></h4>
<p>CnosDBå­˜æ”¾WAL(Write Ahead Log é¢„å†™æ—¥å¿—)æ–‡ä»¶çš„ç›®å½•è·¯å¾„ã€‚è¦å®šåˆ¶æ­¤è·¯å¾„ï¼Œè¯·ä½¿ç”¨<code>[data].wal-dir</code>é…ç½®é€‰é¡¹ã€‚</p>
<h4 id="meta-ç›®å½•"><a class="header" href="#meta-ç›®å½•">Meta ç›®å½•</a></h4>
<p>CnosDBå­˜æ”¾metaæ–‡ä»¶çš„ç›®å½•è·¯å¾„ï¼Œå­˜å‚¨æœ‰å…³ç”¨æˆ·ã€æ•°æ®åº“ã€ä¿ç•™ç­–ç•¥ã€åˆ†ç‰‡å’Œè¿ç»­æŸ¥è¯¢çš„ä¿¡æ¯ã€‚è¦å®šåˆ¶æ­¤è·¯å¾„ï¼Œè¯·ä½¿ç”¨<code>[meta].dir</code>é…ç½®é€‰é¡¹ã€‚</p>
</li>
<li>
<h3 id="æ–‡ä»¶å¸ƒå±€"><a class="header" href="#æ–‡ä»¶å¸ƒå±€">æ–‡ä»¶å¸ƒå±€</a></h3>
<ul>
<li><a href="content/cnosdb/latest/concept/file_system_layout.html#macos">macOS</a></li>
<li><a href="content/cnosdb/latest/concept/file_system_layout.html#linux">Linux</a></li>
<li><a href="content/cnosdb/latest/concept/file_system_layout.html#windows">Windows</a></li>
<li><a href="content/cnosdb/latest/concept/file_system_layout.html#docker">Docker</a></li>
<li><a href="content/cnosdb/latest/concept/file_system_layout.html#kubernetes">Kubernetes</a></li>
</ul>
</li>
</ul>
<h4 id="macos-1"><a class="header" href="#macos-1">macOS</a></h4>
<p>macOsé»˜è®¤ç›®å½•</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">~/.cnosdb/data/</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">~/.cnosdb/mata/</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">~/.cnosdb/wal/</td></tr>
</tbody></table>
<p>macOS æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°</p>
<pre><code>          ~/.cnosdb/
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db
</code></pre>
<h4 id="linux"><a class="header" href="#linux">Linux</a></h4>
<p>åœ¨Linuxä¸Šå®‰è£…CnosDBæ—¶ï¼Œæ‚¨å¯ä»¥ä¸‹è½½å¹¶å®‰è£…cnosdbäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä»¥åŒ…çš„å½¢å¼å®‰è£…ã€‚ä½¿ç”¨çš„å®‰è£…æ–¹æ³•å†³å®šäº†æ–‡ä»¶ç³»ç»Ÿçš„å¸ƒå±€ã€‚</p>
<p>Linux é»˜è®¤ç›®å½• (ä»¥ç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶å½¢å¼å®‰è£…)</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">~/.cnosdb/data/</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">~/.cnosdb/mata/</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">~/.cnosdb/wal/</td></tr>
</tbody></table>
<p>Linux æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿° (ä»¥ç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶å½¢å¼å®‰è£…)</p>
<pre><code>          ~/.cnosdb/
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db
</code></pre>
<p>Linux é»˜è®¤ç›®å½• (ä»¥åŒ…çš„å½¢å¼å®‰è£…)</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">/var/lib/cnosdb/data/</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">/var/lib/cnosdb/meta/</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">/var/lib/cnosdb/wal/</td></tr>
<tr><td style="text-align: center">é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„</td><td style="text-align: center">/etc/cnosdb/cnosdb.conf</td></tr>
</tbody></table>
<p>Linux æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿° (ä»¥åŒ…çš„å½¢å¼å®‰è£…)</p>
<pre><code>          /var/lib/cnosdb/
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db

          /etc/cnosdb/
            â””â”€â”€cnosdb.conf
</code></pre>
<h4 id="windows"><a class="header" href="#windows">Windows</a></h4>
<p>Windows é»˜è®¤ç›®å½•</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">%USERPROFILE% \ .cnosdb\data\</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">%USERPROFILE% \ .cnosdb\meta\</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">%USERPROFILE% \ .cnosdb\meta\</td></tr>
</tbody></table>
<p>Windows æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°</p>
<pre><code>          %USERPROFILE% \ .cnosdb\
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db
</code></pre>
<h4 id="docker-1"><a class="header" href="#docker-1">Docker</a></h4>
<p>Docker é»˜è®¤ç›®å½•</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">/var/lib/cnosdb/data/</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">/var/lib/cnosdb/meta/</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">/var/lib/cnosdb/wal/</td></tr>
</tbody></table>
<p>Docker æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°</p>
<pre><code>          /var/lib/cnosdb/
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db
</code></pre>
<h4 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h4>
<p>Kubernetes é»˜è®¤ç›®å½•</p>
<table><thead><tr><th style="text-align: center">è·¯å¾„</th><th style="text-align: center">é»˜è®¤è·¯å¾„</th></tr></thead><tbody>
<tr><td style="text-align: center">Data directory</td><td style="text-align: center">/var/lib/cnosdb/data/</td></tr>
<tr><td style="text-align: center">Meta directory</td><td style="text-align: center">/var/lib/cnosdb/meta/</td></tr>
<tr><td style="text-align: center">WAL directory</td><td style="text-align: center">/var/lib/cnosdb/wal/</td></tr>
</tbody></table>
<p>Kubernetes æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°</p>
<pre><code>          /var/lib/cnosdb/
            â”œâ”€â”€data
            â”‚  â””â”€â”€TSMç›®å½•å’Œæ–‡ä»¶
            â”œâ”€â”€wal
            â”‚  â””â”€â”€WALç›®å½•å’Œæ–‡ä»¶
            â””â”€â”€meta
               â””â”€â”€meta.db
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>
<h3 id="æŸ¥è¯¢å…¥é—¨"><a class="header" href="#æŸ¥è¯¢å…¥é—¨">æŸ¥è¯¢å…¥é—¨</a></h3>
<h4 id="æŸ¥çœ‹æ‰€æœ‰-measurements"><a class="header" href="#æŸ¥çœ‹æ‰€æœ‰-measurements">æŸ¥çœ‹æ‰€æœ‰ <code>measurements</code></a></h4>
<pre><code>SHOW MEASUREMENTS
</code></pre>
<h4 id="è®¡ç®—airä¸­temperatureçš„æ•°é‡"><a class="header" href="#è®¡ç®—airä¸­temperatureçš„æ•°é‡">è®¡ç®—<code>air</code>ä¸­<code>temperature</code>çš„æ•°é‡</a></h4>
<p><code>  SELECT COUNT(&quot;temperature&quot;) FROM air</code></p>
<h4 id="æŸ¥çœ‹airä¸­çš„å‰äº”ä¸ªå€¼"><a class="header" href="#æŸ¥çœ‹airä¸­çš„å‰äº”ä¸ªå€¼">æŸ¥çœ‹<code>air</code>ä¸­çš„å‰äº”ä¸ªå€¼</a></h4>
<p><code>SELECT * FROM air LIMIT 5</code></p>
<h4 id="æŒ‡å®šå­—æ®µçš„æ ‡è¯†ç¬¦å·"><a class="header" href="#æŒ‡å®šå­—æ®µçš„æ ‡è¯†ç¬¦å·">æŒ‡å®šå­—æ®µçš„æ ‡è¯†ç¬¦å·</a></h4>
<pre><code> SELECT &quot;temperature&quot;::field,&quot;station&quot;::tag,&quot;visibility&quot;::field FROM &quot;air&quot; limit 10
</code></pre>
<h4 id="æŸ¥çœ‹measurementçš„tag-key"><a class="header" href="#æŸ¥çœ‹measurementçš„tag-key">æŸ¥çœ‹<code>measurement</code>çš„tag key</a></h4>
<p><code> SHOW TAG KEYS FROM air</code></p>
<h4 id="æŸ¥çœ‹tag-value"><a class="header" href="#æŸ¥çœ‹tag-value">æŸ¥çœ‹tag value</a></h4>
<p><code> SHOW TAG VALUES FROM air WITH KEY = &quot;station&quot;</code></p>
<h4 id="æŸ¥çœ‹field-key"><a class="header" href="#æŸ¥çœ‹field-key">æŸ¥çœ‹field key</a></h4>
<p><code> SHOW FIELD KEYS FROM air</code></p>
<h4 id="æŸ¥çœ‹series"><a class="header" href="#æŸ¥çœ‹series">æŸ¥çœ‹series</a></h4>
<p><code>SHOW SERIES</code></p>
<h4 id="å‡½æ•°ä½¿ç”¨"><a class="header" href="#å‡½æ•°ä½¿ç”¨">å‡½æ•°ä½¿ç”¨</a></h4>
<blockquote>
<p><a href="https://www.cnosdb.com/content/cnosdb/0.10/cnosql/function.html">æ›´å¤š</a></p>
</blockquote>
<p><code> SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot;</code></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h3 id="æ•°æ®åº“ç®¡ç†"><a class="header" href="#æ•°æ®åº“ç®¡ç†">æ•°æ®åº“ç®¡ç†</a></h3>
<h4 id="åˆ›å»ºæ•°æ®åº“"><a class="header" href="#åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">CREATE DATABASE &lt;database_name&gt; [WITH [DURATION &lt;duration&gt;] [REPLICATION &lt;n&gt;] [SHARD DURATION &lt;duration&gt;] [NAME &lt;rp-name&gt;]]
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>CREATE DATABASE</code>éœ€è¦ä¸€ä¸ªæ•°æ®åº“åç§°ï¼Œå…¶ä»–éƒ½ä¸ºå¯é€‰é¡¹ã€‚å¦‚æœæœªåœ¨<code>WITH</code>åé¢æŒ‡å®šä¿ç•™ç­–ç•¥ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ä¿ç•™ç­–ç•¥ï¼Œåç§°ä¸º<code>autogen</code>ã€‚</p>
<p><code>DURATION</code>ä¿ç•™ç­–ç•¥çš„æ€»çª—å£æ—¶é•¿ã€‚</p>
<p><code>REPLICATION</code>å‰¯æœ¬æ•°é‡ï¼Œé»˜è®¤ä¸º<code>1</code>å¹¶ä¸”åªèƒ½ä¸º<code>1</code>ã€‚</p>
<p><code>SHARD DURATION</code>åˆ†ç‰‡çš„çª—å£æ—¶é•¿ã€‚</p>
<p><code>NAME</code>æŒ‡å®šä¿ç•™ç­–ç•¥åç§°ã€‚</p>
<p><code>CREATE DATABASE</code>æˆåŠŸæ‰§è¡Œåä¸ä¼šè¿”å›ä»»ä½•ç»“æœã€‚</p>
<p><strong>ç¤ºä¾‹</strong></p>
<p>åˆ›å»ºæ•°æ®åº“</p>
<blockquote>
<p>åˆ›å»ºä¸€ä¸ªåä¸º<code>cnos</code>çš„æ•°æ®åº“ï¼ŒCnosDBè¿˜ä¼šåœ¨å…¶ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code>autogen</code>çš„ä¿ç•™ç­–ç•¥ã€‚</p>
</blockquote>
<pre><code class="language-sql"> CREATE DATABASE &quot;cnos&quot;
</code></pre>
<p>åˆ›å»ºæ•°æ®åº“å¹¶æŒ‡å®šä¿ç•™ç­–ç•¥</p>
<blockquote>
<p>åˆ›å»ºä¸€ä¸ªåä¸º<code>cnos</code>çš„æ•°æ®åº“ï¼Œå¹¶æŒ‡å®šä¿ç•™ç­–ç•¥ä¸º<code>1d_events</code>ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸ºæ€»ä¿ç•™æ—¶é•¿ä¸ºä¸€å¤©ï¼Œå‰¯æœ¬æ•°ä¸º1ï¼Œæ¯ä¸ªåˆ†ç‰‡çš„çš„çª—å£é•¿åº¦ä¸ºä¸€å°æ—¶ã€‚</p>
</blockquote>
<pre><code class="language-sql">&gt; CREATE DATABASE &quot;cnos&quot; WITH DURATION 1d REPLICATION 1 SHARD DURATION 1h NAME &quot;1d_events&quot;
</code></pre>
<h4 id="æ˜¾ç¤ºæ•°æ®åº“"><a class="header" href="#æ˜¾ç¤ºæ•°æ®åº“">æ˜¾ç¤ºæ•°æ®åº“</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code>SHOW DATABASES
</code></pre>
<h4 id="åˆ é™¤æ•°æ®åº“"><a class="header" href="#åˆ é™¤æ•°æ®åº“">åˆ é™¤æ•°æ®åº“</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DROP DATABASE &lt;database_name&gt;
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>DROP DATABASE</code>ä¼šåˆ é™¤æ•°æ®åº“ä¸‹æ‰€æœ‰æ•°æ®ã€‚</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">DROP DATABASE &quot;cnos&quot;
</code></pre>
<h3 id="ä¿ç•™ç­–ç•¥ç®¡ç†"><a class="header" href="#ä¿ç•™ç­–ç•¥ç®¡ç†">ä¿ç•™ç­–ç•¥ç®¡ç†</a></h3>
<h4 id="åˆ›å»ºä¿ç•™ç­–ç•¥"><a class="header" href="#åˆ›å»ºä¿ç•™ç­–ç•¥">åˆ›å»ºä¿ç•™ç­–ç•¥</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">CREATE RETENTION POLICY &lt;rp_name&gt; ON &lt;database_name&gt; DURATION &lt;duration&gt; REPLICATION &lt;n&gt; [SHARD DURATION &lt;duration&gt;] [DEFAULT]
</code></pre>
<p><strong>æè¿°</strong></p>
<p><code>DURATION</code>ä¿ç•™ç­–ç•¥çš„æ€»çª—å£æ—¶é•¿ã€‚</p>
<p><code>REPLICATION</code>å‰¯æœ¬æ•°é‡ï¼Œé»˜è®¤ä¸º<code>1</code>å¹¶ä¸”åªèƒ½ä¸º<code>1</code>ã€‚</p>
<p><code>SHARD DURATION</code>åˆ†ç‰‡çš„çª—å£æ—¶é•¿ã€‚</p>
<p><code>DEFAULT</code>å¯é€‰é¡¹ï¼ŒæŒ‡å®šå…¶æ˜¯å¦ä¸ºé»˜è®¤ä¿ç•™ç­–ç•¥</p>
<p><strong>ç¤ºä¾‹</strong></p>
<p>åˆ›å»ºä¿ç•™ç­–ç•¥</p>
<blockquote>
<p>è¯¥è¯­å¥åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>1d_events</code>çš„ä¿ç•™ç­–ç•¥ï¼Œå¹¶ä¸”å‰¯æœ¬æ•°ä¸º1</p>
</blockquote>
<pre><code class="language-sql">&gt; CREATE RETENTION POLICY &quot;1d_events&quot; ON &quot;cnos&quot; DURATION 1d REPLICATION 1
&gt;
</code></pre>
<p>åˆ›å»ºé»˜è®¤ä¿ç•™ç­–ç•¥</p>
<pre><code class="language-sql">&gt; CREATE RETENTION POLICY &quot;1d_events&quot; ON &quot;cnos&quot; DURATION 23h60m REPLICATION 1 DEFAULT
&gt;
</code></pre>
<h4 id="æ˜¾ç¤ºä¿ç•™ç­–ç•¥"><a class="header" href="#æ˜¾ç¤ºä¿ç•™ç­–ç•¥">æ˜¾ç¤ºä¿ç•™ç­–ç•¥</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code>```sql
SHOW RETENTION POLICIES [ON &lt;database_name&gt;]
```
</code></pre>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code>```sql
&gt; SHOW RETENTION POLICIES ON &quot;cnos&quot;

name      duration   shardGroupDuration   replicaN   default
----      --------   ------------------   --------   -------
autogen   0s         168h0m0s             1          true
```
</code></pre>
<h4 id="ä¿®æ”¹ä¿ç•™ç­–ç•¥"><a class="header" href="#ä¿®æ”¹ä¿ç•™ç­–ç•¥">ä¿®æ”¹ä¿ç•™ç­–ç•¥</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">ALTER RETENTION POLICY &lt;rp_name&gt; ON &lt;database_name&gt; DURATION &lt;duration&gt; REPLICATION &lt;n&gt; SHARD DURATION &lt;duration&gt; DEFAULT
</code></pre>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">ALTER RETENTION POLICY &quot;1d_events&quot; ON &quot;cnos&quot; DURATION 7 SHARD DURATION 1d DEFAULT
</code></pre>
<h4 id="åˆ é™¤ä¿ç•™ç­–ç•¥"><a class="header" href="#åˆ é™¤ä¿ç•™ç­–ç•¥">åˆ é™¤ä¿ç•™ç­–ç•¥</a></h4>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DROP RETENTION POLICY &lt;rp_name&gt; ON &lt;database_name&gt;
</code></pre>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">&gt; DROP RETENTION POLICY &quot;1d_events&quot; ON &quot;cnos&quot;
&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="schemaæŸ¥è¯¢"><a class="header" href="#schemaæŸ¥è¯¢">schemaæŸ¥è¯¢</a></h2>
<h3 id="æ˜¾ç¤ºseries"><a class="header" href="#æ˜¾ç¤ºseries">æ˜¾ç¤º<code>SERIES</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">SHOW SERIES [ON &lt;database_name&gt;] [FROM_clause] [WHERE &lt;tag_key&gt; &lt;operator&gt; [ '&lt;tag_value&gt;' | &lt;regular_expression&gt;]] [LIMIT_clause] [OFFSET_clause]
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>SHOW SERIES</code>åé¢éƒ½æ˜¯å¯é€‰é¡¹</p>
<p><code>[ON &lt;database_name&gt;]</code>æŒ‡å®šæ•°æ®åº“åç§°</p>
<p><code>FROM</code>å­å¥æŒ‡å®š<code>measurement</code></p>
<p><code>WHERE</code>å­å¥æ”¯æŒæ¯”è¾ƒ<code>tag</code>ï¼Œ<code>field</code>æ¯”è¾ƒæ˜¯æ— æ•ˆçš„</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">SHOW SERIES ON &quot;oceanic_station&quot; WHERE time &gt; now() - 1m LIMIT 10
</code></pre>
<h3 id="ä½¿ç”¨dropåˆ é™¤series"><a class="header" href="#ä½¿ç”¨dropåˆ é™¤series">ä½¿ç”¨<code>DROP</code>åˆ é™¤<code>series</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DROP SERIES FROM &lt;measurement_name[,measurement_name]&gt; WHERE &lt;tag_key&gt;='&lt;tag_value&gt;'
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>DROP SERIES</code>ä¼šåˆ é™¤æ•°æ®åº“ä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ä»¥åŠæ•°æ®æ‰€å¯¹åº”çš„ç´¢å¼•</p>
<p><strong>ç¤ºä¾‹</strong></p>
<p>ä»ä¸€ä¸ª<code>measurement</code>ä¸­åˆ é™¤æ‰€æœ‰<code>series</code></p>
<pre><code class="language-sql">&gt; DROP SERIES FROM &quot;oceanic_station&quot;
</code></pre>
<p>ä»ä¸€ä¸ª<code>measurement</code>ä¸­åˆ é™¤å…·æœ‰ç‰¹å®šæ¡ä»¶çš„<code>series</code></p>
<pre><code class="language-sql">DROP SERIES FROM &quot;oceanic_station&quot; WHERE &quot;station&quot; = 'XiaoMaiDao'
</code></pre>
<h3 id="ä½¿ç”¨deleteåˆ é™¤series"><a class="header" href="#ä½¿ç”¨deleteåˆ é™¤series">ä½¿ç”¨<code>DELETE</code>åˆ é™¤<code>series</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DELETE FROM &lt;measurement_name&gt; WHERE [&lt;tag_key&gt;='&lt;tag_value&gt;'] | [&lt;time interval&gt;]
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>DROP SERIES</code>ä¼šåˆ é™¤æ•°æ®åº“ä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œä½†æ˜¯ä¸ä¼šåˆ é™¤ç´¢å¼•ï¼Œå¹¶ä¸”æ”¯æŒæ—¶é—´è¿‡æ»¤</p>
<p><strong>ç¤ºä¾‹</strong></p>
<blockquote>
<p>åˆ é™¤2020-01-01ä¹‹å‰äº§ç”Ÿçš„çš„æ‰€æœ‰æ•°æ®</p>
</blockquote>
<pre><code class="language-sql">&gt; DELETE WHERE time &lt; '2021-01-01'
</code></pre>
<h3 id="æ˜¾ç¤ºmeasurement"><a class="header" href="#æ˜¾ç¤ºmeasurement">æ˜¾ç¤º<code>measurement</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">SHOW MEASUREMENTS [ON &lt;database_name&gt;] [WITH MEASUREMENT &lt;operator&gt; ['&lt;measurement_name&gt;' | &lt;regular_expression&gt;]] [WHERE &lt;tag_key&gt; &lt;operator&gt; ['&lt;tag_value&gt;' | &lt;regular_expression&gt;]] [LIMIT_clause] [OFFSET_clause]
</code></pre>
<p><code>SHOW MEASUREMENTS</code>åé¢éƒ½æ˜¯å¯é€‰é¡¹</p>
<p><code>[ON &lt;database_name&gt;]</code>æŒ‡å®šæ•°æ®åº“åç§°</p>
<p><code>FROM</code>å­å¥æŒ‡å®š<code>measurement</code></p>
<p><code>WHERE</code>å­å¥æ”¯æŒæ¯”è¾ƒ<code>tag</code>ï¼Œ<code>field</code>æ¯”è¾ƒæ˜¯æ— æ•ˆçš„</p>
<p><strong>ç¤ºä¾‹</strong></p>
<blockquote>
<p>è¯¥æŸ¥è¯¢è¿”å›æ•°æ®åº“<code>oceanic_station</code>ä¸‹<code>tag key</code>   oceanic_stationä¸‹æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼air*çš„ä¸€ä¸ªmeasurement</p>
</blockquote>
<pre><code class="language-sql">SHOW MEASUREMENTS ON &quot;oceanic_station&quot; WITH MEASUREMENT =~ /air*/
</code></pre>
<h3 id="åˆ é™¤measurement"><a class="header" href="#åˆ é™¤measurement">åˆ é™¤<code>measurement</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DROP MEASUREMENT &lt;measurement_name&gt;
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>DROP MEASUREMENT</code>ä¼šåˆ é™¤æŒ‡å®š<code>measurement</code>ä¸‹æ‰€æœ‰çš„æ•°æ®</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">DROP MEASUREMENT &quot;air&quot;
</code></pre>
<h3 id="æ˜¾ç¤ºtag-key"><a class="header" href="#æ˜¾ç¤ºtag-key">æ˜¾ç¤º<code>tag key</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">SHOW TAG KEYS [ON &lt;database_name&gt;] [FROM_clause] [WHERE &lt;tag_key&gt; &lt;operator&gt; ['&lt;tag_value&gt;' | &lt;regular_expression&gt;]] [LIMIT_clause] [OFFSET_clause]
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>SHOW tag keys</code>åé¢éƒ½æ˜¯å¯é€‰é¡¹</p>
<p><code>[ON &lt;database_name&gt;]</code>æŒ‡å®šæ•°æ®åº“åç§°</p>
<p><code>FROM</code>å­å¥æŒ‡å®š<code>measurement</code></p>
<p><code>WHERE</code>å­å¥æ”¯æŒæ¯”è¾ƒ<code>tag</code>ï¼Œ<code>field</code>æ¯”è¾ƒæ˜¯æ— æ•ˆçš„</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">SHOW TAG KEYS ON &quot;oceanic_station&quot; FROM &quot;air&quot; LIMIT 1 OFFSET 1
</code></pre>
<h3 id="æ˜¾ç¤ºtag-value"><a class="header" href="#æ˜¾ç¤ºtag-value">æ˜¾ç¤º<code>tag value</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code>```sql
SHOW TAG VALUES [ON &lt;database_name&gt;][FROM_clause] WITH KEY [ [&lt;operator&gt; &quot;&lt;tag_key&gt;&quot; | &lt;regular_expression&gt;] | [IN (&quot;&lt;tag_key1&gt;&quot;,&quot;&lt;tag_key2&quot;)]] [WHERE &lt;tag_key&gt; &lt;operator&gt; ['&lt;tag_value&gt;' | &lt;regular_expression&gt;]] [LIMIT_clause] [OFFSET_clause]
```
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>[ON &lt;database_name&gt;]</code>æŒ‡å®šæ•°æ®åº“åç§°</p>
<p><code>FROM</code>å­å¥æŒ‡å®š<code>measurement</code></p>
<p><code>WHERE</code>å­å¥æ”¯æŒæ¯”è¾ƒ<code>tag</code>ï¼Œ<code>field</code>æ¯”è¾ƒæ˜¯æ— æ•ˆçš„</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">SHOW TAG VALUES ON &quot;oceanic_station&quot; WITH KEY IN (&quot;station&quot;)
</code></pre>
<h3 id="æ˜¾ç¤ºfield-key"><a class="header" href="#æ˜¾ç¤ºfield-key">æ˜¾ç¤º<code>field key</code></a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">SHOW FIELD KEYS [ON &lt;database_name&gt;] [FROM &lt;measurement_name&gt;]
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>FROM</code>å­å¥ä¸ºå¯é€‰é¡¹</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">SHOW FIELD KEYS ON &quot;oceanic_station&quot; FROM &quot;air&quot;
</code></pre>
<h3 id="æŒ‰æ—¶é—´è¿‡æ»¤"><a class="header" href="#æŒ‰æ—¶é—´è¿‡æ»¤">æŒ‰æ—¶é—´è¿‡æ»¤</a></h3>
<p>å¯ä»¥åœ¨<code>SHOW TAG KEYS</code>ã€<code>SHOW TAG VALUES</code> <code>SHOW SERIES</code> <code>SHOW MEASUREMENTS</code> <code>SHOW FIELD KEYS</code>ä¸Šä½¿ç”¨</p>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-sql">SHOW TAG KEYS ON &quot;oceanic_station&quot; where time &gt; now() -1h and time &lt; now()
</code></pre>
<h3 id="åˆ é™¤åˆ†ç‰‡"><a class="header" href="#åˆ é™¤åˆ†ç‰‡">åˆ é™¤åˆ†ç‰‡</a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-sql">DROP SHARD &lt;shard_id_number&gt;
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p><code>DROP SHARD</code>ä¼šåœ¨ç£ç›˜ä¸Šåˆ é™¤æœ‰å…³åˆ†ç‰‡çš„æ‰€æœ‰æ•°æ®ä»¥åŠå…ƒæ•°æ®</p>
<pre><code class="language-sql">&gt; DROP SHARD 1
&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cnosqlå‡½æ•°"><a class="header" href="#cnosqlå‡½æ•°">CnosQLå‡½æ•°</a></h2>
<ul>
<li>
<h3 id="ç›®å½•"><a class="header" href="#ç›®å½•">ç›®å½•</a></h3>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0">èšåˆå‡½æ•°</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count">COUNT()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#distinct">DISTINCT()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#integral">INTEGRAL()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean">MEAN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median">MEDIAN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode">MODE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#spread">SPREAD()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#stddev">STDDEV()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum">SUM()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E9%80%89%E6%8B%A9%E5%87%BD%E6%95%B0">é€‰æ‹©å‡½æ•°</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#bottom">BOTTOM()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first">FIRST()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last">LAST()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max">MAX()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min">MIN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile">PERCENTILE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sample">SAMPLE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#top">TOP()</a></li>
</ul>
</li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0">è½¬æ¢å‡½æ•°</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#abs">ABS()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#acos">ACOS()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#asin">ASIN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#atan">ATAN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#atan2">ATAN2()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#ceil">CEIL()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#cos">COS()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#cumulative-sum">CUMULATIVE_SUM()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#derivative">DERIVATIVE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#difference">DIFFERENCE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#elapsed">ELAPSED()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#exp">EXP()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#floor">FLOOR()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#histogram">HISTOGRAM()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#ln">LN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#log">LOG()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#log2">LOG2()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#log10">LOG10()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#moving-average">MOVING_AVERAGE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#non-negative-derivative">NON_NEGATIVE_DERIVATIVE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#non-negative-difference">NON_NEGATIVE_DIFFERENCE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#pow">POW()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#round">ROUND()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sin">SIN()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sqrt">SQRT()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#tan">TAN()</a></li>
</ul>
</li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0">é¢„æµ‹å‡½æ•°</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#holt_winters">HOLT_WINTERS()</a></li>
</ul>
</li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0">åˆ†æå‡½æ•°</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#chande_momentum_oscillator">CHANDE_MOMENTUM_OSCILLATOR()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#exponential_moving_average">EXPONENTIAL_MOVING_AVERAGE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#double_exponential_moving_average">DOUBLE_EXPONENTIAL_MOVING_AVERAGE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_efficiency_ratio">KAUFMANS_EFFICIENCY_RATIO()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_adaptive_moving_average">KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_moving_average">TRIPLE_EXPONENTIAL_MOVING_AVERAGE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_derivative">TRIPLE_EXPONENTIAL_DERIVATIVE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#relative_strength_index">RELATIVE_STRENGTH_INDEX()</a></li>
</ul>
</li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#other">å…¶ä»–</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE">ç¤ºä¾‹æ•°æ®</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E5%87%BD%E6%95%B0%E7%9A%84%E9%80%9A%E7%94%A8%E8%AF%AD%E6%B3%95">å‡½æ•°çš„é€šç”¨è¯­æ³•</a>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E5%9C%A8SELECT%E4%B8%AD%E6%8C%87%E5%AE%9A%E5%A4%9A%E4%B8%AA%E5%87%BD%E6%95%B0">åœ¨<code>SELECT</code>ä¸­æŒ‡å®šå¤šä¸ªå‡½æ•°</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E9%87%8D%E5%91%BD%E5%90%8D%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E5%AD%97%E6%AE%B5">é‡å‘½åæŸ¥è¯¢ç»“æœå­—æ®µ</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E6%94%B9%E5%8F%98%E4%B8%8D%E5%90%AB%E6%95%B0%E6%8D%AE%E7%9A%84%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC">æ”¹å˜ä¸å«æ•°æ®çš„æ—¶é—´é—´éš”çš„è¿”å›å€¼</a></li>
</ul>
</li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å‡½æ•°å¸¸è§é—®é¢˜</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="èšåˆå‡½æ•°"><a class="header" href="#èšåˆå‡½æ•°">èšåˆå‡½æ•°</a></h3>
<ul>
<li>
<h3 id="count"><a class="header" href="#count">COUNT()</a></h3>
<p>è¿”å›éç©ºå€¼ field valuesæ•°é‡</p>
<h4 id="è¯­æ³•-14"><a class="header" href="#è¯­æ³•-14">è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT COUNT( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="åµŒå¥—è¯­æ³•"><a class="header" href="#åµŒå¥—è¯­æ³•">åµŒå¥—è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT COUNT(DISTINCT( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [...]
</code></pre>
<p><code>COUNT(field_key)</code>è¿”å›<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸ªæ•°ã€‚</p>
<p><code>COUNT(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸ªæ•°ã€‚</p>
<p><code>COUNT(*)</code>è¿”å›åœ¨<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸ªæ•°ã€‚</p>
<p><code>COUNT()</code>æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„<code>field value</code>ã€‚cnosQLæ”¯æŒå°†<a href="content/cnosdb/latest/cnosql/cnosql_function.html#distinct"><code>DISTINCT()</code></a>å‡½æ•°åµŒå¥—åœ¨<code>COUNT()</code>å‡½æ•°é‡Œã€‚</p>
<h4 id="ç¤ºä¾‹"><a class="header" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyçš„field-valueçš„æ•°ç›®"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyçš„field-valueçš„æ•°ç›®">è®¡ç®—æŒ‡å®šfield keyçš„field valueçš„æ•°ç›®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COUNT(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 count
----                 -----
1970-01-01T00:00:00Z 3334
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement``air</code>ä¸­çš„<code>temperature</code>çš„éç©ºfield valueçš„æ•°é‡ã€‚</p>
<ul>
<li>
<h4 id="è®¡æ•°measurementä¸­æ¯ä¸ªfield-keyå…³è”çš„field-valueçš„æ•°é‡"><a class="header" href="#è®¡æ•°measurementä¸­æ¯ä¸ªfield-keyå…³è”çš„field-valueçš„æ•°é‡">è®¡æ•°measurementä¸­æ¯ä¸ªfield keyå…³è”çš„field valueçš„æ•°é‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COUNT(*) FROM &quot;air&quot;
name: air
time                 count_pressure count_temperature count_visibility
----                 -------------- ----------------- ----------------
1970-01-01T00:00:00Z 3334           3334              3334
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›ä¸measurement<code>air</code>ç›¸å…³è”çš„æ¯ä¸ªfield keyçš„éç©ºfield valueçš„æ•°é‡ã€‚<code>air</code>æœ‰3ä¸ªfield keysï¼š<code>count_pressure</code> <code>count_temperature</code> <code>count_visibility</code></p>
<ul>
<li>
<h4 id="è®¡ç®—åŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ¯ä¸ªfield-keyå…³è”çš„field-valueçš„æ•°ç›®"><a class="header" href="#è®¡ç®—åŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ¯ä¸ªfield-keyå…³è”çš„field-valueçš„æ•°ç›®">è®¡ç®—åŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ¯ä¸ªfield keyå…³è”çš„field valueçš„æ•°ç›®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COUNT(/.*pre.*/) FROM &quot;air&quot;
name: air
time                 count_pressure
----                 --------------
1970-01-01T00:00:00Z 3334
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement<code>air</code>ä¸­åŒ…å«<code>pre</code>çš„æ¯ä¸ªfield keyçš„éç©ºå­—æ®µå€¼çš„æ•°é‡ã€‚</p>
<ul>
<li>
<h4 id="è®¡æ•°åŒ…æ‹¬å¤šä¸ªå­å¥çš„field-keyçš„field-valueçš„æ•°ç›®"><a class="header" href="#è®¡æ•°åŒ…æ‹¬å¤šä¸ªå­å¥çš„field-keyçš„field-valueçš„æ•°ç›®">è®¡æ•°åŒ…æ‹¬å¤šä¸ªå­å¥çš„field keyçš„field valueçš„æ•°ç›®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt;  SELECT COUNT(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &lt; now()  GROUP BY time(1ms),* fill(-1) LIMIT 7 SLIMIT 1
name: air
tags: station=LianYunGang
time                     count
----                     -----
2022-04-11T08:03:37.071Z 108
2022-04-11T08:03:37.072Z 193
2022-04-11T08:03:37.073Z 207
2022-04-11T08:03:37.074Z 209
2022-04-11T08:03:37.075Z 209
2022-04-11T08:03:37.076Z 218
2022-04-11T08:03:37.077Z 216
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>pressure</code>field keyä¸­çš„éç©ºfield valueçš„æ•°é‡ã€‚å®ƒæ¶µç›–<code>now()</code>ä¹‹é—´çš„<code>æ—¶é—´æ®µ</code>ï¼Œå¹¶å°†ç»“æœåˆ†ç»„ä¸º1msçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtag(è¡¨ç¤ºä¸ºä»¥ä¸Šä»£ç ä¸­çš„<code>*</code>)ã€‚å¹¶ç”¨<code>-1</code>å¡«å……ç©ºçš„æ—¶é—´é—´éš”ï¼Œå¹¶è¿”å›7ä¸ª<code>point</code>ï¼Œè¡¨æ ¼è¿”å›1ã€‚</p>
</li>
<li>
<h4 id="è®¡ç®—ä¸€ä¸ªfield-keyçš„distinctçš„field-valueçš„æ•°é‡"><a class="header" href="#è®¡ç®—ä¸€ä¸ªfield-keyçš„distinctçš„field-valueçš„æ•°é‡">è®¡ç®—ä¸€ä¸ªfield keyçš„distinctçš„field valueçš„æ•°é‡</a></h4>
<pre><code class="language-sql">&gt; SELECT COUNT(DISTINCT(&quot;pressure&quot;)) FROM &quot;air&quot;
name: air
time                 count
----                 -----
1970-01-01T00:00:00Z 7
</code></pre>
</li>
</ul>
<p>æŸ¥è¯¢è¿”å›measurementä¸º<code>air</code>field<code>ä¸º</code>pressure çš„å”¯ä¸€field valueçš„æ•°é‡ã€‚</p>
<h4 id="countçš„å¸¸è§é—®é¢˜"><a class="header" href="#countçš„å¸¸è§é—®é¢˜"><code>COUNT()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="countå’Œfill"><a class="header" href="#countå’Œfill"><code>COUNT()</code>å’Œ<code>fill()</code></a></h4>
</li>
</ul>
<p>å¤§å¤šæ•°cnosQLå‡½æ•°å¯¹äºæ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”è¿”å›<code>null</code>å€¼ï¼Œ<code>fill(&lt;fill_option&gt;)</code>å°†è¯¥<code>null</code>å€¼æ›¿æ¢ä¸º<code>fill_option</code>ã€‚ <code>COUNT()</code>é’ˆå¯¹æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”è¿”å›<code>0</code>ï¼Œ<code>fill(&lt;fill_option&gt;)</code>ç”¨<code>fill_option</code>æ›¿æ¢0å€¼ã€‚</p>
<p><em>ç¤ºä¾‹</em></p>
<p>ä¸‹é¢çš„ä»£ç å—ä¸­çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸åŒ…æ‹¬<code>fill()</code>ã€‚æœ€åä¸€ä¸ªæ—¶é—´é—´éš”æ²¡æœ‰æ•°æ®ï¼Œå› æ­¤è¯¥æ—¶é—´é—´éš”çš„å€¼è¿”å›ä¸ºé›¶ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢åŒ…æ‹¬<code>fill(-1)</code>; å®ƒå°†æœ€åä¸€ä¸ªé—´éš”ä¸­çš„é›¶æ›¿æ¢ä¸º<code>-1</code>ã€‚</p>
<pre><code class="language-sql">&gt; SELECT COUNT(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &lt; now()  GROUP BY time(1s),*  LIMIT 7 SLIMIT 1
name: air
tags: station=LianYunGang
time                 count
----                 -----
2022-04-11T08:03:37Z 1617
2022-04-11T08:03:38Z 0
2022-04-11T08:03:39Z 0
2022-04-11T08:03:40Z 0
2022-04-11T08:03:41Z 0
2022-04-11T08:03:42Z 0
2022-04-11T08:03:43Z 0

&gt; SELECT COUNT(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &lt; now()  GROUP BY time(1s),* fill(-1) LIMIT 7 SLIMIT 1
name: air
tags: station=LianYunGang
time                 count
----                 -----
2022-04-11T08:03:37Z 1617
2022-04-11T08:03:38Z -1
2022-04-11T08:03:39Z -1
2022-04-11T08:03:40Z -1
2022-04-11T08:03:41Z -1
2022-04-11T08:03:42Z -1
2022-04-11T08:03:43Z -1
</code></pre>
<ul>
<li>
<h3 id="distinct"><a class="header" href="#distinct"><code>DISTINCT()</code></a></h3>
<p>è¿”å›<code>field value</code>çš„ä¸é‡å¤å€¼åˆ—è¡¨ã€‚</p>
<h4 id="è¯­æ³•-15"><a class="header" href="#è¯­æ³•-15">è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT DISTINCT( [ &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="åµŒå¥—è¯­æ³•-1"><a class="header" href="#åµŒå¥—è¯­æ³•-1">åµŒå¥—è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT COUNT(DISTINCT( [ &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [...]
</code></pre>
<h4 id="è¯­æ³•æè¿°-1"><a class="header" href="#è¯­æ³•æè¿°-1">è¯­æ³•æè¿°</a></h4>
<p><code>DISTINCT(field_key)</code> è¿”å›<code>field key</code>å¯¹åº”çš„ä¸åŒ<code>field values</code>ã€‚</p>
<p><code>DISTINCT()</code> æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„<code>field value</code>ï¼ŒcnosQLæ”¯æŒ<a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a>åµŒå¥—<code>DISTINCT()</code>ã€‚</p>
<h4 id="ç¤ºä¾‹-1"><a class="header" href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="åˆ—å‡ºä¸€ä¸ªfield-keyçš„ä¸åŒçš„field-value"><a class="header" href="#åˆ—å‡ºä¸€ä¸ªfield-keyçš„ä¸åŒçš„field-value">åˆ—å‡ºä¸€ä¸ª<code>field key</code>çš„ä¸åŒçš„<code>field value</code></a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DISTINCT(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 distinct
----                 --------
1970-01-01T00:00:00Z 58
1970-01-01T00:00:00Z 62
1970-01-01T00:00:00Z 56
1970-01-01T00:00:00Z 59
1970-01-01T00:00:00Z 57
1970-01-01T00:00:00Z 61
1970-01-01T00:00:00Z 60
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>air</code> measurementä¸­<code>temperature</code>field å…³é”®å­—ä¸­å”¯ä¸€<code>field values</code>çš„åˆ—è¡¨</p>
</li>
</ul>
<ul>
<li>
<h4 id="åˆ—å‡ºåŒ…å«å¤šä¸ªå­å¥çš„field-keyå…³è”çš„ä¸åŒå€¼çš„åˆ—è¡¨"><a class="header" href="#åˆ—å‡ºåŒ…å«å¤šä¸ªå­å¥çš„field-keyå…³è”çš„ä¸åŒå€¼çš„åˆ—è¡¨">åˆ—å‡ºåŒ…å«å¤šä¸ªå­å¥çš„field keyå…³è”çš„ä¸åŒå€¼çš„åˆ—è¡¨</a></h4>
<pre><code class="language-sql">&gt;SELECT DISTINCT(&quot;pressure&quot;) FROM &quot;air&quot; WHERE  time &lt;now() GROUP BY time(12m),* SLIMIT 1
name: air
tags: station=LianYunGang
time                 distinct
----                 --------
2022-04-11T08:00:00Z 58
2022-04-11T08:00:00Z 56
2022-04-11T08:00:00Z 59
2022-04-11T08:00:00Z 57
2022-04-11T08:00:00Z 62
2022-04-11T08:00:00Z 60
2022-04-11T08:00:00Z 61
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>pressure</code>field keyä¸­ä¸åŒfield valueçš„åˆ—è¡¨ã€‚å®ƒæ¶µç›–now()ä¹‹å‰çš„æ—¶é—´æ®µï¼Œå¹¶å°†ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagåˆ†ç»„ã€‚æŸ¥è¯¢é™åˆ¶ï¼ˆSLIMITï¼‰è¿”å›ä¸€ä¸ªseriesã€‚</p>
<ul>
<li>
<h4 id="å¯¹ä¸€ä¸ªå­—æ®µçš„ä¸åŒå€¼è¿›è¡Œè®¡ç®—"><a class="header" href="#å¯¹ä¸€ä¸ªå­—æ®µçš„ä¸åŒå€¼è¿›è¡Œè®¡ç®—">å¯¹ä¸€ä¸ªå­—æ®µçš„ä¸åŒå€¼è¿›è¡Œè®¡ç®—</a></h4>
<pre><code class="language-sql">&gt; SELECT COUNT(DISTINCT(&quot;pressure&quot;)) FROM &quot;air&quot;
name: air
time                 count
----                 -----
1970-01-01T00:00:00Z 7
</code></pre>
</li>
</ul>
<p>æŸ¥è¯¢è¿”å›<code>air</code>è¿™ä¸ªmeasurementä¸­å­—æ®µ<code>pressure</code>çš„ä¸åŒå€¼çš„æ•°ç›®ã€‚</p>
<h4 id="distinctçš„å¸¸è§é—®é¢˜"><a class="header" href="#distinctçš„å¸¸è§é—®é¢˜"><code>DISTINCT()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="distinct-å’Œ-into-å­å¥"><a class="header" href="#distinct-å’Œ-into-å­å¥"><code>DISTINCT()</code> å’Œ <code>INTO</code> å­å¥</a></h4>
</li>
</ul>
<p>åœ¨<code>INTO</code>å­å¥ä¸­ä½¿ç”¨<code>DISTINCT()</code>å¯èƒ½ä¼šå¯¼è‡´CnosDBè¦†ç›–ç›®æ ‡measurementä¸­çš„<code>points</code>ã€‚<code>DISTINCT()</code>é€šå¸¸è¿”å›å¤šä¸ªå…·æœ‰ç›¸åŒæ—¶é—´æˆ³çš„ç»“æœï¼›CnosDBå‡è®¾åœ¨ç›¸åŒseriesä¸­å¹¶å…·æœ‰ç›¸åŒæ—¶é—´æˆ³çš„<code>point</code>æ˜¯é‡å¤<code>point</code>ï¼Œå¹¶ç®€å•åœ°ç”¨ç›®æ ‡measurementä¸­æœ€æ–°çš„<code>point</code>è¦†ç›–é‡å¤<code>point</code>ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢ä»£ç å—ä¸­çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä½¿ç”¨äº†<code>DISTINCT()</code>ï¼Œå¹¶è¿”å›7ä¸ªç»“æœã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªç»“æœéƒ½æœ‰ç›¸åŒçš„æ—¶é—´æˆ³ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢å°†<code>INTO</code>å­å¥æ·»åŠ åˆ°æŸ¥è¯¢ä¸­ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœå†™å…¥measurement <code>distincts</code>ã€‚æœ€åä¸€ä¸ªæŸ¥è¯¢é€‰æ‹©measurement <code>distincts</code>ä¸­æ‰€æœ‰æ•°æ®ã€‚
å› ä¸ºåŸæ¥çš„å››ä¸ªç»“æœæ˜¯é‡å¤çš„(å®ƒä»¬åœ¨ç›¸åŒçš„seriesï¼Œæœ‰ç›¸åŒçš„æ—¶é—´æˆ³)ï¼Œæ‰€ä»¥æœ€åä¸€ä¸ªæŸ¥è¯¢åªè¿”å›ä¸€ä¸ª<code>point</code>ã€‚å½“ç³»ç»Ÿé‡åˆ°é‡å¤æ•°æ®<code>point</code>ï¼Œå®ƒä¼šç”¨æœ€è¿‘çš„<code>point</code>è¦†ç›–ä¹‹å‰çš„<code>point</code>ã€‚</p>
<pre><code class="language-sql">&gt; SELECT DISTINCT(&quot;pressure&quot;) FROM &quot;air&quot;
name: air
time                 distinct
----                 --------
1970-01-01T00:00:00Z 56
1970-01-01T00:00:00Z 59
1970-01-01T00:00:00Z 62
1970-01-01T00:00:00Z 58
1970-01-01T00:00:00Z 60
1970-01-01T00:00:00Z 61
1970-01-01T00:00:00Z 57

&gt; SELECT DISTINCT(&quot;pressure&quot;) INTO &quot;distincts&quot; FROM &quot;air&quot;
name: result
time                 written
----                 -------
1970-01-01T00:00:00Z 7 

&gt; SELECT * FROM &quot;distincts&quot;
name: distincts
time                 distinct
----                 --------
1970-01-01T00:00:00Z 57
</code></pre>
<ul>
<li>
<h3 id="integral"><a class="header" href="#integral"><code>INTEGRAL()</code></a></h3>
<p>è¿”å›<code>field value</code>æ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œå³å…³äº<code>field value</code>çš„ç§¯åˆ†ã€‚</p>
<h4 id="è¯­æ³•-16"><a class="header" href="#è¯­æ³•-16">è¯­æ³•</a></h4>
<pre><code>SELECT INTEGRAL( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] [ , &lt;unit&gt; ]  ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-2"><a class="header" href="#è¯­æ³•æè¿°-2">è¯­æ³•æè¿°</a></h4>
<p>CnosDBè®¡ç®—field valueæ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œå¹¶å°†è¿™äº›ç»“æœè½¬æ¢ä¸ºæ¯ä¸ª<code>unit</code>çš„æ€»é¢ç§¯ã€‚å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>unit</code>é»˜è®¤ä¸ºä¸€ç§’(<code>1s</code>)ã€‚</p>
<p><code>INTEGRAL(field_key)</code>è¿”å›field keyå…³è”çš„å€¼ä¹‹ä¸‹çš„é¢ç§¯ã€‚</p>
<p><code>INTEGRAL(/regular_expression/)</code>è¿”å›æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼çš„æ¯ä¸ªfield keyå…³è”çš„å€¼ä¹‹ä¸‹çš„é¢ç§¯ã€‚</p>
<p><code>INTEGRAL(*)</code>è¿”å›<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å…³è”çš„å€¼ä¹‹ä¸‹çš„é¢ç§¯ã€‚</p>
<p><code>INTEGRAL()</code>ä¸æ”¯æŒ<code>fill()</code>ï¼Œ<code>INTEGRAL()</code>æ”¯æŒint64å’Œfloat64ä¸¤ä¸ªæ•°æ®ç±»å‹ã€‚</p>
<h4 id="ç¤ºä¾‹-2"><a class="header" href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„äº”ä¸ªä¾‹å­ï¼Œä½¿ç”¨æ•°æ®åº“<a href="content/cnosdb/latest/cnosql/oceanic_station.txt"><code>oceanic_station</code>ä¸­çš„æ•°æ®</a>ï¼š</p>
<pre><code class="language-sql">&gt;  SELECT  temperature  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' limit 10
name: air
time                        temperature
----                        -----------
2022-04-11T08:03:37.07132Z  58
2022-04-11T08:03:37.071378Z 62
2022-04-11T08:03:37.071385Z 58
2022-04-11T08:03:37.071391Z 56
2022-04-11T08:03:37.071394Z 56
2022-04-11T08:03:37.071401Z 59
2022-04-11T08:03:37.071403Z 57
2022-04-11T08:03:37.071406Z 62
2022-04-11T08:03:37.071409Z 59
2022-04-11T08:03:37.071411Z 62
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šçš„field-keyçš„å€¼å¾—ç§¯åˆ†"><a class="header" href="#è®¡ç®—æŒ‡å®šçš„field-keyçš„å€¼å¾—ç§¯åˆ†">è®¡ç®—æŒ‡å®šçš„field keyçš„å€¼å¾—ç§¯åˆ†</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt;SELECT  INTEGRAL(temperature)  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' limit 10 
name: air
time                 integral
----                 --------
1970-01-01T00:00:00Z 0.4677579999999999
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>air</code>ä¸­çš„å­—æ®µ<code>temperature</code>çš„æ›²çº¿ä¸‹çš„é¢ç§¯ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šçš„field-keyå’Œæ—¶é—´å•ä½çš„å€¼çš„ç§¯åˆ†"><a class="header" href="#è®¡ç®—æŒ‡å®šçš„field-keyå’Œæ—¶é—´å•ä½çš„å€¼çš„ç§¯åˆ†">è®¡ç®—æŒ‡å®šçš„field keyå’Œæ—¶é—´å•ä½çš„å€¼çš„ç§¯åˆ†</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT  INTEGRAL(temperature,1ms)  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' limit 10
name: air
time                 integral
----                 --------
1970-01-01T00:00:00Z 467.7580000000045
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>air</code>ä¸­çš„å­—æ®µ<code>temperature</code>çš„æ›²çº¿ä¸‹çš„é¢ç§¯ï¼ˆä»¥1msä¸ºå•ä½ï¼‰ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT  INTEGRAL(*,1ms)  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' and time&lt;now()
name: air
time                 integral_pressure  integral_temperature integral_visibility
----                 -----------------  -------------------- -------------------
1970-01-01T00:00:00Z 467.22900000000413 467.7580000000045    491.2000000000007
</code></pre>
<p>æŸ¥è¯¢è¿”å›measurement<code>air</code>ä¸­å­˜å‚¨çš„æ¯ä¸ªæ•°å€¼å­—æ®µç›¸å…³çš„å­—æ®µå€¼çš„æ›²çº¿ä¸‹é¢ç§¯ï¼ˆä»¥1msä¸ºå•ä½ï¼‰</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„field-keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†"><a class="header" href="#è®¡ç®—measurementä¸­åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„field-keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†">è®¡ç®—measurementä¸­åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„field keyåœ¨æŒ‡å®šæ—¶é—´å•ä½çš„å€¼å¾—ç§¯åˆ†</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT  INTEGRAL(/temp/,1ms)  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' and time&lt;now()
name: air
time                 integral_temperature
----                 --------------------
1970-01-01T00:00:00Z 467.7580000000045

</code></pre>
<p>æŸ¥è¯¢è¿”å›field keyåŒ…æ‹¬å•è¯<code>water</code>çš„æ¯ä¸ªæ•°å€¼ç±»å‹çš„å­—æ®µç›¸å…³è”çš„å­—æ®µå€¼çš„æ›²çº¿ä¸‹çš„åŒºåŸŸï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ã€‚</p>
<ul>
<li>
<h4 id="åœ¨å«æœ‰å¤šä¸ªå­å¥ä¸­è®¡ç®—æŒ‡å®šå­—æ®µçš„ç§¯åˆ†"><a class="header" href="#åœ¨å«æœ‰å¤šä¸ªå­å¥ä¸­è®¡ç®—æŒ‡å®šå­—æ®µçš„ç§¯åˆ†">åœ¨å«æœ‰å¤šä¸ªå­å¥ä¸­è®¡ç®—æŒ‡å®šå­—æ®µçš„ç§¯åˆ†</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT  INTEGRAL(temperature,1ms)  FROM &quot;air&quot; WHERE &quot;station&quot; = 'XiaoMaiDao' and time&lt;now() GROUP BY time(12m) LIMIT 1
name: air
time                 integral_temperature
----                 --------------------
2022-04-11T08:00:00Z 467.7580000000045
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­<code>field key</code> <code>temperature</code>å¯¹åº”çš„field valueæ›²çº¿ä¸‹çš„é¢ç§¯(ä»¥åˆ†é’Ÿä¸ºå•ä½)ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨now()ä¹‹å‰ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º1ã€‚</p>
</li>
<li>
<h3 id="mean"><a class="header" href="#mean"><code>MEAN()</code></a></h3>
<p>è¿”å›field valueçš„å¹³å‡å€¼ã€‚</p>
<h4 id="è¯­æ³•-17"><a class="header" href="#è¯­æ³•-17">è¯­æ³•</a></h4>
<pre><code>SELECT MEAN( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>MEAN(field_key)</code>è¿”å›<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡å€¼ã€‚</p>
<p><code>MEAN(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„field valueçš„å¹³å‡å€¼ã€‚</p>
<p><code>MEAN(*)</code>è¿”å›åœ¨<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡å€¼ã€‚</p>
<p><code>MEAN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-3"><a class="header" href="#ç¤ºä¾‹-3">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¹³å‡å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                   mean
----                   ----
1970-01-01T00:00:00Z   4.442107025822522
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­<code>field key</code> <code>temperature</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¹³å‡å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(*) FROM &quot;air&quot; 
name: air
time                 mean_pressure     mean_temperature  mean_visibility
----                 -------------     ----------------  ---------------
1970-01-01T00:00:00Z 59.00689862027595 59.04949010197961 62.01889622075585
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¹³å‡å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(/temp/) FROM &quot;air&quot; 
name: air
time                   mean_temperature
----                   ----------------
1970-01-01T00:00:00Z   4.442107025822523
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &lt;now() GROUP BY time(12m),* fill(9.01) LIMIT 7 SLIMIT 1
name: air
tags: station=LianYunGang
time                 mean
----                 ----
2022-04-11T08:00:00Z 59.06864564007421
2022-04-11T08:12:00Z 9.01
2022-04-11T08:24:00Z 9.01
2022-04-11T08:36:00Z 9.01
2022-04-11T08:48:00Z 9.01
2022-04-11T09:00:00Z 9.01
2022-04-11T09:12:00Z 9.01 
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„å¹³å‡å€¼ï¼Œå°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ª<code>tag</code>è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>9.01</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º7å’Œ1ã€‚</p>
</li>
<li>
<h3 id="median"><a class="header" href="#median">MEDIAN()</a></h3>
<p>è¿”å›<code>field value</code>çš„è®¡ç®—ä¸­å€¼ã€‚</p>
<h4 id="è¯­æ³•-18"><a class="header" href="#è¯­æ³•-18">è¯­æ³•</a></h4>
<pre><code>SELECT MEDIAN( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-3"><a class="header" href="#è¯­æ³•æè¿°-3">è¯­æ³•æè¿°</a></h4>
<p><code>MEDIAN(field_key)</code>è¿”å›ä¸<code>field key</code>å¯¹åº”çš„field valueçš„ä¸­å€¼ã€‚</p>
<p><code>MEDIAN(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸­å€¼ã€‚</p>
<p><code>MEDIAN(*)</code>è¿”å›åœ¨<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸­å€¼ã€‚</p>
<p><code>MEDIAN()</code> æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong><code>MEDIAN()</code>è¿‘ä¼¼äº<code>PERCENTILE(field_key, 50)</code>ï¼Œé™¤é<code>field key</code>åŒ…å«çš„<code>field value</code>æœ‰å¶æ•°ä¸ªï¼Œé‚£ä¹ˆè¿™æ—¶å€™<code>MEDIAN()</code>å°†è¿”å›ä¸¤ä¸ªä¸­é—´å€¼çš„å¹³å‡æ•°ã€‚</p>
</blockquote>
<h4 id="ç¤ºä¾‹-4"><a class="header" href="#ç¤ºä¾‹-4">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä¸­å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEDIAN(&quot;pressure&quot;) FROM &quot;air&quot;
name: air
time                 median
----                 ------
1970-01-01T00:00:00Z 59
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­field key <code>pressure</code>å¯¹åº”çš„<code>field value</code>çš„ä¸­å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä¸­å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEDIAN(*) FROM &quot;air&quot;
name: air
time                 median_pressure median_temperature median_visibility
----                 --------------- ------------------ -----------------
1970-01-01T00:00:00Z 59              59                 62
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„ä¸­å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä¸­å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEDIAN(/temp/) FROM &quot;air&quot;
name: air
time                 median_temperature
----                 ------------------
1970-01-01T00:00:00Z 59
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„ä¸­å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä¸­å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä¸­å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEDIAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE  time&lt;now()  GROUP BY time(1m),* fill(-1) LIMIT 7 SLIMIT 3 SOFFSET 1
name: air
tags: station=XiaoMaiDao
time                 median
----                 ------
2022-04-11T08:03:00Z 59
2022-04-11T08:04:00Z -1
2022-04-11T08:05:00Z -1
2022-04-11T08:06:00Z -1
2022-04-11T08:07:00Z -1
2022-04-11T08:08:00Z -1
2022-04-11T08:09:00Z -1
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­<code>field key</code> <code>temperature</code>å¯¹åº”çš„<code>field value</code>çš„å¹³å‡æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨now()ä¹‹å‰ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰1åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ª<code>tag</code>è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>-1</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º3å’Œ1ï¼Œå¹¶å°†è¿”å›çš„<code>series</code>åç§»ä¸€ä¸ªï¼ˆå³ç¬¬ä¸€ä¸ª<code>series</code>çš„æ•°æ®ä¸è¿”å›ï¼‰ã€‚</p>
</li>
<li>
<h3 id="mode"><a class="header" href="#mode">MODE()</a></h3>
<p>è¿”å›<code>field value</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ã€‚</p>
<h4 id="è¯­æ³•-19"><a class="header" href="#è¯­æ³•-19">è¯­æ³•</a></h4>
<pre><code>SELECT MODE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>MODE(field_key)</code>è¿”å›<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ã€‚</p>
<p><code>MODE(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ã€‚</p>
<p><code>MODE(*)</code>è¿”å›åœ¨<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ã€‚</p>
<p><code>MODE()</code> æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„<code>field value</code>ã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å¦‚æœå‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªå¹¶ä¸”å®ƒä»¬ä¹‹é—´æœ‰å…³è”ï¼Œé‚£ä¹ˆ<code>MODE()</code>è¿”å›å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„<code>field value</code>ã€‚</p>
</blockquote>
<h4 id="ç¤ºä¾‹-5"><a class="header" href="#ç¤ºä¾‹-5">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MODE(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 mode
----                 ----
1970-01-01T00:00:00Z 62
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æŸä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MODE(*) FROM &quot;air&quot;
name: air
time                 mode_pressure mode_temperature mode_visibility
----                 ------------- ---------------- ---------------
1970-01-01T00:00:00Z 57            62               61
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">SELECT MODE(/temp/) FROM &quot;air&quot;
name: air
time                 mode_temperature
----                 ----------------
1970-01-01T00:00:00Z 62
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MODE(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &lt;now() GROUP BY time(12m),* LIMIT 3 SLIMIT 1 SOFFSET 1
name: air
tags: station=XiaoMaiDao
time                 mode
----                 ----
2022-04-11T08:00:00Z 59
2022-04-11T08:12:00Z 
2022-04-11T08:24:00Z 
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­<code>field key</code> <code>temperature</code>å¯¹åº”çš„<code>temperature</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ª<code>tag</code>è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œ<code>series</code>ä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º3å’Œ1ï¼Œå¹¶å°†è¿”å›çš„<code>series</code>åç§»ä¸€ä¸ªï¼ˆå³ç¬¬ä¸€ä¸ª<code>series</code>çš„æ•°æ®ä¸è¿”å›ï¼‰ã€‚</p>
</li>
<li>
<h3 id="spread"><a class="header" href="#spread">SPREAD()</a></h3>
<p>è¿”å›<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<h4 id="è¯­æ³•-20"><a class="header" href="#è¯­æ³•-20">è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT SPREAD( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-4"><a class="header" href="#è¯­æ³•æè¿°-4">è¯­æ³•æè¿°</a></h4>
<p><code>SPREAD(field_key)</code>è¿”å›<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<p><code>SPREAD(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<p><code>SPREAD(*)</code>è¿”å›åœ¨<code>measurement</code>ä¸­æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<p><code>SPREAD()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„<code>field value</code>ã€‚</p>
<h4 id="ç¤ºä¾‹-6"><a class="header" href="#ç¤ºä¾‹-6">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">SELECT SPREAD(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 spread
----                 ------
1970-01-01T00:00:00Z 6
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­<code>field key</code> <code>temperature</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SPREAD(*) FROM &quot;air&quot;
name: air
time                 spread_pressure spread_temperature spread_visibility
----                 --------------- ------------------ -----------------
1970-01-01T00:00:00Z 6               6                  6
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SPREAD(/tem/) FROM &quot;air&quot;
name: air
time                 spread_temperature
----                 ------------------
1970-01-01T00:00:00Z 6
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„<code>field key</code>å¯¹åº”çš„<code>field value</code>ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SPREAD(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &lt;now() GROUP BY time(12m),* fill(-1) LIMIT 3 SLIMIT 1 SOFFSET 1
name: air
tags: station=XiaoMaiDao
time                 spread
----                 ------
2022-04-11T08:00:00Z 6
2022-04-11T08:12:00Z -1
2022-04-11T08:24:00Z -1
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>measurement</code> <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹å·®ï¼Œå°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ª<code>tag</code>è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>-1</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œ<code>series</code>ä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º3å’Œ1ï¼Œå¹¶å°†è¿”å›çš„<code>series</code>åç§»ä¸€ä¸ªï¼ˆå³ç¬¬ä¸€ä¸ª<code>series</code>çš„æ•°æ®ä¸è¿”å›ï¼‰</p>
</li>
<li>
<h3 id="stddev"><a class="header" href="#stddev">STDDEV()</a></h3>
<p>è¿”å›<code>field value</code>çš„æ ‡å‡†å·®ã€‚</p>
<h4 id="è¯­æ³•-21"><a class="header" href="#è¯­æ³•-21">è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT STDDEV( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>STDDEV(field_key)</code>è¿”å›<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„æ ‡å‡†å·®ã€‚</p>
<p><code>STDDEV(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ª<code>field key</code>å¯¹åº”çš„<code>field value</code>çš„æ ‡å‡†å·®ã€‚</p>
<p><code>STDDEV(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®ã€‚</p>
<p><code>STDDEV()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-7"><a class="header" href="#ç¤ºä¾‹-7">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT STDDEV(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 stddev
----                 ------
1970-01-01T00:00:00Z 1.9933006709246002
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ ‡å‡†å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT STDDEV(*) FROM &quot;air&quot;
name: air
time                 stddev_pressure    stddev_temperature stddev_visibility
----                 ---------------    ------------------ -----------------
1970-01-01T00:00:00Z 2.0234776612813525 1.9933006709246002 1.9942769555619093
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT STDDEV(/temp/) FROM &quot;air&quot;
name: air
time                   stddev_temperature
----                   ------------------
1970-01-01T00:00:00Z   2.279144584196141
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ ‡å‡†å·®å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ ‡å‡†å·®å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">SELECT STDDEV(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &lt;now() GROUP BY time(12m),* fill(18000) LIMIT 2 SLIMIT 1 SOFFSET 1
name: air
tags: station=XiaoMaiDao
time                 stddev
----                 ------
2022-04-11T08:00:00Z 1.9988781365491315
2022-04-11T08:12:00Z 18000
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ ‡å‡†å·®ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>18000</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º2å’Œ1ï¼Œå¹¶å°†è¿”å›çš„seriesåç§»ä¸€ä¸ªï¼ˆå³ç¬¬ä¸€ä¸ªseriesçš„æ•°æ®ä¸è¿”å›ï¼‰ã€‚</p>
</li>
<li>
<h3 id="sum"><a class="header" href="#sum">SUM()</a></h3>
<p>è¿”å›field valueçš„æ€»å’Œã€‚</p>
<h4 id="è¯­æ³•-22"><a class="header" href="#è¯­æ³•-22">è¯­æ³•</a></h4>
<pre><code>SELECT SUM( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-5"><a class="header" href="#è¯­æ³•æè¿°-5">è¯­æ³•æè¿°</a></h4>
<p><code>SUM(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<p><code>SUM(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<p><code>SUM(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<p><code>SUM()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-8"><a class="header" href="#ç¤ºä¾‹-8">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 sum
----                 ---
1970-01-01T00:00:00Z 196871
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SUM(*) FROM &quot;air&quot;
name: air
time                 sum_pressure sum_temperature sum_visibility
----                 ------------ --------------- --------------
1970-01-01T00:00:00Z 196729       196871          206771
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œ">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SUM(/temp/) FROM &quot;air&quot;
name: air
time                 sum_temperature
----                 ---------------
1970-01-01T00:00:00Z 196871
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„æ€»å’Œã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &lt;now() GROUP BY time(12m),* fill(18000) LIMIT 4 SLIMIT 1
name: air
tags: station=LianYunGang
time                 sum
----                 ---
2022-04-11T08:00:00Z 95514
2022-04-11T08:12:00Z 18000
2022-04-11T08:24:00Z 18000
2022-04-11T08:36:00Z 18000
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ€»å’Œï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>18000</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º4å’Œ1ã€‚</p>
</li>
</ul>
<h2 id="é€‰æ‹©å‡½æ•°"><a class="header" href="#é€‰æ‹©å‡½æ•°">é€‰æ‹©å‡½æ•°</a></h2>
<ul>
<li>
<h3 id="bottom"><a class="header" href="#bottom">BOTTOM()</a></h3>
<p>è¿”å›æœ€å°çš„Nä¸ªfield valueã€‚</p>
<h4 id="è¯­æ³•-23"><a class="header" href="#è¯­æ³•-23">è¯­æ³•</a></h4>
<pre><code>SELECT BOTTOM(&lt;field_key&gt;[,&lt;tag_key(s)&gt;],&lt;N&gt; )[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-6"><a class="header" href="#è¯­æ³•æè¿°-6">è¯­æ³•æè¿°</a></h4>
<p><code>BOTTOM(field_key,N)</code>è¿”å›field keyå¯¹åº”çš„æœ€å°çš„Nä¸ªå€¼ã€‚</p>
<p><code>BOTTOM(field_key,tag_key(s),N)</code>è¿”å›tag keyçš„Nä¸ªtag valueå¯¹åº”çš„field keyçš„æœ€å°å€¼ã€‚</p>
<p><code>BOTTOM(field_key,N),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„æœ€å°çš„Nä¸ªå€¼ï¼Œä»¥åŠç›¸å…³çš„tagå’Œ/æˆ–fieldã€‚</p>
<p><code>BOTTOM()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>å¦‚æœæœ€å°å€¼æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç›¸ç­‰çš„å€¼ï¼Œ<code>BOTTOM()</code>è¿”å›å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</li>
<li>å½“<code>BOTTOM()</code>å‡½æ•°ä¸<code>INTO</code>å­å¥ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ<code>BOTTOM()</code>ä¸å…¶å®ƒcnosQLå‡½æ•°ä¸åŒã€‚è¯·æŸ¥çœ‹<code>BOTTOM()</code>çš„å¸¸è§é—®é¢˜ç« èŠ‚è·å¾—æ›´å¤šä¿¡æ¯ã€‚</li>
</ul>
<h4 id="ç¤ºä¾‹-9"><a class="header" href="#ç¤ºä¾‹-9">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,3) FROM &quot;air&quot;
name: air
time                 bottom
----                 ------
2021-08-31T16:18:00Z 50
2021-08-31T17:09:00Z 50
2021-08-31T18:39:00Z 50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field-keyçš„æœ€å°å€¼"><a class="header" href="#é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field-keyçš„æœ€å°å€¼">é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field keyçš„æœ€å°å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,&quot;station&quot;,2) FROM &quot;air&quot;
name: air
time                 bottom station
----                 ------ -------
2021-08-31T16:18:00Z 50     XiaoMaiDao
2021-08-31T18:39:00Z 50     LianYunGang
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›tag key <code>station</code>çš„ä¸¤ä¸ªtag valueå¯¹åº”çš„field key <code>temperature</code>çš„æœ€å°å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å°çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,4),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 bottom station     pressure
----                 ------ -------     --------
2021-08-31T16:18:00Z 50     XiaoMaiDao  55
2021-08-31T17:09:00Z 50     XiaoMaiDao  63
2021-08-31T18:39:00Z 50     LianYunGang 64
2021-08-31T19:51:00Z 50     LianYunGang 62
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æœ€å°çš„å››ä¸ªå€¼ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,3),&quot;station&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:54:00Z' GROUP BY time(24m) ORDER BY time DESC
name: air
time                 bottom station
----                 ------ -------
2021-09-18T00:54:00Z 69     LianYunGang
2021-09-18T00:51:00Z 65     LianYunGang
2021-09-18T00:48:00Z 68     XiaoMaiDao
2021-09-18T00:39:00Z 53     XiaoMaiDao
2021-09-18T00:36:00Z 52     LianYunGang
2021-09-18T00:33:00Z 50     LianYunGang
2021-09-18T00:06:00Z 55     LianYunGang
2021-09-18T00:03:00Z 53     XiaoMaiDao
2021-09-18T00:00:00Z 51     LianYunGang
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´çš„æ¯ä¸ª24åˆ†é’Ÿé—´éš”å†…ï¼Œfield key <code>temperature</code>å¯¹åº”çš„æœ€å°çš„ä¸‰ä¸ªå€¼ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¸ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚è¯·æŸ¥çœ‹ä¸‹é¢ç« èŠ‚è·å¾—æ›´è¯¦ç»†çš„è¯´æ˜ã€‚</p>
<h4 id="bottomçš„å¸¸è§é—®é¢˜"><a class="header" href="#bottomçš„å¸¸è§é—®é¢˜"><code>BOTTOM()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="bottomå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><a class="header" href="#bottomå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><code>BOTTOM()</code>å’Œ<code>GROUP BY time()</code>å­å¥åŒæ—¶ä½¿ç”¨</a></h4>
</li>
</ul>
<p>å¯¹äºåŒæ—¶å¸¦æœ‰<code>BOTTOM()</code>å’Œ<code>GROUP BY time()</code>å­å¥çš„æŸ¥è¯¢ï¼Œå°†è¿”å›æ¯ä¸ª<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„æŒ‡å®šä¸ªæ•°çš„<code>point</code>ã€‚å¯¹äºå¤§å¤šæ•°<code>GROUP BY time()</code>æŸ¥è¯¢ï¼Œè¿”å›çš„æ—¶é—´æˆ³è¡¨ç¤º<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œä½†æ˜¯ï¼Œå¸¦æœ‰<code>BOTTOM()</code>å‡½æ•°çš„<code>GROUP BY time()</code>æŸ¥è¯¢åˆ™ä¸ä¸€æ ·ï¼Œå®ƒä»¬ä¿ç•™åŸå§‹<code>point</code>çš„æ—¶é—´æˆ³ã€‚</p>
<p>ä»¥ä¸‹æŸ¥è¯¢è¿”å›æ¯18åˆ†é’Ÿ<code>GROUP BY time()</code>é—´éš”å¯¹åº”çš„ä¸¤ä¸ª<code>point</code>ã€‚è¯·æ³¨æ„ï¼Œè¿”å›çš„æ—¶é—´æˆ³æ˜¯<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ï¼›å®ƒä»¬ä¸ä¼šè¢«å¼ºåˆ¶è¦æ±‚å¿…é¡»åŒ¹é…<code>GROUP BY time()</code>é—´éš”çš„å¼€å§‹æ—¶é—´ã€‚</p>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,2) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(18m)
name: air
time                   bottom
----                   ------
                           __
2021-09-28T00:00:00Z  2.064 |
2021-09-18T00:12:00Z  2.028 | &lt;------- Smallest points for the first time interval
                           --
                           __
2021-09-18T00:24:00Z  2.041 |
2021-09-18T00:30:00Z  2.051 | &lt;------- Smallest points for the second time interval                      --
</code></pre>
<ul>
<li>
<h4 id="bottomå’Œå…·æœ‰å°‘äºnä¸ªtag-valueçš„tag-key"><a class="header" href="#bottomå’Œå…·æœ‰å°‘äºnä¸ªtag-valueçš„tag-key"><code>BOTTOM()</code>å’Œå…·æœ‰å°‘äºNä¸ªtag valueçš„tag key</a></h4>
</li>
</ul>
<p>ä½¿ç”¨è¯­æ³•<code>SELECT BOTTOM(&lt;field_key&gt;,&lt;tag_key&gt;,&lt;N&gt;)</code>çš„æŸ¥è¯¢å¯ä»¥è¿”å›æ¯”é¢„æœŸå°‘çš„<code>point</code>ã€‚å¦‚æœtag keyæœ‰<code>X</code>ä¸ªtag valueï¼Œä½†æ˜¯æŸ¥è¯¢æŒ‡å®šçš„æ˜¯<code>N</code>ä¸ªtag valueï¼Œå¦‚æœ<code>X</code>å°äº<code>N</code>ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†è¿”å›<code>X</code>ä¸ª<code>point</code>ã€‚</p>
<p>ä»¥ä¸‹æŸ¥è¯¢è¯·æ±‚çš„æ˜¯tag key <code>station</code>çš„ä¸‰ä¸ªtag valueå¯¹äºçš„<code>temperature</code>çš„æœ€å°å€¼ã€‚å› ä¸ºtag key <code>station</code>åªæœ‰ä¸¤ä¸ªtag value(<code>LianYunGang</code>å’Œ<code>XiaoMaiDao</code>)ï¼Œæ‰€ä»¥è¯¥æŸ¥è¯¢è¿”å›ä¸¤ä¸ª<code>point</code>è€Œä¸æ˜¯ä¸‰ä¸ªã€‚</p>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,&quot;station&quot;,3) FROM &quot;air&quot;
name: air
time                 bottom station
----                 ------ -------
2021-08-31T16:18:00Z 50     XiaoMaiDao
2021-08-31T18:39:00Z 50     LianYunGang
</code></pre>
<ul>
<li>
<h4 id="bottomtagå’Œintoå­å¥"><a class="header" href="#bottomtagå’Œintoå­å¥"><code>BOTTOM()</code>ã€tagå’Œ<code>INTO</code>å­å¥</a></h4>
</li>
</ul>
<p>å½“ä½¿ç”¨<code>INTO</code>å­å¥ä½†æ²¡æœ‰ä½¿ç”¨<code>GROUP BY tag</code>å­å¥æ—¶ï¼Œå¤§å¤šæ•°cnosQLå‡½æ•°å°†åŸå§‹æ•°æ®ä¸­çš„tagè½¬æ¢ä¸ºæ–°å†™å…¥æ•°æ®ä¸­çš„fieldã€‚è¿™ç§è¡Œä¸ºåŒæ ·é€‚ç”¨äº<code>BOTTOM()</code>å‡½æ•°é™¤é<code>BOTTOM()</code>ä¸­åŒ…å«tag keyä½œä¸ºå‚æ•°ï¼š<code>BOTTOM(field_key,tag_key(s),N)</code>ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šå°†æŒ‡å®šçš„tagä¿ç•™ä¸ºæ–°å†™å…¥æ•°æ®ä¸­çš„tagã€‚</p>
<p>ä¸‹é¢ä»£ç å—ä¸­çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›tag key <code>station</code>çš„ä¸¤ä¸ªtag valueå¯¹åº”çš„field key <code>temperature</code>çš„æœ€å°å€¼ï¼Œå¹¶ä¸”ï¼Œå®ƒè¿™äº›ç»“æœå†™å…¥measurement <code>bottom_temperatures</code>ä¸­ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢å±•ç¤ºäº†CnosDBå°†tag <code>station</code>ä¿ç•™ä¸ºmeasurement <code>bottom_temperatures</code>ä¸­çš„tagã€‚</p>
<pre><code class="language-sql">&gt; SELECT BOTTOM(&quot;temperature&quot;,&quot;station&quot;,2) INTO &quot;bottom_temperatures&quot; FROM &quot;air&quot;
name: result
time                 written
----                 -------
1970-01-01T00:00:00Z 2

&gt; SHOW TAG KEYS FROM &quot;air&quot;
name: air
tagKey
------
station
</code></pre>
</li>
<li>
<h3 id="first"><a class="header" href="#first">FIRST()</a></h3>
<p>è¿”å›å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<h4 id="è¯­æ³•-24"><a class="header" href="#è¯­æ³•-24">è¯­æ³•</a></h4>
<pre><code>SELECT FIRST(&lt;field_key&gt;)[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<h4 id="è¯­æ³•æè¿°-7"><a class="header" href="#è¯­æ³•æè¿°-7">è¯­æ³•æè¿°</a></h4>
<p><code>FIRST(field_key)</code>è¿”å›field keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>FIRST(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>FIRST(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>FIRST(field_key),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueï¼Œä»¥åŠç›¸å…³çš„tagæˆ–fieldã€‚</p>
<p><code>FIRST()</code>æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-10"><a class="header" href="#ç¤ºä¾‹-10">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FIRST(&quot;pressure&quot;) FROM &quot;air&quot;
name: air
time                 first
----                 -----
2021-08-31T16:00:00Z 78
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>pressure</code>å¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FIRST(*) FROM &quot;air&quot;

name: air
time                 first_pressure first_temperature first_visibility
----                 -------------- ----------------- ----------------
1970-01-01T00:00:00Z 78             79                71
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚measurement <code>air</code>ä¸­æœ‰ä¸¤ä¸ªfield keyï¼š<code>pressure</code>å’Œ<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-value">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FIRST(/temp/) FROM &quot;air&quot;

name: air
time                 first_temperature
----                 -----------------
2021-08-31T16:00:00Z 79
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªåŒ…å«å•è¯<code>level</code>çš„field keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FIRST(&quot;pressure&quot;),&quot;station&quot;,&quot;temperature&quot; FROM &quot;air&quot;
name: air
time                 first station     temperature
----                 ----- -------     -----------
2021-08-31T16:00:00Z 78    LianYunGang 63
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>pressure</code>å¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>temperature</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueå¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FIRST(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:54:00Z' GROUP BY time(12m),* fill(9.01) LIMIT 4 SLIMIT 1
name: air
tags: station=LianYunGang
time                 first
----                 -----
2021-09-18T00:00:00Z 51
2021-09-18T00:12:00Z 63
2021-09-18T00:24:00Z 70
2021-09-18T00:36:00Z 52
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>9.01</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º4å’Œ1ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³è¡¨ç¤ºæ¯12åˆ†é’Ÿæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2021-09-28T00:00:00Z</code>ä¹‹é—´ï¼Œæœ€åä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-18T00:24:00Z</code>å’Œ<code>2020-08-18T00:36:00Z</code>ä¹‹é—´ã€‚</p>
</li>
<li>
<h3 id="last"><a class="header" href="#last">LAST()</a></h3>
<p>è¿”å›å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<h4 id="è¯­æ³•-25"><a class="header" href="#è¯­æ³•-25">è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT LAST(&lt;field_key&gt;)[,&lt;tag_key(s)&gt;|&lt;field_keys(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>LAST(field_key)</code>è¿”å›field keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>LAST(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>LAST(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<p><code>LAST(field_key),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueï¼Œä»¥åŠç›¸å…³çš„tagæˆ–fieldã€‚</p>
<p><code>LAST()</code>æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-11"><a class="header" href="#ç¤ºä¾‹-11">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LAST(&quot;pressure&quot;) FROM &quot;air&quot;
name: air
time                 last
----                 ----
2021-09-30T04:00:00Z 65
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>pressure</code>å¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LAST(*) FROM &quot;air&quot;
name: air
time                 last_pressure last_temperature last_visibility
----                 ------------- ---------------- ---------------
1970-01-01T00:00:00Z 65            59               78
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚measurement <code>air</code>ä¸­æœ‰ä¸¤ä¸ªfield keyï¼š<code>pressure</code>å’Œ<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-value">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LAST(/temp/) FROM &quot;air&quot;
name: air
time                 last_temperature
----                 ----------------
2021-09-30T04:00:00Z 59
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªåŒ…å«å•è¯<code>level</code>çš„field keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LAST(&quot;pressure&quot;),&quot;station&quot;,&quot;temperature&quot; FROM &quot;air&quot;
name: air
time                 last station     temperature
----                 ---- -------     -----------
2021-09-30T04:00:00Z 65   LianYunGang 50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>pressure</code>å¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>temperature</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueå¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LAST(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:54:00Z' GROUP BY time(12m),* fill(9.01) LIMIT 4 SLIMIT 1
name: air
tags: station=LianYunGang
time                 last
----                 ----
2021-09-18T00:00:00Z 55
2021-09-18T00:12:00Z 68
2021-09-18T00:24:00Z 50
2021-09-18T00:36:00Z 58
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„å…·æœ‰æœ€æ–°æ—¶é—´æˆ³çš„field valueï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>9.01</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º4å’Œ1ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³è¡¨ç¤ºæ¯12åˆ†é’Ÿæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2021-09-28T00:00:00Z</code>ä¹‹é—´ï¼Œæœ€åä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-18T00:24:00Z</code>å’Œ<code>2020-08-18T00:36:00Z</code>ä¹‹é—´ã€‚</p>
</li>
<li>
<h3 id="max"><a class="header" href="#max">MAX()</a></h3>
<p>è¿”å›field valueçš„æœ€å¤§å€¼ã€‚</p>
<h4 id="è¯­æ³•-26"><a class="header" href="#è¯­æ³•-26">è¯­æ³•</a></h4>
<pre><code>SELECT MAX(&lt;field_key&gt;)[,&lt;tag_key(s)&gt;|&lt;field__key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>MAX(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚</p>
<p><code>MAX(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚</p>
<p><code>MAX(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚</p>
<p><code>MAX(field_key),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ï¼Œä»¥åŠç›¸å…³çš„tagæˆ–fieldã€‚</p>
<p><code>MAX()</code> æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-12"><a class="header" href="#ç¤ºä¾‹-12">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 max
----                 ---
2021-08-31T18:03:00Z 80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MAX(*) FROM &quot;air&quot;
name: air
time                 max_pressure max_temperature max_visibility
----                 ------------ --------------- --------------
1970-01-01T00:00:00Z 80           80              80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MAX(/pres/) FROM &quot;air&quot;
name: air
time                 max_pressure
----                 ------------
2021-08-31T17:03:00Z 80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 max station     pressure
----                 --- -------     --------
2021-08-31T18:03:00Z 80  LianYunGang 74
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å¤§å€¼ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å¤§å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å¤§å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:54:00Z' GROUP BY time(12m),* fill(9.01) LIMIT 4 SLIMIT 1
name: air
tags: station=LianYunGang
time                 max
----                 ---
2021-09-18T00:00:00Z 60
2021-09-18T00:12:00Z 79
2021-09-18T00:24:00Z 79
2021-09-18T00:36:00Z 70
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å¤§å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>9.01</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º4å’Œ1ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³è¡¨ç¤ºæ¯12åˆ†é’Ÿæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2021-09-28T00:00:00Z</code>ä¹‹é—´ï¼Œæœ€åä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-18T00:24:00Z</code>å’Œ<code>2020-08-18T00:36:00Z</code>ä¹‹é—´ã€‚</p>
</li>
<li>
<h3 id="min"><a class="header" href="#min">MIN()</a></h3>
<p>è¿”å›field valueçš„æœ€å°å€¼ã€‚</p>
<h4 id="è¯­æ³•-27"><a class="header" href="#è¯­æ³•-27">è¯­æ³•</a></h4>
<pre><code>SELECT MIN(&lt;field_key&gt;)[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>MIN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚</p>
<p><code>MIN(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚</p>
<p><code>MIN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚</p>
<p><code>MIN(field_key),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ï¼Œä»¥åŠç›¸å…³çš„tagå’Œ/æˆ–fieldã€‚</p>
<p><code>MIN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-13"><a class="header" href="#ç¤ºä¾‹-13">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 min
----                 ---
2021-08-31T16:18:00Z 50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(*) FROM &quot;air&quot;

name: air
time                 min_pressure min_temperature min_visibility
----                 ------------ --------------- --------------
1970-01-01T00:00:00Z 50           50              50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(/temp/) FROM &quot;air&quot;

name: air
time                 min_temperature
----                 ---------------
2021-08-31T16:18:00Z 50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼ä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(&quot;temperature&quot;),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 min station    pressure
----                 --- -------    --------
2021-08-31T16:18:00Z 50  XiaoMaiDao 55
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å°å€¼ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æœ€å°å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æœ€å°å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:54:00Z' GROUP BY time(12m),* fill(9.01) LIMIT 4 SLIMIT 1
name: air
tags: station=LianYunGang
time                 min
----                 ---
2021-09-18T00:00:00Z 51
2021-09-18T00:12:00Z 63
2021-09-18T00:24:00Z 50
2021-09-18T00:36:00Z 52
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æœ€å°å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å’Œæ¯ä¸ªtagè¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>9.01</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°å’Œseriesä¸ªæ•°åˆ†åˆ«é™åˆ¶ä¸º4å’Œ1ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³è¡¨ç¤ºæ¯12åˆ†é’Ÿæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2021-09-28T00:00:00Z</code>ä¹‹é—´ï¼Œæœ€åä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-18T00:24:00Z</code>å’Œ<code>2020-08-18T00:36:00Z</code>ä¹‹é—´ã€‚</p>
</li>
<li>
<h3 id="percentile"><a class="header" href="#percentile">PERCENTILE()</a></h3>
<p>è¿”å›ç¬¬Nä¸ªç™¾åˆ†ä½æ•°çš„<code>field value</code></p>
<h4 id="è¯­æ³•-28"><a class="header" href="#è¯­æ³•-28">è¯­æ³•</a></h4>
<pre><code>SELECT PERCENTILE(&lt;field_key&gt;, &lt;N&gt;)[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>PERCENTILE(field_key,N)</code>è¿”å›æŒ‡å®šfield keyå¯¹åº”çš„ç¬¬Nä¸ªç™¾åˆ†ä½æ•°çš„field valueã€‚</p>
<p><code>PERCENTILE(/regular_expression/,N)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„ç¬¬Nä¸ªç™¾åˆ†ä½æ•°çš„field valueã€‚</p>
<p><code>PERCENTILE(*,N)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„ç¬¬Nä¸ªç™¾åˆ†ä½æ•°çš„field valueã€‚</p>
<p><code>PERCENTILE(field_key,N),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„ç¬¬Nä¸ªç™¾åˆ†ä½æ•°çš„field valueï¼Œä»¥åŠç›¸å…³çš„tagå’Œ/æˆ–fieldã€‚</p>
<p><code>N</code>å¿…é¡»æ˜¯0åˆ°100ä¹‹é—´çš„æ•´æ•°æˆ–æµ®ç‚¹æ•°ã€‚</p>
<p><code>PERCENTILE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-14"><a class="header" href="#ç¤ºä¾‹-14">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT PERCENTILE(&quot;temperature&quot;,5) FROM &quot;air&quot;

name: air
time                 percentile
----                 ----------
2021-09-03T23:51:00Z 51
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›çš„field valueå¤§äºmeasurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æ‰€æœ‰field valueä¸­çš„ç™¾åˆ†ä¹‹äº”ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT PERCENTILE(*,5) FROM &quot;air&quot;

name: air
time                 percentile_pressure percentile_temperature percentile_visibility
----                 ------------------- ---------------------- ---------------------
1970-01-01T00:00:00Z 51                  51                     51
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›çš„field valueå¤§äºmeasurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„æ‰€æœ‰field valueä¸­çš„ç™¾åˆ†ä¹‹äº”ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-value">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field value</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT PERCENTILE(/visi/,5) FROM &quot;air&quot;
name: air
time                 percentile_visibility
----                 ---------------------
2021-09-29T09:54:00Z 51
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›çš„field valueå¤§äºmeasurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„æ‰€æœ‰field valueä¸­çš„ç™¾åˆ†ä¹‹äº”ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field-valueä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„ç¬¬äº”ä¸ªç™¾åˆ†ä½æ•°çš„field valueä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT PERCENTILE(&quot;temperature&quot;,5),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 percentile station    pressure
----                 ---------- -------    --------
2021-09-03T23:51:00Z 51         XiaoMaiDao 65
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›çš„field valueå¤§äºmeasurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æ‰€æœ‰field valueä¸­çš„ç™¾åˆ†ä¹‹äº”ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬20ä¸ªç™¾åˆ†ä½æ•°çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„ç¬¬20ä¸ªç™¾åˆ†ä½æ•°çš„field-valueå¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„ç¬¬20ä¸ªç™¾åˆ†ä½æ•°çš„field valueå¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT PERCENTILE(&quot;temperature&quot;,20) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:54:00Z' GROUP BY time(24m) fill(15) LIMIT 2
name: air
time                 percentile
----                 ----------
2020-08-17T23:36:00Z 15
2020-08-18T00:00:00Z 15
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›çš„field valueå¤§äºmeasurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æ‰€æœ‰field valueä¸­çš„ç™¾åˆ†ä¹‹äºŒåï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-08-17T23:48:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰24åˆ†é’Ÿçš„æ—¶é—´é—´éš”è¿›è¡Œåˆ†ç»„ï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢ç”¨<code>15</code>å¡«å……æ²¡æœ‰æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º2ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³è¡¨ç¤ºæ¯24åˆ†é’Ÿæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2020-08-17T23:36:00Z</code>å’Œ<code>2021-09-28T00:00:00Z</code>ä¹‹é—´ï¼Œæœ€åä¸€ä¸ª<code>point</code>æ¶µç›–çš„æ—¶é—´é—´éš”åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2020-08-18T00:24:00Z</code>ä¹‹é—´ã€‚</p>
<h4 id="percentileçš„å¸¸è§é—®é¢˜"><a class="header" href="#percentileçš„å¸¸è§é—®é¢˜"><code>PERCENTILE()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="percentile-vs-å…¶å®ƒcnosqlå‡½æ•°"><a class="header" href="#percentile-vs-å…¶å®ƒcnosqlå‡½æ•°"><code>PERCENTILE()</code> vs å…¶å®ƒcnosQLå‡½æ•°</a></h4>
</li>
</ul>
<ul>
<li><code>PERCENTILE(&lt;field_key&gt;,100)</code>ç›¸å½“äº<code>MAX(&lt;field_key&gt;)</code>ã€‚</li>
<li><code>PERCENTILE(&lt;field_key&gt;, 50)</code>è¿‘ä¼¼äº<code>MEDIAN(&lt;field_key&gt;)</code>ï¼Œé™¤éfield keyåŒ…å«çš„field valueæœ‰å¶æ•°ä¸ªï¼Œé‚£ä¹ˆè¿™æ—¶å€™<code>MEDIAN()</code>å°†è¿”å›ä¸¤ä¸ªä¸­é—´å€¼çš„å¹³å‡æ•°ã€‚</li>
<li><code>PERCENTILE(&lt;field_key&gt;,0)</code>ä¸ç­‰äº<code>MIN(&lt;field_key&gt;)</code>ï¼Œ<code>PERCENTILE(&lt;field_key&gt;,0)</code>ä¼šè¿”å›<code>null</code>ã€‚</li>
</ul>
</li>
<li>
<h3 id="sample"><a class="header" href="#sample">SAMPLE()</a></h3>
<p>è¿”å›åŒ…å«Nä¸ªfield valueçš„éšæœºæ ·æœ¬ã€‚<code>SAMPLE()</code>ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Reservoir_sampling">reservoir sampling</a>æ¥ç”Ÿæˆéšæœº<code>point</code>ã€‚</p>
<h4 id="è¯­æ³•-29"><a class="header" href="#è¯­æ³•-29">è¯­æ³•</a></h4>
<pre><code>SELECT SAMPLE(&lt;field_key&gt;, &lt;N&gt;)[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>SAMPLE(field_key,N)</code>è¿”å›æŒ‡å®šfield keyå¯¹åº”çš„Nä¸ªéšæœºé€‰æ‹©çš„field valueã€‚</p>
<p><code>SAMPLE(/regular_expression/,N)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„Nä¸ªéšæœºé€‰æ‹©çš„field valueã€‚</p>
<p><code>SAMPLE(*,N)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„Nä¸ªéšæœºé€‰æ‹©çš„field valueã€‚</p>
<p><code>SAMPLE(field_key,N),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„Nä¸ªéšæœºé€‰æ‹©çš„field valueï¼Œä»¥åŠç›¸å…³çš„tagå’Œ/æˆ–fieldã€‚</p>
<p><code>N</code>å¿…é¡»æ˜¯æ•´æ•°ã€‚</p>
<p><code>SAMPLE()</code>æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-15"><a class="header" href="#ç¤ºä¾‹-15">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„éšæœºæ ·æœ¬</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SAMPLE(&quot;temperature&quot;,2) FROM &quot;air&quot;
name: air
time                 sample
----                 ------
2021-09-07T02:18:00Z 77
2021-09-13T12:00:00Z 62
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„ä¸¤ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬"><a class="header" href="#é€‰æ‹©measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬">é€‰æ‹©measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éšæœºæ ·æœ¬</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SAMPLE(*,2) FROM &quot;air&quot;
name: air
time                 sample_pressure sample_temperature sample_visibility
----                 --------------- ------------------ -----------------
2021-08-31T16:18:00Z                 52                 
2021-09-03T14:33:00Z 74                                 
2021-09-12T19:39:00Z 59                                 
2021-09-17T11:33:00Z                 51                 
2021-09-20T04:09:00Z                                    50
2021-09-22T19:15:00Z                                    80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªfield keyå¯¹åº”çš„ä¸¤ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ã€‚measurement <code>air</code>ä¸­æœ‰ä¸¤ä¸ªfield keyï¼š<code>pressure</code>å’Œ<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬"><a class="header" href="#é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬">é€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éšæœºæ ·æœ¬</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SAMPLE(/pres/,2) FROM &quot;air&quot;
name: air
time                 sample_pressure
----                 ---------------
2021-09-25T20:27:00Z 77
2021-09-26T20:33:00Z 52
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªåŒ…å«å•è¯<code>level</code>çš„field keyå¯¹åº”çš„ä¸¤ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬ä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„éšæœºæ ·æœ¬ä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„éšæœºæ ·æœ¬ä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SAMPLE(&quot;temperature&quot;,2),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 sample station     pressure
----                 ------ -------     --------
2021-09-09T00:03:00Z 71     LianYunGang 61
2021-09-11T01:39:00Z 53     LianYunGang 51
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„ä¸¤ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”field-valueçš„éšæœºæ ·æœ¬å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”field-valueçš„éšæœºæ ·æœ¬å¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”field valueçš„éšæœºæ ·æœ¬å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SAMPLE(&quot;temperature&quot;,1) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(18m)
name: air
time                 sample
----                 ------
2021-09-18T00:09:00Z 55
2021-09-18T00:27:00Z 79
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„ä¸€ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœæŒ‰18åˆ†é’Ÿçš„æ—¶é—´é—´éš”è¿›è¡Œåˆ†ç»„ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¸ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚è¯·æŸ¥çœ‹ä¸‹é¢ç« èŠ‚è·å¾—æ›´è¯¦ç»†çš„è¯´æ˜ã€‚</p>
<h4 id="sampleçš„å¸¸è§é—®é¢˜"><a class="header" href="#sampleçš„å¸¸è§é—®é¢˜"><code>SAMPLE()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="sampleå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><a class="header" href="#sampleå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><code>SAMPLE()</code>å’Œ<code>GROUP BY time()</code>å­å¥åŒæ—¶ä½¿ç”¨</a></h4>
</li>
</ul>
<p>å¯¹äºåŒæ—¶å¸¦æœ‰<code>SAMPLE()</code>å’Œ<code>GROUP BY time()</code>å­å¥çš„æŸ¥è¯¢ï¼Œå°†è¿”å›æ¯ä¸ª<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„æŒ‡å®šä¸ªæ•°(<code>N</code>)çš„<code>point</code>ã€‚å¯¹äºå¤§å¤šæ•°<code>GROUP BY time()</code>æŸ¥è¯¢ï¼Œè¿”å›çš„æ—¶é—´æˆ³è¡¨ç¤º<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œä½†æ˜¯ï¼Œå¸¦æœ‰<code>SAMPLE()</code>å‡½æ•°çš„<code>GROUP BY time()</code>æŸ¥è¯¢åˆ™ä¸ä¸€æ ·ï¼Œå®ƒä»¬ä¿ç•™åŸå§‹<code>point</code>çš„æ—¶é—´æˆ³ã€‚</p>
<p>ä»¥ä¸‹æŸ¥è¯¢è¿”å›æ¯18åˆ†é’Ÿ<code>GROUP BY time()</code>é—´éš”å¯¹åº”çš„ä¸¤ä¸ªéšæœºé€‰æ‹©çš„<code>point</code>ã€‚è¯·æ³¨æ„ï¼Œè¿”å›çš„æ—¶é—´æˆ³æ˜¯<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ï¼›å®ƒä»¬ä¸ä¼šè¢«å¼ºåˆ¶è¦æ±‚å¿…é¡»åŒ¹é…<code>GROUP BY time()</code>é—´éš”çš„å¼€å§‹æ—¶é—´ã€‚</p>
<pre><code class="language-sql">&gt; SELECT SAMPLE(&quot;temperature&quot;,2) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(18m)
name: air
time                   sample
----                   ------
                           __
2021-09-18T00:09:00Z      55   |
2021-09-18T00:12:00Z      63   | &lt;------- Randomly-selected points for the first time interval
                           --
                           __
2021-09-18T00:18:00Z      79  |
2021-09-18T00:21:00Z      68  | &lt;------- Randomly-selected points for the second time interval
                           --
</code></pre>
</li>
<li>
<h3 id="top"><a class="header" href="#top">TOP()</a></h3>
<p>è¿”å›æœ€å¤§çš„Nä¸ªfield value</p>
<h4 id="è¯­æ³•-30"><a class="header" href="#è¯­æ³•-30">è¯­æ³•</a></h4>
<pre><code>SELECT TOP( &lt;field_key&gt;[,&lt;tag_key(s)&gt;],&lt;N&gt; )[,&lt;tag_key(s)&gt;|&lt;field_key(s)&gt;] [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>TOP(field_key,N)</code>è¿”å›field keyå¯¹åº”çš„æœ€å¤§çš„Nä¸ªå€¼ã€‚</p>
<p><code>TOP(field_key,tag_key(s),N)</code>è¿”å›tag keyçš„Nä¸ªtag valueå¯¹åº”çš„field keyçš„æœ€å¤§å€¼ã€‚</p>
<p><code>TOP(field_key,N),tag_key(s),field_key(s)</code>è¿”å›æ‹¬å·ä¸­çš„field keyå¯¹åº”çš„æœ€å¤§çš„Nä¸ªå€¼ï¼Œä»¥åŠç›¸å…³çš„tagå’Œ/æˆ–fieldã€‚</p>
<p><code>TOP()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>å¦‚æœæœ€å¤§å€¼æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªå¹¶ä¸”å®ƒä»¬ä¹‹é—´æœ‰å…³è”ï¼Œ<code>TOP()</code>è¿”å›å…·æœ‰æœ€æ—©æ—¶é—´æˆ³çš„field valueã€‚</li>
</ul>
<h4 id="ç¤ºä¾‹-16"><a class="header" href="#ç¤ºä¾‹-16">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,3) FROM &quot;air&quot;
name: air
time                 top
----                 ---
2021-08-31T18:03:00Z 80
2021-08-31T18:18:00Z 80
2021-08-31T18:57:00Z 80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field-keyçš„æœ€å¤§å€¼"><a class="header" href="#é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field-keyçš„æœ€å¤§å€¼">é€‰æ‹©ä¸¤ä¸ªtagå¯¹åº”çš„field keyçš„æœ€å¤§å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,&quot;station&quot;,2) FROM &quot;air&quot;
name: air
time                 top station
----                 --- -------
2021-08-31T18:03:00Z 80  LianYunGang
2021-08-31T18:18:00Z 80  XiaoMaiDao
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›tag key <code>station</code>çš„ä¸¤ä¸ªtag valueå¯¹åº”çš„field key <code>temperature</code>çš„æœ€å¤§å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å¤§çš„å››ä¸ªå€¼ä»¥åŠç›¸å…³çš„tagå’Œfield</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,4),&quot;station&quot;,&quot;pressure&quot; FROM &quot;air&quot;
name: air
time                 top station     pressure
----                 --- -------     --------
2021-08-31T18:03:00Z 80  LianYunGang 74
2021-08-31T18:18:00Z 80  XiaoMaiDao  53
2021-08-31T18:57:00Z 80  LianYunGang 51
2021-08-31T20:15:00Z 80  XiaoMaiDao  53
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æœ€å¤§çš„å››ä¸ªå€¼ï¼Œä»¥åŠç›¸å…³çš„tag key <code>station</code>å’Œfield key <code>pressure</code>çš„å€¼ã€‚</p>
<ul>
<li>
<h4 id="é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#é€‰æ‹©æŒ‡å®šfield-keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">é€‰æ‹©æŒ‡å®šfield keyå¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,3),&quot;station&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:54:00Z' GROUP BY time(24m) ORDER BY time DESC
name: air
time                 top station
----                 --- -------
2021-09-18T00:54:00Z 79  XiaoMaiDao
2021-09-18T00:51:00Z 71  XiaoMaiDao
2021-09-18T00:48:00Z 77  LianYunGang
2021-09-18T00:30:00Z 75  LianYunGang
2021-09-18T00:27:00Z 79  LianYunGang
2021-09-18T00:24:00Z 70  LianYunGang
2021-09-18T00:18:00Z 79  LianYunGang
2021-09-18T00:09:00Z 80  XiaoMaiDao
2021-09-18T00:00:00Z 77  XiaoMaiDao
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2020-08-18T00:54:00Z</code>ä¹‹é—´çš„æ¯ä¸ª24åˆ†é’Ÿé—´éš”å†…ï¼Œfield key <code>temperature</code>å¯¹åº”çš„æœ€å¤§çš„ä¸‰ä¸ªå€¼ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>GROUP BY time()</code>å­å¥ä¸ä¼šè¦†ç›–<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ã€‚è¯·æŸ¥çœ‹ä¸‹é¢ç« èŠ‚è·å¾—æ›´è¯¦ç»†çš„è¯´æ˜ã€‚</p>
<h4 id="topçš„å¸¸è§é—®é¢˜"><a class="header" href="#topçš„å¸¸è§é—®é¢˜"><code>TOP()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="topå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><a class="header" href="#topå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><code>TOP()</code>å’Œ<code>GROUP BY time()</code>å­å¥åŒæ—¶ä½¿ç”¨</a></h4>
</li>
</ul>
<p>å¯¹äºåŒæ—¶å¸¦æœ‰<code>TOP()</code>å’Œ<code>GROUP BY time()</code>å­å¥çš„æŸ¥è¯¢ï¼Œå°†è¿”å›æ¯ä¸ª<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„æŒ‡å®šä¸ªæ•°çš„<code>point</code>ã€‚å¯¹äºå¤§å¤šæ•°<code>GROUP BY time()</code>æŸ¥è¯¢ï¼Œè¿”å›çš„æ—¶é—´æˆ³è¡¨ç¤º<code>GROUP BY time()</code>æ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ï¼Œä½†æ˜¯ï¼Œå¸¦æœ‰<code>TOP()</code>å‡½æ•°çš„<code>GROUP BY time()</code>æŸ¥è¯¢åˆ™ä¸ä¸€æ ·ï¼Œå®ƒä»¬ä¿ç•™åŸå§‹<code>point</code>çš„æ—¶é—´æˆ³ã€‚</p>
<p>ä»¥ä¸‹æŸ¥è¯¢è¿”å›æ¯18åˆ†é’Ÿ<code>GROUP BY time()</code>é—´éš”å¯¹åº”çš„ä¸¤ä¸ª<code>point</code>ã€‚è¯·æ³¨æ„ï¼Œè¿”å›çš„æ—¶é—´æˆ³æ˜¯<code>point</code>çš„åŸå§‹æ—¶é—´æˆ³ï¼›å®ƒä»¬ä¸ä¼šè¢«å¼ºåˆ¶è¦æ±‚å¿…é¡»åŒ¹é…<code>GROUP BY time()</code>é—´éš”çš„å¼€å§‹æ—¶é—´ã€‚</p>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,2) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(18m)

name: air
time                   top
----                   ------
                        __
2021-09-18T00:12:00Z    63   |
2021-09-18T00:15:00Z    74   | &lt;------- Greatest points for the first time interval
                        --
                        __
2021-09-18T00:18:00Z    79   |
2021-09-18T00:27:00Z   79    | &lt;------- Greatest points for the second time interval
                        --
</code></pre>
<ul>
<li>
<h4 id="topå’Œå…·æœ‰å°‘äºnä¸ªtag-valueçš„tag-key"><a class="header" href="#topå’Œå…·æœ‰å°‘äºnä¸ªtag-valueçš„tag-key"><code>TOP()</code>å’Œå…·æœ‰å°‘äºNä¸ªtag valueçš„tag key</a></h4>
</li>
</ul>
<p>ä½¿ç”¨è¯­æ³•<code>SELECT TOP(&lt;field_key&gt;,&lt;tag_key&gt;,&lt;N&gt;)</code>çš„æŸ¥è¯¢å¯ä»¥è¿”å›æ¯”é¢„æœŸå°‘çš„<code>point</code>ã€‚å¦‚æœtag keyæœ‰<code>X</code>ä¸ªtag valueï¼Œä½†æ˜¯æŸ¥è¯¢æŒ‡å®šçš„æ˜¯<code>N</code>ä¸ªtag valueï¼Œå¦‚æœ<code>X</code>å°äº<code>N</code>ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†è¿”å›<code>X</code>ä¸ª<code>point</code>ã€‚</p>
<p>ä»¥ä¸‹æŸ¥è¯¢è¯·æ±‚çš„æ˜¯tag key <code>station</code>çš„ä¸‰ä¸ªtag valueå¯¹äºçš„<code>temperature</code>çš„æœ€å¤§å€¼ã€‚å› ä¸ºtag key <code>station</code>åªæœ‰ä¸¤ä¸ªtag value(<code>LianYunGang</code>å’Œ<code>XiaoMaiDao</code>)ï¼Œæ‰€ä»¥è¯¥æŸ¥è¯¢è¿”å›ä¸¤ä¸ª<code>point</code>è€Œä¸æ˜¯ä¸‰ä¸ªã€‚</p>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,&quot;station&quot;,3) FROM &quot;air&quot;
name: air
time                 top station
----                 --- -------
2021-08-31T18:03:00Z 80  LianYunGang
2021-08-31T18:18:00Z 80  XiaoMaiDao
</code></pre>
<ul>
<li>
<h4 id="toptagå’Œintoå­å¥"><a class="header" href="#toptagå’Œintoå­å¥"><code>TOP()</code>ã€tagå’Œ<code>INTO</code>å­å¥</a></h4>
</li>
</ul>
<p>å½“ä½¿ç”¨<code>INTO</code>å­å¥ä½†æ²¡æœ‰ä½¿ç”¨<code>GROUP BY tag</code>å­å¥æ—¶ï¼Œå¤§å¤šæ•°cnosQLå‡½æ•°å°†åŸå§‹æ•°æ®ä¸­çš„tagè½¬æ¢ä¸ºæ–°å†™å…¥æ•°æ®ä¸­çš„fieldã€‚è¿™ç§è¡Œä¸ºåŒæ ·é€‚ç”¨äº<code>TOP()</code>å‡½æ•°ï¼Œé™¤é<code>TOP()</code>ä¸­åŒ…å«tag keyä½œä¸ºå‚æ•°ï¼š<code>TOP(field_key,tag_key(s),N)</code>ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šå°†æŒ‡å®šçš„tagä¿ç•™ä¸ºæ–°å†™å…¥æ•°æ®ä¸­çš„tagã€‚</p>
<p>ä¸‹é¢ä»£ç å—ä¸­çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›tag key <code>station</code>çš„ä¸¤ä¸ªtag valueå¯¹åº”çš„field key <code>temperature</code>çš„æœ€å¤§å€¼ï¼Œå¹¶ä¸”ï¼Œå®ƒè¿™äº›ç»“æœå†™å…¥measurement <code>top_temperatures</code>ä¸­ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢å±•ç¤ºäº†CnosDBå°†tag <code>station</code>ä¿ç•™ä¸ºmeasurement <code>top_temperatures</code>ä¸­çš„tagã€‚</p>
<pre><code class="language-sql">&gt; SELECT TOP(&quot;temperature&quot;,&quot;station&quot;,2) INTO &quot;top_temperatures&quot; FROM &quot;air&quot;
name: result
time                 written
----                 -------
1970-01-01T00:00:00Z 2

&gt; SHOW TAG KEYS FROM &quot;top_temperatures&quot;
name: top_temperatures
tagKey
------
station
</code></pre>
</li>
</ul>
<h3 id="è½¬æ¢å‡½æ•°"><a class="header" href="#è½¬æ¢å‡½æ•°">è½¬æ¢å‡½æ•°</a></h3>
<ul>
<li>
<h3 id="abs"><a class="header" href="#abs">ABS()</a></h3>
<p>è¿”å›field valueçš„ç»å¯¹å€¼</p>
<h4 id="åŸºæœ¬è¯­æ³•"><a class="header" href="#åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ABS( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ABS(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼ã€‚</p>
<p><code>ABS(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼ã€‚</p>
<p><code>ABS()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ABS()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-17"><a class="header" href="#ç¤ºä¾‹-17">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T12:05:00Z'
name: air
time                 pressure station     temperature visibility
----                 -------- -------     ----------- ----------
2021-09-24T12:00:00Z 76       LianYunGang 61          59
2021-09-24T12:00:00Z 58       XiaoMaiDao  52          77
2021-09-24T12:03:00Z 64       LianYunGang 57          72
2021-09-24T12:03:00Z 50       XiaoMaiDao  70          77
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ABS(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T12:05:00Z'
name: air
time                 abs
----                 ---
2021-09-24T12:00:00Z 76
2021-09-24T12:00:00Z 58
2021-09-24T12:03:00Z 64
2021-09-24T12:03:00Z 50
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>data</code>ä¸­field key <code>a</code>å¯¹åº”çš„field valueçš„ç»å¯¹å€¼ã€‚</p>
</li>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼</a></h4>
<pre><code class="language-sql">&gt; SELECT ABS(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T12:05:00Z'
name: air
time                 abs_pressure abs_temperature abs_visibility
----                 ------------ --------------- --------------
2021-09-24T12:00:00Z 76           61              59
2021-09-24T12:00:00Z 58           52              77
2021-09-24T12:03:00Z 64           57              72
2021-09-24T12:03:00Z 50           70              77
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>data</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>,<code>pressure</code>å’Œ<code>visibility</code>ã€‚</p>
</li>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç»å¯¹å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ç»å¯¹å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
<pre><code class="language-sql">&gt; SELECT ABS(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T12:05:00Z' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 abs
----                 ---
2021-09-24T12:00:00Z 58
2021-09-24T12:00:00Z 76
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>data</code>ä¸­field key <code>a</code>å¯¹åº”çš„field valueçš„ç»å¯¹å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-06-24T12:00:00Z</code>å’Œ<code>2020-06-24T12:05:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•"><a class="header" href="#é«˜çº§è¯­æ³•">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ABS(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„ç»å¯¹å€¼ã€‚</p>
<p><code>ABS()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ç»å¯¹å€¼"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ç»å¯¹å€¼">è®¡ç®—å¹³å‡å€¼çš„ç»å¯¹å€¼</a></h4>
<pre><code class="language-sql">&gt; SELECT ABS(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T13:00:00Z' GROUP BY time(12m)
name: air
time                 abs
----                 ---
2021-09-24T12:00:00Z 62.75
2021-09-24T12:12:00Z 64.25
2021-09-24T12:24:00Z 66
2021-09-24T12:36:00Z 64.375
2021-09-24T12:48:00Z 63.875
2021-09-24T13:00:00Z 59.5
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>a</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„ç»å¯¹å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>a</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ABS()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-24T12:00:00Z' AND time &lt;= '2021-09-24T13:00:00Z' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-24T12:00:00Z 61.75
2021-09-24T12:12:00Z 68.25
2021-09-24T12:24:00Z 66.125
2021-09-24T12:36:00Z 58
2021-09-24T12:48:00Z 68.625
2021-09-24T13:00:00Z 71
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ç»å¯¹å€¼ã€‚</p>
</li>
<li>
<h3 id="acos"><a class="header" href="#acos">ACOS()</a></h3>
<p>è¿”å›field valueçš„åä½™å¼¦(ä»¥å¼§åº¦è¡¨ç¤º)ã€‚field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-1"><a class="header" href="#åŸºæœ¬è¯­æ³•-1">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT ACOS( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ACOS(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„åä½™å¼¦ã€‚</p>
<p><code>ACOS(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åä½™å¼¦ã€‚</p>
<p><code>ACOS()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueï¼Œå¹¶ä¸”field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ACOS()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-18"><a class="header" href="#ç¤ºä¾‹-18">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨å¦‚ä¸‹æ¨¡æ‹Ÿçš„å…¬å›­å æœ‰ç‡(ç›¸å¯¹äºæ€»ç©ºé—´)çš„æ•°æ®ã€‚éœ€è¦æ³¨æ„çš„é‡è¦äº‹é¡¹æ˜¯ï¼Œæ‰€æœ‰çš„field valueéƒ½åœ¨<code>ACOS()</code>å‡½æ•°çš„å¯è®¡ç®—èŒƒå›´é‡Œ(-1åˆ°1)ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z'
name: air
time                  capacity
----                  --------
2020-05-01T00:00:00Z  0.83
2020-05-02T00:00:00Z  0.3
2020-05-03T00:00:00Z  0.84
2020-05-04T00:00:00Z  0.22
2020-05-05T00:00:00Z  0.17
2020-05-06T00:00:00Z  0.77
2020-05-07T00:00:00Z  0.64
2020-05-08T00:00:00Z  0.72
2020-05-09T00:00:00Z  0.16
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åä½™å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ACOS(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z'
name: air
time                  acos
----                  ----
2020-05-01T00:00:00Z  0.591688642426544
2020-05-02T00:00:00Z  1.266103672779499
2020-05-03T00:00:00Z  0.5735131044230969
2020-05-04T00:00:00Z  1.3489818562981022
2020-05-05T00:00:00Z  1.399966657665792
2020-05-06T00:00:00Z  0.6919551751263169
2020-05-07T00:00:00Z  0.8762980611683406
2020-05-08T00:00:00Z  0.7669940078618667
2020-05-09T00:00:00Z  1.410105673842986
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åä½™å¼¦ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åä½™å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ACOS(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 acos_pressure acos_temperature acos_visibility
----                 ------------- ---------------- ---------------
2021-09-11T00:00:00Z                                
2021-09-11T00:00:00Z                                
2021-09-11T00:03:00Z                                
2021-09-11T00:03:00Z                                
2021-09-11T00:06:00Z                                
2021-09-11T00:06:00Z                                
2021-09-11T00:09:00Z                                
2021-09-11T00:09:00Z                                
2021-09-11T00:12:00Z                                
2021-09-11T00:12:00Z                                
2021-09-11T00:15:00Z                                
2021-09-11T00:15:00Z                                
2021-09-11T00:18:00Z                                
2021-09-11T00:18:00Z                                
2021-09-11T00:21:00Z                                
2021-09-11T00:21:00Z                                
2021-09-11T00:24:00Z                                
2021-09-11T00:24:00Z                                
2021-09-11T00:27:00Z                                
2021-09-11T00:27:00Z                                
2021-09-11T00:30:00Z                                
2021-09-11T00:30:00Z                                
2021-09-11T00:33:00Z                                
2021-09-11T00:33:00Z                                
2021-09-11T00:36:00Z                                
2021-09-11T00:36:00Z                                
2021-09-11T00:39:00Z                                
2021-09-11T00:39:00Z                                
2021-09-11T00:42:00Z                                
2021-09-11T00:42:00Z                                
2021-09-11T00:45:00Z                                
2021-09-11T00:45:00Z                                
2021-09-11T00:48:00Z                                
2021-09-11T00:48:00Z                                
2021-09-11T00:51:00Z                                
2021-09-11T00:51:00Z                                
2021-09-11T00:54:00Z                                
2021-09-11T00:54:00Z                                
2021-09-11T00:57:00Z                                
2021-09-11T00:57:00Z                                
2021-09-11T01:00:00Z                                
2021-09-11T01:00:00Z
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„åä½™å¼¦ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚ä½†ç”±äºè¿™ä¸‰ä¸ªfield keyå¯¹åº”çš„field valueè¶…è¿‡ä½™å¼¦å‡½æ•°çš„èŒƒå›´ï¼Œå› æ­¤å…¶åä½™å¼¦å€¼å¹¶ä¸å­˜åœ¨ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åä½™å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åä½™å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ACOS(temperature/100) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 acos
----                 ----
2021-09-18T23:57:00Z 0.6435011087932843
2021-09-18T23:57:00Z 0.6599873293874983
2021-09-18T23:54:00Z 0.7669940078618667
2021-09-18T23:54:00Z 1.0003592173949745
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åä½™å¼¦ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-05-01T00:00:00Z</code>å’Œ<code>2020-05-09T00:00:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-1"><a class="header" href="#é«˜çº§è¯­æ³•-1">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ACOS(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„åä½™å¼¦ã€‚</p>
<p>ACOS()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„åä½™å¼¦"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„åä½™å¼¦">è®¡ç®—å¹³å‡å€¼çš„åä½™å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ACOS(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' GROUP BY time(3d)
name: air
time                 acos
----                 ----
2021-09-09T00:00:00Z
2021-09-12T00:00:00Z
2021-09-15T00:00:00Z
2021-09-18T00:00:00Z  ã€
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„åä½™å¼¦ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ACOS()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' GROUP BY time(3d)
name: air
time                 mean
----                 ----
2021-09-09T00:00:00Z 65.26041666666667
2021-09-12T00:00:00Z 64.96944444444445
2021-09-15T00:00:00Z 65.00902777777777
2021-09-18T00:00:00Z 65.32952182952182
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„åä½™å¼¦ã€‚</p>
</li>
<li>
<h3 id="asin"><a class="header" href="#asin">ASIN()</a></h3>
<p>è¿”å›field valueçš„åæ­£å¼¦(ä»¥å¼§åº¦è¡¨ç¤º)ã€‚field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-2"><a class="header" href="#åŸºæœ¬è¯­æ³•-2">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT ASIN( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ASIN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„åæ­£å¼¦ã€‚</p>
<p><code>ASIN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åæ­£å¼¦ã€‚</p>
<p><code>ASIN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueï¼Œå¹¶ä¸”field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ASIN()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-19"><a class="header" href="#ç¤ºä¾‹-19">ç¤ºä¾‹</a></h4>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 temperature
----                 -----------
2021-09-11T00:00:00Z 74
2021-09-11T00:00:00Z 79
2021-09-11T00:03:00Z 61
2021-09-11T00:03:00Z 73
2021-09-11T00:06:00Z 72
2021-09-11T00:06:00Z 61
2021-09-11T00:09:00Z 61
2021-09-11T00:09:00Z 72
2021-09-11T00:12:00Z 52
2021-09-11T00:12:00Z 58
2021-09-11T00:15:00Z 74
2021-09-11T00:15:00Z 78
2021-09-11T00:18:00Z 67
2021-09-11T00:18:00Z 74
2021-09-11T00:21:00Z 71
2021-09-11T00:21:00Z 55
2021-09-11T00:24:00Z 66
2021-09-11T00:24:00Z 67
2021-09-11T00:27:00Z 72
2021-09-11T00:27:00Z 66
2021-09-11T00:30:00Z 61
2021-09-11T00:30:00Z 54
2021-09-11T00:33:00Z 55
2021-09-11T00:33:00Z 75
2021-09-11T00:36:00Z 65
2021-09-11T00:36:00Z 66
2021-09-11T00:39:00Z 68
2021-09-11T00:39:00Z 58
2021-09-11T00:42:00Z 59
2021-09-11T00:42:00Z 58
2021-09-11T00:45:00Z 69
2021-09-11T00:45:00Z 71
2021-09-11T00:48:00Z 69
2021-09-11T00:48:00Z 57
2021-09-11T00:51:00Z 55
2021-09-11T00:51:00Z 73
2021-09-11T00:54:00Z 69
2021-09-11T00:54:00Z 64
2021-09-11T00:57:00Z 73
2021-09-11T00:57:00Z 52
2021-09-11T01:00:00Z 59
2021-09-11T01:00:00Z 68
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åæ­£å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ASIN(temperature/100) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 asin
----                 ----
2021-09-11T00:00:00Z 0.8330703583416478
2021-09-11T00:00:00Z 0.9108089974073983
2021-09-11T00:03:00Z 0.6560605909249226
2021-09-11T00:03:00Z 0.8183219506315597
2021-09-11T00:06:00Z 0.8038023189330299
2021-09-11T00:06:00Z 0.6560605909249226
2021-09-11T00:09:00Z 0.6560605909249226
2021-09-11T00:09:00Z 0.8038023189330299
2021-09-11T00:12:00Z 0.546850950695944
2021-09-11T00:12:00Z 0.618728690672251
2021-09-11T00:15:00Z 0.8330703583416478
2021-09-11T00:15:00Z 0.8946658172342352
2021-09-11T00:18:00Z 0.7342087874533589
2021-09-11T00:18:00Z 0.8330703583416478
2021-09-11T00:21:00Z 0.7894982093461719
2021-09-11T00:21:00Z 0.5823642378687435
2021-09-11T00:24:00Z 0.7208187608700896
2021-09-11T00:24:00Z 0.7342087874533589
2021-09-11T00:27:00Z 0.8038023189330299
2021-09-11T00:27:00Z 0.7208187608700896
2021-09-11T00:30:00Z 0.6560605909249226
2021-09-11T00:30:00Z 0.570437109399922
2021-09-11T00:33:00Z 0.5823642378687435
2021-09-11T00:33:00Z 0.848062078981481
2021-09-11T00:36:00Z 0.7075844367253555
2021-09-11T00:36:00Z 0.7208187608700896
2021-09-11T00:39:00Z 0.7477626346599205
2021-09-11T00:39:00Z 0.618728690672251
2021-09-11T00:42:00Z 0.6310588407780212
2021-09-11T00:42:00Z 0.618728690672251
2021-09-11T00:45:00Z 0.7614890527476331
2021-09-11T00:45:00Z 0.7894982093461719
2021-09-11T00:48:00Z 0.7614890527476331
2021-09-11T00:48:00Z 0.6065058552130869
2021-09-11T00:51:00Z 0.5823642378687435
2021-09-11T00:51:00Z 0.8183219506315597
2021-09-11T00:54:00Z 0.7614890527476331
2021-09-11T00:54:00Z 0.6944982656265559
2021-09-11T00:57:00Z 0.8183219506315597
2021-09-11T00:57:00Z 0.546850950695944
2021-09-11T01:00:00Z 0.6310588407780212
2021-09-11T01:00:00Z 0.7477626346599205    
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åæ­£å¼¦ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åæ­£å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ASIN(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 asin_pressure asin_temperature asin_visibility
----                 ------------- ---------------- ---------------
2021-09-11T00:00:00Z                                
2021-09-11T00:00:00Z                                
2021-09-11T00:03:00Z                                
2021-09-11T00:03:00Z                                
2021-09-11T00:06:00Z                                
2021-09-11T00:06:00Z                                
2021-09-11T00:09:00Z                                
2021-09-11T00:09:00Z                                
2021-09-11T00:12:00Z                                
2021-09-11T00:12:00Z                                
2021-09-11T00:15:00Z                                
2021-09-11T00:15:00Z                                
2021-09-11T00:18:00Z                                
2021-09-11T00:18:00Z                                
2021-09-11T00:21:00Z                                
2021-09-11T00:21:00Z                                
2021-09-11T00:24:00Z                                
2021-09-11T00:24:00Z                                
2021-09-11T00:27:00Z                                
2021-09-11T00:27:00Z                                
2021-09-11T00:30:00Z                                
2021-09-11T00:30:00Z                                
2021-09-11T00:33:00Z                                
2021-09-11T00:33:00Z                                
2021-09-11T00:36:00Z                                
2021-09-11T00:36:00Z                                
2021-09-11T00:39:00Z                                
2021-09-11T00:39:00Z                                
2021-09-11T00:42:00Z                                
2021-09-11T00:42:00Z                                
2021-09-11T00:45:00Z                                
2021-09-11T00:45:00Z                                
2021-09-11T00:48:00Z                                
2021-09-11T00:48:00Z                                
2021-09-11T00:51:00Z                                
2021-09-11T00:51:00Z                                
2021-09-11T00:54:00Z                                
2021-09-11T00:54:00Z                                
2021-09-11T00:57:00Z                                
2021-09-11T00:57:00Z                                
2021-09-11T01:00:00Z                                
2021-09-11T01:00:00Z
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„åæ­£å¼¦ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚ä½†æ˜¯ç”±äºè¿™ä¸‰ä¸ªfield valueå…¨éƒ¨å¤§äº1ï¼Œå› æ­¤å…¶åæ­£å¼¦å€¼ä¸å­˜åœ¨ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åæ­£å¼¦å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ASIN(temperature/100) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 asin
----                 ----
2021-09-18T23:57:00Z 0.9272952180016123
2021-09-18T23:57:00Z 0.9108089974073983
2021-09-18T23:54:00Z 0.8038023189330299
2021-09-18T23:54:00Z 0.570437109399922
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åæ­£å¼¦ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-05-01T00:00:00Z</code>å’Œ<code>2020-05-09T00:00:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-2"><a class="header" href="#é«˜çº§è¯­æ³•-2">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ASIN(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„åæ­£å¼¦ã€‚</p>
<p>ASIN()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a>.</p>
<h4 id="ç¤ºä¾‹-20"><a class="header" href="#ç¤ºä¾‹-20">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„åæ­£å¼¦"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„åæ­£å¼¦">è®¡ç®—å¹³å‡å€¼çš„åæ­£å¼¦</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ASIN(MEAN(&quot;speed&quot;)) FROM &quot;wind&quot; WHERE time &gt;= '2021-09-01T00:00:00Z' AND time &lt;= '2021-09-30T00:00:00Z' GROUP BY time(1d)
name: air
time                  asin
----                  ----
2020-04-30T00:00:00Z  0.6004332535805232
2020-05-03T00:00:00Z  0.42245406218675574
2020-05-06T00:00:00Z  0.7894982093461719
2020-05-09T00:00:00Z  0.1606906529519106
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„åæ­£å¼¦ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ASIN()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' GROUP BY time(3d)
name: air
time                 mean
----                 ----
2021-09-09T00:00:00Z 65.26041666666667
2021-09-12T00:00:00Z 64.96944444444445
2021-09-15T00:00:00Z 65.00902777777777
2021-09-18T00:00:00Z 65.32952182952182
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„åæ­£å¼¦ã€‚</p>
</li>
<li>
<h3 id="atan"><a class="header" href="#atan">ATAN()</a></h3>
<p>è¿”å›field valueçš„åæ­£åˆ‡ï¼ˆä»¥å¼§åº¦è¡¨ç¤º)ã€‚field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-3"><a class="header" href="#åŸºæœ¬è¯­æ³•-3">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ATAN( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ATAN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚</p>
<p><code>ATAN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚</p>
<p><code>ATAN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueï¼Œå¹¶ä¸”field valueå¿…é¡»åœ¨-1å’Œ1ä¹‹é—´ã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ATAN()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-21"><a class="header" href="#ç¤ºä¾‹-21">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨å¦‚ä¸‹æ¨¡æ‹Ÿçš„å…¬å›­å æœ‰ç‡(ç›¸å¯¹äºæ€»ç©ºé—´)çš„æ•°æ®ã€‚éœ€è¦æ³¨æ„çš„é‡è¦äº‹é¡¹æ˜¯ï¼Œæ‰€æœ‰çš„field valueéƒ½åœ¨<code>ATAN()</code>å‡½æ•°çš„å¯è®¡ç®—èŒƒå›´é‡Œ(-1åˆ°1)ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 temperature
----                 -----------
2021-09-11T00:00:00Z 74
2021-09-11T00:00:00Z 79
2021-09-11T00:03:00Z 61
2021-09-11T00:03:00Z 73
2021-09-11T00:06:00Z 72
2021-09-11T00:06:00Z 61
2021-09-11T00:09:00Z 61
2021-09-11T00:09:00Z 72
2021-09-11T00:12:00Z 52
2021-09-11T00:12:00Z 58
2021-09-11T00:15:00Z 74
2021-09-11T00:15:00Z 78
2021-09-11T00:18:00Z 67
2021-09-11T00:18:00Z 74
2021-09-11T00:21:00Z 71
2021-09-11T00:21:00Z 55
2021-09-11T00:24:00Z 66
2021-09-11T00:24:00Z 67
2021-09-11T00:27:00Z 72
2021-09-11T00:27:00Z 66
2021-09-11T00:30:00Z 61
2021-09-11T00:30:00Z 54
2021-09-11T00:33:00Z 55
2021-09-11T00:33:00Z 75
2021-09-11T00:36:00Z 65
2021-09-11T00:36:00Z 66
2021-09-11T00:39:00Z 68
2021-09-11T00:39:00Z 58
2021-09-11T00:42:00Z 59
2021-09-11T00:42:00Z 58
2021-09-11T00:45:00Z 69
2021-09-11T00:45:00Z 71
2021-09-11T00:48:00Z 69
2021-09-11T00:48:00Z 57
2021-09-11T00:51:00Z 55
2021-09-11T00:51:00Z 73
2021-09-11T00:54:00Z 69
2021-09-11T00:54:00Z 64
2021-09-11T00:57:00Z 73
2021-09-11T00:57:00Z 52
2021-09-11T01:00:00Z 59
2021-09-11T01:00:00Z 68
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 atan
----                 ----
2021-09-11T00:00:00Z 1.5572836357815683
2021-09-11T00:00:00Z 1.5581387749608446
2021-09-11T00:03:00Z 1.5544043524868913
2021-09-11T00:03:00Z 1.5570985534220307
2021-09-11T00:06:00Z 1.5569083308639295
2021-09-11T00:06:00Z 1.5544043524868913
2021-09-11T00:09:00Z 1.5544043524868913
2021-09-11T00:09:00Z 1.5569083308639295
2021-09-11T00:12:00Z 1.5515679276951893
2021-09-11T00:12:00Z 1.5535566556003668
2021-09-11T00:15:00Z 1.5572836357815683
2021-09-11T00:15:00Z 1.557976516321996
2021-09-11T00:18:00Z 1.5558720618048116
2021-09-11T00:18:00Z 1.5572836357815683
2021-09-11T00:21:00Z 1.5567127509720364
2021-09-11T00:21:00Z 1.5526165117219182
2021-09-11T00:24:00Z 1.5556459709201267
2021-09-11T00:24:00Z 1.5558720618048116
2021-09-11T00:27:00Z 1.5569083308639295
2021-09-11T00:27:00Z 1.5556459709201267
2021-09-11T00:30:00Z 1.5544043524868913
2021-09-11T00:30:00Z 1.5522799247268875
2021-09-11T00:33:00Z 1.5526165117219182
2021-09-11T00:33:00Z 1.557463783500751
2021-09-11T00:36:00Z 1.5554129250143014
2021-09-11T00:36:00Z 1.5556459709201267
2021-09-11T00:39:00Z 1.5560915044170451
2021-09-11T00:39:00Z 1.5535566556003668
2021-09-11T00:42:00Z 1.5538487969884915
2021-09-11T00:42:00Z 1.5535566556003668
2021-09-11T00:45:00Z 1.5563045877293966
2021-09-11T00:45:00Z 1.5567127509720364
2021-09-11T00:48:00Z 1.5563045877293966
2021-09-11T00:48:00Z 1.553254266737494
2021-09-11T00:51:00Z 1.5526165117219182
2021-09-11T00:51:00Z 1.5570985534220307
2021-09-11T00:54:00Z 1.5563045877293966
2021-09-11T00:54:00Z 1.5551725981744198
2021-09-11T00:57:00Z 1.5570985534220307
2021-09-11T00:57:00Z 1.5515679276951893
2021-09-11T01:00:00Z 1.5538487969884915
2021-09-11T01:00:00Z 1.5560915044170451
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-11T01:00:00Z'
name: air
time                 atan_pressure      atan_temperature   atan_visibility
----                 -------------      ----------------   ---------------
2021-09-11T00:00:00Z 1.5544043524868913 1.5572836357815683 1.5526165117219182
2021-09-11T00:00:00Z 1.5576391913221408 1.5581387749608446 1.550798992821746
2021-09-11T00:03:00Z 1.5535566556003668 1.5544043524868913 1.551190995937692
2021-09-11T00:03:00Z 1.5541312030809558 1.5570985534220307 1.5581387749608446
2021-09-11T00:06:00Z 1.5549246438031066 1.5569083308639295 1.5556459709201267
2021-09-11T00:06:00Z 1.557976516321996  1.5544043524868913 1.5541312030809558
2021-09-11T00:09:00Z 1.553254266737494  1.5544043524868913 1.5560915044170451
2021-09-11T00:09:00Z 1.5556459709201267 1.5569083308639295 1.557463783500751
2021-09-11T00:12:00Z 1.5541312030809558 1.5515679276951893 1.5563045877293966
2021-09-11T00:12:00Z 1.550798992821746  1.5535566556003668 1.5565115842075
2021-09-11T00:15:00Z 1.5554129250143014 1.5572836357815683 1.5535566556003668
2021-09-11T00:15:00Z 1.5572836357815683 1.557976516321996  1.557976516321996
2021-09-11T00:18:00Z 1.557463783500751  1.5558720618048116 1.5526165117219182
2021-09-11T00:18:00Z 1.557810043874724  1.5572836357815683 1.551190995937692
2021-09-11T00:21:00Z 1.5544043524868913 1.5567127509720364 1.552941081655344
2021-09-11T00:21:00Z 1.5576391913221408 1.5526165117219182 1.5570985534220307
2021-09-11T00:24:00Z 1.552941081655344  1.5556459709201267 1.5541312030809558
2021-09-11T00:24:00Z 1.5570985534220307 1.5558720618048116 1.550798992821746
2021-09-11T00:27:00Z 1.550798992821746  1.5569083308639295 1.552941081655344
2021-09-11T00:27:00Z 1.5582969777755349 1.5556459709201267 1.5551725981744198
2021-09-11T00:30:00Z 1.5582969777755349 1.5544043524868913 1.5567127509720364
2021-09-11T00:30:00Z 1.5549246438031066 1.5522799247268875 1.5546686929512603
2021-09-11T00:33:00Z 1.5576391913221408 1.5526165117219182 1.5560915044170451
2021-09-11T00:33:00Z 1.5519306407732258 1.557463783500751  1.5560915044170451
2021-09-11T00:36:00Z 1.5558720618048116 1.5554129250143014 1.5519306407732258
2021-09-11T00:36:00Z 1.5560915044170451 1.5556459709201267 1.5563045877293966
2021-09-11T00:39:00Z 1.5526165117219182 1.5560915044170451 1.5567127509720364
2021-09-11T00:39:00Z 1.5563045877293966 1.5535566556003668 1.557810043874724
2021-09-11T00:42:00Z 1.5569083308639295 1.5538487969884915 1.5565115842075
2021-09-11T00:42:00Z 1.5522799247268875 1.5535566556003668 1.5549246438031066
2021-09-11T00:45:00Z 1.557810043874724  1.5563045877293966 1.5576391913221408
2021-09-11T00:45:00Z 1.5560915044170451 1.5567127509720364 1.557810043874724
2021-09-11T00:48:00Z 1.5535566556003668 1.5563045877293966 1.5551725981744198
2021-09-11T00:48:00Z 1.5546686929512603 1.553254266737494  1.5560915044170451
2021-09-11T00:51:00Z 1.5526165117219182 1.5526165117219182 1.5570985534220307
2021-09-11T00:51:00Z 1.557463783500751  1.5570985534220307 1.5572836357815683
2021-09-11T00:54:00Z 1.5563045877293966 1.5563045877293966 1.5558720618048116
2021-09-11T00:54:00Z 1.5538487969884915 1.5551725981744198 1.5544043524868913
2021-09-11T00:57:00Z 1.5565115842075    1.5570985534220307 1.5572836357815683
2021-09-11T00:57:00Z 1.5576391913221408 1.5515679276951893 1.5572836357815683
2021-09-11T01:00:00Z 1.5522799247268875 1.5538487969884915 1.5522799247268875
2021-09-11T01:00:00Z 1.557810043874724  1.5560915044170451 1.5551725981744198
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 atan
----                 ----
2021-09-18T23:57:00Z 1.5582969777755349
2021-09-18T23:57:00Z 1.5581387749608446
2021-09-18T23:54:00Z 1.5569083308639295
2021-09-18T23:54:00Z 1.5522799247268875
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„åæ­£åˆ‡ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-05-01T00:00:00Z</code>å’Œ<code>2020-05-09T00:00:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-3"><a class="header" href="#é«˜çº§è¯­æ³•-3">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ATAN(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„åæ­£åˆ‡ã€‚</p>
<p><code>ATAN()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<h4 id="ç¤ºä¾‹-22"><a class="header" href="#ç¤ºä¾‹-22">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡">è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' GROUP BY time(3d)
name: air
time                 atan
----                 ----
2021-09-09T00:00:00Z 1.5554743016680184
2021-09-12T00:00:00Z 1.5554056912417906
2021-09-15T00:00:00Z 1.555415060964228
2021-09-18T00:00:00Z 1.555490506678637
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„åæ­£åˆ‡ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯ä¸‰å¤©çš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ATAN()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-11T00:00:00Z' AND time &lt;= '2021-09-19T00:00:00Z' GROUP BY time(3d)
name: air
time                 mean
----                 ----
2021-09-09T00:00:00Z 65.26041666666667
2021-09-12T00:00:00Z 64.96944444444445
2021-09-15T00:00:00Z 65.00902777777777
2021-09-18T00:00:00Z 65.32952182952182
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„åæ­£åˆ‡ã€‚</p>
</li>
<li>
<h3 id="atan2"><a class="header" href="#atan2">ATAN2()</a></h3>
<p>è¿”å›ä»¥å¼§åº¦è¡¨ç¤ºçš„<code>y/x</code>çš„åæ­£åˆ‡ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-4"><a class="header" href="#åŸºæœ¬è¯­æ³•-4">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT ATAN2( [ * | &lt;field_key&gt; | num ], [ &lt;field_key&gt; | num ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ATAN2(field_key_y, field_key_x)</code>è¿”å›field key â€œfield_key_yâ€å¯¹åº”çš„field valueé™¤ä»¥field key â€œfield_key_xâ€å¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚</p>
<p><code>ATAN2(*, field_key_x)&lt;br /&gt;</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueé™¤ä»¥field key â€œfield_key_xâ€å¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚</p>
<p><code>ATAN2()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ATAN2()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-23"><a class="header" href="#ç¤ºä¾‹-23">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨å¦‚ä¸‹æ¨¡æ‹Ÿçš„é£è¡Œæ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot;, &quot;pressure&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-06T12:01:00Z' AND time &lt;= '2021-09-06T12:15:00Z'
name: air
time                 temperature pressure
----                 ----------- --------
2021-09-06T12:03:00Z 53          78
2021-09-06T12:03:00Z 72          71
2021-09-06T12:06:00Z 69          58
2021-09-06T12:06:00Z 59          76
2021-09-06T12:09:00Z 71          55
2021-09-06T12:09:00Z 57          76
2021-09-06T12:12:00Z 53          75
2021-09-06T12:12:00Z 65          52
2021-09-06T12:15:00Z 69          67
2021-09-06T12:15:00Z 64          56
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—field_key_yé™¤ä»¥field_key_xçš„åæ­£åˆ‡"><a class="header" href="#è®¡ç®—field_key_yé™¤ä»¥field_key_xçš„åæ­£åˆ‡">è®¡ç®—field_key_yé™¤ä»¥field_key_xçš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN2(&quot;temperature&quot;, &quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-06T12:01:00Z' AND time &lt;= '2021-09-06T13:01:00Z'
name: air
time                 atan2
----                 -----
2021-09-06T12:03:00Z 0.5968259039857009
2021-09-06T12:03:00Z 0.7923910564027816
2021-09-06T12:06:00Z 0.8717967127558954
2021-09-06T12:06:00Z 0.6601315920749263
2021-09-06T12:09:00Z 0.9117062804606886
2021-09-06T12:09:00Z 0.6435011087932844
2021-09-06T12:12:00Z 0.6151862381119739
2021-09-06T12:12:00Z 0.8960553845713439
2021-09-06T12:15:00Z 0.8001029857752997
2021-09-06T12:15:00Z 0.851966327173272
2021-09-06T12:18:00Z 0.6960841704042261
2021-09-06T12:18:00Z 0.8010218920179252
2021-09-06T12:21:00Z 0.7594299761858918
2021-09-06T12:21:00Z 0.7028792089644667
2021-09-06T12:24:00Z 0.812418612584713
2021-09-06T12:24:00Z 0.7309067071567171
2021-09-06T12:27:00Z 0.9948777271765435
2021-09-06T12:27:00Z 0.7546386373269791
2021-09-06T12:30:00Z 0.7785017210090998
2021-09-06T12:30:00Z 0.6435011087932844
2021-09-06T12:33:00Z 0.8960553845713439
2021-09-06T12:33:00Z 0.8007815651780434
2021-09-06T12:36:00Z 0.8498250028230019
2021-09-06T12:36:00Z 0.8736040677941312
2021-09-06T12:39:00Z 0.7168036599431737
2021-09-06T12:39:00Z 0.9296875579351908
2021-09-06T12:42:00Z 0.8633647972289906
2021-09-06T12:42:00Z 0.9437256642058782
2021-09-06T12:45:00Z 0.6215266244966218
2021-09-06T12:45:00Z 0.8152400480645576
2021-09-06T12:48:00Z 0.7378150601204648
2021-09-06T12:48:00Z 0.7638187798309181
2021-09-06T12:51:00Z 0.9179496956941223
2021-09-06T12:51:00Z 0.7935280655773922
2021-09-06T12:54:00Z 0.9572401812829798
2021-09-06T12:54:00Z 0.6593100683328579
2021-09-06T12:57:00Z 0.8674056089236339
2021-09-06T12:57:00Z 0.8674056089236339
2021-09-06T13:00:00Z 0.8187191592756955
2021-09-06T13:00:00Z 0.8134282033572947
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„field valueé™¤ä»¥field key <code>pressure</code>å¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚è¿™ä¸¤ä¸ªfield keyéƒ½åœ¨measurement <code>wind</code>ä¸­ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyé™¤ä»¥field_key_xçš„åæ­£åˆ‡"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyé™¤ä»¥field_key_xçš„åæ­£åˆ‡">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyé™¤ä»¥field_key_xçš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN2(*, &quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-06T12:01:00Z' AND time &lt;= '2021-09-06T12:06:00Z'
name: air
time                 atan2_pressure     atan2_temperature  atan2_visibility
----                 --------------     -----------------  ----------------
2021-09-06T12:03:00Z 0.7853981633974483 0.5968259039857009 0.60554466360497
2021-09-06T12:03:00Z 0.7853981633974483 0.7923910564027816 0.7257674502662789
2021-09-06T12:06:00Z 0.7853981633974483 0.8717967127558954 0.8645972343668997
2021-09-06T12:06:00Z 0.7853981633974483 0.6601315920749263 0.6435011087932844
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>wind</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueé™¤ä»¥field key <code>pressure</code>å¯¹åº”çš„field valueçš„åæ­£åˆ‡ã€‚measurement <code>wind</code>ä¸­æœ‰ä¸¤ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>å’Œ<code>pressure</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—field-valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—field-valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—field valueçš„åæ­£åˆ‡å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN2(&quot;temperature&quot;, &quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-06T12:01:00Z' AND time &lt;= '2021-09-16T13:01:00Z' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 atan2
----                 -----
2021-09-16T12:57:00Z 0.8773368222796695
2021-09-16T12:57:00Z 0.8114792046882006
2021-09-16T12:54:00Z 0.8007815651780434
2021-09-16T12:54:00Z 1.003258702010146
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„field valueé™¤ä»¥field key <code>pressure</code>å¯¹åº”çš„field valueçš„åæ­£åˆ‡ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2020-05-16T12:10:00Z</code>å’Œ<code>2020-05-16T12:10:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-4"><a class="header" href="#é«˜çº§è¯­æ³•-4">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ATAN2(&lt;function()&gt;, &lt;function()&gt;) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„åæ­£åˆ‡(<code>ATAN2()</code>)ã€‚</p>
<p>ATAN2()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li>COUNT()</li>
<li>MEAN()</li>
<li>MEDIAN()</li>
<li>MODE()</li>
<li>SUM()</li>
<li>FIRST()</li>
<li>LAST()</li>
<li>MIN()</li>
<li>MAX()</li>
<li>PERCENTILE()</li>
</ul>
<h4 id="ç¤ºä¾‹-24"><a class="header" href="#ç¤ºä¾‹-24">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡-1"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡-1">è®¡ç®—å¹³å‡å€¼çš„åæ­£åˆ‡</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ATAN2(MEAN(&quot;temperature&quot;), MEAN(&quot;pressure&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-16T12:01:00Z' AND time &lt;= '2021-09-16T14:02:00Z' GROUP BY time(12m)
name: air
time                 atan2
----                 -----
2021-09-16T12:00:00Z 0.7916716068182019
2021-09-16T12:12:00Z 0.7687819020057319
2021-09-16T12:24:00Z 0.8293469014295621
2021-09-16T12:36:00Z 0.7483094274728471
2021-09-16T12:48:00Z 0.8579805385837196
2021-09-16T13:00:00Z 0.7640815957515122
2021-09-16T13:12:00Z 0.7660813391498594
2021-09-16T13:24:00Z 0.7595170787800846
2021-09-16T13:36:00Z 0.781755192263569
2021-09-16T13:48:00Z 0.8137459550765823
2021-09-16T14:00:00Z 0.7572931159369924
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„field valueçš„å¹³å‡å€¼é™¤ä»¥field key <code>pressure</code>å¯¹åº”çš„field valueçš„å¹³å‡å€¼çš„åæ­£åˆ‡ã€‚å¹³å‡å€¼æ˜¯æŒ‰æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”è®¡ç®—çš„ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å’Œ<code>pressure</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ATAN2()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;), MEAN(&quot;pressure&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-16T12:01:00Z' AND time &lt;= '2021-09-16T14:02:00Z' GROUP BY time(12m)
name: air
time                 mean              mean_1
----                 ----              ------
2021-09-16T12:00:00Z 66.83333333333333 66
2021-09-16T12:12:00Z 62.875            65
2021-09-16T12:24:00Z 68.25             62.5
2021-09-16T12:36:00Z 64.875            69.875
2021-09-16T12:48:00Z 71                61.375
2021-09-16T13:00:00Z 60.25             62.875
2021-09-16T13:12:00Z 66.625            69.25
2021-09-16T13:24:00Z 63.5              66.875
2021-09-16T13:36:00Z 68.375            68.875
2021-09-16T13:48:00Z 68                64.25
2021-09-16T14:00:00Z 60.5              64
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„åæ­£åˆ‡ã€‚</p>
</li>
<li>
<h3 id="ceil"><a class="header" href="#ceil">CEIL()</a></h3>
<p>è¿”å›å¤§äºæŒ‡å®šå€¼çš„æœ€å°æ•´æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-5"><a class="header" href="#åŸºæœ¬è¯­æ³•-5">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT CEIL( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>CEIL(field_key)</code>è¿”å›field keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°ã€‚</p>
<p><code>CEIL(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°ã€‚</p>
<p><code>CEIL()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>CEIL()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-25"><a class="header" href="#ç¤ºä¾‹-25">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="content/cnosdb/latest/cnosql/oceanic_station.txt"><code>oceanic_station</code>æ•°æ®é›†</a>çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CEIL(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 ceil
----                 ----
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CEIL(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 ceil_pressure ceil_temperature ceil_visibility
----                 ------------- ---------------- ---------------
2021-09-18T00:00:00Z 64            51               68
2021-09-18T00:03:00Z 72            60               74
2021-09-18T00:06:00Z 54            55               77
2021-09-18T00:09:00Z 66            55               55
2021-09-18T00:12:00Z 64            63               70
2021-09-18T00:15:00Z 58            74               62
2021-09-18T00:18:00Z 55            79               54
2021-09-18T00:21:00Z 64            68               58
2021-09-18T00:24:00Z 66            70               69
2021-09-18T00:27:00Z 77            79               78
2021-09-18T00:30:00Z 62            75               80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°ã€‚measurement <code>air</code>åªæœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å¤§äºfield-valueçš„æœ€å°æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CEIL(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 ceil
----                 ----
2021-09-18T00:24:00Z 70
2021-09-18T00:21:00Z 68
2021-09-18T00:18:00Z 79
2021-09-18T00:15:00Z 74
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„å¤§äºfield valueçš„æœ€å°æ•´æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›)ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-5"><a class="header" href="#é«˜çº§è¯­æ³•-5">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT CEIL(&lt;function&gt;( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åå°†<code>CEIL()</code>åº”ç”¨äºè¿™äº›ç»“æœã€‚</p>
<p><code>CEIL()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<h4 id="ç¤ºä¾‹-26"><a class="header" href="#ç¤ºä¾‹-26">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¤§äºå¹³å‡å€¼çš„æœ€å°æ•´æ•°"><a class="header" href="#è®¡ç®—å¤§äºå¹³å‡å€¼çš„æœ€å°æ•´æ•°">è®¡ç®—å¤§äºå¹³å‡å€¼çš„æœ€å°æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CEIL(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 ceil
----                 ----
2021-09-18T00:00:00Z 56
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 75
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„å¤§äº<code>temperature</code>å¹³å‡å€¼çš„æœ€å°æ•´æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„å¤§äº<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>CEIL()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—å¤§äºè¿™äº›å¹³å‡å€¼çš„æœ€å°æ•´æ•°ã€‚</p>
</li>
<li>
<h3 id="cos"><a class="header" href="#cos">COS()</a></h3>
<p>è¿”å›field valueçš„ä½™å¼¦å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-6"><a class="header" href="#åŸºæœ¬è¯­æ³•-6">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT COS( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>COS(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼ã€‚</p>
<p><code>COS(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼ã€‚</p>
<p><code>COS()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>COS()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-27"><a class="header" href="#ç¤ºä¾‹-27">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨oceanic_stationæ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®"><a class="header" href="#ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨oceanic_stationæ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®">ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COS(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 cos
----                 ---
2021-09-18T00:00:00Z 0.7421541968137826
2021-09-18T00:03:00Z -0.9524129804151563
2021-09-18T00:06:00Z 0.022126756261955732
2021-09-18T00:09:00Z 0.022126756261955732
2021-09-18T00:12:00Z 0.9858965815825497
2021-09-18T00:15:00Z 0.17171734183077755
2021-09-18T00:18:00Z -0.8959709467909631
2021-09-18T00:21:00Z 0.4401430224960407
2021-09-18T00:24:00Z 0.6333192030862999
2021-09-18T00:27:00Z -0.8959709467909631
2021-09-18T00:30:00Z 0.9217512697247493
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä½™å¼¦å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COS(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 cos_pressure          cos_temperature      cos_visibility
----                 ------------          ---------------      --------------
2021-09-18T00:00:00Z 0.39185723042955      0.7421541968137826   0.4401430224960407
2021-09-18T00:03:00Z -0.9672505882738824   -0.9524129804151563  0.17171734183077755
2021-09-18T00:06:00Z -0.8293098328631501   0.022126756261955732 -0.030975031731216456
2021-09-18T00:09:00Z -0.9996474559663501   0.022126756261955732 0.022126756261955732
2021-09-18T00:12:00Z 0.39185723042955      0.9858965815825497   0.6333192030862999
2021-09-18T00:15:00Z 0.11918013544881928   0.17171734183077755  0.6735071623235862
2021-09-18T00:18:00Z 0.022126756261955732  -0.8959709467909631  -0.8293098328631501
2021-09-18T00:21:00Z 0.39185723042955      0.4401430224960407   0.11918013544881928
2021-09-18T00:24:00Z -0.9996474559663501   0.6333192030862999   0.9933903797222716
2021-09-18T00:27:00Z -0.030975031731216456 -0.8959709467909631  -0.8578030932449878
2021-09-18T00:30:00Z 0.6735071623235862    0.9217512697247493   -0.11038724383904756
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä½™å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä½™å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COS(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 cos
----                 ---
2021-09-18T00:24:00Z 0.6333192030862999
2021-09-18T00:21:00Z 0.4401430224960407
2021-09-18T00:18:00Z -0.8959709467909631
2021-09-18T00:15:00Z 0.17171734183077755
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä½™å¼¦å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-6"><a class="header" href="#é«˜çº§è¯­æ³•-6">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT COS(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„ä½™å¼¦å€¼ã€‚</p>
<p><code>COS()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<h4 id="ç¤ºä¾‹-28"><a class="header" href="#ç¤ºä¾‹-28">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ä½™å¼¦å€¼"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ä½™å¼¦å€¼">è®¡ç®—å¹³å‡å€¼çš„ä½™å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT COS(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 cos
----                 ---
2021-09-18T00:00:00Z 0.2687822771684872
2021-09-18T00:12:00Z -0.3090227281660707
2021-09-18T00:24:00Z 0.7441351704799297
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„ä½™å¼¦å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>COS()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ä½™å¼¦å€¼ã€‚</p>
</li>
<li>
<h3 id="cumulative_sum"><a class="header" href="#cumulative_sum">CUMULATIVE_SUM()</a></h3>
<p>è¿”å›field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-7"><a class="header" href="#åŸºæœ¬è¯­æ³•-7">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT CUMULATIVE_SUM( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>CUMULATIVE_SUM(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<p><code>CUMULATIVE_SUM(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<p><code>CUMULATIVE_SUM(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<p><code>CUMULATIVE_SUM()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>CUMULATIVE_SUM()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-29"><a class="header" href="#ç¤ºä¾‹-29">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CUMULATIVE_SUM(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 cumulative_sum
----                 --------------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 111
2021-09-18T00:06:00Z 166
2021-09-18T00:09:00Z 221
2021-09-18T00:12:00Z 284
2021-09-18T00:15:00Z 358
2021-09-18T00:18:00Z 437
2021-09-18T00:21:00Z 505
2021-09-18T00:24:00Z 575
2021-09-18T00:27:00Z 654
2021-09-18T00:30:00Z 729
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CUMULATIVE_SUM(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 cumulative_sum_pressure cumulative_sum_temperature cumulative_sum_visibility
----                 ----------------------- -------------------------- -------------------------
2021-09-18T00:00:00Z 64                      51                         68
2021-09-18T00:03:00Z 136                     111                        142
2021-09-18T00:06:00Z 190                     166                        219
2021-09-18T00:09:00Z 256                     221                        274
2021-09-18T00:12:00Z 320                     284                        344
2021-09-18T00:15:00Z 378                     358                        406
2021-09-18T00:18:00Z 433                     437                        460
2021-09-18T00:21:00Z 497                     505                        518
2021-09-18T00:24:00Z 563                     575                        587
2021-09-18T00:27:00Z 640                     654                        665
2021-09-18T00:30:00Z 702                     729                        745
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œ">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CUMULATIVE_SUM(/temp/) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
time                 cumulative_sum_temperature
----                 --------------------------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 111
2021-09-18T00:06:00Z 166
2021-09-18T00:09:00Z 221
2021-09-18T00:12:00Z 284
2021-09-18T00:15:00Z 358
2021-09-18T00:18:00Z 437
2021-09-18T00:21:00Z 505
2021-09-18T00:24:00Z 575
2021-09-18T00:27:00Z 654
2021-09-18T00:30:00Z 729
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ç´¯ç§¯æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œå¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CUMULATIVE_SUM(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 cumulative_sum
----                 --------------
2021-09-18T00:24:00Z 224
2021-09-18T00:21:00Z 292
2021-09-18T00:18:00Z 371
2021-09-18T00:15:00Z 445
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ç´¯ç§¯æ€»å’Œï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-7"><a class="header" href="#é«˜çº§è¯­æ³•-7">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT CUMULATIVE_SUM(&lt;function&gt;( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„ç´¯ç§¯æ€»å’Œã€‚</p>
<p><code>CUMULATIVE_SUM()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ç´¯ç§¯æ€»å’Œ"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ç´¯ç§¯æ€»å’Œ">è®¡ç®—å¹³å‡å€¼çš„ç´¯ç§¯æ€»å’Œ</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT CUMULATIVE_SUM(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 cumulative_sum
----                 --------------
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 126.25
2021-09-18T00:24:00Z 200.91666666666669
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„ç´¯ç§¯æ€»å’Œã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>CUMULATIVE_SUM()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ç´¯ç§¯æ€»å’Œã€‚æœ€ç»ˆæŸ¥è¯¢ç»“æœä¸­çš„ç¬¬äºŒä¸ª<code>point</code>(<code>4.167</code>)æ˜¯<code>2.09</code>å’Œ<code>2.077</code>çš„æ€»å’Œï¼Œç¬¬ä¸‰ä¸ª<code>point</code>(<code>6.213</code>)æ˜¯<code>2.09</code>ã€<code>2.077</code>å’Œ<code>2.0460000000000003</code>çš„æ€»å’Œã€‚</p>
</li>
<li>
<h3 id="derivative"><a class="header" href="#derivative">DERIVATIVE()</a></h3>
<p>è¿”å›field valueä¹‹é—´çš„å˜åŒ–ç‡ï¼Œå³å¯¼æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-8"><a class="header" href="#åŸºæœ¬è¯­æ³•-8">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT DERIVATIVE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>CnosDBè®¡ç®—field valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¿™äº›ç»“æœè½¬æ¢ä¸ºæ¯ä¸ª<code>unit</code>çš„å˜åŒ–ç‡ã€‚å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>unit</code>é»˜è®¤ä¸ºä¸€ç§’(<code>1s</code>)ã€‚</p>
<p><code>DERIVATIVE(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„å˜åŒ–ç‡ã€‚</p>
<p><code>DERIVATIVE(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å˜åŒ–ç‡ã€‚</p>
<p><code>DERIVATIVE(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å˜åŒ–ç‡ã€‚</p>
<p><code>DERIVATIVE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>DERIVATIVE()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-30"><a class="header" href="#ç¤ºä¾‹-30">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¯¼æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 derivative
----                 ----------
2021-09-18T00:03:00Z 0.05
2021-09-18T00:06:00Z -0.027777777777777776
2021-09-18T00:09:00Z 0
2021-09-18T00:12:00Z 0.044444444444444446
2021-09-18T00:15:00Z 0.06111111111111111
2021-09-18T00:18:00Z 0.027777777777777776
2021-09-18T00:21:00Z -0.06111111111111111
2021-09-18T00:24:00Z 0.011111111111111112
2021-09-18T00:27:00Z 0.05
2021-09-18T00:30:00Z -0.022222222222222223
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ¯ç§’å˜åŒ–ç‡ã€‚</p>
<p>ç¬¬ä¸€ä¸ªç»“æœ(<code>0.05</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨ä¸€ç§’å†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸ºä¸€ç§’çš„å˜åŒ–ç‡ã€‚</p>
</li>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¯¼æ•°å¹¶æŒ‡å®š<code>unit</code></a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(&quot;temperature&quot;,6m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 derivative
----                 ----------
2021-09-18T00:03:00Z 18
2021-09-18T00:06:00Z -10
2021-09-18T00:09:00Z 0
2021-09-18T00:12:00Z 16
2021-09-18T00:15:00Z 22
2021-09-18T00:18:00Z 10
2021-09-18T00:21:00Z -22
2021-09-18T00:24:00Z 4
2021-09-18T00:27:00Z 18
2021-09-18T00:30:00Z -8
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ¯å…­åˆ†é’Ÿçš„å˜åŒ–ç‡ã€‚</p>
<p>ç¬¬ä¸€ä¸ªç»“æœ(<code>0.052000000000000046</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨å…­åˆ†é’Ÿå†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸ºå…­åˆ†é’Ÿçš„å˜åŒ–ç‡ï¼š</p>
<pre><code>(2.116 - 2.064) / (6m / 6m)
--------------    ----------
       |              |
       |          the difference between the field values' timestamps / the specified unit
second field value - first field value
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¯¼æ•°å¹¶æŒ‡å®š<code>unit</code></a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(*,3m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 derivative_pressure derivative_temperature derivative_visibility
----                 ------------------- ---------------------- ---------------------
2021-09-18T00:03:00Z 8                   9                      6
2021-09-18T00:06:00Z -18                 -5                     3
2021-09-18T00:09:00Z 12                  0                      -22
2021-09-18T00:12:00Z -2                  8                      15
2021-09-18T00:15:00Z -6                  11                     -8
2021-09-18T00:18:00Z -3                  5                      -8
2021-09-18T00:21:00Z 9                   -11                    4
2021-09-18T00:24:00Z 2                   2                      11
2021-09-18T00:27:00Z 11                  9                      9
2021-09-18T00:30:00Z -15                 -4                     2
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æ¯ä¸‰åˆ†é’Ÿçš„å˜åŒ–ç‡ã€‚measurement <code>air</code>ä¸­æ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>,<code>pressure</code>,<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶æŒ‡å®šunit">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¯¼æ•°å¹¶æŒ‡å®š<code>unit</code></a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(/temp/,2m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 derivative_temperature
----                 ----------------------
2021-09-18T00:03:00Z 6
2021-09-18T00:06:00Z -3.3333333333333335
2021-09-18T00:09:00Z 0
2021-09-18T00:12:00Z 5.333333333333333
2021-09-18T00:15:00Z 7.333333333333333
2021-09-18T00:18:00Z 3.3333333333333335
2021-09-18T00:21:00Z -7.333333333333333
2021-09-18T00:24:00Z 1.3333333333333333
2021-09-18T00:27:00Z 6
2021-09-18T00:30:00Z -2.6666666666666665
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­çš„å¯¹åº”field key&quot;temperature&quot;å¯¹åº”çš„field valueçš„æ¯ä¸¤åˆ†é’Ÿçš„å˜åŒ–ç‡ã€‚</p>
<p>ç¬¬ä¸€ä¸ªç»“æœ(<code>6</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨ä¸¤åˆ†é’Ÿå†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸ºä¸¤åˆ†é’Ÿçš„å˜åŒ–ç‡ï¼š</p>
<pre><code>(-3.3333333333333335 6) / (6m / 2m)
--------------            ----------
       |                      |
       |                the difference between the field values' timestamps / the specified unit
second field value - first field value
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¯¼æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¯¼æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' ORDER BY time DESC LIMIT 1 OFFSET 2
name: air
time                 derivative
----                 ----------
2021-09-18T00:21:00Z -0.011111111111111112
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ¯ç§’å˜åŒ–ç‡ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º1ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<p>å”¯ä¸€çš„ç»“æœ(<code>-0.011111111111111112</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨ä¸€ç§’å†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸ºä¸€ç§’çš„å˜åŒ–ç‡ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-8"><a class="header" href="#é«˜çº§è¯­æ³•-8">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT DERIVATIVE(&lt;function&gt; ([ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ]) [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„å¯¼æ•°ã€‚</p>
<p>å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>unit</code>é»˜è®¤ä¸º<code>GROUP BY time()</code>çš„æ—¶é—´é—´éš”ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œ<code>unit</code>çš„é»˜è®¤å€¼è·ŸåŸºæœ¬è¯­æ³•ä¸­<code>unit</code>çš„é»˜è®¤å€¼ä¸ä¸€æ ·ã€‚</p>
<p><code>DERIVATIVE()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°">è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°</a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)
name: air
time                 derivative
----                 ----------
2021-09-18T00:00:00Z -14.25
2021-09-18T00:12:00Z 15.75
2021-09-18T00:24:00Z 3.6666666666666714
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„æ¯12åˆ†é’Ÿå˜åŒ–ç‡ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>DERIVATIVE()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„æ¯12åˆ†é’Ÿçš„å˜åŒ–ç‡ã€‚ç¬¬ä¸€ä¸ªç»“æœ(<code>55.25</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨12åˆ†é’Ÿå†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸º12åˆ†é’Ÿçš„å˜åŒ–ç‡ï¼š</p>
<pre><code>(71 - 74.66666666666667)  / (12m / 12m)
-------------                   ----------
       |                           |
       |                     the difference between the field values' timestamps / the default unit
second field value - first field value
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°å¹¶æŒ‡å®šunit">è®¡ç®—å¹³å‡å€¼çš„å¯¼æ•°å¹¶æŒ‡å®š<code>unit</code></a></h4>
<pre><code class="language-sql">&gt; SELECT DERIVATIVE(MEAN(&quot;temperature&quot;),6m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)
name: air
time                 derivative
----                 ----------
2021-09-18T00:00:00Z -7.125
2021-09-18T00:12:00Z 7.875
2021-09-18T00:24:00Z 1.8333333333333357
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼çš„æ¯å…­åˆ†é’Ÿå˜åŒ–ç‡ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>DERIVATIVE()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)

name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„æ¯å…­åˆ†é’Ÿçš„å˜åŒ–ç‡ã€‚ç¬¬ä¸€ä¸ªç»“æœ(<code>-55.25</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueåœ¨å…­åˆ†é’Ÿå†…çš„å˜åŒ–ç‡ã€‚CnosDBè®¡ç®—ä¸¤ä¸ªfield valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¯¥å€¼æ ‡å‡†åŒ–ä¸ºå…­åˆ†é’Ÿçš„å˜åŒ–ç‡ï¼š</p>
<pre><code class="language-sql">(71 - 74.66666666666667) / (12m / 6m)
-------------    ----------
       |                         |
       |                    the difference between the field values' timestamps / the specified unit
second field value - first field value
</code></pre>
<ul>
<li>
<h3 id="difference"><a class="header" href="#difference">DIFFERENCE()</a></h3>
<p>è¿”å›field valueä¹‹é—´çš„å·®å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-9"><a class="header" href="#åŸºæœ¬è¯­æ³•-9">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT DIFFERENCE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>DIFFERENCE(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„å·®å€¼ã€‚</p>
<p><code>DIFFERENCE(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å·®å€¼ã€‚</p>
<p><code>DIFFERENCE(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å·®å€¼ã€‚</p>
<p><code>DIFFERENCE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>DIFFERENCE()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-31"><a class="header" href="#ç¤ºä¾‹-31">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å·®å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DIFFERENCE(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 difference
----                 ----------
2021-09-18T00:03:00Z 9
2021-09-18T00:06:00Z -5
2021-09-18T00:09:00Z 0
2021-09-18T00:12:00Z 8
2021-09-18T00:15:00Z 11
2021-09-18T00:18:00Z 5
2021-09-18T00:21:00Z -11
2021-09-18T00:24:00Z 2
2021-09-18T00:27:00Z 9
2021-09-18T00:30:00Z -4
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueä¹‹é—´çš„å·®å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å·®å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DIFFERENCE(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 difference_pressure difference_temperature difference_visibility
----                 ------------------- ---------------------- ---------------------
2021-09-18T00:03:00Z 8                   9                      6
2021-09-18T00:06:00Z -18                 -5                     3
2021-09-18T00:09:00Z 12                  0                      -22
2021-09-18T00:12:00Z -2                  8                      15
2021-09-18T00:15:00Z -6                  11                     -8
2021-09-18T00:18:00Z -3                  5                      -8
2021-09-18T00:21:00Z 9                   -11                    4
2021-09-18T00:24:00Z 2                   2                      11
2021-09-18T00:27:00Z 11                  9                      9
2021-09-18T00:30:00Z -15                 -4                     2
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueä¹‹é—´çš„å·®å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å·®å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DIFFERENCE(/visi/) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 difference_visibility
----                 ----------
2021-09-18T00:03:00Z 6
2021-09-18T00:06:00Z 3
2021-09-18T00:09:00Z -22
2021-09-18T00:12:00Z 15
2021-09-18T00:15:00Z -8
2021-09-18T00:18:00Z -8
2021-09-18T00:21:00Z 4
2021-09-18T00:24:00Z 11
2021-09-18T00:27:00Z 9
2021-09-18T00:30:00Z 2
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>water</code>çš„field keyå¯¹åº”çš„field valueä¹‹é—´çš„å·®å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å·®å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å·®å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DIFFERENCE(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 2 OFFSET 2
name: air
time                 difference
----                 ----------
2021-09-18T00:21:00Z -2
2021-09-18T00:18:00Z 11
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueä¹‹é—´çš„å·®å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º2ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ªï¼ˆå³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-9"><a class="header" href="#é«˜çº§è¯­æ³•-9">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT DIFFERENCE(&lt;function&gt;( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœä¹‹é—´çš„å·®å€¼ã€‚</p>
<p>DIFFERENCE()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a>, and
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a>.</p>
<h4 id="ç¤ºä¾‹-32"><a class="header" href="#ç¤ºä¾‹-32">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—æœ€å¤§å€¼ä¹‹é—´çš„å·®å€¼"><a class="header" href="#è®¡ç®—æœ€å¤§å€¼ä¹‹é—´çš„å·®å€¼">è®¡ç®—æœ€å¤§å€¼ä¹‹é—´çš„å·®å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT DIFFERENCE(MAX(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 difference
----                 ----------
2021-09-18T00:00:00Z -19
2021-09-18T00:12:00Z 19
2021-09-18T00:24:00Z 0
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„æœ€å¤§å€¼ä¹‹é—´çš„å·®å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—field key <code>temperature</code>å¯¹åº”çš„æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„field valueçš„æœ€å¤§å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MAX()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>DIFFERENCE()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 max
----                 ---
2021-09-18T00:00:00Z 60
2021-09-18T00:12:00Z 79
2021-09-18T00:24:00Z 79
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›æœ€å¤§å€¼ä¹‹é—´çš„å·®å€¼ã€‚æœ€ç»ˆæŸ¥è¯¢ç»“æœä¸­çš„ç¬¬ä¸€ä¸ª<code>point</code>(<code>0.009999999999999787</code>)æ˜¯<code>2.126</code>å’Œ<code>2.116</code>çš„å·®ï¼Œç¬¬äºŒä¸ª<code>point</code>(<code>-0.07499999999999973</code>)æ˜¯<code>2.051</code>å’Œ<code>2.126</code>çš„å·®ã€‚</p>
</li>
<li>
<h3 id="elapsed"><a class="header" href="#elapsed">ELAPSED()</a></h3>
<p>è¿”å›field valueçš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚</p>
<h4 id="è¯­æ³•-31"><a class="header" href="#è¯­æ³•-31">è¯­æ³•</a></h4>
<pre><code>SELECT ELAPSED( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>CnosDBè®¡ç®—æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ï¼Œå®ƒå†³å®šäº†è¿”å›çš„å·®å€¼çš„å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°†è¿”å›ä»¥çº³ç§’ä¸ºå•ä½çš„ä¸¤ä¸ªæ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚</p>
<p><code>ELAPSED(field_key)</code>è¿”å›field keyå¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚</p>
<p><code>ELAPSED(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚</p>
<p><code>ELAPSED(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ã€‚</p>
<p><code>ELAPSED()</code>æ”¯æŒæ‰€æœ‰æ•°æ®ç±»å‹çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-33"><a class="header" href="#ç¤ºä¾‹-33">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:24:00Z'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¹‹é—´çš„æ—¶é—´é—´éš”</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ELAPSED(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:24:00Z'
name: air
time                 elapsed
----                 -------
2021-09-18T00:03:00Z 180000000000
2021-09-18T00:06:00Z 180000000000
2021-09-18T00:09:00Z 180000000000
2021-09-18T00:12:00Z 180000000000
2021-09-18T00:15:00Z 180000000000
2021-09-18T00:18:00Z 180000000000
2021-09-18T00:21:00Z 180000000000
2021-09-18T00:24:00Z 180000000000
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼(ä»¥çº³ç§’ä¸ºå•ä½)ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®šunit">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®š<code>unit</code></a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ELAPSED(&quot;temperature&quot;,1m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:24:00Z'
name: air
time                 elapsed
----                 -------
2021-09-18T00:03:00Z 3
2021-09-18T00:06:00Z 3
2021-09-18T00:09:00Z 3
2021-09-18T00:12:00Z 3
2021-09-18T00:15:00Z 3
2021-09-18T00:18:00Z 3
2021-09-18T00:21:00Z 3
2021-09-18T00:24:00Z 3
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªfield keyå¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼(ä»¥åˆ†é’Ÿä¸ºå•ä½)ã€‚measurement <code>air</code>ä¸­æœ‰ä¸¤ä¸ªfield keyï¼š<code>pressure</code>å’Œ<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®šunit"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®šunit">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶æŒ‡å®š<code>unit</code></a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ELAPSED(/press/,1m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:24:00Z'
name: air
time                 elapsed_pressure
----                 ----------------
2021-09-18T00:03:00Z 3
2021-09-18T00:06:00Z 3
2021-09-18T00:09:00Z 3
2021-09-18T00:12:00Z 3
2021-09-18T00:15:00Z 3
2021-09-18T00:18:00Z 3
2021-09-18T00:21:00Z 3
2021-09-18T00:24:00Z 3
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªåŒ…å«å•è¯<code>level</code>çš„field keyå¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼(ä»¥ç§’ä¸ºå•ä½)ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueä¹‹é—´çš„æ—¶é—´é—´éš”å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ELAPSED(&quot;temperature&quot;,1ms) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:24:00Z' ORDER BY time DESC LIMIT 1 OFFSET 1
name: air
time                 elapsed
----                 -------
2021-09-18T00:18:00Z -180000
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„æ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼(ä»¥æ¯«ç§’ä¸ºå•ä½)ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2020-08-18T00:12:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º1ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸€ä¸ªï¼ˆå³å‰ä¸€ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<p>è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯è´Ÿæ•°ï¼›å› ä¸º<code>ORDER BY time DESC</code>å­å¥æŒ‰é€’å‡çš„é¡ºåºå¯¹æ—¶é—´æˆ³è¿›è¡Œæ’åºï¼Œæ‰€ä»¥<code>ELAPSED()</code>ä»¥ç›¸åçš„é¡ºåºè®¡ç®—æ—¶é—´æˆ³çš„å·®å€¼ã€‚</p>
<h4 id="elapsedçš„å¸¸è§é—®é¢˜"><a class="header" href="#elapsedçš„å¸¸è§é—®é¢˜"><code>ELAPSED()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="elapsedå’Œå¤§äºç»è¿‡æ—¶é—´çš„å•ä½"><a class="header" href="#elapsedå’Œå¤§äºç»è¿‡æ—¶é—´çš„å•ä½"><code>ELAPSED()</code>å’Œå¤§äºç»è¿‡æ—¶é—´çš„å•ä½</a></h4>
</li>
</ul>
<p>Iå¦‚æœ<code>unit</code>çš„å€¼å¤§äºæ—¶é—´æˆ³ä¹‹é—´çš„å·®å€¼ï¼Œé‚£ä¹ˆCnosDBå°†ä¼šè¿”å›<code>0</code>ã€‚</p>
<p>measurement <code>air</code>ä¸­æ¯å…­åˆ†é’Ÿæœ‰ä¸€ä¸ª<code>point</code>ã€‚å¦‚æœæŸ¥è¯¢å°†<code>unit</code>è®¾ç½®ä¸ºä¸€å°æ—¶ï¼ŒCnosDBå°†ä¼šè¿”å›<code>0</code>ï¼š</p>
<pre><code class="language-sql">&gt; SELECT ELAPSED(&quot;temperature&quot;,1h) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:12:00Z'
name: air
time                 elapsed
----                 -------
2021-09-18T00:03:00Z 0
2021-09-18T00:06:00Z 0
2021-09-18T00:09:00Z 0
2021-09-18T00:12:00Z 0
</code></pre>
<ul>
<li>
<h4 id="elapsedå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><a class="header" href="#elapsedå’Œgroup-by-timeå­å¥åŒæ—¶ä½¿ç”¨"><code>ELAPSED()</code>å’Œ<code>GROUP BY time()</code>å­å¥åŒæ—¶ä½¿ç”¨</a></h4>
</li>
</ul>
<p><code>ELAPSED()</code>å‡½æ•°æ”¯æŒ<code>GROUP BY time()</code>å­å¥ï¼Œä½†æ˜¯æŸ¥è¯¢ç»“æœä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ã€‚ç›®å‰ï¼Œå¦‚æœ<code>ELAPSED()</code>æŸ¥è¯¢åŒ…å«ä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°å’Œä¸€ä¸ª<code>GROUP BY time()</code>å­å¥ï¼Œé‚£ä¹ˆåªä¼šè¿”å›æŒ‡å®š<code>GROUP BY time()</code>å­å¥ä¸­çš„æ—¶é—´é—´éš”ã€‚</p>
<p><code>GROUP BY time()</code>å­å¥å†³å®šäº†æŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³ï¼šæ¯ä¸ªæ—¶é—´æˆ³è¡¨ç¤ºæ—¶é—´é—´éš”çš„å¼€å§‹æ—¶é—´ã€‚è¯¥è¡Œä¸ºä¹Ÿé€‚ç”¨äºåµŒå¥—çš„selectorå‡½æ•°(ä¾‹å¦‚<code>FIRST()</code>æˆ–<code>MAX()</code>)ï¼Œè€Œåœ¨å…¶å®ƒçš„æ‰€æœ‰æƒ…å†µä¸‹ï¼Œè¿™äº›å‡½æ•°è¿”å›çš„æ˜¯åŸå§‹æ•°æ®çš„ç‰¹å®šæ—¶é—´æˆ³ã€‚å› ä¸º<code>GROUP BY time()</code>å­å¥ä¼šè¦†ç›–åŸå§‹æ—¶é—´æˆ³ï¼Œæ‰€ä»¥<code>ELAPSED()</code>å§‹ç»ˆè¿”å›ä¸<code>GROUP BY time()</code>çš„æ—¶é—´é—´éš”ç›¸åŒçš„æ—¶é—´æˆ³ã€‚</p>
<p>ä¸‹é¢ä»£ç å—ä¸­çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢å°è¯•ä½¿ç”¨<code>ELAPSED()</code>å’Œ<code>GROUP BY time()</code>å­å¥æ¥æŸ¥æ‰¾æœ€å°çš„<code>temperature</code>çš„å€¼ä¹‹é—´ç»è¿‡çš„æ—¶é—´(ä»¥åˆ†é’Ÿä¸ºå•ä½)ã€‚æŸ¥è¯¢çš„ä¸¤ä¸ªæ—¶é—´é—´éš”éƒ½è¿”å›äº†12åˆ†é’Ÿã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”çš„<code>temperature</code>çš„æœ€å°å€¼ã€‚ä»£ç å—ä¸­çš„ç¬¬äºŒä¸ªæŸ¥è¯¢å±•ç¤ºäº†è¿™ä¸€æ­¥çš„ç»“æœã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MIN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ELAPSED()</code>çš„æƒ…å½¢ä¸€æ ·ã€‚è¯·æ³¨æ„ï¼Œç¬¬äºŒä¸ªæŸ¥è¯¢è¿”å›çš„æ—¶é—´æˆ³é—´éš”12åˆ†é’Ÿã€‚åœ¨åŸå§‹æ•°æ®ä¸­ï¼Œç¬¬ä¸€ä¸ªç»“æœ(<code>2.057</code>)å‘ç”Ÿåœ¨<code>2020-08-18T00:42:00Z</code>ï¼Œä½†æ˜¯<code>GROUP BY time()</code>å­å¥è¦†ç›–äº†åŸå§‹çš„æ—¶é—´æˆ³ã€‚å› ä¸ºæ—¶é—´æˆ³ç”±<code>GROUP BY time()</code>çš„æ—¶é—´é—´éš”(è€Œä¸æ˜¯åŸå§‹æ•°æ®)å†³å®šï¼Œæ‰€ä»¥<code>ELAPSED()</code>å§‹ç»ˆè¿”å›ä¸GROUP BY time()çš„æ—¶é—´é—´éš”ç›¸åŒçš„æ—¶é—´æˆ³ã€‚</p>
<pre><code class="language-sql">&gt; SELECT ELAPSED(MIN(&quot;temperature&quot;),1m) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-08T00:36:00Z' AND time &lt;= '2021-09-08T00:54:00Z' GROUP BY time(12m)
name: air
time                 elapsed
----                 -------
2021-09-08T00:36:00Z 12
2021-09-08T00:48:00Z 12

&gt; SELECT MIN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-08T00:36:00Z' AND time &lt;= '2021-09-08T00:54:00Z' GROUP BY time(12m)
name: air
time                 min
----                 ---
2021-09-08T00:36:00Z 50
2021-09-08T00:48:00Z 73  &lt;--- Actually occurs at 2021-09-08T00:48:00Z
</code></pre>
</li>
<li>
<h3 id="exp"><a class="header" href="#exp">EXP()</a></h3>
<p>è¿”å›field valueçš„æŒ‡æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-10"><a class="header" href="#åŸºæœ¬è¯­æ³•-10">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT EXP( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>EXP(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æŒ‡æ•°ã€‚</p>
<p><code>EXP(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æŒ‡æ•°ã€‚</p>
<p><code>EXP()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>EXP()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-34"><a class="header" href="#ç¤ºä¾‹-34">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.85.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æŒ‡æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT EXP(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 exp
----                 ---
2021-09-18T00:00:00Z 1.4093490824269389e+22
2021-09-18T00:03:00Z 1.1420073898156842e+26
2021-09-18T00:06:00Z 7.694785265142018e+23
2021-09-18T00:09:00Z 7.694785265142018e+23
2021-09-18T00:12:00Z 2.29378315946961e+27
2021-09-18T00:15:00Z 1.3733829795401763e+32
2021-09-18T00:18:00Z 2.0382810665126688e+34
2021-09-18T00:21:00Z 3.404276049931741e+29
2021-09-18T00:24:00Z 2.515438670919167e+30
2021-09-18T00:27:00Z 2.0382810665126688e+34
2021-09-18T00:30:00Z 3.7332419967990015e+32
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æŒ‡æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æŒ‡æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT EXP(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 exp_pressure           exp_temperature        exp_visibility
----                 ------------           ---------------        --------------
2021-09-18T00:00:00Z 6.235149080811617e+27  1.4093490824269389e+22 3.404276049931741e+29
2021-09-18T00:03:00Z 1.8586717452841279e+31 1.1420073898156842e+26 1.3733829795401763e+32
2021-09-18T00:06:00Z 2.830753303274694e+23  7.694785265142018e+23  2.7585134545231703e+33
2021-09-18T00:09:00Z 4.607186634331292e+28  7.694785265142018e+23  7.694785265142018e+23
2021-09-18T00:12:00Z 6.235149080811617e+27  2.29378315946961e+27   2.515438670919167e+30
2021-09-18T00:15:00Z 1.545538935590104e+25  1.3733829795401763e+32 8.438356668741455e+26
2021-09-18T00:18:00Z 7.694785265142018e+23  2.0382810665126688e+34 2.830753303274694e+23
2021-09-18T00:21:00Z 6.235149080811617e+27  3.404276049931741e+29  1.545538935590104e+25
2021-09-18T00:24:00Z 4.607186634331292e+28  2.515438670919167e+30  9.253781725587789e+29
2021-09-18T00:27:00Z 2.7585134545231703e+33 2.0382810665126688e+34 7.49841699699012e+33
2021-09-18T00:30:00Z 8.438356668741455e+26  3.7332419967990015e+32 5.54062238439351e+34
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æŒ‡æ•°ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æŒ‡æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æŒ‡æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT EXP(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 exp
----                 ---
2021-09-18T00:24:00Z 2.515438670919167e+30
2021-09-18T00:21:00Z 3.404276049931741e+29
2021-09-18T00:18:00Z 2.0382810665126688e+34
2021-09-18T00:15:00Z 1.3733829795401763e+32
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æŒ‡æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›)ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-10"><a class="header" href="#é«˜çº§è¯­æ³•-10">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT EXP(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„æŒ‡æ•°ã€‚</p>
<p>EXP()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a>, and
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a>.</p>
<h4 id="ç¤ºä¾‹-35"><a class="header" href="#ç¤ºä¾‹-35">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„æŒ‡æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„æŒ‡æ•°">è®¡ç®—å¹³å‡å€¼çš„æŒ‡æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT EXP(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 exp
----                 ---
2021-09-18T00:00:00Z 9.880299856396672e+23
2021-09-18T00:12:00Z 6.837671229762744e+30
2021-09-18T00:24:00Z 2.674984780655511e+32
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„ç»å¯¹å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>EXP()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>.ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„æŒ‡æ•°ã€‚</p>
<h3 id="floor"><a class="header" href="#floor">FLOOR()</a></h3>
<p>è¿”å›å°äºæŒ‡å®šå€¼çš„æœ€å¤§æ•´æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-11"><a class="header" href="#åŸºæœ¬è¯­æ³•-11">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT FLOOR( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>FLOOR(field_key)</code>è¿”å›field keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°ã€‚</p>
<p><code>FLOOR(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°ã€‚</p>
<p><code>FLOOR()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>FLOOR()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-36"><a class="header" href="#ç¤ºä¾‹-36">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FLOOR(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 floor
----                 -----
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FLOOR(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 floor_pressure floor_temperature floor_visibility
----                 -------------- ----------------- ----------------
2021-09-18T00:00:00Z 64             51                68
2021-09-18T00:03:00Z 72             60                74
2021-09-18T00:06:00Z 54             55                77
2021-09-18T00:09:00Z 66             55                55
2021-09-18T00:12:00Z 64             63                70
2021-09-18T00:15:00Z 58             74                62
2021-09-18T00:18:00Z 55             79                54
2021-09-18T00:21:00Z 64             68                58
2021-09-18T00:24:00Z 66             70                69
2021-09-18T00:27:00Z 77             79                78
2021-09-18T00:30:00Z 62             75                80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°ã€‚measurement <code>air</code>åªæœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„å°äºfield-valueçš„æœ€å¤§æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FLOOR(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 floor
----                 -----
2021-09-18T00:24:00Z 70
2021-09-18T00:21:00Z 68
2021-09-18T00:18:00Z 79
2021-09-18T00:15:00Z 74
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›field key <code>temperature</code>å¯¹åº”çš„å°äºfield valueçš„æœ€å¤§æ•´æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›)ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-11"><a class="header" href="#é«˜çº§è¯­æ³•-11">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT FLOOR(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åå°†<code>FLOOR()</code>åº”ç”¨äºè¿™äº›ç»“æœã€‚</p>
<p><code>FLOOR()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å°äºå¹³å‡å€¼çš„æœ€å¤§æ•´æ•°"><a class="header" href="#è®¡ç®—å°äºå¹³å‡å€¼çš„æœ€å¤§æ•´æ•°">è®¡ç®—å°äºå¹³å‡å€¼çš„æœ€å¤§æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT FLOOR(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 floor
----                 -----
2021-09-18T00:00:00Z 55
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„å°äº<code>temperature</code>å¹³å‡å€¼çš„æœ€å¤§æ•´æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>FLOOR()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—å°äºè¿™äº›å¹³å‡å€¼çš„æœ€å¤§æ•´æ•°ã€‚</p>
</li>
<li>
<h3 id="ln"><a class="header" href="#ln">LN()</a></h3>
<p>è¿”å›field valueçš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-12"><a class="header" href="#åŸºæœ¬è¯­æ³•-12">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT LN( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>LN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<p><code>LN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<p><code>LN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>LN()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<h4 id="ç¤ºä¾‹-37"><a class="header" href="#ç¤ºä¾‹-37">ç¤ºä¾‹</a></h4>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.86.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 ln
----                 --
2021-09-18T00:00:00Z 3.9318256327243257
2021-09-18T00:03:00Z 4.0943445622221
2021-09-18T00:06:00Z 4.007333185232471
2021-09-18T00:09:00Z 4.007333185232471
2021-09-18T00:12:00Z 4.143134726391533
2021-09-18T00:15:00Z 4.304065093204169
2021-09-18T00:18:00Z 4.3694478524670215
2021-09-18T00:21:00Z 4.219507705176107
2021-09-18T00:24:00Z 4.248495242049359
2021-09-18T00:27:00Z 4.3694478524670215
2021-09-18T00:30:00Z 4.31748811353631
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LN(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 ln_pressure        ln_temperature     ln_visibility
----                 -----------        --------------     -------------
2021-09-18T00:00:00Z 4.1588830833596715 3.9318256327243257 4.219507705176107
2021-09-18T00:03:00Z 4.276666119016055  4.0943445622221    4.304065093204169
2021-09-18T00:06:00Z 3.9889840465642745 4.007333185232471  4.343805421853684
2021-09-18T00:09:00Z 4.189654742026425  4.007333185232471  4.007333185232471
2021-09-18T00:12:00Z 4.1588830833596715 4.143134726391533  4.248495242049359
2021-09-18T00:15:00Z 4.060443010546419  4.304065093204169  4.127134385045092
2021-09-18T00:18:00Z 4.007333185232471  4.3694478524670215 3.9889840465642745
2021-09-18T00:21:00Z 4.1588830833596715 4.219507705176107  4.060443010546419
2021-09-18T00:24:00Z 4.189654742026425  4.248495242049359  4.23410650459726
2021-09-18T00:27:00Z 4.343805421853684  4.3694478524670215 4.356708826689592
2021-09-18T00:30:00Z 4.127134385045092  4.31748811353631   4.382026634673881
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„è‡ªç„¶å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 ln
----                 --
2021-09-18T00:24:00Z 4.248495242049359
2021-09-18T00:21:00Z 4.219507705176107
2021-09-18T00:18:00Z 4.3694478524670215
2021-09-18T00:15:00Z 4.304065093204169
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„è‡ªç„¶å¯¹æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-12"><a class="header" href="#é«˜çº§è¯­æ³•-12">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT LN(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª GROUP BY time() <code>å’Œä¸€ä¸ªåµŒå¥—çš„cnosQL å‡½æ•°. è¯¥æŸ¥è¯¢å—é™ä»¥æŒ‡å®š</code>GROUP BY time()<code>é—´éš”è®¡ç®—åµŒå¥—å‡½æ•°çš„ç»“æœ </code>LN()` .</p>
<p>LN()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a>,
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a>, and
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a>.</p>
</li>
</ul>
<h4 id="ç¤ºä¾‹-38"><a class="header" href="#ç¤ºä¾‹-38">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„è‡ªç„¶å¯¹æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„è‡ªç„¶å¯¹æ•°">è®¡ç®—å¹³å‡å€¼çš„è‡ªç„¶å¯¹æ•°</a></h4>
<pre><code class="language-sql">&gt; SELECT LN(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 ln
----                 --
2021-09-18T00:00:00Z 4.0118683403978626
2021-09-18T00:12:00Z 4.2626798770413155
2021-09-18T00:24:00Z 4.31303376318693
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>LN()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„è‡ªç„¶å¯¹æ•°ã€‚</p>
<ul>
<li>
<h3 id="log"><a class="header" href="#log">LOG()</a></h3>
<p>è¿”å›field valueçš„ä»¥<code>b</code>ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-13"><a class="header" href="#åŸºæœ¬è¯­æ³•-13">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT LOG( [ * | &lt;field_key&gt; ], &lt;b&gt; ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>LOG(field_key, b)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ä»¥<code>b</code>ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG(*, b)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥<code>b</code>ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>LOG()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.87.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG(&quot;temperature&quot;, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log
----                 ---
2021-09-18T00:00:00Z 2.836212670985748
2021-09-18T00:03:00Z 2.9534452978042594
2021-09-18T00:06:00Z 2.89067985676233
2021-09-18T00:09:00Z 2.89067985676233
2021-09-18T00:12:00Z 2.9886399617499584
2021-09-18T00:15:00Z 3.1047266828144746
2021-09-18T00:18:00Z 3.1518903740885515
2021-09-18T00:21:00Z 3.04373142062517
2021-09-18T00:24:00Z 3.0646415084724836
2021-09-18T00:27:00Z 3.1518903740885515
2021-09-18T00:30:00Z 3.11440934524794
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG(*, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log_pressure       log_temperature    log_visibility
----                 ------------       ---------------    --------------
2021-09-18T00:00:00Z 3                  2.836212670985748  3.04373142062517
2021-09-18T00:03:00Z 3.084962500721156  2.9534452978042594 3.1047266828144746
2021-09-18T00:06:00Z 2.8774437510817346 2.89067985676233   3.133393270347451
2021-09-18T00:09:00Z 3.0221970596792267 2.89067985676233   2.89067985676233
2021-09-18T00:12:00Z 3                  2.9886399617499584 3.0646415084724836
2021-09-18T00:15:00Z 2.928990497563786  3.1047266828144746 2.977098155193438
2021-09-18T00:18:00Z 2.89067985676233   3.1518903740885515 2.8774437510817346
2021-09-18T00:21:00Z 3                  3.04373142062517   2.928990497563786
2021-09-18T00:24:00Z 3.0221970596792267 3.0646415084724836 3.054262228389085
2021-09-18T00:27:00Z 3.133393270347451  3.1518903740885515 3.1427011094311244
2021-09-18T00:30:00Z 2.977098155193438  3.11440934524794   3.160964047443681
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG(&quot;temperature&quot;, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 log
----                 ---
2021-09-18T00:24:00Z 3.0646415084724836
2021-09-18T00:21:00Z 3.04373142062517
2021-09-18T00:18:00Z 3.1518903740885515
2021-09-18T00:15:00Z 3.1047266828144746
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-13"><a class="header" href="#é«˜çº§è¯­æ³•-13">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT LOG(&lt;function&gt;( [ * | &lt;field_key&gt; ] ), &lt;b&gt;) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„å¯¹æ•°ã€‚</p>
<p><code>LOG()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—å¹³å‡å€¼çš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG(MEAN(&quot;temperature&quot;), 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 log
----                 ---
2021-09-18T00:00:00Z 2.8939512796957163
2021-09-18T00:12:00Z 3.074873559752341
2021-09-18T00:24:00Z 3.1111962106682243
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>LOG()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ä»¥4ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
</li>
<li>
<h3 id="log2"><a class="header" href="#log2">LOG2()</a></h3>
<p>è¿”å›field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-14"><a class="header" href="#åŸºæœ¬è¯­æ³•-14">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT LOG2( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>LOG2(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG2(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG2()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>LOG2()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.88.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG2(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log2
----                 ----
2021-09-18T00:00:00Z 5.672425341971495
2021-09-18T00:03:00Z 5.906890595608519
2021-09-18T00:06:00Z 5.78135971352466
2021-09-18T00:09:00Z 5.78135971352466
2021-09-18T00:12:00Z 5.977279923499917
2021-09-18T00:15:00Z 6.20945336562895
2021-09-18T00:18:00Z 6.303780748177103
2021-09-18T00:21:00Z 6.087462841250339
2021-09-18T00:24:00Z 6.129283016944966
2021-09-18T00:27:00Z 6.303780748177103
2021-09-18T00:30:00Z 6.22881869049588
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG2(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log2_pressure     log2_temperature  log2_visibility
----                 -------------     ----------------  ---------------
2021-09-18T00:00:00Z 6                 5.672425341971495 6.087462841250339
2021-09-18T00:03:00Z 6.169925001442312 5.906890595608519 6.20945336562895
2021-09-18T00:06:00Z 5.754887502163468 5.78135971352466  6.266786540694901
2021-09-18T00:09:00Z 6.044394119358453 5.78135971352466  5.78135971352466
2021-09-18T00:12:00Z 6                 5.977279923499917 6.129283016944966
2021-09-18T00:15:00Z 5.857980995127572 6.20945336562895  5.954196310386875
2021-09-18T00:18:00Z 5.78135971352466  6.303780748177103 5.754887502163468
2021-09-18T00:21:00Z 6                 6.087462841250339 5.857980995127572
2021-09-18T00:24:00Z 6.044394119358453 6.129283016944966 6.108524456778169
2021-09-18T00:27:00Z 6.266786540694901 6.303780748177103 6.285402218862249
2021-09-18T00:30:00Z 5.954196310386875 6.22881869049588  6.321928094887363
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG2(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 log2
----                 ----
2021-09-18T00:24:00Z 6.129283016944966
2021-09-18T00:21:00Z 6.087462841250339
2021-09-18T00:18:00Z 6.303780748177103
2021-09-18T00:15:00Z 6.20945336562895
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-14"><a class="header" href="#é«˜çº§è¯­æ³•-14">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT LOG2(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG2()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—å¹³å‡å€¼çš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG2(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 log2
----                 ----
2021-09-18T00:00:00Z 5.787902559391432
2021-09-18T00:12:00Z 6.149747119504682
2021-09-18T00:24:00Z 6.222392421336448
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>LOG2()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ä»¥2ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
</li>
<li>
<h3 id="log10"><a class="header" href="#log10">LOG10()</a></h3>
<p>è¿”å›field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-15"><a class="header" href="#åŸºæœ¬è¯­æ³•-15">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT LOG10( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>LOG10(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG10(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG10()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>LOG10()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.89.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG10(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log10
----                 -----
2021-09-18T00:00:00Z 1.7075701760979363
2021-09-18T00:03:00Z 1.7781512503836434
2021-09-18T00:06:00Z 1.7403626894942439
2021-09-18T00:09:00Z 1.7403626894942439
2021-09-18T00:12:00Z 1.7993405494535817
2021-09-18T00:15:00Z 1.869231719730976
2021-09-18T00:18:00Z 1.8976270912904414
2021-09-18T00:21:00Z 1.8325089127062364
2021-09-18T00:24:00Z 1.845098040014257
2021-09-18T00:27:00Z 1.8976270912904414
2021-09-18T00:30:00Z 1.8750612633916999
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG10(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 log10_pressure     log10_temperature  log10_visibility
----                 --------------     -----------------  ----------------
2021-09-18T00:00:00Z 1.806179973983887  1.7075701760979363 1.8325089127062364
2021-09-18T00:03:00Z 1.8573324964312685 1.7781512503836434 1.869231719730976
2021-09-18T00:06:00Z 1.7323937598229686 1.7403626894942439 1.8864907251724818
2021-09-18T00:09:00Z 1.8195439355418686 1.7403626894942439 1.7403626894942439
2021-09-18T00:12:00Z 1.806179973983887  1.7993405494535817 1.845098040014257
2021-09-18T00:15:00Z 1.7634279935629371 1.869231719730976  1.792391689498254
2021-09-18T00:18:00Z 1.7403626894942439 1.8976270912904414 1.7323937598229686
2021-09-18T00:21:00Z 1.806179973983887  1.8325089127062364 1.7634279935629371
2021-09-18T00:24:00Z 1.8195439355418686 1.845098040014257  1.8388490907372554
2021-09-18T00:27:00Z 1.8864907251724818 1.8976270912904414 1.8920946026904804
2021-09-18T00:30:00Z 1.792391689498254  1.8750612633916999 1.9030899869919433
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG10(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 log10
----                 -----
2021-09-18T00:24:00Z 1.845098040014257
2021-09-18T00:21:00Z 1.8325089127062364
2021-09-18T00:18:00Z 1.8976270912904414
2021-09-18T00:15:00Z 1.869231719730976
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-15"><a class="header" href="#é«˜çº§è¯­æ³•-15">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT LOG10(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p><code>LOG10()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°">è®¡ç®—å¹³å‡å€¼çš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT LOG10(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 log10
----                 -----
2021-09-18T00:00:00Z 1.7423322823571483
2021-09-18T00:12:00Z 1.8512583487190752
2021-09-18T00:24:00Z 1.8731267636145004
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>LOG10()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„ä»¥10ä¸ºåº•æ•°çš„å¯¹æ•°ã€‚</p>
</li>
<li>
<h3 id="moving_average"><a class="header" href="#moving_average">MOVING_AVERAGE()</a></h3>
<p>è¿”å›field valueçª—å£çš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-16"><a class="header" href="#åŸºæœ¬è¯­æ³•-16">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT MOVING_AVERAGE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] , &lt;N&gt; ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>MOVING_AVERAGE()</code>è®¡ç®—åŒ…å«<code>N</code>ä¸ªè¿ç»­field valueçš„çª—å£çš„æ»šåŠ¨å¹³å‡å€¼ã€‚å‚æ•°<code>N</code>æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶ä¸”å®ƒæ˜¯å¿…é¡»çš„ã€‚</p>
<p><code>MOVING_AVERAGE(field_key,N)</code>è¿”å›field keyå¯¹åº”çš„Nä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<p><code>MOVING_AVERAGE(/regular_expression/,N)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„Nä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<p><code>MOVING_AVERAGE(*,N)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„Nä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<p><code>MOVING_AVERAGE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>MOVING_AVERAGE()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
</li>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ»šåŠ¨å¹³å‡å€¼</a></h4>
<pre><code class="language-sql">&gt; SELECT MOVING_AVERAGE(&quot;temperature&quot;,2) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 moving_average
----                 --------------
2021-09-18T00:03:00Z 55.5
2021-09-18T00:06:00Z 57.5
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 59
2021-09-18T00:15:00Z 68.5
2021-09-18T00:18:00Z 76.5
2021-09-18T00:21:00Z 73.5
2021-09-18T00:24:00Z 69
2021-09-18T00:27:00Z 74.5
2021-09-18T00:30:00Z 77
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„çª—å£å¤§å°ä¸ºä¸¤ä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚ç¬¬ä¸€ä¸ªç»“æœ(<code>2.09</code>)æ˜¯åŸå§‹æ•°æ®ä¸­å‰ä¸¤ä¸ªfield valueçš„å¹³å‡å€¼ï¼š(2.064 + 2.116) / 2ã€‚ç¬¬äºŒä¸ªç»“æœ(<code>2.072</code>)æ˜¯åŸå§‹æ•°æ®ä¸­ç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªfield valueçš„å¹³å‡å€¼ï¼š(2.116 + 2.028) / 2ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ»šåŠ¨å¹³å‡å€¼</a></h4>
<pre><code class="language-sql">&gt; SELECT MOVING_AVERAGE(*,3) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 moving_average_pressure moving_average_temperature moving_average_visibility
----                 ----------------------- -------------------------- -------------------------
2021-09-18T00:06:00Z 63.333333333333336      55.333333333333336         73
2021-09-18T00:09:00Z 64                      56.666666666666664         68.66666666666667
2021-09-18T00:12:00Z 61.333333333333336      57.666666666666664         67.33333333333333
2021-09-18T00:15:00Z 62.666666666666664      64                         62.333333333333336
2021-09-18T00:18:00Z 59                      72                         62
2021-09-18T00:21:00Z 59                      73.66666666666667          58
2021-09-18T00:24:00Z 61.666666666666664      72.33333333333333          60.333333333333336
2021-09-18T00:27:00Z 69                      72.33333333333333          68.33333333333333
2021-09-18T00:30:00Z 68.33333333333333       74.66666666666667          75.66666666666667
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„çª—å£å¤§å°ä¸ºä¸‰ä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼"><a class="header" href="#è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼">è®¡ç®—ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ»šåŠ¨å¹³å‡å€¼</a></h4>
<pre><code>&gt; SELECT MOVING_AVERAGE(/press/,4) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z'
name: air
time                 moving_average_pressure
----                 -----------------------
2021-09-18T00:09:00Z 64
2021-09-18T00:12:00Z 64
2021-09-18T00:15:00Z 60.5
2021-09-18T00:18:00Z 60.75
2021-09-18T00:21:00Z 60.25
2021-09-18T00:24:00Z 60.75
2021-09-18T00:27:00Z 65.5
2021-09-18T00:30:00Z 67.25
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼å¹¶åŒ…å«å•è¯<code>level</code>çš„field keyå¯¹åº”çš„çª—å£å¤§å°ä¸ºå››ä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ»šåŠ¨å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ»šåŠ¨å¹³å‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
<pre><code class="language-sql">&gt; SELECT MOVING_AVERAGE(&quot;temperature&quot;,2) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' ORDER BY time DESC LIMIT 2 OFFSET 3
name: air
time                 moving_average
----                 --------------
2021-09-18T00:18:00Z 73.5
2021-09-18T00:15:00Z 76.5
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„çª—å£å¤§å°ä¸ºä¸¤ä¸ªfield valueçš„æ»šåŠ¨å¹³å‡å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º2ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸‰ä¸ª(å³å‰ä¸‰ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-16"><a class="header" href="#é«˜çº§è¯­æ³•-16">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT MOVING_AVERAGE(&lt;function&gt; ([ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ]) , N ) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœä¹‹é—´çš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<p><code>MOVING_AVERAGE()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—æœ€å¤§å€¼çš„æ»šåŠ¨å¹³å‡å€¼"><a class="header" href="#è®¡ç®—æœ€å¤§å€¼çš„æ»šåŠ¨å¹³å‡å€¼">è®¡ç®—æœ€å¤§å€¼çš„æ»šåŠ¨å¹³å‡å€¼</a></h4>
<pre><code class="language-sql">&gt; SELECT MOVING_AVERAGE(MAX(&quot;temperature&quot;),2) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)
name: air
time                 moving_average
----                 --------------
2021-09-18T00:00:00Z 69.5
2021-09-18T00:12:00Z 69.5
2021-09-18T00:24:00Z 79
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„æœ€å¤§å€¼çš„çª—å£å¤§å°ä¸ºä¸¤ä¸ªå€¼çš„æ»šåŠ¨å¹³å‡å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„æœ€å¤§å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MAX()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>MOVING_AVERAGE()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot; WHERE &quot;station&quot; = 'LianYunGang' AND time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' GROUP BY time(12m)
name: air
time                 max
----                 ---
2021-09-18T00:00:00Z 60
2021-09-18T00:12:00Z 79
2021-09-18T00:24:00Z 79
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›æœ€å¤§å€¼çš„çª—å£å¤§å°ä¸ºä¸¤ä¸ªå€¼çš„æ»šåŠ¨å¹³å‡å€¼ã€‚æœ€ç»ˆæŸ¥è¯¢ç»“æœä¸­çš„ç¬¬ä¸€ä¸ª<code>point</code>(<code>2.121</code>)æ˜¯å‰ä¸¤ä¸ªæœ€å¤§å€¼çš„å¹³å‡å€¼(<code>(2.116 + 2.126) / 2</code>)ã€‚</p>
<ul>
<li>
<h3 id="non_negative_derivative"><a class="header" href="#non_negative_derivative">NON_NEGATIVE_DERIVATIVE()</a></h3>
<p>è¿”å›field valueä¹‹é—´çš„éè´Ÿå˜åŒ–ç‡ã€‚éè´Ÿå˜åŒ–ç‡åŒ…æ‹¬æ­£çš„å˜åŒ–ç‡å’Œç­‰äº0çš„å˜åŒ–ç‡ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-17"><a class="header" href="#åŸºæœ¬è¯­æ³•-17">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT NON_NEGATIVE_DERIVATIVE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>CnosDBè®¡ç®—field valueä¹‹é—´çš„å·®å€¼ï¼Œå¹¶å°†è¿™äº›ç»“æœè½¬æ¢ä¸ºæ¯ä¸ª<code>unit</code>çš„å˜åŒ–ç‡ã€‚å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>unit</code>é»˜è®¤ä¸ºä¸€ç§’(<code>1s</code>)ã€‚<code>NON_NEGATIVE_DERIVATIVE()</code>åªè¿”å›æ­£çš„å˜åŒ–ç‡å’Œç­‰äº0çš„å˜åŒ–ç‡ã€‚</p>
<p><code>NON_NEGATIVE_DERIVATIVE(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„éè´Ÿå˜åŒ–ç‡ã€‚</p>
<p><code>NON_NEGATIVE_DERIVATIVE(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éè´Ÿå˜åŒ–ç‡ã€‚</p>
<p><code>NON_NEGATIVE_DERIVATIVE(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éè´Ÿå˜åŒ–ç‡ã€‚</p>
<p><code>NON_NEGATIVE_DERIVATIVE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>NON_NEGATIVE_DERIVATIVE()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>è¯·æŸ¥çœ‹<code>DERIVATIVE()</code>æ–‡æ¡£ä¸­çš„ç¤ºä¾‹ï¼Œ<code>NON_NEGATIVE_DERIVATIVE()</code>è·Ÿ<code>DERIVATIVE()</code>çš„è¿è¡Œæ–¹å¼ç›¸åŒï¼Œä½†æ˜¯<code>NON_NEGATIVE_DERIVATIVE()</code>åªè¿”å›æŸ¥è¯¢ç»“æœä¸­æ­£çš„å˜åŒ–ç‡å’Œç­‰äº0çš„å˜åŒ–ç‡ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-17"><a class="header" href="#é«˜çº§è¯­æ³•-17">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT NON_NEGATIVE_DERIVATIVE(&lt;function&gt; ([ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ]) [ , &lt;unit&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„éè´Ÿå¯¼æ•°ã€‚</p>
<p>å‚æ•°<code>unit</code>çš„å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåè·Ÿä¸€ä¸ªæ—¶é—´å•ä½ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¸æ˜¯å¿…é¡»è¦æœ‰çš„ã€‚å¦‚æœæŸ¥è¯¢æ²¡æœ‰æŒ‡å®š<code>unit</code>çš„å€¼ï¼Œé‚£ä¹ˆ<code>unit</code>é»˜è®¤ä¸º<code>GROUP BY time()</code>çš„æ—¶é—´é—´éš”ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œ<code>unit</code>çš„é»˜è®¤å€¼è·ŸåŸºæœ¬è¯­æ³•ä¸­<code>unit</code>çš„é»˜è®¤å€¼ä¸ä¸€æ ·ã€‚<code>NON_NEGATIVE_DERIVATIVE()</code>åªè¿”å›æ­£çš„å˜åŒ–ç‡å’Œç­‰äº0çš„å˜åŒ–ç‡ã€‚</p>
<p><code>NON_NEGATIVE_DERIVATIVE()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a>
####ç¤ºä¾‹</li>
</ul>
<p>è¯·æŸ¥çœ‹<code>DERIVATIVE()</code>æ–‡æ¡£ä¸­çš„ç¤ºä¾‹ï¼Œ<code>NON_NEGATIVE_DERIVATIVE()</code>è·Ÿ<code>DERIVATIVE()</code>çš„è¿è¡Œæ–¹å¼ç›¸åŒï¼Œä½†æ˜¯<code>NON_NEGATIVE_DERIVATIVE()</code>åªè¿”å›æŸ¥è¯¢ç»“æœä¸­æ­£çš„å˜åŒ–ç‡å’Œç­‰äº0çš„å˜åŒ–ç‡ã€‚</p>
</li>
<li>
<h3 id="non_negative_difference"><a class="header" href="#non_negative_difference">NON_NEGATIVE_DIFFERENCE()</a></h3>
<p>è¿”å›field valueä¹‹é—´çš„éè´Ÿå·®å€¼ã€‚éè´Ÿå·®å€¼åŒ…æ‹¬æ­£çš„å·®å€¼å’Œç­‰äº0çš„å·®å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-18"><a class="header" href="#åŸºæœ¬è¯­æ³•-18">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT NON_NEGATIVE_DIFFERENCE( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>NON_NEGATIVE_DIFFERENCE(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„éè´Ÿå·®å€¼ã€‚</p>
<p><code>NON_NEGATIVE_DIFFERENCE(/regular_expression/)</code>è¿”å›ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éè´Ÿå·®å€¼ã€‚</p>
<p><code>NON_NEGATIVE_DIFFERENCE(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„éè´Ÿå·®å€¼ã€‚</p>
<p><code>NON_NEGATIVE_DIFFERENCE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>NON_NEGATIVE_DIFFERENCE()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>è¯·æŸ¥çœ‹<code>DIFFERENCE()</code>æ–‡æ¡£ä¸­çš„ç¤ºä¾‹ï¼Œ<code>NON_NEGATIVE_DIFFERENCE()</code>è·Ÿ<code>DIFFERENCE()</code>çš„è¿è¡Œæ–¹å¼ç›¸åŒï¼Œä½†æ˜¯<code>NON_NEGATIVE_DIFFERENCE()</code>åªè¿”å›æŸ¥è¯¢ç»“æœä¸­æ­£çš„å·®å€¼å’Œç­‰äº0çš„å·®å€¼ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-18"><a class="header" href="#é«˜çº§è¯­æ³•-18">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT NON_NEGATIVE_DIFFERENCE(&lt;function&gt;( [ * | &lt;field_key&gt; | /&lt;regular_expression&gt;/ ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœä¹‹é—´çš„éè´Ÿå·®å€¼ã€‚</p>
<p>`NON_NEGATIVE_DIFFERENCE()æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<p>è¯·æŸ¥çœ‹<code>DIFFERENCE()</code>æ–‡æ¡£ä¸­çš„ç¤ºä¾‹ï¼Œ<code>NON_NEGATIVE_DIFFERENCE()</code>è·Ÿ<code>DIFFERENCE()</code>çš„è¿è¡Œæ–¹å¼ç›¸åŒï¼Œä½†æ˜¯<code>NON_NEGATIVE_DIFFERENCE()</code>åªè¿”å›æŸ¥è¯¢ç»“æœä¸­æ­£çš„å·®å€¼å’Œç­‰äº0çš„å·®å€¼ã€‚</p>
</li>
<li>
<h3 id="pow"><a class="header" href="#pow">POW()</a></h3>
<p>è¿”å›field valueçš„<code>x</code>æ¬¡æ–¹ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-19"><a class="header" href="#åŸºæœ¬è¯­æ³•-19">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT POW( [ * | &lt;field_key&gt; ], &lt;x&gt; ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>POW(field_key, x)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„<code>x</code>æ¬¡æ–¹ã€‚</p>
<p><code>POW(*, x)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„<code>x</code>æ¬¡æ–¹ã€‚</p>
<p><code>POW()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>POW()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.90.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„4æ¬¡æ–¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT POW(&quot;temperature&quot;, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 pow
----                 ---
2021-09-18T00:00:00Z 6765201
2021-09-18T00:03:00Z 12960000
2021-09-18T00:06:00Z 9150625
2021-09-18T00:09:00Z 9150625
2021-09-18T00:12:00Z 15752961
2021-09-18T00:15:00Z 29986576
2021-09-18T00:18:00Z 38950081
2021-09-18T00:21:00Z 21381376
2021-09-18T00:24:00Z 24010000
2021-09-18T00:27:00Z 38950081
2021-09-18T00:30:00Z 31640625
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„4æ¬¡æ–¹ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„4æ¬¡æ–¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT POW(*, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 pow_pressure pow_temperature pow_visibility
----                 ------------ --------------- --------------
2021-09-18T00:00:00Z 16777216     6765201         21381376
2021-09-18T00:03:00Z 26873856     12960000        29986576
2021-09-18T00:06:00Z 8503056      9150625         35153041
2021-09-18T00:09:00Z 18974736     9150625         9150625
2021-09-18T00:12:00Z 16777216     15752961        24010000
2021-09-18T00:15:00Z 11316496     29986576        14776336
2021-09-18T00:18:00Z 9150625      38950081        8503056
2021-09-18T00:21:00Z 16777216     21381376        11316496
2021-09-18T00:24:00Z 18974736     24010000        22667121
2021-09-18T00:27:00Z 35153041     38950081        37015056
2021-09-18T00:30:00Z 14776336     31640625        40960000
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„4æ¬¡æ–¹ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„4æ¬¡æ–¹å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„4æ¬¡æ–¹å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT POW(&quot;temperature&quot;, 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 pow
----                 ---
2021-09-18T00:24:00Z 24010000
2021-09-18T00:21:00Z 21381376
2021-09-18T00:18:00Z 38950081
2021-09-18T00:15:00Z 29986576
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„4æ¬¡æ–¹ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-19"><a class="header" href="#é«˜çº§è¯­æ³•-19">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT POW(&lt;function&gt;( [ * | &lt;field_key&gt; ] ), &lt;x&gt;) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„<code>x</code>æ¬¡æ–¹ã€‚</p>
<p><code>POW()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„4æ¬¡æ–¹"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„4æ¬¡æ–¹">è®¡ç®—å¹³å‡å€¼çš„4æ¬¡æ–¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT POW(MEAN(&quot;temperature&quot;), 4) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 pow
----                 ---
2021-09-18T00:00:00Z 9318137.81640625
2021-09-18T00:12:00Z 25411681
2021-09-18T00:24:00Z 31081863.901234582
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„4æ¬¡æ–¹ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>POW()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„4æ¬¡æ–¹ã€‚</p>
</li>
<li>
<h3 id="round"><a class="header" href="#round">ROUND()</a></h3>
<p>è¿”å›æŒ‡å®šå€¼çš„å››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-20"><a class="header" href="#åŸºæœ¬è¯­æ³•-20">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT ROUND( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>ROUND(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<p><code>ROUND(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<p><code>ROUND()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>ROUND()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<a href="https://gist.github.com/sanderson/8f8aec94a60b2c31a61f44a37737bfea?spm=a2c4g.11186623.2.91.41fc3ee27HC1R6">ç¤ºä¾‹æ•°æ®</a>ä¸­çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ROUND(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 round
----                 -----
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ROUND(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 round_pressure round_temperature round_visibility
----                 -------------- ----------------- ----------------
2021-09-18T00:00:00Z 64             51                68
2021-09-18T00:03:00Z 72             60                74
2021-09-18T00:06:00Z 54             55                77
2021-09-18T00:09:00Z 66             55                55
2021-09-18T00:12:00Z 64             63                70
2021-09-18T00:15:00Z 58             74                62
2021-09-18T00:18:00Z 55             79                54
2021-09-18T00:21:00Z 64             68                58
2021-09-18T00:24:00Z 66             70                69
2021-09-18T00:27:00Z 77             79                78
2021-09-18T00:30:00Z 62             75                80
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueå››èˆäº”å…¥åçš„æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ROUND(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 round
----                 -----
2021-09-18T00:24:00Z 70
2021-09-18T00:21:00Z 68
2021-09-18T00:18:00Z 79
2021-09-18T00:15:00Z 74
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueå››èˆäº”å…¥åçš„æ•´æ•°ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-20"><a class="header" href="#é«˜çº§è¯­æ³•-20">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT ROUND(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœå››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<p><code>ROUND()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼å››èˆäº”å…¥åçš„æ•´æ•°"><a class="header" href="#è®¡ç®—å¹³å‡å€¼å››èˆäº”å…¥åçš„æ•´æ•°">è®¡ç®—å¹³å‡å€¼å››èˆäº”å…¥åçš„æ•´æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT ROUND(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 round
----                 -----
2021-09-18T00:00:00Z 55
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 75
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼å››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>ROUND()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼å››èˆäº”å…¥åçš„æ•´æ•°ã€‚</p>
</li>
<li>
<h3 id="sin"><a class="header" href="#sin">SIN()</a></h3>
<p>è¿”å›field valueçš„æ­£å¼¦å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-21"><a class="header" href="#åŸºæœ¬è¯­æ³•-21">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT SIN( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>SIN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼ã€‚</p>
<p><code>SIN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼ã€‚</p>
<p><code>SIN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>SIN()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SIN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 sin
----                 ---
2021-09-18T00:00:00Z 0.6702291758433747
2021-09-18T00:03:00Z -0.3048106211022167
2021-09-18T00:06:00Z -0.9997551733586199
2021-09-18T00:09:00Z -0.9997551733586199
2021-09-18T00:12:00Z 0.16735570030280694
2021-09-18T00:15:00Z -0.9851462604682474
2021-09-18T00:18:00Z -0.4441126687075084
2021-09-18T00:21:00Z -0.8979276806892912
2021-09-18T00:24:00Z 0.7738906815578891
2021-09-18T00:27:00Z -0.4441126687075084
2021-09-18T00:30:00Z -0.38778163540943045
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ­£å¼¦å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SIN(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 sin_pressure          sin_temperature      sin_visibility
----                 ------------          ---------------      --------------
2021-09-18T00:00:00Z 0.9200260381967907    0.6702291758433747   -0.8979276806892912
2021-09-18T00:03:00Z 0.25382336276203626   -0.3048106211022167  -0.9851462604682474
2021-09-18T00:06:00Z -0.5587890488516162   -0.9997551733586199  0.9995201585807312
2021-09-18T00:09:00Z -0.026551154023966794 -0.9997551733586199  -0.9997551733586199
2021-09-18T00:12:00Z 0.9200260381967907    0.16735570030280694  0.7738906815578891
2021-09-18T00:15:00Z 0.9928726480845371    -0.9851462604682474  -0.7391806966492229
2021-09-18T00:18:00Z -0.9997551733586199   -0.4441126687075084  -0.5587890488516162
2021-09-18T00:21:00Z 0.9200260381967907    -0.8979276806892912  0.9928726480845371
2021-09-18T00:24:00Z -0.026551154023966794 0.7738906815578891   -0.11478481378318722
2021-09-18T00:27:00Z 0.9995201585807312    -0.4441126687075084  0.5139784559875352
2021-09-18T00:30:00Z -0.7391806966492229   -0.38778163540943045 -0.9938886539233751
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ­£å¼¦å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SIN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 sin
----                 ---
2021-09-18T00:24:00Z 0.7738906815578891
2021-09-18T00:21:00Z -0.8979276806892912
2021-09-18T00:18:00Z -0.4441126687075084
2021-09-18T00:15:00Z -0.9851462604682474
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ­£å¼¦å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-21"><a class="header" href="#é«˜çº§è¯­æ³•-21">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT SIN(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„æ­£å¼¦å€¼ã€‚</p>
<p><code>SIN()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼">è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SIN(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 sin
----                 ---
2021-09-18T00:00:00Z -0.9632009590319781
2021-09-18T00:12:00Z 0.9510546532543747
2021-09-18T00:24:00Z -0.6680290772524845
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„æ­£å¼¦å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>SIN()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„æ­£å¼¦å€¼ã€‚</p>
</li>
<li>
<h3 id="sqrt"><a class="header" href="#sqrt">SQRT()</a></h3>
<p>è¿”å›field valueçš„å¹³æ–¹æ ¹ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-22"><a class="header" href="#åŸºæœ¬è¯­æ³•-22">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT SQRT( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>SQRT(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹ã€‚</p>
<p><code>SQRT(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹ã€‚</p>
<p><code>SQRT()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>SQRT()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨â€oceanic_stationâ€æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SQRT(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 sqrt
----                 ----
2021-09-18T00:00:00Z 7.14142842854285
2021-09-18T00:03:00Z 7.745966692414834
2021-09-18T00:06:00Z 7.416198487095663
2021-09-18T00:09:00Z 7.416198487095663
2021-09-18T00:12:00Z 7.937253933193772
2021-09-18T00:15:00Z 8.602325267042627
2021-09-18T00:18:00Z 8.888194417315589
2021-09-18T00:21:00Z 8.246211251235321
2021-09-18T00:24:00Z 8.366600265340756
2021-09-18T00:27:00Z 8.888194417315589
2021-09-18T00:30:00Z 8.660254037844387
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SQRT(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 sqrt_pressure      sqrt_temperature  sqrt_visibility
----                 -------------      ----------------  ---------------
2021-09-18T00:00:00Z 8                  7.14142842854285  8.246211251235321
2021-09-18T00:03:00Z 8.48528137423857   7.745966692414834 8.602325267042627
2021-09-18T00:06:00Z 7.3484692283495345 7.416198487095663 8.774964387392123
2021-09-18T00:09:00Z 8.12403840463596   7.416198487095663 7.416198487095663
2021-09-18T00:12:00Z 8                  7.937253933193772 8.366600265340756
2021-09-18T00:15:00Z 7.615773105863909  8.602325267042627 7.874007874011811
2021-09-18T00:18:00Z 7.416198487095663  8.888194417315589 7.3484692283495345
2021-09-18T00:21:00Z 8                  8.246211251235321 7.615773105863909
2021-09-18T00:24:00Z 8.12403840463596   8.366600265340756 8.306623862918075
2021-09-18T00:27:00Z 8.774964387392123  8.888194417315589 8.831760866327848
2021-09-18T00:30:00Z 7.874007874011811  8.660254037844387 8.94427190999916
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„å¹³æ–¹æ ¹å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SQRT(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 sqrt
----                 ----
2021-09-18T00:24:00Z 8.366600265340756
2021-09-18T00:21:00Z 8.246211251235321
2021-09-18T00:18:00Z 8.888194417315589
2021-09-18T00:15:00Z 8.602325267042627
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„å¹³æ–¹æ ¹ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-22"><a class="header" href="#é«˜çº§è¯­æ³•-22">é«˜çº§è¯­æ³•</a></h4>
<pre><code>SELECT SQRT(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„å¹³æ–¹æ ¹ã€‚</p>
<p><code>SQRT()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„å¹³æ–¹æ ¹"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„å¹³æ–¹æ ¹">è®¡ç®—å¹³å‡å€¼çš„å¹³æ–¹æ ¹</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT SQRT(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 sqrt
----                 ----
2021-09-18T00:00:00Z 7.433034373659253
2021-09-18T00:12:00Z 8.426149773176359
2021-09-18T00:24:00Z 8.640987597877148
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„å¹³æ–¹æ ¹ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>SQRT()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„å¹³æ–¹æ ¹ã€‚</p>
</li>
<li>
<h3 id="tan"><a class="header" href="#tan">TAN()</a></h3>
<p>è¿”å›field valueçš„æ­£åˆ‡å€¼ã€‚</p>
<h4 id="åŸºæœ¬è¯­æ³•-23"><a class="header" href="#åŸºæœ¬è¯­æ³•-23">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>SELECT TAN( [ * | &lt;field_key&gt; ] ) [INTO_clause] FROM_clause [WHERE_clause] [GROUP_BY_clause] [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>TAN(field_key)</code>è¿”å›field keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼ã€‚</p>
<p><code>TAN(*)</code>è¿”å›åœ¨measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼ã€‚</p>
<p><code>TAN()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<p>åŸºæœ¬è¯­æ³•æ”¯æŒgroup by tagsçš„<code>GROUP BY</code>å­å¥ï¼Œä½†æ˜¯ä¸æ”¯æŒgroup by timeã€‚è¯·æŸ¥çœ‹é«˜çº§è¯­æ³•ç« èŠ‚äº†è§£å¦‚ä½•ä½¿ç”¨<code>TAN()</code>å’Œ<code>GROUP BY time()</code>å­å¥ã€‚</p>
<p>####ç¤ºä¾‹</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">&gt; SELECT &quot;temperature&quot; FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 temperature
----                 -----------
2021-09-18T00:00:00Z 51
2021-09-18T00:03:00Z 60
2021-09-18T00:06:00Z 55
2021-09-18T00:09:00Z 55
2021-09-18T00:12:00Z 63
2021-09-18T00:15:00Z 74
2021-09-18T00:18:00Z 79
2021-09-18T00:21:00Z 68
2021-09-18T00:24:00Z 70
2021-09-18T00:27:00Z 79
2021-09-18T00:30:00Z 75
</code></pre>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 tan
----                 ---
2021-09-18T00:00:00Z 0.9030861493754311
2021-09-18T00:03:00Z 0.320040389379563
2021-09-18T00:06:00Z -45.18308791052113
2021-09-18T00:09:00Z -45.18308791052113
2021-09-18T00:12:00Z 0.16974975208268753
2021-09-18T00:15:00Z -5.737022539278999
2021-09-18T00:18:00Z 0.49567753318135577
2021-09-18T00:21:00Z -2.040081598015946
2021-09-18T00:24:00Z 1.2219599181369432
2021-09-18T00:27:00Z 0.49567753318135577
2021-09-18T00:30:00Z -0.42070095062112434
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼"><a class="header" href="#è®¡ç®—measurementä¸­æ¯ä¸ªfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼">è®¡ç®—measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TAN(*) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang'
name: air
time                 tan_pressure         tan_temperature      tan_visibility
----                 ------------         ---------------      --------------
2021-09-18T00:00:00Z 2.3478603091954366   0.9030861493754311   -2.040081598015946
2021-09-18T00:03:00Z -0.26241737750193517 0.320040389379563    -5.737022539278999
2021-09-18T00:06:00Z 0.6738001006480597   -45.18308791052113   -32.268575775934416
2021-09-18T00:09:00Z 0.026560517776039395 -45.18308791052113   -45.18308791052113
2021-09-18T00:12:00Z 2.3478603091954366   0.16974975208268753  1.2219599181369432
2021-09-18T00:15:00Z 8.33085685249046     -5.737022539278999   -1.0975097786622852
2021-09-18T00:18:00Z -45.18308791052113   0.49567753318135577  0.6738001006480597
2021-09-18T00:21:00Z 2.3478603091954366   -2.040081598015946   8.33085685249046
2021-09-18T00:24:00Z 0.026560517776039395 1.2219599181369432   -0.11554854579453279
2021-09-18T00:27:00Z -32.268575775934416  0.49567753318135577  -0.5991799983411151
2021-09-18T00:30:00Z -1.0975097786622852  -0.42070095062112434 9.00365494560708
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­æ¯ä¸ªå­˜å‚¨æ•°å€¼çš„field keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼ã€‚ã€‚measurement <code>air</code>ä¸­æœ‰ä¸‰ä¸ªæ•°å€¼ç±»å‹çš„fieldï¼š<code>temperature</code>ã€<code>pressure</code>ä»¥åŠ<code>visibility</code>ã€‚</p>
<ul>
<li>
<h4 id="è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥"><a class="header" href="#è®¡ç®—æŒ‡å®šfield-keyå¯¹åº”çš„field-valueçš„æ­£åˆ‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥">è®¡ç®—æŒ‡å®šfield keyå¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼å¹¶åŒ…å«å¤šä¸ªå­å¥</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' ORDER BY time DESC LIMIT 4 OFFSET 2
name: air
time                 tan
----                 ---
2021-09-18T00:24:00Z 1.2219599181369432
2021-09-18T00:21:00Z -2.040081598015946
2021-09-18T00:18:00Z 0.49567753318135577
2021-09-18T00:15:00Z -5.737022539278999
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›measurement <code>air</code>ä¸­field key <code>temperature</code>å¯¹åº”çš„field valueçš„æ­£åˆ‡å€¼ï¼Œå®ƒæ¶µç›–çš„æ—¶é—´èŒƒå›´åœ¨<code>2021-09-28T00:00:00Z</code>å’Œ<code>2021-09-18T00:30:00Z</code>ä¹‹é—´ï¼Œå¹¶ä¸”ä»¥é€’å‡çš„æ—¶é—´æˆ³é¡ºåºè¿”å›ç»“æœï¼ŒåŒæ—¶ï¼Œè¯¥æŸ¥è¯¢å°†è¿”å›çš„<code>point</code>ä¸ªæ•°é™åˆ¶ä¸º4ï¼Œå¹¶å°†è¿”å›çš„<code>point</code>åç§»ä¸¤ä¸ª(å³å‰ä¸¤ä¸ª<code>point</code>ä¸è¿”å›ï¼‰ã€‚</p>
<h4 id="é«˜çº§è¯­æ³•-23"><a class="header" href="#é«˜çº§è¯­æ³•-23">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">SELECT TAN(&lt;function&gt;( [ * | &lt;field_key&gt; ] )) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p>é«˜çº§è¯­æ³•éœ€è¦ä¸€ä¸ª<code>GROUP BY time()</code>å­å¥å’Œä¸€ä¸ªåµŒå¥—çš„cnosQLå‡½æ•°ã€‚æŸ¥è¯¢é¦–å…ˆè®¡ç®—åœ¨æŒ‡å®šçš„<code>GROUP BY time()</code>é—´éš”å†…åµŒå¥—å‡½æ•°çš„ç»“æœï¼Œç„¶åè®¡ç®—è¿™äº›ç»“æœçš„æ­£åˆ‡å€¼ã€‚</p>
<p><code>TAN()</code>æ”¯æŒä»¥ä¸‹åµŒå¥—å‡½æ•°ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mean"><code>MEAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#median"><code>MEDIAN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#mode"><code>MODE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#sum"><code>SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#first"><code>FIRST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#last"><code>LAST()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#min"><code>MIN()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#max"><code>MAX()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#percentile"><code>PERCENTILE()</code></a></li>
</ul>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼-1"><a class="header" href="#è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼-1">è®¡ç®—å¹³å‡å€¼çš„æ­£å¼¦å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT TAN(MEAN(&quot;temperature&quot;)) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 tan
----                 ---
2021-09-18T00:00:00Z -3.583573177439047
2021-09-18T00:12:00Z -3.0776204031933605
2021-09-18T00:24:00Z -0.8977254452596822
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼çš„æ­£åˆ‡å€¼ã€‚</p>
<p>ä¸ºäº†å¾—åˆ°è¿™äº›ç»“æœï¼ŒCnosDBé¦–å…ˆè®¡ç®—æ¯12åˆ†é’Ÿçš„æ—¶é—´é—´éš”å¯¹åº”çš„<code>temperature</code>çš„å¹³å‡å€¼ã€‚è¿™ä¸€æ­¥è·ŸåŒæ—¶ä½¿ç”¨<code>MEAN()</code>å‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ã€ä½†ä¸ä½¿ç”¨<code>TAN()</code>çš„æƒ…å½¢ä¸€æ ·ï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:30:00Z' AND &quot;station&quot; = 'LianYunGang' GROUP BY time(12m)
name: air
time                 mean
----                 ----
2021-09-18T00:00:00Z 55.25
2021-09-18T00:12:00Z 71
2021-09-18T00:24:00Z 74.66666666666667
</code></pre>
<p>ç„¶åï¼ŒCnosDBè®¡ç®—è¿™äº›å¹³å‡å€¼çš„æ­£åˆ‡å€¼ã€‚</p>
</li>
</ul>
<h3 id="é¢„æµ‹å‡½æ•°"><a class="header" href="#é¢„æµ‹å‡½æ•°">é¢„æµ‹å‡½æ•°</a></h3>
<ul>
<li>
<h3 id="holt_winters"><a class="header" href="#holt_winters">HOLT_WINTERS()</a></h3>
<ul>
<li>
<p>ä½¿ç”¨<a href="https://www.otexts.org/fpp/7/5?spm=a2c4g.11186623.2.92.41fc3ee27HC1R6">Holt-Winters</a>çš„å­£èŠ‚æ€§æ–¹æ³•è¿”å›Nä¸ªé¢„æµ‹çš„field valueã€‚</p>
<p><code>HOLT_WINTERS()</code>å¯ç”¨äºï¼š</p>
<ul>
<li>é¢„æµ‹æ—¶é—´ä»€ä¹ˆæ—¶å€™ä¼šè¶…è¿‡ç»™å®šçš„é˜ˆå€¼</li>
<li>å°†é¢„æµ‹å€¼ä¸å®é™…å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ£€æµ‹æ•°æ®ä¸­çš„å¼‚å¸¸</li>
</ul>
</li>
</ul>
<h4 id="è¯­æ³•-32"><a class="header" href="#è¯­æ³•-32">è¯­æ³•</a></h4>
<pre><code>SELECT HOLT_WINTERS[_WITH-FIT](&lt;function&gt;(&lt;field_key&gt;),&lt;N&gt;,&lt;S&gt;) [INTO_clause] FROM_clause [WHERE_clause] GROUP_BY_clause [ORDER_BY_clause] [LIMIT_clause] [OFFSET_clause] [SLIMIT_clause] [SOFFSET_clause]
</code></pre>
<p><code>HOLT_WINTERS(function(field_key),N,S)</code>è¿”å›field keyå¯¹åº”çš„<code>N</code>ä¸ªå­£èŠ‚æ€§è°ƒæ•´çš„é¢„æµ‹field valueã€‚</p>
<p><code>N</code>ä¸ªé¢„æµ‹å€¼å‡ºç°çš„æ—¶é—´é—´éš”è·Ÿgroup by timeæ—¶é—´é—´éš”ç›¸åŒã€‚å¦‚æœæ‚¨çš„<code>GROUP BY time()</code>æ—¶é—´é—´éš”æ˜¯<code>6m</code>å¹¶ä¸”<code>N</code>ç­‰äº<code>3</code>ï¼Œé‚£ä¹ˆæ‚¨å°†ä¼šå¾—åˆ°3ä¸ªæ—¶é—´é—´éš”ä¸º6åˆ†é’Ÿçš„é¢„æµ‹å€¼ã€‚</p>
<p><code>S</code>æ˜¯ä¸€ä¸ªå­£èŠ‚æ€§æ¨¡å¼å‚æ•°ï¼Œå¹¶ä¸”æ ¹æ®<code>GROUP BY time()</code>æ—¶é—´é—´éš”é™å®šä¸€ä¸ªå­£èŠ‚æ€§æ¨¡å¼çš„é•¿åº¦ã€‚å¦‚æœæ‚¨çš„<code>GROUP BY time()</code>æ—¶é—´é—´éš”æ˜¯<code>2m</code>å¹¶ä¸”<code>S</code>ç­‰äº<code>3</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªå­£èŠ‚æ€§æ¨¡å¼æ¯å…­åˆ†é’Ÿå‡ºç°ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸‰ä¸ª<code>point</code>ã€‚å¦‚æœæ‚¨ä¸å¸Œæœ›å­£èŠ‚æ€§è°ƒæ•´æ‚¨çš„é¢„æµ‹å€¼ï¼Œè¯·å°†<code>S</code>è®¾ç½®ä¸º<code>0</code>æˆ–<code>1</code>ã€‚</p>
<p><code>HOLT_WINTERS_WITH_FIT(function(field_key),N,S)</code>é™¤äº†è¿”å›field keyå¯¹åº”çš„<code>N</code>ä¸ªå­£èŠ‚æ€§è°ƒæ•´çš„é¢„æµ‹field valueï¼Œè¿˜è¿”å›æ‹Ÿåˆå€¼ã€‚</p>
<p><code>HOLT_WINTERS()</code>å’Œ<code>HOLT_WINTERS_WITH_FIT()</code>å¤„ç†ä»¥ç›¸åŒçš„æ—¶é—´é—´éš”å‡ºç°çš„æ•°æ®ï¼›åµŒå¥—çš„cnosQLå‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥ç¡®ä¿Holt-Winterså‡½æ•°èƒ½å¤Ÿå¯¹å¸¸è§„æ•°æ®è¿›è¡Œæ“ä½œã€‚</p>
<p><code>HOLT_WINTERS()</code>å’Œ<code>HOLT_WINTERS_WITH_FIT()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<h4 id="ç¤ºä¾‹-39"><a class="header" href="#ç¤ºä¾‹-39">ç¤ºä¾‹</a></h4>
<ul>
<li>
<h4 id="é¢„æµ‹æŒ‡å®šfield-keyçš„field-value"><a class="header" href="#é¢„æµ‹æŒ‡å®šfield-keyçš„field-value">é¢„æµ‹æŒ‡å®šfield keyçš„field value</a></h4>
</li>
<li>
<h4 id="åŸå§‹æ•°æ®"><a class="header" href="#åŸå§‹æ•°æ®">åŸå§‹æ•°æ®</a></h4>
</li>
</ul>
<p>è¯¥ç¤ºä¾‹é‡ç‚¹å…³æ³¨<code>oceanic_station</code>æ•°æ®é›†çš„å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code class="language-sql">SELECT &quot;temperature&quot; FROM &quot;oceanic_station&quot;.&quot;autogen&quot;.&quot;air&quot; WHERE &quot;station&quot;='LianYunGang' AND time &gt;= '2021-09-12 12:12:00' AND time &lt;= '2021-09-28 04:00:00'
</code></pre>
<ul>
<li>
<h4 id="æ­¥éª¤ä¸€åŒ¹é…åŸå§‹æ•°æ®çš„è¶‹åŠ¿"><a class="header" href="#æ­¥éª¤ä¸€åŒ¹é…åŸå§‹æ•°æ®çš„è¶‹åŠ¿">æ­¥éª¤ä¸€ï¼šåŒ¹é…åŸå§‹æ•°æ®çš„è¶‹åŠ¿</a></h4>
</li>
</ul>
<p>ç¼–å†™ä¸€ä¸ª<code>GROUP BY time()</code>æŸ¥è¯¢ï¼Œä½¿å¾—å®ƒåŒ¹é…åŸå§‹<code>temperature</code>æ•°æ®çš„æ€»ä½“è¶‹åŠ¿ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>FIRST()</code>å‡½æ•°ï¼š</p>
<pre><code class="language-sql">SELECT FIRST(&quot;temperature&quot;) FROM &quot;oceanic_station&quot;.&quot;autogen&quot;.&quot;air&quot; WHERE &quot;station&quot;='LianYunGang' and time &gt;= '2021-09-12 12:12:00' and time &lt;= '2021-09-28 04:00:00' GROUP BY time(379m,348m)
</code></pre>
<p>åœ¨<code>GROUP BY time()</code>å­å¥ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°(<code>379m</code>)åŒ¹é…<code>temperature</code>æ•°æ®ä¸­æ¯ä¸ªæ³¢å³°å’Œæ³¢è°·ä¹‹é—´å‘ç”Ÿçš„æ—¶é—´é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°(<code>348m</code>)æ˜¯ä¸€ä¸ªåç§»é—´éš”ï¼Œå®ƒé€šè¿‡æ”¹å˜CnosDBçš„é»˜è®¤<code>GROUP BY time()</code>è¾¹ç•Œæ¥åŒ¹é…åŸå§‹æ•°æ®çš„æ—¶é—´èŒƒå›´ã€‚</p>
<ul>
<li>
<h4 id="æ­¥éª¤äºŒç¡®å®šå­£èŠ‚æ€§æ¨¡å¼"><a class="header" href="#æ­¥éª¤äºŒç¡®å®šå­£èŠ‚æ€§æ¨¡å¼">æ­¥éª¤äºŒï¼šç¡®å®šå­£èŠ‚æ€§æ¨¡å¼</a></h4>
</li>
</ul>
<p>ä½¿ç”¨æ­¥éª¤ä¸€ä¸­æŸ¥è¯¢çš„ä¿¡æ¯ç¡®å®šæ•°æ®ä¸­çš„å­£èŠ‚æ€§æ¨¡å¼ã€‚</p>
<ul>
<li>
<h4 id="æ­¥éª¤ä¸‰åº”ç”¨holt_winterså‡½æ•°"><a class="header" href="#æ­¥éª¤ä¸‰åº”ç”¨holt_winterså‡½æ•°">æ­¥éª¤ä¸‰ï¼šåº”ç”¨<code>HOLT_WINTERS()</code>å‡½æ•°</a></h4>
</li>
</ul>
<p>åœ¨æŸ¥è¯¢ä¸­åŠ å…¥Holt-Winterså‡½æ•°ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code>HOLT_WINTERS_WITH_FIT()</code>æ¥æŸ¥çœ‹æ‹Ÿåˆå€¼å’Œé¢„æµ‹å€¼ï¼š</p>
<pre><code class="language-sql">SELECT HOLT_WINTERS_WITH_FIT(FIRST(&quot;temperature&quot;),10,4) FROM &quot;oceanic_station&quot;.&quot;autogen&quot;.&quot;air&quot; WHERE &quot;station&quot;='LianYunGang' AND time &gt;= '2021-09-12 12:12:00' AND time &lt;= '2021-09-28 04:00:00' GROUP BY time(379m,348m)
</code></pre>
<p>åœ¨<code>HOLT_WINTERS_WITH_FIT()</code>å‡½æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°(<code>10</code>)è¯·æ±‚10ä¸ªé¢„æµ‹çš„field valueã€‚æ¯ä¸ªé¢„æµ‹çš„<code>point</code>ç›¸è·<code>379m</code>ï¼Œä¸<code>GROUP BY time()</code>å­å¥ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ç›¸åŒã€‚<code>HOLT_WINTERS_WITH_FIT()</code>å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°(<code>4</code>)æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥éª¤ä¸­ç¡®å®šçš„å­£èŠ‚æ€§æ¨¡å¼ã€‚</p>
<h4 id="holt_wintersçš„å¸¸è§é—®é¢˜"><a class="header" href="#holt_wintersçš„å¸¸è§é—®é¢˜"><code>HOLT_WINTERS()</code>çš„å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="holt_winterså’Œæ”¶åˆ°çš„pointå°‘äºnä¸ª"><a class="header" href="#holt_winterså’Œæ”¶åˆ°çš„pointå°‘äºnä¸ª"><code>HOLT_WINTERS()</code>å’Œæ”¶åˆ°çš„<code>point</code>å°‘äºâ€Nâ€ä¸ª</a></h4>
</li>
</ul>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ”¶åˆ°æ¯”å‚æ•°<code>N</code>è¯·æ±‚çš„æ›´å°‘çš„é¢„æµ‹<code>point</code>ã€‚å½“æ•°å­¦è®¡ç®—ä¸ç¨³å®šå’Œä¸èƒ½é¢„æµ‹æ›´å¤š<code>point</code>æ—¶ï¼Œè¿™ç§æƒ…å†µå°±ä¼šå‘ç”Ÿã€‚è¿™æ„å‘³ç€è¯¥æ•°æ®é›†ä¸é€‚åˆä½¿ç”¨<code>HOLT_WINTERS()</code>ï¼Œæˆ–è€…ï¼Œå­£èŠ‚æ€§è°ƒæ•´å‚æ•°æ˜¯æ— æ•ˆçš„å¹¶ä¸”æ˜¯ç®—æ³•æ··ä¹±ã€‚</p>
</li>
</ul>
<h3 id="åˆ†æå‡½æ•°"><a class="header" href="#åˆ†æå‡½æ•°">åˆ†æå‡½æ•°</a></h3>
<p>ä¸‹é¢æŠ€æœ¯åˆ†æçš„å‡½æ•°å°†å¹¿æ³›ä½¿ç”¨çš„ç®—æ³•åº”ç”¨åœ¨æ‚¨çš„æ•°æ®ä¸­ã€‚è™½ç„¶è¿™äº›å‡½æ•°ä¸»è¦åº”ç”¨åœ¨é‡‘èå’ŒæŠ•èµ„é¢†åŸŸï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿé€‚ç”¨äºå…¶å®ƒè¡Œä¸šå’Œç”¨ä¾‹ã€‚</p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#chande_momentum_oscillator">CHANDE_MOMENTUM_OSCILLATOR()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#exponential_moving_average">EXPONENTIAL_MOVING_AVERAGE()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#double_exponential_moving_average">DOUBLE_EXPONENTIAL_MOVING_AVERAGE()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_efficiency_ratio">KAUFMANS_EFFICIENCY_RATIO()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_adaptive_moving_average">KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_moving_average">TRIPLE_EXPONENTIAL_MOVING_AVERAGE()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_derivative">TRIPLE_EXPONENTIAL_DERIVATIVE()</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#relative_strength_index">RELATIVE_STRENGTH_INDEX()</a></p>
<ul>
<li>
<h3 id="å‚æ•°"><a class="header" href="#å‚æ•°">å‚æ•°</a></h3>
<p>é™¤äº†field keyï¼ŒæŠ€æœ¯åˆ†æå‡½æ•°è¿˜æ¥å—ä»¥ä¸‹å‚æ•°ï¼š</p>
<p><code>PERIOD</code></p>
<p><strong>å¿…éœ€ï¼Œæ•´æ•°ï¼Œmin=1</strong></p>
<p>ç®—æ³•çš„æ ·æœ¬å¤§å°ã€‚è¿™åŸºæœ¬ä¸Šæ˜¯å¯¹ç®—æ³•çš„è¾“å‡ºæœ‰æ˜¾è‘—å½±å“çš„å†å²æ ·æœ¬çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼Œ<code>2</code>è¡¨ç¤ºå½“å‰çš„<code>point</code>å’Œå‰ä¸€ä¸ª<code>point</code>ã€‚ç®—æ³•ä½¿ç”¨æŒ‡æ•°è¡°å‡ç‡æ¥å†³å®šå†å²<code>point</code>çš„æƒé‡ï¼Œé€šå¸¸ç§°ä¸º<code>alpha(Î±)</code>ã€‚å‚æ•°<code>PERIOD</code>æ§åˆ¶è¡°å‡ç‡ã€‚</p>
<blockquote>
<p>è¯·æ³¨æ„ï¼Œå†å²<code>point</code>ä»ç„¶å¯ä»¥äº§ç”Ÿå½±å“ã€‚</p>
</blockquote>
<h4 id="hold_period"><a class="header" href="#hold_period">HOLD_PERIOD</a></h4>
<p><strong>æ•´æ•°ï¼Œmin=-1</strong></p>
<p>ç®—æ³•éœ€è¦å¤šå°‘ä¸ªæ ·æœ¬æ‰ä¼šå¼€å§‹å‘é€ç»“æœã€‚é»˜è®¤å€¼<code>-1</code>è¡¨ç¤ºè¯¥å‚æ•°çš„å€¼åŸºäºç®—æ³•ã€<code>PERIOD</code>å’Œ<code>WARMUP_TYPE</code>ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå¯ä»¥ä½¿ç®—æ³•å‘é€æœ‰æ„ä¹‰çš„ç»“æœçš„å€¼ã€‚</p>
<p><strong>é»˜è®¤çš„Hold Periodsï¼š</strong></p>
<p>å¯¹äºå¤§å¤šæ•°æä¾›çš„æŠ€æœ¯åˆ†æï¼Œ<code>HOLD_PERIOD</code>çš„é»˜è®¤å€¼ç”±æ‚¨ä½¿ç”¨çš„æŠ€æœ¯åˆ†æç®—æ³•å’Œ<code>WARMUP_TYPE</code>å†³å®šã€‚</p>
</li>
</ul>
<table><thead><tr><th>ç®—æ³• \ Warmup Type</th><th>simple</th><th>exponential</th><th style="text-align: center">none</th></tr></thead><tbody>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#exponential_moving_average">EXPONENTIAL_MOVING_AVERAGE</a></td><td>PERIOD - 1</td><td>PERIOD - 1</td><td style="text-align: center"><span style="opacity:.35">n/a</span></td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#double_exponential_moving_average">DOUBLE_EXPONENTIAL_MOVING_AVERAGE</a></td><td>( PERIOD - 1 ) * 2</td><td>PERIOD - 1</td><td style="text-align: center"><span style="opacity:.35">n/a</span></td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_moving_average">TRIPLE_EXPONENTIAL_MOVING_AVERAGE</a></td><td>( PERIOD - 1 ) * 3</td><td>PERIOD - 1</td><td style="text-align: center"><span style="opacity:.35">n/a</span></td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#triple_exponential_derivative">TRIPLE_EXPONENTIAL_DERIVATIVE</a></td><td>( PERIOD - 1 ) * 3 + 1</td><td>PERIOD</td><td style="text-align: center"><span style="opacity:.35">n/a</span></td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#relative_strength_index">RELATIVE_STRENGTH_INDEX</a></td><td>PERIOD</td><td>PERIOD</td><td style="text-align: center"><span style="opacity:.35">n/a</span></td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#chande_momentum_oscillator">CHANDE_MOMENTUM_OSCILLATOR</a></td><td>PERIOD</td><td>PERIOD</td><td style="text-align: center">PERIOD - 1</td></tr>
</tbody></table>
<p><em><strong>Kaufmanç®—æ³•é»˜è®¤çš„Hold Periodsï¼š</strong></em></p>
<table><thead><tr><th>ç®—æ³•</th><th>é»˜è®¤çš„Hold Period</th></tr></thead><tbody>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_efficiency_ratio">KAUFMANS_EFFICIENCY_RATIO()</a></td><td>PERIOD</td></tr>
<tr><td><a href="content/cnosdb/latest/cnosql/cnosql_function.html#kaufmans_adaptive_moving_average">KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</a></td><td>PERIOD</td></tr>
</tbody></table>
<h4 id="warmup_type"><a class="header" href="#warmup_type">WARMUP_TYPE</a></h4>
<p><strong>é»˜è®¤=â€exponentialâ€</strong></p>
<p>è¿™ä¸ªå‚æ•°æ§åˆ¶ç®—æ³•å¦‚ä½•ä¸ºç¬¬ä¸€ä¸ª<code>PERIOD</code>æ ·æœ¬åˆå§‹åŒ–è‡ªèº«ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å…·æœ‰ä¸å®Œæ•´æ ·æœ¬é›†çš„æŒç»­æ—¶é—´ã€‚</p>
<p><code>simple</code>
ç¬¬ä¸€ä¸ª<code>PERIOD</code>æ ·æœ¬çš„ç®€å•ç§»åŠ¨å¹³å‡å€¼(simple moving averageï¼ŒSMA)ã€‚è¿™æ˜¯<a href="https://www.ta-lib.org/?spm=a2c4g.11186623.2.106.41fc3ee27HC1R6">ta-lib</a>ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>
<p><code>exponential</code>
å…·æœ‰ç¼©æ”¾alpha(Î±)çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼(exponential moving averageï¼ŒEMA)ã€‚åŸºæœ¬ä¸Šæ˜¯è¿™æ ·ä½¿ç”¨EMAï¼š<code>PERIOD=1</code>ç”¨äºç¬¬ä¸€ä¸ªç‚¹ï¼Œ<code>PERIOD=2</code>ç”¨äºç¬¬äºŒä¸ªç‚¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³ç®—æ³•å·²ç»æ¶ˆè€—äº†<code>PERIOD</code>ä¸ª<code>point</code>ã€‚ç”±äºç®—æ³•ä¸€å¼€å§‹å°±ä½¿ç”¨äº†EMAï¼Œå½“ä½¿ç”¨æ­¤æ–¹æ³•å¹¶ä¸”æ²¡æœ‰æŒ‡å®š<code>HOLD_PERIOD</code>çš„å€¼æˆ–<code>HOLD_PERIOD</code>çš„å€¼ä¸º<code>-1</code>æ—¶ï¼Œç®—æ³•å¯èƒ½ä¼šåœ¨æ¯”<code>simple</code>å°å¾—å¤šçš„æ ·æœ¬å¤§å°çš„æƒ…å†µä¸‹å¼€å§‹å‘é€<code>point</code>ã€‚</p>
<p><code>none</code>
ç®—æ³•ä¸æ‰§è¡Œä»»ä½•çš„å¹³æ»‘æ“ä½œã€‚è¿™æ˜¯<a href="https://www.ta-lib.org/?spm=a2c4g.11186623.2.107.41fc3ee27HC1R6">ta-lib</a>ä½¿ç”¨çš„æ–¹æ³•ã€‚å½“ä½¿ç”¨æ­¤æ–¹æ³•å¹¶ä¸”æ²¡æœ‰æŒ‡å®š<code>HOLD_PERIOD</code>æ—¶ï¼Œ<code>HOLD_PERIOD</code>çš„é»˜è®¤å€¼æ˜¯<code>PERIOD - 1</code>ã€‚</p>
<blockquote>
<p>ç±»å‹<code>none</code>ä»…é€‚ç”¨äº<code>CHANDE_MOMENTUM_OSCILLATOR()</code>å‡½æ•°ã€‚</p>
</blockquote>
<ul>
<li>
<h3 id="chande_momentum_oscillator"><a class="header" href="#chande_momentum_oscillator">CHANDE_MOMENTUM_OSCILLATOR()</a></h3>
<p>Chande Momentum Oscillator (CMO)æ˜¯ç”±Tushar Chandeå¼€å‘çš„ä¸€ä¸ªæŠ€æœ¯åŠ¨é‡æŒ‡æ ‡ã€‚é€šè¿‡è®¡ç®—æ‰€æœ‰æœ€è¿‘è¾ƒé«˜<code>point</code>çš„æ€»å’Œä¸æ‰€æœ‰æœ€è¿‘è¾ƒä½<code>point</code>çš„æ€»å’Œçš„å·®å€¼ï¼Œç„¶åå°†ç»“æœé™¤ä»¥ç»™å®šæ—¶é—´èŒƒå›´å†…çš„æ‰€æœ‰æ•°æ®å˜åŠ¨çš„æ€»å’Œæ¥åˆ›å»ºCMOæŒ‡æ ‡ã€‚å°†ç»“æœä¹˜ä»¥100å¯ä»¥å¾—åˆ°ä¸€ä¸ªä»-100åˆ°+100çš„èŒƒå›´ã€‚
<sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://www.fidelity.com/learning-center/trading-investing/technical-analysis/technical-indicator-guide/cmo" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-24"><a class="header" href="#åŸºæœ¬è¯­æ³•-24">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>CHANDE_MOMENTUM_OSCILLATOR([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period&gt;, [warmup_type]])
</code></pre>
<p><strong>å¯ç”¨çš„å‚æ•°ï¼š</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup-type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>CHANDE_MOMENTUM_OSCILLATOR(field_key, 2)</code>è¿”å›ä½¿ç”¨CMOç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>CHANDE_MOMENTUM_OSCILLATOR(field_key, 10, 9, 'none')</code>è¿”å›ä½¿ç”¨CMOç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º9ï¼Œwarmup typeè®¾ä¸º<code>none</code>ã€‚</p>
<p><code>CHANDE_MOMENTUM_OSCILLATOR(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨CMOç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>CHANDE_MOMENTUM_OSCILLATOR()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>CHANDE_MOMENTUM_OSCILLATOR(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨CMOç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>CHANDE_MOMENTUM_OSCILLATOR(*, 2)</code>è¿”å›ä½¿ç”¨CMOç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>CHANDE_MOMENTUM_OSCILLATOR()</code> æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="exponential_moving_average"><a class="header" href="#exponential_moving_average">EXPONENTIAL_MOVING_AVERAGE()</a></h3>
<p>æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ (Exponential Moving Averageï¼ŒEMA)ç±»ä¼¼äºç®€å•ç§»åŠ¨å¹³å‡å€¼ï¼Œä¸åŒçš„æ˜¯ï¼ŒæŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼å¯¹æœ€æ–°æ•°æ®ç»™äºˆæ›´å¤šçš„æƒé‡ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºâ€æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡å€¼â€ã€‚ä¸ç®€å•ç§»åŠ¨å¹³å‡å€¼ç›¸æ¯”ï¼Œè¿™ç§ç±»å‹çš„ç§»åŠ¨å¹³å‡å€¼å¯¹æœ€è¿‘æ•°æ®çš„å˜åŒ–ååº”æ›´å¿«ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://www.investopedia.com/terms/e/ema.asp" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-25"><a class="header" href="#åŸºæœ¬è¯­æ³•-25">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>EXPONENTIAL_MOVING_AVERAGE([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period)[, &lt;warmup_type]])
</code></pre>
<p><strong>å¯ç”¨å‚æ•°:</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>EXPONENTIAL_MOVING_AVERAGE(field_key, 2)</code>è¿”å›ä½¿ç”¨EMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>EXPONENTIAL_MOVING_AVERAGE(field_key, 10, 9, 'exponential')</code>è¿”å›ä½¿ç”¨EMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º9ï¼Œwarmup typeè®¾ä¸º<code>exponential</code>ã€‚</p>
<p><code>EXPONENTIAL_MOVING_AVERAGE(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨EMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>EXPONENTIAL_MOVING_AVERAGE()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>EXPONENTIAL_MOVING_AVERAGE(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨EMAç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>EXPONENTIAL_MOVING_AVERAGE(*, 2)</code>è¿”å›ä½¿ç”¨EMAç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>EXPONENTIAL_MOVING_AVERAGE()</code> æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="double_exponential_moving_average"><a class="header" href="#double_exponential_moving_average">DOUBLE_EXPONENTIAL_MOVING_AVERAGE()</a></h3>
<p>åŒé‡æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ (Double Exponential Moving Averageï¼ŒDEMA)é€šè¿‡å¢åŠ æœ€è¿‘æ•°æ®çš„æƒé‡ï¼Œå°è¯•æ¶ˆé™¤ä¸ç§»åŠ¨å¹³å‡å€¼ç›¸å…³çš„å›ºæœ‰æ»åã€‚è¯¥åå­—ä¼¼ä¹è¡¨æ˜è¿™æ˜¯é€šè¿‡åŒé‡æŒ‡æ•°å¹³æ»‘æ¥å®ç°çš„ï¼Œç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯å°†EMAçš„å€¼ç¿»å€ã€‚ä¸ºäº†ä½¿å®ƒä¸å®é™…æ•°æ®ä¿æŒä¸€è‡´ï¼Œä¹Ÿä¸ºäº†æ¶ˆé™¤æ»åï¼Œä»ä¹‹å‰ä¸¤å€EMAçš„å€¼ä¸­æŠŠâ€EMA of EMAâ€çš„å€¼å‡å»ï¼Œå…¬å¼ä¸ºï¼šDEMA = 2 * EMA - EMA(EMA)ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://en.wikipedia.org/wiki/Double_exponential_moving_average" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-26"><a class="header" href="#åŸºæœ¬è¯­æ³•-26">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period)[, &lt;warmup_type]])
</code></pre>
<p><strong>å¯ç”¨çš„å‚æ•°ï¼š</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE(field_key, 2)</code>è¿”å›ä½¿ç”¨DEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE(field_key, 10, 9, 'exponential')</code>è¿”å›ä½¿ç”¨DEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º9ï¼Œwarmup typeè®¾ä¸º<code>exponential</code>ã€‚</p>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨DEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨DEMAç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE(*, 2)</code>è¿”å›ä½¿ç”¨DEMAç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>DOUBLE_EXPONENTIAL_MOVING_AVERAGE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="kaufmans_efficiency_ratio"><a class="header" href="#kaufmans_efficiency_ratio">KAUFMANS_EFFICIENCY_RATIO()</a></h3>
<p>Kaufmanæ•ˆç‡æ¯” (Kaufmanâ€™s Efficiency Ration)ï¼Œæˆ–ç®€ç§°ä¸ºæ•ˆç‡æ¯” (Efficiency Ratioï¼ŒER)ï¼Œå®ƒçš„è®¡ç®—æ–¹æ³•æ˜¯ï¼šå°†ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®å˜åŒ–é™¤ä»¥å®ç°è¯¥å˜åŒ–æ‰€å‘ç”Ÿçš„æ•°æ®å˜åŠ¨çš„ç»å¯¹å€¼çš„æ€»å’Œã€‚å¾—å‡ºçš„æ¯”ç‡åœ¨0å’Œ1ä¹‹é—´ï¼Œæ¯”ç‡è¶Šé«˜ï¼Œè¡¨ç¤ºå¸‚åœºè¶Šæœ‰æ•ˆç‡æˆ–è¶Šæœ‰è¶‹åŠ¿ã€‚</p>
</li>
</ul>
<p>ERè·ŸChande Momentum Oscillator (CMO)éå¸¸ç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯ï¼ŒCMOå°†å¸‚åœºæ–¹å‘è€ƒè™‘åœ¨å†…ï¼Œä½†æ˜¯å¦‚æœæ‚¨å°†CMOçš„ç»å¯¹å€¼é™¤ä»¥100ï¼Œå°±å¯ä»¥å¾—åˆ°ERã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="http://etfhq.com/blog/2011/02/07/kaufmans-efficiency-ratio/" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-27"><a class="header" href="#åŸºæœ¬è¯­æ³•-27">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">KAUFMANS_EFFICIENCY_RATIO([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period&gt;])
</code></pre>
<p><strong>å¯ç”¨çš„å‚æ•°ï¼š</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>KAUFMANS_EFFICIENCY_RATIO(field_key, 2)</code>è¿”å›ä½¿ç”¨æ•ˆç‡æŒ‡æ•°(Efficiency Index)ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_EFFICIENCY_RATIO(field_key, 10, 10)</code>è¿”å›ä½¿ç”¨æ•ˆç‡æŒ‡æ•°ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º10ã€‚</p>
<p><code>KAUFMANS_EFFICIENCY_RATIO(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨æ•ˆç‡æŒ‡æ•°ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>KAUFMANS_EFFICIENCY_RATIO()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>KAUFMANS_EFFICIENCY_RATIO(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨æ•ˆç‡æŒ‡æ•°ç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_EFFICIENCY_RATIO(*, 2)</code>è¿”å›ä½¿ç”¨æ•ˆç‡æŒ‡æ•°ç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_EFFICIENCY_RATIO()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<ul>
<li>
<h3 id="kaufmans_adaptive_moving_average"><a class="header" href="#kaufmans_adaptive_moving_average">KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</a></h3>
<p>Kaufmanè‡ªé€‚åº”ç§»åŠ¨å¹³å‡å€¼ (Kaufmanâ€™s Adaptive Moving Averageï¼ŒKAMA)ï¼Œæ˜¯ä¸€ä¸ªç”¨äºè®¡ç®—æ ·æœ¬å™ªéŸ³æˆ–æ³¢åŠ¨ç‡çš„ç§»åŠ¨å¹³å‡å€¼ã€‚å½“æ•°æ®æ³¢åŠ¨ç›¸å¯¹è¾ƒå°å¹¶ä¸”å™ªéŸ³è¾ƒä½æ—¶ï¼ŒKAMAä¼šå¯†åˆ‡å…³æ³¨<code>point</code>ã€‚å½“æ•°æ®æ³¢åŠ¨è¾ƒå¤§æ—¶ï¼ŒKAMAä¼šè¿›è¡Œè°ƒæ•´ï¼Œå¹³æ»‘å™ªéŸ³ã€‚è¯¥è¶‹åŠ¿è·Ÿè¸ªæŒ‡æ ‡å¯ç”¨äºè¯†åˆ«æ€»ä½“è¶‹åŠ¿ã€æ—¶é—´è½¬æŠ˜ç‚¹å’Œè¿‡æ»¤ä»·æ ¼å˜åŠ¨ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="http://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:kaufman_s_adaptive_moving_average" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-28"><a class="header" href="#åŸºæœ¬è¯­æ³•-28">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period&gt;])
</code></pre>
<p><strong>å¯ç”¨çš„å‚æ•°ï¼š</strong>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE(field_key, 2)</code>è¿”å›ä½¿ç”¨KAMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE(field_key, 10, 10)</code>è¿”å›ä½¿ç”¨KAMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º10ã€‚</p>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨KAMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨KAMAç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE(*, 2)</code>è¿”å›ä½¿ç”¨KAMAç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodã€‚</p>
<p><code>KAUFMANS_ADAPTIVE_MOVING_AVERAGE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="triple_exponential_moving_average"><a class="header" href="#triple_exponential_moving_average">TRIPLE_EXPONENTIAL_MOVING_AVERAGE()</a></h3>
<p>ä¸‰é‡æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ (Triple Exponential Moving Averageï¼ŒTEMA)ï¼Œæ—¨åœ¨è¿‡æ»¤å¸¸è§„ç§»åŠ¨å¹³å‡å€¼çš„æ³¢åŠ¨ã€‚è¯¥åå­—ä¼¼ä¹è¡¨æ˜è¿™æ˜¯é€šè¿‡ä¸‰é‡æŒ‡æ•°å¹³æ»‘æ¥å®ç°çš„ï¼Œç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œå®ƒå®é™…ä¸Šæ˜¯åŒ…å«æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ã€åŒé‡æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼å’Œä¸‰é‡æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼çš„å¤åˆå‡½æ•°ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://www.investopedia.com/terms/t/triple-exponential-moving-average.asp " target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-29"><a class="header" href="#åŸºæœ¬è¯­æ³•-29">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period)[, &lt;warmup_type]])
</code></pre>
<p><strong>Available Arguments:</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE(field_key, 2)</code>è¿”å›ä½¿ç”¨TEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE(field_key, 10, 9, 'exponential')</code>è¿”å›ä½¿ç”¨TEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º9ï¼Œwarmup typeè®¾ä¸º<code>exponential</code>ã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨TEMAç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨TEMAç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE(*, 2)</code>è¿”å›ä½¿ç”¨TEMAç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_MOVING_AVERAGE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="triple_exponential_derivative"><a class="header" href="#triple_exponential_derivative">TRIPLE_EXPONENTIAL_DERIVATIVE()</a></h3>
<p>ä¸‰é‡æŒ‡æ•°å¯¼æ•°æŒ‡æ ‡ (Triple Exponential Derivative Indicator)ï¼Œé€šå¸¸ç§°ä¸ºâ€TRIXâ€ï¼Œæ˜¯ä¸€ç§ç”¨äºè¯†åˆ«è¶…å–å’Œè¶…ä¹°å¸‚åœºçš„æŒ¯è¡å™¨ï¼Œä¹Ÿå¯ç”¨ä½œåŠ¨é‡æŒ‡æ ‡ã€‚TRIXè®¡ç®—ä¸€æ®µæ—¶é—´å†…è¾“å…¥æ•°æ®çš„å¯¹æ•°çš„ä¸‰é‡æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ã€‚ä»å½“å‰çš„å€¼ä¸­å‡å»ä¹‹å‰çš„å€¼ï¼Œè¿™å¯ä»¥é˜²æ­¢æŒ‡æ ‡è€ƒè™‘æ¯”è§„å®šæœŸé—´çŸ­çš„å‘¨æœŸã€‚</p>
</li>
</ul>
<p>è·Ÿå¾ˆå¤šæŒ¯è¡å™¨ä¸€æ ·ï¼ŒTRIXå›´ç»•ç€é›¶çº¿éœ‡è¡ã€‚å½“å®ƒç”¨ä½œæŒ¯è¡å™¨æ—¶ï¼Œæ­£æ•°è¡¨ç¤ºç‚’ä¹°è¶…ä¹°å¸‚åœºï¼Œè€Œè´Ÿæ•°è¡¨ç¤ºè¶…å–å¸‚åœºã€‚å½“å®ƒç”¨ä½œåŠ¨é‡æŒ‡æ ‡æ—¶ï¼Œæ­£æ•°è¡¨ç¤ºåŠ¨é‡åœ¨å¢åŠ ï¼Œè€Œè´Ÿæ•°è¡¨ç¤ºåŠ¨é‡åœ¨å‡å°‘ã€‚å¾ˆå¤šåˆ†æå¸ˆè®¤ä¸ºï¼Œå½“TRIXè¶…è¿‡é›¶çº¿æ—¶ï¼Œå®ƒä¼šç»™å‡ºä¹°å…¥ä¿¡å·ï¼Œå½“ä½äºé›¶çº¿æ—¶ï¼Œå®ƒä¼šç»™å‡ºå–å‡ºä¿¡å·ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://www.investopedia.com/articles/technical/02/092402.asp " target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-30"><a class="header" href="#åŸºæœ¬è¯­æ³•-30">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>TRIPLE_EXPONENTIAL_DERIVATIVE([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period)[, &lt;warmup_type]])
</code></pre>
<p><strong>å¯ç”¨çš„å‚æ•°ï¼š</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE(field_key, 2)</code>è¿”å›ä½¿ç”¨ä¸‰é‡æŒ‡æ•°å¯¼æ•°ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE(field_key, 10, 10, 'exponential')</code>è¿”å›ä½¿ç”¨ä¸‰é‡æŒ‡æ•°å¯¼æ•°ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º10ï¼Œwarmup typeè®¾ä¸º<code>exponential</code>ã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨ä¸‰é‡æŒ‡æ•°å¯¼æ•°ç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>TRIPLE_EXPONENTIAL_DERIVATIVE()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨ä¸‰é‡æŒ‡æ•°å¯¼æ•°ç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE(*, 2)</code>è¿”å›ä½¿ç”¨ä¸‰é‡æŒ‡æ•°å¯¼æ•°ç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>TRIPLE_EXPONENTIAL_DERIVATIVE()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
<ul>
<li>
<h3 id="relative_strength_index"><a class="header" href="#relative_strength_index">RELATIVE_STRENGTH_INDEX()</a></h3>
<p>ç›¸å¯¹å¼ºå¼±æŒ‡æ•° (Relative Strength Indexï¼ŒRSI)æ˜¯ä¸€ä¸ªåŠ¨é‡æŒ‡æ ‡ï¼Œç”¨äºæ¯”è¾ƒåœ¨æŒ‡å®šæ—¶é—´æ®µå†…æœ€è¿‘æ•°æ®å¢å¤§å’Œå‡å°çš„å¹…åº¦ï¼Œä»¥ä¾¿measurementæ•°æ®å˜åŠ¨çš„é€Ÿåº¦å’Œå˜åŒ–ã€‚</p>
<p><sup style="line-height:0; font-size:.7rem; font-style:italic; font-weight:normal;"><a href="https://www.investopedia.com/terms/r/rsi.asp" target="\_blank">Source</a></p>
<h4 id="åŸºæœ¬è¯­æ³•-31"><a class="header" href="#åŸºæœ¬è¯­æ³•-31">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code>RELATIVE_STRENGTH_INDEX([ * | &lt;field_key&gt; | /regular_expression/ ], &lt;period&gt;[, &lt;hold_period)[, &lt;warmup_type]])
</code></pre>
<p><strong>Available Arguments:</strong></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_function.html#period">period</a>
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">hold_period</a> ï¼ˆå¯é€‰é¡¹ï¼‰
<a href="content/cnosdb/latest/cnosql/cnosql_function.html#warmup_type">warmup_type</a> ï¼ˆå¯é€‰é¡¹ï¼‰</p>
<p><code>RELATIVE_STRENGTH_INDEX(field_key, 2)</code>è¿”å›ä½¿ç”¨RSIç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>RELATIVE_STRENGTH_INDEX(field_key, 10, 10, 'exponential')</code>è¿”å›ä½¿ç”¨RSIç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º10ï¼Œhold periodè®¾ä¸º10ï¼Œwarmup typeè®¾ä¸º<code>exponential</code>ã€‚</p>
<p><code>RELATIVE_STRENGTH_INDEX(MEAN(&lt;field_key&gt;), 2) ... GROUP BY time(1d)</code>è¿”å›ä½¿ç”¨RSIç®—æ³•å¤„ç†field keyå¯¹åº”çš„field valueå¹³å‡å€¼åçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<blockquote>
<p>**æ³¨æ„ï¼š**å½“ä½¿ç”¨<code>GROUP BY</code>å­å¥å°†æ•°æ®è¿›è¡Œèšåˆæ—¶ï¼Œæ‚¨å¿…é¡»åœ¨<code>RELATIVE_STRENGTH_INDEX()</code>å‡½æ•°ä¸­è°ƒç”¨èšåˆå‡½æ•°ã€‚</p>
</blockquote>
<p><code>RELATIVE_STRENGTH_INDEX(/regular_expression/, 2)</code>è¿”å›ä½¿ç”¨RSIç®—æ³•å¤„ç†ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>RELATIVE_STRENGTH_INDEX(*, 2)</code>è¿”å›ä½¿ç”¨RSIç®—æ³•å¤„ç†measurementä¸­æ¯ä¸ªfield keyå¯¹åº”çš„field valueåçš„ç»“æœï¼Œè¯¥ç®—æ³•ä¸­ï¼Œperiodè®¾ä¸º2ï¼Œä½¿ç”¨é»˜è®¤çš„hold periodå’Œwarmup typeã€‚</p>
<p><code>RELATIVE_STRENGTH_INDEX()</code>æ”¯æŒæ•°æ®ç±»å‹ä¸ºint64å’Œfloat64çš„field valueã€‚</p>
</li>
<li>
<h3 id="å…¶å®ƒ"><a class="header" href="#å…¶å®ƒ">å…¶å®ƒ</a></h3>
<h4 id="ç¤ºä¾‹æ•°æ®"><a class="header" href="#ç¤ºä¾‹æ•°æ®">ç¤ºä¾‹æ•°æ®</a></h4>
<p>æœ¬æ–‡æ¡£ä½¿ç”¨çš„æ•°æ®å¯åœ¨<a href="content/cnosdb/latest/cnosql/oceanic_station.txt">ç¤ºä¾‹æ•°æ®</a>ä¸­ä¸‹è½½ã€‚</p>
<h4 id="å‡½æ•°çš„é€šç”¨è¯­æ³•"><a class="header" href="#å‡½æ•°çš„é€šç”¨è¯­æ³•">å‡½æ•°çš„é€šç”¨è¯­æ³•</a></h4>
<ul>
<li>
<h4 id="åœ¨selectä¸­æŒ‡å®šå¤šä¸ªå‡½æ•°"><a class="header" href="#åœ¨selectä¸­æŒ‡å®šå¤šä¸ªå‡½æ•°">åœ¨<code>SELECT</code>ä¸­æŒ‡å®šå¤šä¸ªå‡½æ•°</a></h4>
</li>
</ul>
<pre><code>SELECT &lt;function&gt;(),&lt;function&gt;() FROM_clause [...]
</code></pre>
<p>ä½¿ç”¨é€—å·(<code>,</code>)å°†<code>SELECT</code>è¯­å¥ä¸­çš„å¤šä¸ªå‡½æ•°åˆ†å¼€ã€‚è¯¥è¯­æ³•é€‚ç”¨äºé™¤<code>TOP()</code>å’Œ<code>BOTTOM()</code>ä¹‹å¤–çš„æ‰€æœ‰cnosQLå‡½æ•°ã€‚<code>SELECT</code>å­å¥ä¸æ”¯æŒ<code>TOP()</code>æˆ–<code>BOTTOM()</code>å’Œå…¶å®ƒå‡½æ•°åŒæ—¶ä½¿ç”¨ã€‚</p>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field-valueçš„å¹³å‡å€¼å’Œå¹³å‡æ•°"><a class="header" href="#åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field-valueçš„å¹³å‡å€¼å’Œå¹³å‡æ•°">åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field valueçš„å¹³å‡å€¼å’Œå¹³å‡æ•°</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;),MEDIAN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 mean              median
----                 ----              ------
1970-01-01T00:00:00Z 64.94933267424616 65
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>temperature</code>çš„å¹³å‡å€¼å’Œå¹³å‡æ•°ã€‚</p>
<ul>
<li>
<h4 id="åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—ä¸¤ä¸ªfieldçš„mode"><a class="header" href="#åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—ä¸¤ä¸ªfieldçš„mode">åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—ä¸¤ä¸ªfieldçš„mode</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MODE(&quot;temperature&quot;),MODE(&quot;pressure&quot;) FROM &quot;air&quot;
name: air
time                 mode mode_1
----                 ---- ------
1970-01-01T00:00:00Z 53
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>temperature</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„field valueå’Œ<code>pressure</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„field valueã€‚<code>temperature</code>å¯¹åº”çš„å€¼åœ¨åˆ—<code>mode</code>ä¸­ï¼Œ<code>pressure</code>å¯¹åº”çš„å€¼åœ¨åˆ—<code>mode_1</code>ä¸­ã€‚å› ä¸ºç³»ç»Ÿä¸èƒ½è¿”å›å¤šä¸ªå…·æœ‰ç›¸åŒåå­—çš„åˆ—ï¼Œæ‰€ä»¥å®ƒå°†ç¬¬äºŒä¸ªåˆ—<code>mode</code>é‡å‘½åä¸º<code>mode_1</code>ã€‚</p>
<ul>
<li>
<h4 id="åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field-valueçš„æœ€å°å€¼å’Œæœ€å¤§å€¼"><a class="header" href="#åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field-valueçš„æœ€å°å€¼å’Œæœ€å¤§å€¼">åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­è®¡ç®—field valueçš„æœ€å°å€¼å’Œæœ€å¤§å€¼</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MIN(&quot;temperature&quot;), MAX(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 min max
----                 --- ---
1970-01-01T00:00:00Z 50  80
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>temperature</code>çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œè¯¥æŸ¥è¯¢è¿”å›<code>1970-01-01T00:00:00Z</code>ä½œä¸ºæ—¶é—´æˆ³ï¼Œè¿™æ˜¯CnosDBçš„ç©ºæ—¶é—´æˆ³ã€‚<code>MIN()</code>å’Œ<code>MAX()</code>æ˜¯selectorå‡½æ•°ï¼›å½“selectorå‡½æ•°æ˜¯<code>SELECT</code>å­å¥ä¸­çš„å”¯ä¸€å‡½æ•°æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æˆ³ã€‚å› ä¸º<code>MIN()</code>å’Œ<code>MAX()</code>è¿”å›ä¸¤ä¸ªä¸åŒçš„æ—¶é—´æˆ³ï¼ˆè§ä¸‹é¢çš„ä¾‹å­ï¼‰ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šç”¨ç©ºæ—¶é—´æˆ³è¦†ç›–è¿™äº›æ—¶é—´æˆ³ã€‚</p>
<pre><code class="language-sql">&gt;  SELECT MIN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                  min
----                  ---
2021-08-31T16:18:00Z  50    &lt;--- Timestamp 1

&gt;  SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                  max
----                  ---
2021-08-31T18:03:00Z  80    &lt;--- Timestamp 2
</code></pre>
<h4 id="é‡å‘½åæŸ¥è¯¢ç»“æœå­—æ®µ"><a class="header" href="#é‡å‘½åæŸ¥è¯¢ç»“æœå­—æ®µ">é‡å‘½åæŸ¥è¯¢ç»“æœå­—æ®µ</a></h4>
<ul>
<li>
<h4 id="è¯­æ³•-33"><a class="header" href="#è¯­æ³•-33">è¯­æ³•</a></h4>
</li>
</ul>
<pre><code>SELECT &lt;function&gt;() AS &lt;field_key&gt; [...]
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°è¿”å›çš„ç»“æœåœ¨ä¸å‡½æ•°åç§°åŒ¹é…çš„field keyä¸‹é¢ã€‚ä½¿ç”¨<code>AS</code>å­å¥å¯ä»¥æŒ‡å®šè¾“å‡ºçš„field keyçš„åå­—ã€‚</p>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="æŒ‡å®šè¾“å‡ºçš„field-key"><a class="header" href="#æŒ‡å®šè¾“å‡ºçš„field-key">æŒ‡å®šè¾“å‡ºçš„field key</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) AS &quot;dream_name&quot; FROM &quot;air&quot;
name: air
time                  dream_name
----                  ----------
1970-01-01T00:00:00Z 64.94933267424616
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>temperature</code>çš„å¹³å‡å€¼ï¼Œå¹¶å°†è¾“å‡ºçš„field keyé‡å‘½åä¸º<code>dream_name</code>ã€‚å¦‚æœæ²¡æœ‰<code>AS</code>å­å¥ï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¼šè¿”å›<code>mean</code>ä½œä¸ºè¾“å‡ºçš„field keyï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEAN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                  mean
----                  ----
1970-01-01T00:00:00Z 64.94933267424616
</code></pre>
<ul>
<li>
<h4 id="ä¸ºå¤šä¸ªå‡½æ•°æŒ‡å®šè¾“å‡ºçš„field-key"><a class="header" href="#ä¸ºå¤šä¸ªå‡½æ•°æŒ‡å®šè¾“å‡ºçš„field-key">ä¸ºå¤šä¸ªå‡½æ•°æŒ‡å®šè¾“å‡ºçš„field key</a></h4>
</li>
</ul>
<pre><code class="language-sql">&gt; SELECT MEDIAN(&quot;temperature&quot;) AS &quot;med_wat&quot;,MODE(&quot;temperature&quot;) AS &quot;mode_wat&quot; FROM &quot;air&quot;
name: air
time                 med_wat mode_wat
----                 ------- --------
1970-01-01T00:00:00Z 65      53
</code></pre>
<p>è¯¥æŸ¥è¯¢è¿”å›<code>temperature</code>çš„å¹³å‡æ•°å’Œ<code>temperature</code>ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„field valueï¼Œå¹¶å°†è¾“å‡ºçš„field keyåˆ†åˆ«é‡å‘½åä¸º<code>med_wat</code>å’Œ<code>mode_wat</code>ã€‚å¦‚æœæ²¡æœ‰<code>AS</code>å­å¥ï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¼šè¿”å›<code>median</code>å’Œ<code>mode</code>ä½œä¸ºè¾“å‡ºçš„field keyï¼š</p>
<pre><code class="language-sql">&gt; SELECT MEDIAN(&quot;temperature&quot;),MODE(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 median mode
----                 ------ ----
1970-01-01T00:00:00Z 65     53
</code></pre>
<h4 id="æ”¹å˜ä¸å«æ•°æ®çš„æ—¶é—´é—´éš”çš„è¿”å›å€¼"><a class="header" href="#æ”¹å˜ä¸å«æ•°æ®çš„æ—¶é—´é—´éš”çš„è¿”å›å€¼">æ”¹å˜ä¸å«æ•°æ®çš„æ—¶é—´é—´éš”çš„è¿”å›å€¼</a></h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«cnosQLå‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥çš„æŸ¥è¯¢å¯¹ä¸åŒ…å«æ•°æ®çš„æ—¶é—´é—´éš”è¿”å›ç©ºå€¼ã€‚åœ¨<code>GROUP BY</code>å­å¥åé¢åŠ ä¸Š<code>fill()</code>å¯ä»¥æ›´æ”¹è¿™ä¸ªå€¼ã€‚å…³äº<code>fill()</code>çš„è¯¦ç»†è®¨è®ºï¼Œè¯·æŸ¥çœ‹æ•°æ®æ¢ç´¢ã€‚</p>
<h4 id="å‡½æ•°çš„å¸¸è§é—®é¢˜"><a class="header" href="#å‡½æ•°çš„å¸¸è§é—®é¢˜">å‡½æ•°çš„å¸¸è§é—®é¢˜</a></h4>
<p>ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†æ‰€æœ‰å‡½æ•°ã€èšåˆå‡½æ•°å’Œé€‰æ‹©å‡½æ•°çš„å¸¸è§æ··æ·†æ¥æºï¼Œæœ‰å…³å•ä¸ªåŠŸèƒ½çš„å¸¸è§é—®é¢˜ï¼Œè¯·å‚è§ä»¥ä¸‹ç‰¹å®šæ–‡æ¡£ï¼š</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-distinct">DISTINCT()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-bottom">BOTTOM()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-percentile">PERCENTILE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-sample">SAMPLE()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-top">TOP()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-elapsed">ELAPSED()</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#common-issues-with-holt-winters">HOLT_WINTERS()</a></li>
</ul>
<h4 id="æ‰€æœ‰å‡½æ•°"><a class="header" href="#æ‰€æœ‰å‡½æ•°">æ‰€æœ‰å‡½æ•°</a></h4>
<ul>
<li>
<h4 id="åµŒå¥—å‡½æ•°"><a class="header" href="#åµŒå¥—å‡½æ•°">åµŒå¥—å‡½æ•°</a></h4>
</li>
</ul>
</li>
</ul>
<p>æŸäº›cnosQL å‡½æ•°æ”¯æŒ <a href="content/cnosdb/latest/cnosql//cnosdb/v1.8/query_language/explore-data/#select-clause"><code>SELECT</code> clause</a>ä¸­åµŒå¥—:</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#count"><code>COUNT()</code></a> with <a href="content/cnosdb/latest/cnosql/cnosql_function.html#distinct"><code>DISTINCT()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#cumulative-sum"><code>CUMULATIVE_SUM()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#derivative"><code>DERIVATIVE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#difference"><code>DIFFERENCE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#elapsed"><code>ELAPSED()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#moving-average"><code>MOVING_AVERAGE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#non-negative-derivative"><code>NON_NEGATIVE_DERIVATIVE()</code></a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_function.html#holt-winters"><code>HOLT_WINTERS()</code></a> and <a href="content/cnosdb/latest/cnosql/cnosql_function.html#holt-winters"><code>HOLT_WINTERS_WITH_FIT()</code></a></li>
</ul>
<ul>
<li>
<h4 id="æŸ¥è¯¢åœ¨nowä¹‹åçš„æ—¶é—´èŒƒå›´"><a class="header" href="#æŸ¥è¯¢åœ¨nowä¹‹åçš„æ—¶é—´èŒƒå›´">æŸ¥è¯¢åœ¨now()ä¹‹åçš„æ—¶é—´èŒƒå›´</a></h4>
</li>
</ul>
<p>å¤§å¤šæ•°<code>SELECT</code>è¯­å¥çš„é»˜è®¤æ—¶é—´èŒƒå›´åœ¨<code>1677-09-21 00:12:43.145224194</code> UTCå’Œ<code>2262-04-11T23:47:16.854775806Z</code> UTCä¹‹é—´ã€‚å¯¹äºåŒ…å«cnosQLå‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥çš„<code>SELECT</code>æŸ¥è¯¢ï¼Œé»˜è®¤çš„æ—¶é—´èŒƒå›´åœ¨<code>1677-09-21 00:12:43.145224194</code>å’Œ<code>now()</code>ä¹‹é—´ã€‚</p>
<p>å¦‚æœè¦æŸ¥è¯¢æ—¶é—´æˆ³å‘ç”Ÿåœ¨<code>now()</code>ä¹‹åçš„æ•°æ®ï¼Œé‚£ä¹ˆåŒ…å«cnosQLå‡½æ•°å’Œ<code>GROUP BY time()</code>å­å¥çš„<code>SELECT</code>æŸ¥è¯¢å¿…é¡»åœ¨<code>WHERE</code>å­å¥ä¸­æä¾›ä¸€ä¸ªæ—¶é—´ä¸Šé™ã€‚è¯·æŸ¥çœ‹å¸¸è§é—®é¢˜ã€‚</p>
<h4 id="èšåˆå‡½æ•°-1"><a class="header" href="#èšåˆå‡½æ•°-1">èšåˆå‡½æ•°</a></h4>
<ul>
<li>
<h4 id="ç†è§£è¿”å›çš„æ—¶é—´æˆ³"><a class="header" href="#ç†è§£è¿”å›çš„æ—¶é—´æˆ³">ç†è§£è¿”å›çš„æ—¶é—´æˆ³</a></h4>
</li>
</ul>
<p>å­å¥ä¸­å…·æœ‰ <a href="content/cnosdb/latest/cnosql/cnosql_function.html#aggregations">èšåˆå‡½æ•°</a> ä¸” <code>WHERE</code>æ²¡æœ‰æ—¶é—´èŒƒå›´çš„æŸ¥è¯¢è®²è¿”å› epoch 0 (<code>1970-01-01T00:00:00Z</code>) ä½œä¸ºæ—¶é—´æˆ³.
CnosDB ä½¿ç”¨ epoch 0 ä½œä¸ºç­‰æ•ˆçš„ç©ºæ—¶é—´æˆ³.
å¸¦æœ‰èšåˆå‡½æ•°çš„æŸ¥è¯¢ï¼Œå¦‚æœ <code>WHERE</code> å­å¥ä¸­åŒ…å«æ—¶é—´èŒƒå›´ï¼Œå°†è¿”å›æ—¶é—´ä¸‹é™ä½œä¸ºæ—¶é—´æˆ³.</p>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 sum
----                 ---
1970-01-01T00:00:00Z 1839495
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢å°†CnosDBçš„ç©ºæ—¶é—´æˆ³(epoch 0: <code>1970-01-01T00:00:00Z</code>)ä½œä¸ºæ—¶é—´æˆ³è¿”å›ã€‚<code>SUM()</code>å°†å¤šä¸ª<code>point</code>èšåˆï¼Œæ²¡æœ‰å•ä¸ªæ—¶é—´æˆ³å¯ä»¥è¿”å›ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z'
name: air
time                 sum
----                 ---
2021-09-28T00:00:00Z 134766
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢å°†æ—¶é—´èŒƒå›´çš„ä¸‹ç•Œ(<code>WHERE time &gt;= '2021-09-18T00:00:00Z'</code>)ä½œä¸ºæ—¶é—´æˆ³è¿”å›ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´å’Œä½¿ç”¨group-by-timeå­å¥"><a class="header" href="#ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´å’Œä½¿ç”¨group-by-timeå­å¥">ä½¿ç”¨èšåˆå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´å’Œä½¿ç”¨GROUP BY time()å­å¥</a></h4>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-28T00:28:00Z' GROUP BY time(12m)
name: air
time                 sum
----                 ---
2021-09-28T00:00:00Z 490
2021-09-28T00:12:00Z 524
2021-09-28T00:24:00Z 263
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢å°†æ¯ä¸ª<code>GROUP BY time()</code>é—´éš”çš„æ—¶é—´ä¸‹ç•Œä½œä¸ºæ—¶é—´æˆ³è¿”å›ã€‚</p>
<ul>
<li>
<h4 id="å°†èšåˆå‡½æ•°å’Œä¸èšåˆçš„æ•°æ®æ··åˆä½¿ç”¨"><a class="header" href="#å°†èšåˆå‡½æ•°å’Œä¸èšåˆçš„æ•°æ®æ··åˆä½¿ç”¨">å°†èšåˆå‡½æ•°å’Œä¸èšåˆçš„æ•°æ®æ··åˆä½¿ç”¨</a></h4>
</li>
</ul>
<p>èšåˆå‡½æ•°ä¸æ”¯æŒåœ¨<code>SELECT</code>è¯­å¥ä¸­æŒ‡å®šä¸ä½¿ç”¨èšåˆå‡½æ•°çš„å•ç‹¬çš„field keyæˆ–tag keyã€‚èšåˆå‡½æ•°è¿”å›ä¸€ä¸ªè®¡ç®—ç»“æœï¼Œå¯¹äºæ²¡æœ‰è¢«èšåˆçš„fieldæˆ–tagï¼Œæ²¡æœ‰æ˜æ˜¾çš„å•ä¸ªå€¼å¯ä»¥è¿”å›ã€‚å½“<code>SELECT</code>è¯­å¥åŒæ—¶åŒ…å«èšåˆå‡½æ•°å’Œå•ç‹¬çš„field keyæˆ–tag keyæ—¶ï¼Œä¼šè¿”å›é”™è¯¯ï¼š</p>
<pre><code class="language-sql">&gt; SELECT SUM(&quot;temperature&quot;),&quot;station&quot; FROM &quot;air&quot;
ERR: mixing aggregate and non-aggregate queries is not supported
</code></pre>
<ul>
<li>
<h4 id="å¾—åˆ°ç•¥æœ‰ä¸åŒçš„ç»“æœ"><a class="header" href="#å¾—åˆ°ç•¥æœ‰ä¸åŒçš„ç»“æœ">å¾—åˆ°ç•¥æœ‰ä¸åŒçš„ç»“æœ</a></h4>
</li>
</ul>
<p>å¯¹äºæŸäº›èšåˆå‡½æ•°ï¼Œåœ¨ç›¸åŒçš„<code>point</code>ï¼ˆæ•°æ®ç±»å‹ä¸ºfloat64)ä¸Šæ‰§è¡Œç›¸åŒçš„å‡½æ•°ï¼Œå¯èƒ½ä¼šäº§ç”Ÿç¨å¾®ä¸åŒçš„ç»“æœã€‚åœ¨åº”ç”¨èšåˆå‡½æ•°ä¹‹é—´ï¼ŒCnosDBä¸ä¼šå°†<code>point</code>è¿›è¡Œæ’åºï¼›è¯¥è¡Œä¸ºå¯èƒ½ä¼šå¯¼è‡´æŸ¥è¯¢ç»“æœä¸­å‡ºç°å°å°çš„å·®å¼‚ã€‚</p>
<h4 id="selectorå‡½æ•°"><a class="header" href="#selectorå‡½æ•°">Selectorå‡½æ•°</a></h4>
<ul>
<li>
<h4 id="ç†è§£è¿”å›çš„æ—¶é—´æˆ³-1"><a class="header" href="#ç†è§£è¿”å›çš„æ—¶é—´æˆ³-1">ç†è§£è¿”å›çš„æ—¶é—´æˆ³</a></h4>
</li>
</ul>
<p>selectorå‡½æ•°è¿”å›çš„æ—¶é—´æˆ³ä¾èµ–æŸ¥è¯¢ä¸­å‡½æ•°çš„æ•°é‡å’ŒæŸ¥è¯¢ä¸­çš„å…¶å®ƒå­å¥ï¼š</p>
<p>å¸¦æœ‰å•ä¸ªé€‰æ‹©å™¨å‡½æ•°ï¼Œå•ä¸ª field key å‚æ•°å’Œæ—  <code>GROUP BY time()</code> çš„æŸ¥è¯¢è¿”å›åŸå§‹æ•°æ®ä¸­å‡ºç°çš„pointæ—¶é—´æˆ³.
å…·æœ‰å•ä¸ª selector å‡½æ•°, å¤šä¸ª <code>field key</code> å‚æ•°çš„æŸ¥è¯¢, <code>GROUP BY time()</code> è¿”å›åŸå§‹æ•°æ®ä¸­å‡ºç°çš„point æ—¶é—´æˆ³ï¼Œæˆ–ä¸ç©ºæ—¶é—´æˆ³ (epoch 0: <code>1970-01-01T00:00:00Z</code>)ç­‰ä»·çš„CnosDB.</p>
<p><code>WHERE</code>å­å¥ä¸­æœ‰å¤šä¸ªå‡½æ•°ä¸”æ²¡æœ‰æ—¶é—´èŒƒå›´çš„æŸ¥è¯¢å°†è¿”å›ç›¸å½“äºç©ºæ—¶é—´æˆ³ (epoch 0: <code>1970-01-01T00:00:00Z</code>).
åœ¨ <code>WHERE</code>å­å¥ä¸­åŒ…å«å¤šä¸ªå‡½æ•°å’Œæ—¶é—´èŒƒå›´çš„æŸ¥è¯¢å°†æ—¶é—´ä¸‹é™ä½œä¸ºæ—¶é—´æˆ³è¿”å›</p>
<p>å¸¦æœ‰ selector å‡½æ•°å’Œ  <code>GROUP BY time()</code> å­å¥çš„æŸ¥è¯¢è¿”å›æ¯ä¸ª <code>GROUP BY time()</code>é—´éš”çš„æ—¶é—´ä¸‹é™.</p>
<p>####ç¤ºä¾‹</p>
<ul>
<li>
<h4 id="ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå•ä¸ªfield-keyå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå•ä¸ªfield-keyå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå•ä¸ªfield keyï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                  max
----                  ---
2020-08-29T07:24:00Z  9.964

&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z'
name: air
time                 max
----                 ---
2021-09-28T01:57:00Z 80
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›åŸå§‹æ•°æ®ä¸­å…·æœ‰<code>æœ€å¤§</code>å€¼çš„<code>point</code>çš„æ—¶é—´æˆ³ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå¤šä¸ªfield-keyå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå¤šä¸ªfield-keyå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å’Œå¤šä¸ªfield keyï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT FIRST(*) FROM &quot;air&quot;
name: air
time                 first_pressure first_temperature first_visibility
----                 -------------- ----------------- ----------------
1970-01-01T00:00:00Z 78             79                71

&gt; SELECT MAX(*) FROM &quot;air&quot;
name: air
time                 max_pressure max_temperature max_visibility
----                 ------------ --------------- --------------
1970-01-01T00:00:00Z 80           80              80

</code></pre>
</li>
</ul>
<p>ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›CnosDBçš„ç©ºæ—¶é—´æˆ³(epoch 0: <code>1970-01-01T00:00:00Z</code>)ä½œä¸ºæŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³ã€‚å› ä¸º<code>FIRST(*)</code>è¿”å›ä¸¤ä¸ªæ—¶é—´æˆ³ï¼ˆå¯¹åº”measurement <code>air</code>ä¸­çš„æ¯ä¸ªfield keyï¼‰ï¼Œæ‰€ä»¥ç³»ç»Ÿä½¿ç”¨ç©ºæ—¶é—´æˆ³è¦†ç›–è¿™ä¸¤ä¸ªæ—¶é—´æˆ³ã€‚</p>
<p>ç¬¬äºŒä¸ªæŸ¥è¯¢è¿”å›åŸå§‹æ•°æ®ä¸­å…·æœ‰æœ€å¤§å€¼çš„<code>point</code>çš„æ—¶é—´æˆ³ã€‚å› ä¸º<code>MAX(*)</code>åªè¿”å›ä¸€ä¸ªæ—¶é—´æˆ³(measurement <code>air</code>ä¸­åªæœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹çš„field)ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ä¼šè¦†ç›–åŸå§‹æ—¶é—´æˆ³ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°å¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°å¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;),MIN(&quot;temperature&quot;) FROM &quot;air&quot;
name: air
time                 max min
----                 --- ---
1970-01-01T00:00:00Z 80  50 
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›CnosDBçš„ç©ºæ—¶é—´æˆ³(epoch 0: <code>1970-01-01T00:00:00Z</code>)ä½œä¸ºæŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³ã€‚å› ä¸º<code>MAX()</code>å’Œ<code>MIN()</code>å‡½æ•°è¿”å›ä¸åŒçš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥ç³»ç»Ÿæ²¡æœ‰å•ä¸ªæ—¶é—´æˆ³å¯ä»¥è¿”å›ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨å¤šä¸ªselectorå‡½æ•°ï¼Œå¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;),MIN(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z'
  name: air
  time                 max min
  ----                 --- ---
  2021-09-28T00:00:00Z 80  50
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›æ—¶é—´èŒƒå›´çš„ä¸‹ç•Œ(<code>WHERE time &gt;= '2021-09-18T00:00:00Z'</code>)ä½œä¸ºæŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³ã€‚</p>
<ul>
<li>
<h4 id="ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´"><a class="header" href="#ä½¿ç”¨å•ä¸ªselectorå‡½æ•°å¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´">ä½¿ç”¨å•ä¸ªselectorå‡½æ•°ï¼Œå¹¶ä¸”æŒ‡å®šæ—¶é—´èŒƒå›´</a></h4>
<pre><code class="language-sql">&gt; SELECT MAX(&quot;temperature&quot;) FROM &quot;air&quot; WHERE time &gt;= '2021-09-18T00:00:00Z' AND time &lt;= '2021-09-18T00:18:00Z' GROUP BY time(12m)
name: air
time                 max
----                 ---
2021-09-18T00:00:00Z 80
2021-09-18T00:12:00Z 797
</code></pre>
</li>
</ul>
<p>è¯¥æŸ¥è¯¢è¿”å›æ¯ä¸ª<code>GROUP BY time()</code>é—´éš”çš„æ—¶é—´ä¸‹é™ä½œä¸ºæŸ¥è¯¢ç»“æœä¸­çš„æ—¶é—´æˆ³ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="è¿ç»­æŸ¥è¯¢-1"><a class="header" href="#è¿ç»­æŸ¥è¯¢-1">è¿ç»­æŸ¥è¯¢</a></h2>
<table><thead><tr><th><a href="content/cnosdb/latest/cnosql/continuous_queries.html#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">åŸºæœ¬è¯­æ³•</a></th><th><a href="content/cnosdb/latest/cnosql/continuous_queries.html#%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95">é«˜çº§è¯­æ³•</a></th><th><a href="content/cnosdb/latest/cnosql/continuous_queries.html#%E7%AE%A1%E7%90%86CQ">ç®¡ç†CQ</a></th></tr></thead><tbody>
<tr><td><a href="content/cnosdb/latest/cnosql/continuous_queries.html#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E7%A4%BA%E4%BE%8B">åŸºæœ¬è¯­æ³•ç¤ºä¾‹</a></td><td><a href="content/cnosdb/latest/cnosql/continuous_queries.html#%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95%E7%A4%BA%E4%BE%8B">é«˜çº§è¯­æ³•ç¤ºä¾‹</a></td><td></td></tr>
</tbody></table>
<ul>
<li>
<h3 id="è¯­æ³•-34"><a class="header" href="#è¯­æ³•-34">è¯­æ³•</a></h3>
<h4 id="åŸºæœ¬è¯­æ³•-32"><a class="header" href="#åŸºæœ¬è¯­æ³•-32">åŸºæœ¬è¯­æ³•</a></h4>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &lt;cq_name&gt; ON &lt;database_name&gt;
BEGIN
  &lt;cq_query&gt;
END
</code></pre>
<p><strong>è¯­æ³•æè¿°</strong></p>
<p>CQæŸ¥è¯¢å¿…é¡»åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ª<code>INTO</code>å­å¥å’Œä¸€ä¸ª<code>GROUP BY time()</code>å­å¥ï¼š</p>
<pre><code class="language-sql">SELECT &lt;function[s]&gt; INTO &lt;destination_measurement&gt; FROM &lt;measurement&gt; [WHERE &lt;stuff&gt;] GROUP BY time(&lt;interval&gt;)[,&lt;tag_key[s]&gt;]
</code></pre>
<blockquote>
<p>åœ¨<code>WHERE</code>å­å¥ä¸­ï¼Œä¸éœ€è¦æŒ‡å®šæ—¶é—´èŒƒå›´ï¼ŒCQæŸ¥è¯¢ä¼šä¸ºè¯­å¥è‡ªåŠ¨åŒ¹é…æ—¶é—´èŒƒå›´</p>
</blockquote>
<h4 id="åŸºæœ¬è¯­æ³•ç¤ºä¾‹"><a class="header" href="#åŸºæœ¬è¯­æ³•ç¤ºä¾‹">åŸºæœ¬è¯­æ³•ç¤ºä¾‹</a></h4>
<p>ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨æ•°æ®åº“<code>transportation</code>ä¸­çš„ç¤ºä¾‹æ•°æ®ï¼Œ<code>bus_data</code>ä¸­å­˜å‚¨çš„æ•°æ®æ˜¯å…¬äº¤è½¦ä¹˜å®¢æ•°é‡å’ŒæŠ•è¯‰æ•°é‡çš„15åˆ†é’Ÿæ•°ï¼š</p>
<pre><code class="language-sql">name: bus_data
--------------
time                   passengers   complaints
2020-08-28T07:00:00Z   5            9
2020-08-28T07:15:00Z   8            9
2020-08-28T07:30:00Z   8            9
2020-08-28T07:45:00Z   7            9
2020-08-28T08:00:00Z   8            9
2020-08-28T08:15:00Z   15           7
2020-08-28T08:30:00Z   15           7
2020-08-28T08:45:00Z   17           7
2020-08-28T09:00:00Z   20           7
</code></pre>
<p><strong>è‡ªåŠ¨é‡‡æ ·æ•°æ®</strong></p>
<p>ä½¿ç”¨CQè‡ªåŠ¨ä»å•ä¸ªå­—æ®µä¸‹é‡‡æ ·æ•°æ®ï¼Œå¹¶å°†ç»“æœå†™å…¥åˆ°åŒä¸€ä¸ªæ•°æ®åº“çš„å¦ä¸€ä¸ª<code>measurement</code>ä¸­ï¼š</p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_basic&quot; ON &quot;transportation&quot;
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(1h)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T07:00:00Z   7
2020-08-28T08:00:00Z   13.75
</code></pre>
<p><strong>è‡ªåŠ¨é‡‡æ ·æ•°æ®å¹¶å°†ç»“æœä¿å­˜åˆ°å¦ä¸€ä¸ªä¿ç•™ç­–ç•¥ä¸­</strong></p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_basic_rp&quot; ON &quot;transportation&quot;
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;transportation&quot;.&quot;three_weeks&quot;.&quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(1h)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;transportation&quot;.&quot;three_weeks&quot;.&quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T07:00:00Z   7
2020-08-28T08:00:00Z   13.75
</code></pre>
<p><strong>ä½¿ç”¨é€šé…ç¬¦è‡ªåŠ¨ä¸‹é‡‡æ ·æ•°æ®</strong></p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_basic_br&quot; ON &quot;transportation&quot;
BEGIN
  SELECT mean(*) INTO &quot;downsampled_transportation&quot;.&quot;autogen&quot;.:MEASUREMENT FROM /.*/ GROUP BY time(30m),*
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;downsampled_transportation.&quot;autogen&quot;.&quot;bus_data&quot;
name: bus_data
--------------
time                   mean_complaints   mean_passengers
2020-08-28T07:00:00Z   9                 6.5
2020-08-28T07:30:00Z   9                 7.5
2020-08-28T08:00:00Z   8                 11.5
2020-08-28T08:30:00Z   7                 16
</code></pre>
<p><strong>è‡ªåŠ¨é‡‡æ ·æ•°æ®å¹¶é…ç½®CQçš„æ—¶é—´è¾¹ç•Œ</strong></p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_basic_offset&quot; ON &quot;transportation&quot;
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(1h,15m)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T07:15:00Z   7.75
2020-08-28T08:15:00Z   16.75
</code></pre>
<h4 id="é«˜çº§è¯­æ³•-24"><a class="header" href="#é«˜çº§è¯­æ³•-24">é«˜çº§è¯­æ³•</a></h4>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &lt;cq_name&gt; ON &lt;database_name&gt;
RESAMPLE EVERY &lt;interval&gt; FOR &lt;interval&gt;
BEGIN
  &lt;cq_query&gt;
END
</code></pre>
<h4 id="é«˜çº§è¯­æ³•ç¤ºä¾‹"><a class="header" href="#é«˜çº§è¯­æ³•ç¤ºä¾‹">é«˜çº§è¯­æ³•ç¤ºä¾‹</a></h4>
<p>ç¤ºä¾‹æ•°æ®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">name: bus_data
--------------
time                   passengers
2020-08-28T06:30:00Z   2
2020-08-28T06:45:00Z   4
2020-08-28T07:00:00Z   5
2020-08-28T07:15:00Z   8
2020-08-28T07:30:00Z   8
2020-08-28T07:45:00Z   7
2020-08-28T08:00:00Z   8
2020-08-28T08:15:00Z   15
2020-08-28T08:30:00Z   15
2020-08-28T08:45:00Z   17
2020-08-28T09:00:00Z   20
</code></pre>
<p><strong>é…ç½®æ—¶é—´é—´éš”</strong></p>
<p>åœ¨<code>RESAMPLE</code>ä¸­ä½¿ç”¨<code>EVERY</code>æ¥æŒ‡æ˜CQçš„æ‰§è¡Œé—´éš”</p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_advanced_every&quot; ON &quot;transportation&quot;
RESAMPLE EVERY 30m
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(1h)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T07:00:00Z   7
2020-08-28T08:00:00Z   13.75
</code></pre>
<p><strong>é…ç½®CQçš„é‡é‡‡æ ·æ—¶é—´èŒƒå›´</strong></p>
<p>åœ¨<code>RESAMPLE</code>ä¸­ä½¿ç”¨<code>FOR</code>æ¥æŒ‡æ˜CQçš„æ—¶é—´é—´éš”çš„é•¿åº¦</p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_advanced_for&quot; ON &quot;transportation&quot;
RESAMPLE FOR 1h
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(30m)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T07:00:00Z   6.5
2020-08-28T07:30:00Z   7.5
2020-08-28T08:00:00Z   11.5
2020-08-28T08:30:00Z   16
</code></pre>
<p><strong>é…ç½®æ‰§è¡Œé—´éš”å’ŒCQæ—¶é—´èŒƒå›´</strong></p>
<p>åœ¨<code>RESAMPLE</code>å­å¥ä¸­ä½¿ç”¨<code>EVERY</code>å’Œ<code>FOR</code>æ¥æŒ‡å®šCQçš„æ‰§è¡Œé—´éš”å’ŒCQçš„æ—¶é—´èŒƒå›´é•¿åº¦ã€‚</p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_advanced_every_for&quot; ON &quot;transportation&quot;
RESAMPLE EVERY 1h FOR 90m
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(30m)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T06:30:00Z   3
2020-08-28T07:00:00Z   6.5
2020-08-28T07:30:00Z   7.5
2020-08-28T08:00:00Z   11.5
2020-08-28T08:30:00Z   16
</code></pre>
<p><strong>é…ç½®CQçš„æ—¶é—´èŒƒå›´å¹¶å¡«å……ç©ºå€¼</strong></p>
<p>ä½¿ç”¨<code>FOR</code>é—´éš”å’Œ<code>fill()</code>æ¥æ›´æ”¹ä¸å«æ•°æ®çš„æ—¶é—´é—´éš”å€¼ã€‚è¯·æ³¨æ„ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®ç‚¹å¿…é¡»åœ¨<code>fill()</code>è¿è¡Œçš„<code>FOR</code>é—´éš”å†…ã€‚ å¦‚æœæ²¡æœ‰æ•°æ®è½åœ¨<code>FOR</code>é—´éš”å†…ï¼Œåˆ™CQä¸ä¼šå°†ä»»ä½•æ•°æ®å†™å…¥ç›®æ ‡<code>measurement</code>ã€‚</p>
<pre><code class="language-sql">CREATE CONTINUOUS QUERY &quot;cq_advanced_for_fill&quot; ON &quot;transportation&quot;
RESAMPLE FOR 2h
BEGIN
  SELECT mean(&quot;passengers&quot;) INTO &quot;average_passengers&quot; FROM &quot;bus_data&quot; GROUP BY time(1h) fill(1000)
END
</code></pre>
<p>æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql">&gt; SELECT * FROM &quot;average_passengers&quot;
name: average_passengers
------------------------
time                   mean
2020-08-28T05:00:00Z   1000
2020-08-28T06:00:00Z   3
2020-08-28T07:00:00Z   7
2020-08-28T08:00:00Z   13.75
2020-08-28T09:00:00Z   20
2020-08-28T10:00:00Z   1000
</code></pre>
</li>
<li>
<h3 id="ç®¡ç†cq"><a class="header" href="#ç®¡ç†cq">ç®¡ç†CQ</a></h3>
<blockquote>
<p>CQä¸èƒ½<code>update</code>ï¼Œåªèƒ½<code>drop</code>å’Œ<code>create</code></p>
</blockquote>
<p><strong>åˆ—å‡ºæ‰€æœ‰CQ</strong></p>
<pre><code class="language-sql">SHOW CONTINUOUS QUERIES
</code></pre>
<p><strong>åˆ é™¤CQ</strong></p>
<pre><code class="language-sql">DROP CONTINUOUS QUERY &lt;cq_name&gt; ON &lt;database_name&gt;
</code></pre>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cnosql-æ•°å­¦è¿ç®—ç¬¦"><a class="header" href="#cnosql-æ•°å­¦è¿ç®—ç¬¦">CnosQL æ•°å­¦è¿ç®—ç¬¦</a></h2>
<ul>
<li>
<h3 id="æ•°å­¦è¿ç®—ç¬¦"><a class="header" href="#æ•°å­¦è¿ç®—ç¬¦"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97%E7%AC%A6">æ•°å­¦è¿ç®—ç¬¦</a></a></h3>
<ul>
<li>
<h4 id="åŠ æ³•"><a class="header" href="#åŠ æ³•"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E5%8A%A0%E6%B3%95">åŠ æ³•</a></a></h4>
</li>
<li>
<h4 id="å‡æ³•"><a class="header" href="#å‡æ³•"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E5%87%8F%E6%B3%95">å‡æ³•</a></a></h4>
</li>
<li>
<h4 id="ä¹˜æ³•"><a class="header" href="#ä¹˜æ³•"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E4%B9%98%E6%B3%95">ä¹˜æ³•</a></a></h4>
</li>
<li>
<h4 id="é™¤æ³•"><a class="header" href="#é™¤æ³•"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E9%99%A4%E6%B3%95">é™¤æ³•</a></a></h4>
</li>
<li>
<h4 id="æ¨¡è¿ç®—"><a class="header" href="#æ¨¡è¿ç®—"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E6%A8%A1%E8%BF%90%E7%AE%97">æ¨¡è¿ç®—</a></a></h4>
</li>
<li>
<h4 id="ä½ä¸è¿ç®—"><a class="header" href="#ä½ä¸è¿ç®—"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E4%BD%8D%E4%B8%8E%E8%BF%90%E7%AE%97">ä½ä¸è¿ç®—</a></a></h4>
</li>
<li>
<h4 id="ä½æˆ–è¿ç®—"><a class="header" href="#ä½æˆ–è¿ç®—"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E4%BD%8D%E6%88%96%E8%BF%90%E7%AE%97">ä½æˆ–è¿ç®—</a></a></h4>
</li>
<li>
<h4 id="ä½å¼‚è¿ç®—"><a class="header" href="#ä½å¼‚è¿ç®—"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E4%BD%8D%E5%BC%82%E8%BF%90%E7%AE%97">ä½å¼‚è¿ç®—</a></a></h4>
</li>
<li>
<h4 id="å¸¸è§é—®é¢˜"><a class="header" href="#å¸¸è§é—®é¢˜"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜</a></a></h4>
</li>
</ul>
</li>
<li>
<h3 id="ä¸æ”¯æŒçš„è¿ç®—ç¬¦"><a class="header" href="#ä¸æ”¯æŒçš„è¿ç®—ç¬¦"><a href="content/cnosdb/latest/cnosql/math_operators.html#%E4%B8%8D%E6%94%AF%E6%8C%81%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6">ä¸æ”¯æŒçš„è¿ç®—ç¬¦</a></a></h3>
</li>
<li>
<h3 id="æ•°å­¦è¿ç®—ç¬¦-1"><a class="header" href="#æ•°å­¦è¿ç®—ç¬¦-1">æ•°å­¦è¿ç®—ç¬¦</a></h3>
<ul>
<li>
<h4 id="åŠ æ³•-1"><a class="header" href="#åŠ æ³•-1">åŠ æ³•</a></h4>
</li>
</ul>
<p>å¸¸é‡çš„åŠ æ³•</p>
<pre><code>SELECT &quot;temperature&quot; + 5 FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; + 5 &gt; 10
</code></pre>
<p>ä¸¤å­—æ®µçš„åŠ æ³•</p>
<pre><code>SELECT &quot;temperature&quot; + &quot;visibility&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; + &quot;visibility&quot; &gt; 10
</code></pre>
<ul>
<li>
<h4 id="å‡æ³•-1"><a class="header" href="#å‡æ³•-1">å‡æ³•</a></h4>
</li>
</ul>
<p>å¸¸é‡çš„å‡æ³•</p>
<pre><code>SELECT &quot;temperature&quot; - 2 FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; - 2 &gt; 12
</code></pre>
<p>ä¸¤å­—æ®µçš„å‡æ³•</p>
<pre><code>SELECT &quot;temperature&quot; - &quot;visibility&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; - &quot;visibility&quot; &gt; 10
</code></pre>
<ul>
<li>
<h4 id="ä¹˜æ³•-1"><a class="header" href="#ä¹˜æ³•-1">ä¹˜æ³•</a></h4>
</li>
</ul>
<p>å¸¸é‡çš„ä¹˜æ³•</p>
<pre><code>SELECT &quot;temperature&quot; * 2 FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; - 2 &gt; 12
</code></pre>
<p>ä¸¤å­—æ®µçš„å‡æ³•</p>
<pre><code>SELECT &quot;temperature&quot; * &quot;visibility&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; * &quot;visibility&quot; &gt; 10
</code></pre>
<p>ä¹˜æ³•å’Œå…¶ä»–æ“ä½œç¬¦å¹¶ç”¨</p>
<pre><code>SELECT 10 * (&quot;temperature&quot; + &quot;visibility&quot; + &quot;pressure&quot;) FROM &quot;air&quot;
SELECT 10 * (&quot;temperature&quot; + &quot;visibility&quot; - &quot;pressure&quot;) FROM &quot;air&quot;
SELECT 10 * (&quot;temperature&quot; - &quot;visibility&quot; - &quot;pressure&quot;) FROM &quot;air&quot;
</code></pre>
<ul>
<li>
<h4 id="é™¤æ³•-1"><a class="header" href="#é™¤æ³•-1">é™¤æ³•</a></h4>
</li>
</ul>
<p>å¸¸é‡çš„é™¤æ³•</p>
<pre><code>SELECT 10 / &quot;temperature&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE 10 / &quot;temperature&quot; &gt; 12
</code></pre>
<p>ä¸¤å­—æ®µçš„å‡æ³•</p>
<pre><code>SELECT &quot;temperature&quot; / &quot;visibility&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; / &quot;visibility&quot; &gt; 10
</code></pre>
<p>ä¹˜æ³•å’Œå…¶ä»–æ“ä½œç¬¦å¹¶ç”¨</p>
<pre><code>SELECT 10 / (&quot;temperature&quot; + &quot;visibility&quot; + &quot;pressure&quot;) FROM &quot;air&quot;
SELECT 10 / (&quot;temperature&quot; + &quot;visibility&quot; - &quot;pressure&quot;) FROM &quot;air&quot;
SELECT 10 / (&quot;temperature&quot; - &quot;visibility&quot; - &quot;pressure&quot;) FROM &quot;air&quot;
</code></pre>
<ul>
<li>
<h4 id="æ¨¡è¿ç®—-1"><a class="header" href="#æ¨¡è¿ç®—-1">æ¨¡è¿ç®—</a></h4>
</li>
</ul>
<p>å¸¸é‡çš„æ¨¡è¿ç®—</p>
<pre><code>SELECT 10 % &quot;temperature&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE 10 % &quot;temperature&quot; = 0
</code></pre>
<p>ä¸¤å­—æ®µçš„æ¨¡è¿ç®—</p>
<pre><code>SELECT &quot;temperature&quot; % &quot;visibility&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; % &quot;visibility&quot; = 0
</code></pre>
<ul>
<li>
<h4 id="æŒ‰ä½ä¸è¿ç®—"><a class="header" href="#æŒ‰ä½ä¸è¿ç®—">æŒ‰ä½ä¸è¿ç®—</a></h4>
</li>
</ul>
<p>æ‚¨å¯ä»¥å¯¹ä»»ä½•æ•´æ•°æˆ–å¸ƒå°”å€¼ä½¿ç”¨æ­¤æ“ä½œç¬¦ï¼Œæ— è®ºå®ƒä»¬æ˜¯å­—æ®µè¿˜æ˜¯å¸¸é‡ã€‚å®ƒä¸é€‚ç”¨äºæµ®ç‚¹æˆ–å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”ä¸èƒ½æ··åˆæ•´æ•°å’Œå¸ƒå°”å€¼ä½¿ç”¨ã€‚</p>
<pre><code>SELECT &quot;temperature&quot; &amp; 255 FROM &quot;air&quot;
SELECT &quot;temperature&quot; &amp; &quot;pressure&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; &amp; 15 &gt; 0
SELECT &quot;temperature&quot; &amp; &quot;pressure&quot; FROM &quot;air&quot;
SELECT (&quot;temperature&quot; ^ true) &amp; &quot;pressure&quot; FROM &quot;air&quot;
</code></pre>
<ul>
<li>
<h4 id="æŒ‰ä½æˆ–è¿ç®—"><a class="header" href="#æŒ‰ä½æˆ–è¿ç®—">æŒ‰ä½æˆ–è¿ç®—</a></h4>
</li>
</ul>
<p>æ‚¨å¯ä»¥å¯¹ä»»ä½•æ•´æ•°æˆ–å¸ƒå°”å€¼ä½¿ç”¨æ­¤æ“ä½œç¬¦ï¼Œæ— è®ºå®ƒä»¬æ˜¯å­—æ®µè¿˜æ˜¯å¸¸é‡ã€‚å®ƒä¸é€‚ç”¨äºæµ®ç‚¹æˆ–å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”ä¸èƒ½æ··åˆæ•´æ•°å’Œå¸ƒå°”å€¼ä½¿ç”¨ã€‚</p>
<pre><code>SELECT &quot;temperature&quot; | 255 FROM &quot;air&quot;
SELECT &quot;temperature&quot; | &quot;pressure&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; | 12 = 12
</code></pre>
<ul>
<li>
<h4 id="æŒ‰ä½å¼‚è¿ç®—"><a class="header" href="#æŒ‰ä½å¼‚è¿ç®—">æŒ‰ä½å¼‚è¿ç®—</a></h4>
</li>
</ul>
<p>æ‚¨å¯ä»¥å¯¹ä»»ä½•æ•´æ•°æˆ–å¸ƒå°”å€¼ä½¿ç”¨æ­¤æ“ä½œç¬¦ï¼Œæ— è®ºå®ƒä»¬æ˜¯å­—æ®µè¿˜æ˜¯å¸¸é‡ã€‚å®ƒä¸é€‚ç”¨äºæµ®ç‚¹æˆ–å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”ä¸èƒ½æ··åˆæ•´æ•°å’Œå¸ƒå°”å€¼ä½¿ç”¨ã€‚</p>
<pre><code>SELECT &quot;temperature&quot; ^ 255 FROM &quot;air&quot;
SELECT &quot;temperature&quot; ^ &quot;pressure&quot; FROM &quot;air&quot;
SELECT * FROM &quot;air&quot; WHERE &quot;temperature&quot; ^ 12 = 12
</code></pre>
<ul>
<li>
<h4 id="å¸¸è§é—®é¢˜-1"><a class="header" href="#å¸¸è§é—®é¢˜-1">å¸¸è§é—®é¢˜</a></h4>
<ul>
<li>
<h4 id="å¸¦æœ‰é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„æ•°å­¦æ“ä½œç¬¦"><a class="header" href="#å¸¦æœ‰é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„æ•°å­¦æ“ä½œç¬¦">å¸¦æœ‰é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„æ•°å­¦æ“ä½œç¬¦</a></h4>
</li>
</ul>
<p>CnosDBä¸æ”¯æŒåœ¨SELECTå­å¥ä¸­ç»„åˆæ•°å­¦æ“ä½œä¸é€šé…ç¬¦(*)æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚ä»¥ä¸‹æŸ¥è¯¢æ— æ•ˆï¼Œç³»ç»Ÿè¿”å›é”™è¯¯:
å¯¹é€šé…ç¬¦æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚</p>
<pre><code>&gt; SELECT * + 2 FROM &quot;air&quot;
ERR: unsupported expression with wildcard: * + 2
</code></pre>
<p>å¯¹å‡½æ•°ä¸­çš„é€šé…ç¬¦æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚</p>
<pre><code>&gt; SELECT COUNT(*) / 2 FROM &quot;nope&quot;
ERR: unsupported expression with wildcard: count(*) / 2
</code></pre>
<p>å¯¹æ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚</p>
<pre><code>&gt; SELECT /A/ + 2 FROM &quot;air&quot;
ERR: error parsing query: found +, expected FROM at line 1, char 12
</code></pre>
<p>å¯¹å‡½æ•°ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œæ•°å­¦è¿ç®—ã€‚</p>
<pre><code>&gt; SELECT COUNT(/A/) + 2 FROM &quot;nope&quot;
ERR: unsupported expression with regex field: count(/A/) + 2
</code></pre>
<ul>
<li>
<h4 id="å‡½æ•°çš„æ•°å­¦è¿ç®—ç¬¦"><a class="header" href="#å‡½æ•°çš„æ•°å­¦è¿ç®—ç¬¦">å‡½æ•°çš„æ•°å­¦è¿ç®—ç¬¦</a></h4>
</li>
</ul>
<p>ç›®å‰ä¸æ”¯æŒåœ¨å‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨æ•°å­¦è¿ç®—ç¬¦ã€‚æ³¨æ„ï¼ŒCnosDBåªå…è®¸SELECTå­å¥ä¸­çš„å‡½æ•°ã€‚
å¯è¡Œæ“ä½œï¼š</p>
<pre><code>SELECT 10 * mean(&quot;value&quot;) FROM &quot;cpu&quot;
</code></pre>
<p>ä¸å¯è¡Œæ“ä½œï¼š</p>
<pre><code>SELECT mean(10 * &quot;value&quot;) FROM &quot;cpu&quot;
</code></pre>
</li>
</ul>
</li>
<li>
<h3 id="ä¸æ”¯æŒçš„è¿ç®—ç¬¦-1"><a class="header" href="#ä¸æ”¯æŒçš„è¿ç®—ç¬¦-1">ä¸æ”¯æŒçš„è¿ç®—ç¬¦</a></h3>
<ul>
<li>
<h4 id="æ¯”è¾ƒè¿ç®—"><a class="header" href="#æ¯”è¾ƒè¿ç®—">æ¯”è¾ƒè¿ç®—</a></h4>
</li>
</ul>
<p>æ‰€æœ‰çš„æ¯”è¾ƒè¿ç®—ç¬¦éƒ½ä¸æ”¯æŒã€‚ä¾‹å¦‚ï¼š<code>=</code>,<code>!=</code>,<code>&lt;</code>,<code>&gt;</code>,<code>&lt;=</code>,<code>&gt;=</code>,<code>&lt;&gt;</code>ã€‚åœ¨SELECTè¯­å¥ä¸­å‡ä¸å¯ä»¥ä½¿ç”¨ã€‚</p>
<ul>
<li>
<h4 id="é€»è¾‘è¿ç®—ç¬¦"><a class="header" href="#é€»è¾‘è¿ç®—ç¬¦">é€»è¾‘è¿ç®—ç¬¦</a></h4>
</li>
</ul>
<p>ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ï¼Œå¦‚ï¼š<code>!|</code>, <code>NAND</code>,<code>XOR</code>,<code>NOR</code>ï¼›éƒ½ä¼šå¯¼è‡´è§£æé”™è¯¯ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨æŸ¥è¯¢çš„<code>SELECT</code>å­å¥ä¸­ä½¿ç”¨<code>AND</code>å’Œ<code>OR</code>ä¸ä¼šè¡¨ç°ä¸ºæ•°å­¦è¿ç®—ç¬¦ï¼Œåªä¼šäº§ç”Ÿç©ºç»“æœï¼Œå› ä¸ºå®ƒä»¬åœ¨CnosQLä¸­å·²ç»è¢«å®šä¹‰ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥å¯¹å¸ƒå°”æ•°æ®åº”ç”¨ä½æ“ä½œç¬¦<code>&amp;</code>ã€<code>|</code>å’Œ<code>^</code>ã€‚</p>
<ul>
<li>
<h4 id="ä½éè¿ç®—"><a class="header" href="#ä½éè¿ç®—">ä½éè¿ç®—</a></h4>
</li>
</ul>
<p>æ²¡æœ‰ä½éè¿ç®—ç¬¦ï¼Œå› ä¸ºæ‚¨æœŸæœ›çš„ç»“æœå–å†³äºæ‚¨çš„ä½åŸŸçš„å®½åº¦ã€‚CnosQLä¸çŸ¥é“æ‚¨çš„ä½åŸŸæœ‰å¤šå®½ï¼Œå› æ­¤æ— æ³•å®ç°åˆé€‚çš„ä½éè¿ç®—ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨<code>^</code>(ä½å¼‚æˆ–)æ“ä½œç¬¦å’Œä»£è¡¨å­—å®½çš„å…¨1çš„äºŒè¿›åˆ¶æ•°å­—æ¥å®ç°ä½éæ“ä½œ:</p>
<pre><code>8-bit æ•°æ®ï¼š

SELECT &quot;temperature&quot; ^ 255 FROM &quot;air&quot;

16-bit æ•°æ®:

SELECT &quot;temperature&quot; ^ 65535 FROM &quot;air&quot;

32-bit æ•°æ®:

SELECT &quot;temperature&quot; ^ 4294967295 FROM &quot;air&quot;
</code></pre>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cnosqlå‚è€ƒ"><a class="header" href="#cnosqlå‚è€ƒ">CnosQLå‚è€ƒ</a></h1>
<h2 id="ä»‹ç»-1"><a class="header" href="#ä»‹ç»-1">ä»‹ç»</a></h2>
<p>CnosQLçš„å®šä¹‰å’Œè¯¦ç»†ä¿¡æ¯</p>
<ul>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E7%AC%A6%E5%8F%B7">ç¬¦å·</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E7%A4%BA">æŸ¥è¯¢è¡¨ç¤º</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E5%AD%97%E6%AF%8D%E5%92%8C%E6%95%B0%E5%AD%97">å­—æ¯å’Œæ•°å­—</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E6%A0%87%E8%AF%86%E7%AC%A6">æ ‡è¯†ç¬¦</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E5%85%B3%E9%94%AE%E5%AD%97">å…³é”®å­—</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E6%96%87%E5%AD%97">æ–‡å­—</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E8%AF%AD%E5%8F%A5">è¯­å¥</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E6%9D%A1%E6%AC%BE">æ¡æ¬¾</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E8%A1%A8%E8%BE%BE%E5%BC%8F">è¡¨è¾¾å¼</a></li>
<li><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E5%85%B6%E4%BB%96">å…¶ä»–</a></li>
</ul>
<blockquote>
<p>è¦äº†è§£æ›´å¤šå…³äºCnosQLçš„ä¿¡æ¯ï¼Œè¯·æµè§ˆä»¥ä¸‹å†…å®¹ï¼š</p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#%E4%BD%BF%E7%94%A8cnosql%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE">ä½¿ç”¨CnosQLæ¢ç´¢æ•°æ®</a></p>
<p><a href="content/cnosdb/latest/cnosql/">ä½¿ç”¨CnosQLæ¢ç´¢æ‚¨çš„æ¨¡å¼</a></p>
<p><a href="content/cnosdb/latest/cnosql/cnosql_spect.html#">æ•°æ®åº“ç®¡ç†</a></p>
</blockquote>
<h3 id="ç¬¦å·"><a class="header" href="#ç¬¦å·">ç¬¦å·</a></h3>
<p>ä½¿ç”¨Extended Backus-Naur Form(&quot; EBNF &quot;)æŒ‡å®šè¯­æ³•ã€‚EBNFä¸Goç¼–ç¨‹è¯­è¨€è§„èŒƒä¸­ä½¿ç”¨çš„ç¬¦å·ç›¸åŒã€‚å¹¶éå·§åˆçš„æ˜¯ï¼ŒCnosDBæ˜¯ç”¨Goç¼–å†™çš„ã€‚</p>
<pre><code>Production  = production_name &quot;=&quot; [ Expression ] &quot;.&quot; .
Expression  = Alternative { &quot;|&quot; Alternative } .
Alternative = Term { Term } .
Term        = production_name | token [ &quot;â€¦&quot; token ] | Group | Option | Repetition .
Group       = &quot;(&quot; Expression &quot;)&quot; .
Option      = &quot;[&quot; Expression &quot;]&quot; .
Repetition  = &quot;{&quot; Expression &quot;}&quot; .
</code></pre>
<p>æŒ‰ä¼˜å…ˆçº§é€’å¢çš„é¡ºåºè¡¨ç¤ºæ“ä½œç¬¦:</p>
<pre><code>|   alternation
()  grouping
[]  option (0 or 1 times)
{}  repetition (0 to n times)
</code></pre>
<h3 id="æŸ¥è¯¢è¡¨ç¤º"><a class="header" href="#æŸ¥è¯¢è¡¨ç¤º">æŸ¥è¯¢è¡¨ç¤º</a></h3>
<ul>
<li>
<h4 id="å­—ç¬¦"><a class="header" href="#å­—ç¬¦">å­—ç¬¦</a></h4>
</li>
</ul>
<p>CnosQLæ˜¯ä½¿ç”¨UTF-8ç¼–ç çš„Unicodeæ–‡æœ¬ã€‚</p>
<pre><code>newline             = /* the Unicode code point U+000A */ .
unicode_char        = /* an arbitrary Unicode code point except newline */ .
</code></pre>
<h3 id="å­—æ¯å’Œæ•°å­—"><a class="header" href="#å­—æ¯å’Œæ•°å­—">å­—æ¯å’Œæ•°å­—</a></h3>
<p>å­—æ¯æ˜¯ASCIIå­—ç¬¦çš„é›†åˆï¼ŒåŠ ä¸Šä¸‹åˆ’çº¿_ (U+005F)ä¹Ÿè¢«è®¤ä¸ºæ˜¯å­—æ¯ã€‚åªæ”¯æŒåè¿›åˆ¶æ•°å­—ã€‚</p>
<pre><code>letter              = ascii_letter | &quot;_&quot; .
ascii_letter        = &quot;A&quot; â€¦ &quot;Z&quot; | &quot;a&quot; â€¦ &quot;z&quot; .
digit               = &quot;0&quot; â€¦ &quot;9&quot; .
</code></pre>
<h3 id="æ ‡è¯†ç¬¦"><a class="header" href="#æ ‡è¯†ç¬¦">æ ‡è¯†ç¬¦</a></h3>
<p>æ ‡è¯†ç¬¦åŒ…æ‹¬æ•°æ®åº“åã€ä¿ç•™ç­–ç•¥åã€ç”¨æˆ·åã€åº¦é‡åã€æ ‡è®°é”®ä»¥åŠå­—æ®µé”®ã€‚</p>
<p>æ ‡è¯†ç¬¦ä½¿ç”¨è§„åˆ™å¦‚ä¸‹ï¼›</p>
<ul>
<li>åŒå¼•å·æ ‡è¯†ç¬¦å¯ä»¥åŒ…å«é™¤æ–°è¡Œä»¥å¤–çš„ä»»ä½•unicodeå­—ç¬¦ã€‚</li>
<li>åŒå¼•å·æ ‡è¯†ç¬¦å¯ä»¥åŒ…æ‹¬è½¬ä¹‰çš„<code>&quot;</code>å­—ç¬¦ã€‚ä¾‹å¦‚ï¼›<code>\&quot;</code> ã€‚</li>
<li>åŒå¼•å·æ ‡è¯†ç¬¦ä¸­å¯ä»¥åŒ…æ‹¬CnosQLçš„å…³é”®å­—ã€‚</li>
<li>æœªåŠ å¼•å·çš„æ ‡è¯†ç¬¦å¿…é¡»ä»¥å¤§å†™æˆ–å°å†™ASCIIå­—ç¬¦æˆ–è€…&quot;_&quot;å¼€å¤´ã€‚</li>
<li>æœªåŠ å¼•å·çš„æ ‡è¯†ç¬¦åªèƒ½åŒ…æ‹¬ASCIIå­—æ¯ã€åè¿›åˆ¶æ•°å­—æˆ–è€…&quot;_&quot;ã€‚</li>
</ul>
<pre><code>identifier          = unquoted_identifier | quoted_identifier .
unquoted_identifier = ( letter ) { letter | digit } .
quoted_identifier   = `&quot;` unicode_char { unicode_char } `&quot;` .
</code></pre>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code>air
_air_temperature
&quot;1h&quot;
&quot;anything really&quot;
&quot;1_Crazy-1337.identifier&gt;NAMEğŸ‘&quot;
</code></pre>
<h3 id="å…³é”®å­—"><a class="header" href="#å…³é”®å­—">å…³é”®å­—</a></h3>
<pre><code>ALL           ALTER         ANY           AS            ASC           BEGIN
BY            CREATE        CONTINUOUS    DATABASE      DATABASES     DEFAULT
DELETE        DESC          DESTINATIONS  DIAGNOSTICS   DISTINCT      DROP
DURATION      END           EVERY         EXPLAIN       FIELD         FOR
FROM          GRANT         GRANTS        GROUP         GROUPS        IN
INF           INSERT        INTO          KEY           KEYS          KILL
LIMIT         SHOW          MEASUREMENT   MEASUREMENTS  NAME          OFFSET
ON            ORDER         PASSWORD      POLICY        POLICIES      PRIVILEGES
QUERIES       QUERY         READ          REPLICATION   RESAMPLE      RETENTION
REVOKE        SELECT        SERIES        SET           SHARD         SHARDS
SLIMIT        SOFFSET       STATS         SUBSCRIPTION  SUBSCRIPTIONS TAG
TO            USER          USERS         VALUES        WHERE         WITH
WRITE
</code></pre>
<p>å¦‚æœä½¿ç”¨äº†CnosQLçš„å…³é”®å­—ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œåˆ™éœ€è¦åœ¨æ¯æ¬¡æŸ¥è¯¢ä¸­å¯¹è¯¥æ ‡è¯†ç¬¦åŠ åŒå¼•å·ã€‚</p>
<p>å…³é”®å­—<code>time</code>æ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚<code>time</code>å¯ä»¥æ˜¯è¿ç»­æŸ¥è¯¢åç§°ã€æ•°æ®åº“åç§°ã€æµ‹é‡åç§°ã€ä¿ç•™ç­–ç•¥åç§°ã€è®¢é˜…åç§°å’Œç”¨æˆ·åç§°ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ä¸­çš„<code>time</code>ä¸éœ€è¦åŒå¼•å·ã€‚<code>time</code>ä¸èƒ½æ˜¯å­—æ®µé”®æˆ–æ ‡ç­¾é”®ï¼›CnosQLæ‹’ç»å°†<code>time</code>ä½œä¸ºå­—æ®µé”®æˆ–æ ‡è®°é”®çš„å†™å…¥ï¼Œå¹¶è¿”å›é”™è¯¯ã€‚</p>
<h3 id="æ–‡å­—"><a class="header" href="#æ–‡å­—">æ–‡å­—</a></h3>
<ul>
<li>
<h4 id="æ•´æ•°-1"><a class="header" href="#æ•´æ•°-1">æ•´æ•°</a></h4>
</li>
</ul>
<p>CnosQLç›®å‰åªæ”¯æŒåè¿›åˆ¶æ•°å­—ï¼Œå¹¶ä¸æ”¯æŒå…¶ä»–è¿›åˆ¶æ•°å­—ã€‚</p>
<pre><code>int_lit             = ( &quot;1&quot; â€¦ &quot;9&quot; ) { digit } .
</code></pre>
<ul>
<li>
<h4 id="æµ®ç‚¹æ•°-1"><a class="header" href="#æµ®ç‚¹æ•°-1">æµ®ç‚¹æ•°</a></h4>
</li>
</ul>
<p>CnosQLç›®å‰åªæ”¯æŒæµ®ç‚¹æ•°ï¼Œå¹¶ä¸æ”¯æŒæŒ‡æ•°ã€‚</p>
<pre><code>float_lit           = int_lit &quot;.&quot; int_lit .
</code></pre>
<ul>
<li>
<h4 id="å­—ç¬¦ä¸²-1"><a class="header" href="#å­—ç¬¦ä¸²-1">å­—ç¬¦ä¸²</a></h4>
</li>
</ul>
<p>å­—ç¬¦ä¸²å¿…é¡»å’Œå•å¼•å·æ­é…ä½¿ç”¨ã€‚å¦‚æœåŠ ä¸Šè½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²ä¸­å¯ä»¥åŒ…å«å•å¼•å·ã€‚</p>
<pre><code>string_lit          = `'` { unicode_char } `'` .
</code></pre>
<ul>
<li>
<h4 id="æŒç»­æ—¶é—´"><a class="header" href="#æŒç»­æ—¶é—´">æŒç»­æ—¶é—´</a></h4>
</li>
</ul>
<p>æŒç»­æ—¶é—´çš„å­—é¢å€¼æŒ‡å®šæ—¶é—´é•¿åº¦ã€‚æ•´æ•°å­—é¢å€¼ç´§è·Ÿç€(æ²¡æœ‰ç©ºæ ¼)ä¸‹é¢åˆ—å‡ºçš„æŒç»­æ—¶é—´å•ä½è¢«ç§°ä¸ºæŒç»­æ—¶é—´å­—é¢å€¼ã€‚å¯ä»¥ä½¿ç”¨æ··åˆå•å…ƒæŒ‡å®šæŒç»­æ—¶é—´ã€‚</p>
<pre><code>duration_lit        = int_lit duration_unit .
duration_unit       = &quot;ns&quot; | &quot;u&quot; | &quot;Âµ&quot; | &quot;ms&quot; | &quot;s&quot; | &quot;m&quot; | &quot;h&quot; | &quot;d&quot; | &quot;w&quot; .
</code></pre>
<ul>
<li>
<h4 id="æ—¥æœŸå’Œæ—¶é—´"><a class="header" href="#æ—¥æœŸå’Œæ—¶é—´">æ—¥æœŸå’Œæ—¶é—´</a></h4>
</li>
</ul>
<p>ä¸æœ¬æ–‡æ¡£çš„å…¶ä½™éƒ¨åˆ†ä¸€æ ·ï¼ŒEBNFä¸­æ²¡æœ‰æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´æ–‡æœ¬æ ¼å¼ã€‚å®ƒæ˜¯ä½¿ç”¨Goçš„æ—¥æœŸ/æ—¶é—´è§£ææ ¼å¼æŒ‡å®šçš„ï¼Œå®ƒæ˜¯æŒ‰ç…§CnosQLè¦æ±‚çš„æ ¼å¼ç¼–å†™çš„å¼•ç”¨æ—¥æœŸã€‚</p>
<p>å‚è€ƒæ—¥æœŸæ—¶é—´ä¸º:January 2nd, 2006 at 3:04:05 PM</p>
<pre><code>time_lit            = &quot;2006-01-02 15:04:05.999999&quot; | &quot;2006-01-02&quot; .
</code></pre>
<ul>
<li>
<h4 id="å¸ƒå°”å€¼-1"><a class="header" href="#å¸ƒå°”å€¼-1">å¸ƒå°”å€¼</a></h4>
</li>
</ul>
<pre><code>bool_lit            = TRUE | FALSE .
</code></pre>
<ul>
<li>
<h4 id="æ­£åˆ™è¡¨è¾¾å¼"><a class="header" href="#æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a></h4>
</li>
</ul>
<pre><code>regex_lit           = &quot;/&quot; { unicode_char } &quot;/&quot; .
</code></pre>
<h3 id="æŸ¥è¯¢-1"><a class="header" href="#æŸ¥è¯¢-1">æŸ¥è¯¢</a></h3>
<p>æŸ¥è¯¢ç”±ä¸€ä¸ªæˆ–å¤šä¸ªä»¥åˆ†å·åˆ†éš”çš„è¯­å¥ç»„æˆã€‚</p>
<pre><code>query               = statement { &quot;;&quot; statement } .

statement           = alter_retention_policy_stmt |
                      create_continuous_query_stmt |
                      create_database_stmt |
                      create_retention_policy_stmt |
                      create_subscription_stmt |
                      create_user_stmt |
                      delete_stmt |
                      drop_continuous_query_stmt |
                      drop_database_stmt |
                      drop_measurement_stmt |
                      drop_retention_policy_stmt |
                      drop_series_stmt |
                      drop_shard_stmt |
                      drop_subscription_stmt |
                      drop_user_stmt |
                      explain_stmt |
                      explain_analyze_stmt |
                      grant_stmt |
                      kill_query_statement |
                      revoke_stmt |
                      select_stmt |
                      show_continuous_queries_stmt |
                      show_databases_stmt |
                      show_diagnostics_stmt |
                      show_field_key_cardinality_stmt |
                      show_field_keys_stmt |
                      show_grants_stmt |
                      show_measurement_cardinality_stmt |
                      show_measurement_exact_cardinality_stmt |
                      show_measurements_stmt |
                      show_queries_stmt |
                      show_retention_policies_stmt |
                      show_series_cardinality_stmt |
                      show_series_exact_cardinality_stmt |
                      show_series_stmt |
                      show_shard_groups_stmt |
                      show_shards_stmt |
                      show_stats_stmt |
                      show_subscriptions_stmt |
                      show_tag_key_cardinality_stmt |
                      show_tag_key_exact_cardinality_stmt |
                      show_tag_keys_stmt |
                      show_tag_values_stmt |
                      show_tag_values_cardinality_stmt |
                      show_users_stmt .
</code></pre>
<h3 id="è¯­å¥"><a class="header" href="#è¯­å¥">è¯­å¥</a></h3>
<ul>
<li>
<h4 id="æ”¹å˜ä¿ç•™ç­–ç•¥"><a class="header" href="#æ”¹å˜ä¿ç•™ç­–ç•¥">æ”¹å˜ä¿ç•™ç­–ç•¥</a></h4>
</li>
</ul>
<pre><code>alter_retention_policy_stmt  = &quot;ALTER RETENTION POLICY&quot; policy_name on_clause
                               retention_policy_option
                               [ retention_policy_option ]
                               [ retention_policy_option ]
                               [ retention_policy_option ] .
</code></pre>
<ul>
<li>
<h4 id="åˆ›å»ºè¿ç»­æŸ¥è¯¢"><a class="header" href="#åˆ›å»ºè¿ç»­æŸ¥è¯¢">åˆ›å»ºè¿ç»­æŸ¥è¯¢</a></h4>
</li>
</ul>
<pre><code>create_continuous_query_stmt = &quot;CREATE CONTINUOUS QUERY&quot; query_name on_clause
[ &quot;RESAMPLE&quot; resample_opts ]
&quot;BEGIN&quot; select_stmt &quot;END&quot; .

query_name                   = identifier .

resample_opts                = (every_stmt for_stmt | every_stmt | for_stmt) .
every_stmt                   = &quot;EVERY&quot; duration_lit
for_stmt                     = &quot;FOR&quot; duration_lit
</code></pre>
<ul>
<li>
<h4 id="åˆ›å»ºæ•°æ®åº“-1"><a class="header" href="#åˆ›å»ºæ•°æ®åº“-1">åˆ›å»ºæ•°æ®åº“</a></h4>
</li>
</ul>
<pre><code>create_database_stmt = &quot;CREATE DATABASE&quot; db_name
                       [ WITH
                           [ retention_policy_duration ]
                           [ retention_policy_replication ]
                           [ retention_policy_shard_group_duration ]
                           [ retention_policy_name ]
                        ] .
</code></pre>
<ul>
<li>
<h4 id="åˆ›å»ºä¿ç•™ç­–ç•¥-1"><a class="header" href="#åˆ›å»ºä¿ç•™ç­–ç•¥-1">åˆ›å»ºä¿ç•™ç­–ç•¥</a></h4>
</li>
</ul>
<pre><code>create_retention_policy_stmt = &quot;CREATE RETENTION POLICY&quot; policy_name on_clause
                               retention_policy_duration
                               retention_policy_replication
                               [ retention_policy_shard_group_duration ]
                               [ &quot;DEFAULT&quot; ] .
</code></pre>
<ul>
<li>
<h4 id="åˆ›å»ºç”¨æˆ·"><a class="header" href="#åˆ›å»ºç”¨æˆ·">åˆ›å»ºç”¨æˆ·</a></h4>
</li>
</ul>
<pre><code>create_user_stmt = &quot;CREATE USER&quot; user_name &quot;WITH PASSWORD&quot; password
                   [ &quot;WITH ALL PRIVILEGES&quot; ] .
</code></pre>
<ul>
<li>
<h4 id="åˆ é™¤-1"><a class="header" href="#åˆ é™¤-1">åˆ é™¤</a></h4>
</li>
</ul>
<pre><code>e_stmt = &quot;DELETE&quot; ( from_clause | where_clause | from_clause where_clause ) .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒè¿ç»­æŸ¥è¯¢"><a class="header" href="#æŠ›å¼ƒè¿ç»­æŸ¥è¯¢">æŠ›å¼ƒè¿ç»­æŸ¥è¯¢</a></h4>
</li>
</ul>
<pre><code>drop_continuous_query_stmt = &quot;DROP CONTINUOUS QUERY&quot; query_name on_clause .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒæ•°æ®åº“"><a class="header" href="#æŠ›å¼ƒæ•°æ®åº“">æŠ›å¼ƒæ•°æ®åº“</a></h4>
</li>
</ul>
<pre><code>drop_database_stmt = &quot;DROP DATABASE&quot; db_name .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒåº¦é‡"><a class="header" href="#æŠ›å¼ƒåº¦é‡">æŠ›å¼ƒåº¦é‡</a></h4>
</li>
</ul>
<pre><code>drop_measurement_stmt = &quot;DROP MEASUREMENT&quot; measurement .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒä¿ç•™ç­–ç•¥"><a class="header" href="#æŠ›å¼ƒä¿ç•™ç­–ç•¥">æŠ›å¼ƒä¿ç•™ç­–ç•¥</a></h4>
</li>
</ul>
<pre><code>drop_retention_policy_stmt = &quot;DROP RETENTION POLICY&quot; policy_name on_clause .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒåºåˆ—"><a class="header" href="#æŠ›å¼ƒåºåˆ—">æŠ›å¼ƒåºåˆ—</a></h4>
</li>
</ul>
<pre><code>drop_series_stmt = &quot;DROP SERIES&quot; ( from_clause | where_clause | from_clause where_clause ) .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒåˆ†ç‰‡"><a class="header" href="#æŠ›å¼ƒåˆ†ç‰‡">æŠ›å¼ƒåˆ†ç‰‡</a></h4>
</li>
</ul>
<pre><code>drop_shard_stmt = &quot;DROP SHARD&quot; ( shard_id ) .
</code></pre>
<ul>
<li>
<h4 id="æŠ›å¼ƒç”¨æˆ·"><a class="header" href="#æŠ›å¼ƒç”¨æˆ·">æŠ›å¼ƒç”¨æˆ·</a></h4>
</li>
</ul>
<pre><code>drop_user_stmt = &quot;DROP USER&quot; user_name .
</code></pre>
<ul>
<li>
<h4 id="explain"><a class="header" href="#explain">EXPLAIN</a></h4>
</li>
</ul>
<pre><code>explain_stmt = &quot;EXPLAIN&quot; select_stmt .
</code></pre>
<ul>
<li>
<h4 id="explain-analyze"><a class="header" href="#explain-analyze">EXPLAIN ANALYZE</a></h4>
</li>
</ul>
<p>ä¾‹å¦‚</p>
<pre><code>&gt; explain analyze select mean(temperature) from air where time &gt;= '2018-02-22T00:00:00Z' and time &lt; '2018-02-22T12:00:00Z'
EXPLAIN ANALYZE
----    -----------
 .
 â””â”€â”€ select
   â”œâ”€â”€ execution_time: 279.292Âµs
   â”œâ”€â”€ planning_time: 952.75Âµs
   â”œâ”€â”€ total_time: 1.232042ms
   â””â”€â”€ build_cursor
    â”œâ”€â”€ labels
     â”‚   â””â”€â”€ statement: SELECT mean(temperature) FROM data.autogen.air
     â””â”€â”€ iterator_scanner
      â””â”€â”€ labels
       â””â”€â”€ expr: mean(temperature)
</code></pre>
<p>execution_time: æ‰§è¡ŒæŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´ï¼ŒåŒ…æ‹¬è¯»å–æ—¶é—´åºåˆ—æ•°æ®ã€åœ¨æ•°æ®æµç»è¿­ä»£å™¨æ—¶æ‰§è¡Œæ“ä½œï¼Œä»¥åŠä»è¿­ä»£å™¨ä¸­æå–å·²å¤„ç†çš„æ•°æ®ã€‚æ‰§è¡Œæ—¶é—´ä¸åŒ…æ‹¬å°†è¾“å‡ºåºåˆ—åŒ–ä¸ºJSONæˆ–å…¶ä»–æ ¼å¼æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚
planning_time: æ˜¾ç¤ºè®¡åˆ’æŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´é‡ã€‚åœ¨CnosDBä¸­è§„åˆ’æŸ¥è¯¢éœ€è¦è®¸å¤šæ­¥éª¤ã€‚æ ¹æ®æŸ¥è¯¢çš„å¤æ‚æ€§ï¼Œä¸æ‰§è¡ŒæŸ¥è¯¢ç›¸æ¯”ï¼Œè®¡åˆ’å¯èƒ½éœ€è¦æ›´å¤šçš„å·¥ä½œå¹¶æ¶ˆè€—æ›´å¤šçš„CPUå’Œå†…å­˜èµ„æºã€‚ä¾‹å¦‚ï¼Œæ‰§è¡ŒæŸ¥è¯¢æ‰€éœ€çš„ç³»åˆ—é”®çš„æ•°é‡ä¼šå½±å“è®¡åˆ’æŸ¥è¯¢çš„é€Ÿåº¦å’Œæ‰€éœ€çš„å†…å­˜ã€‚
create_iterator: è¡¨ç¤ºæœ¬åœ°CnosDBå®ä¾‹æ‰€åšçš„å·¥ä½œâ”€â”€ä¸€ç»„å¤æ‚çš„åµŒå¥—è¿­ä»£å™¨ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥äº§ç”Ÿæœ€ç»ˆçš„æŸ¥è¯¢è¾“å‡ºã€‚
cursor typeï¼šEXPLAIN ANALYZEåŒºåˆ†3ç§æ¸¸æ ‡ç±»å‹ã€‚è™½ç„¶æ¸¸æ ‡ç±»å‹å…·æœ‰ç›¸åŒçš„æ•°æ®ç»“æ„å’Œç›¸åŒçš„CPUå’ŒI/Oæˆæœ¬ï¼Œä½†æ¯ç§æ¸¸æ ‡ç±»å‹çš„æ„é€ åŸå› ä¸åŒï¼Œå¹¶åœ¨æœ€ç»ˆè¾“å‡ºä¸­åˆ†å¼€ã€‚
block typesï¼šEXPLAIN ANALYZEåˆ†ç¦»å­˜å‚¨å—ç±»å‹ï¼Œå¹¶æŠ¥å‘Šè¢«è§£ç çš„å—çš„æ€»æ•°å’Œå®ƒä»¬åœ¨ç£ç›˜ä¸Šçš„å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)ã€‚</p>
<ul>
<li>
<h4 id="æˆæƒ"><a class="header" href="#æˆæƒ">æˆæƒ</a></h4>
</li>
</ul>
<pre><code>grant_stmt = &quot;GRANT&quot; privilege [ on_clause ] to_clause .
</code></pre>
<ul>
<li>
<h4 id="å…³é—­æŸ¥è¯¢"><a class="header" href="#å…³é—­æŸ¥è¯¢">å…³é—­æŸ¥è¯¢</a></h4>
</li>
</ul>
<pre><code>kill_query_statement = &quot;KILL QUERY&quot; query_id .
</code></pre>
<ul>
<li>
<h4 id="æ’¤é”€"><a class="header" href="#æ’¤é”€">æ’¤é”€</a></h4>
</li>
</ul>
<pre><code>revoke_stmt = &quot;REVOKE&quot; privilege [ on_clause ] &quot;FROM&quot; user_name .
</code></pre>
<ul>
<li>
<h4 id="é€‰æ‹©"><a class="header" href="#é€‰æ‹©">é€‰æ‹©</a></h4>
</li>
</ul>
<pre><code>select_stmt = &quot;SELECT&quot; fields [ into_clause ] from_clause [ where_clause ]
         [ group_by_clause ] [ order_by_clause ] [ limit_clause ]
         [ offset_clause ] [ slimit_clause ] [ soffset_clause ] [ timezone_clause ] .
</code></pre>
<ul>
<li>
<h4 id="å±•ç¤ºåŸºæ•°"><a class="header" href="#å±•ç¤ºåŸºæ•°">å±•ç¤ºåŸºæ•°</a></h4>
</li>
</ul>
<p>æŒ‡ç”¨äºç²¾ç¡®ä¼°è®¡æˆ–è®¡æ•°æµ‹é‡å€¼ã€åºåˆ—ã€æ ‡è®°é”®ã€æ ‡è®°é”®å€¼å’Œå­—æ®µé”®çš„åŸºæ•°çš„ä¸€ç»„å‘½ä»¤ã€‚SHOW CARDINALITYå‘½ä»¤æœ‰ä¸¤ç§å˜ä½“:ä¼°è®¡çš„å’Œç²¾ç¡®çš„ã€‚ä¼°è®¡å€¼ä½¿ç”¨è‰å›¾è®¡ç®—ï¼Œæ˜¯æ‰€æœ‰åŸºæ•°å¤§å°çš„å®‰å…¨é»˜è®¤å€¼ã€‚å‡†ç¡®çš„å€¼æ˜¯ç›´æ¥ä»TSM(æ—¶é—´ç»“æ„åˆå¹¶æ ‘)æ•°æ®ä¸­è®¡ç®—çš„ï¼Œä½†æ˜¯å¯¹äºé«˜åŸºæ•°çš„æ•°æ®æ¥è¯´ï¼Œè¿è¡Œè¿™äº›å€¼æ˜¯éå¸¸æ˜‚è´µçš„ã€‚é™¤éå¿…è¦ï¼Œä½¿ç”¨ä¼°è®¡çš„å“ç§ã€‚ä»…å½“åœ¨æ•°æ®åº“ä¸Šå¯ç”¨äº†æ—¶é—´åºåˆ—ç´¢å¼•(TSI)æ—¶ï¼Œæ‰æ”¯æŒæŒ‰æ—¶é—´è¿‡æ»¤ã€‚</p>
<ul>
<li>
<h4 id="show-continuous-queries"><a class="header" href="#show-continuous-queries">SHOW CONTINUOUS QUERIES</a></h4>
</li>
</ul>
<pre><code>show_continuous_queries_stmt = &quot;SHOW CONTINUOUS QUERIES&quot; .
</code></pre>
<ul>
<li>
<h4 id="show-databases"><a class="header" href="#show-databases">SHOW DATABASES</a></h4>
</li>
</ul>
<pre><code>show_databases_stmt = &quot;SHOW DATABASES&quot; .
</code></pre>
<ul>
<li>
<h4 id="show-diagnostics"><a class="header" href="#show-diagnostics">SHOW DIAGNOSTICS</a></h4>
</li>
</ul>
<p>ç¤ºèŠ‚ç‚¹ä¿¡æ¯ï¼Œå¦‚æ„å»ºä¿¡æ¯ã€æ­£å¸¸è¿è¡Œæ—¶é—´ã€ä¸»æœºåã€æœåŠ¡å™¨é…ç½®ã€å†…å­˜ä½¿ç”¨å’Œè¿è¡Œæ—¶è¯Šæ–­ã€‚</p>
<pre><code>show_diagnostics_stmt = &quot;SHOW DIAGNOSTICS&quot;
</code></pre>
<ul>
<li>
<h4 id="show-field-key-cardinality"><a class="header" href="#show-field-key-cardinality">SHOW FIELD KEY CARDINALITY</a></h4>
</li>
</ul>
<pre><code>show_field_key_cardinality_stmt = &quot;SHOW FIELD KEY CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ]

show_field_key_exact_cardinality_stmt = &quot;SHOW FIELD KEY EXACT CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ]
</code></pre>
<ul>
<li>
<h4 id="show-field-keys"><a class="header" href="#show-field-keys">SHOW FIELD KEYS</a></h4>
</li>
</ul>
<pre><code>show_field_keys_stmt = &quot;SHOW FIELD KEYS&quot; [on_clause] [ from_clause ] .
</code></pre>
<ul>
<li>
<h4 id="show-grants"><a class="header" href="#show-grants">SHOW GRANTS</a></h4>
</li>
</ul>
<pre><code>show_grants_stmt = &quot;SHOW GRANTS FOR&quot; user_name .
</code></pre>
<ul>
<li>
<h4 id="show-measurements"><a class="header" href="#show-measurements">SHOW MEASUREMENTS</a></h4>
</li>
</ul>
<pre><code>show_measurements_stmt = &quot;SHOW MEASUREMENTS&quot; [on_clause] [ with_measurement_clause ] [ where_clause ] [ limit_clause ] [ offset_clause ] .
</code></pre>
<ul>
<li>
<h4 id="show-queries"><a class="header" href="#show-queries">SHOW QUERIES</a></h4>
</li>
</ul>
<pre><code>show_queries_stmt = &quot;SHOW QUERIES&quot; .
</code></pre>
<ul>
<li>
<h4 id="show-retention-policies"><a class="header" href="#show-retention-policies">SHOW RETENTION POLICIES</a></h4>
</li>
</ul>
<pre><code>show_retention_policies_stmt = &quot;SHOW RETENTION POLICIES&quot; [on_clause] .
</code></pre>
<ul>
<li>
<h4 id="show-series"><a class="header" href="#show-series">SHOW SERIES</a></h4>
</li>
</ul>
<pre><code>show_series_stmt = &quot;SHOW SERIES&quot; [on_clause] [ from_clause ] [ where_clause ] [ limit_clause ] [ offset_clause ] .
</code></pre>
<ul>
<li>
<h4 id="show-series-cardinality"><a class="header" href="#show-series-cardinality">SHOW SERIES CARDINALITY</a></h4>
</li>
</ul>
<pre><code>show_series_cardinality_stmt = &quot;SHOW SERIES CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ]

show_series_exact_cardinality_stmt = &quot;SHOW SERIES EXACT CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ]

</code></pre>
<ul>
<li>
<h4 id="show-shard-groups"><a class="header" href="#show-shard-groups">SHOW SHARD GROUPS</a></h4>
</li>
</ul>
<pre><code>show_shard_groups_stmt = &quot;SHOW SHARD GROUPS&quot; .
</code></pre>
<ul>
<li>
<h4 id="show-shards"><a class="header" href="#show-shards">SHOW SHARDS</a></h4>
</li>
</ul>
<pre><code>show_shards_stmt = &quot;SHOW SHARDS&quot; .
</code></pre>
<ul>
<li>
<h4 id="show-stats"><a class="header" href="#show-stats">SHOW STATS</a></h4>
</li>
</ul>
<pre><code>show_stats_stmt = &quot;SHOW STATS [ FOR '&lt;component&gt;' | 'indexes' ]&quot;
</code></pre>
<ul>
<li>
<h4 id="show-tag-keys"><a class="header" href="#show-tag-keys">SHOW TAG KEYS</a></h4>
</li>
</ul>
<pre><code>show_tag_keys_stmt = &quot;SHOW TAG KEYS&quot; [on_clause] [ from_clause ] [ where_clause ]
                [ limit_clause ] [ offset_clause ] .
</code></pre>
<ul>
<li>
<h4 id="show-tag-values"><a class="header" href="#show-tag-values">SHOW TAG VALUES</a></h4>
</li>
</ul>
<pre><code>show_tag_values_stmt = &quot;SHOW TAG VALUES&quot; [on_clause] [ from_clause ] with_tag_clause [ where_clause ]
                  [ limit_clause ] [ offset_clause ] .
</code></pre>
<ul>
<li>
<h4 id="show-tag-values-cardinality"><a class="header" href="#show-tag-values-cardinality">SHOW TAG VALUES CARDINALITY</a></h4>
</li>
</ul>
<pre><code>show_tag_values_cardinality_stmt = &quot;SHOW TAG VALUES CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ] with_key_clause

show_tag_values_exact_cardinality_stmt = &quot;SHOW TAG VALUES EXACT CARDINALITY&quot; [ on_clause ] [ from_clause ] [ where_clause ] [ group_by_clause ] [ limit_clause ] [ offset_clause ] with_key_clause
</code></pre>
<ul>
<li>
<h4 id="show-users"><a class="header" href="#show-users">SHOW USERS</a></h4>
</li>
</ul>
<pre><code>show_users_stmt = &quot;SHOW USERS&quot; .
</code></pre>
<h3 id="æ¡æ¬¾"><a class="header" href="#æ¡æ¬¾">æ¡æ¬¾</a></h3>
<pre><code>from_clause     = &quot;FROM&quot; measurements .

group_by_clause = &quot;GROUP BY&quot; dimensions fill(fill_option).

into_clause     = &quot;INTO&quot; ( measurement | back_ref ).

limit_clause    = &quot;LIMIT&quot; int_lit .

offset_clause   = &quot;OFFSET&quot; int_lit .

slimit_clause   = &quot;SLIMIT&quot; int_lit .

soffset_clause  = &quot;SOFFSET&quot; int_lit .

timezone_clause = tz(string_lit) .

on_clause       = &quot;ON&quot; db_name .

order_by_clause = &quot;ORDER BY&quot; sort_fields .

to_clause       = &quot;TO&quot; user_name .

where_clause    = &quot;WHERE&quot; expr .

with_measurement_clause = &quot;WITH MEASUREMENT&quot; ( &quot;=&quot; measurement | &quot;=~&quot; regex_lit ) .

with_tag_clause = &quot;WITH KEY&quot; ( &quot;=&quot; tag_key | &quot;!=&quot; tag_key | &quot;=~&quot; regex_lit | &quot;IN (&quot; tag_keys &quot;)&quot;  ) .
</code></pre>
<h3 id="è¡¨è¾¾å¼"><a class="header" href="#è¡¨è¾¾å¼">è¡¨è¾¾å¼</a></h3>
<pre><code class="language-SQL">binary_op        = &quot;+&quot; | &quot;-&quot; | &quot;*&quot; | &quot;/&quot; | &quot;%&quot; | &quot;&amp;&quot; | &quot;|&quot; | &quot;^&quot; | &quot;AND&quot; |
                &quot;OR&quot; | &quot;=&quot; | &quot;!=&quot; | &quot;&lt;&gt;&quot; | &quot;&lt;&quot; | &quot;&lt;=&quot; | &quot;&gt;&quot; | &quot;&gt;=&quot; .

expr             = unary_expr { binary_op unary_expr } .

unary_expr       = &quot;(&quot; expr &quot;)&quot; | var_ref | time_lit | string_lit | int_lit |
float_lit | bool_lit | duration_lit | regex_lit .
</code></pre>
<h3 id="å…¶ä»–"><a class="header" href="#å…¶ä»–">å…¶ä»–</a></h3>
<pre><code>alias            = &quot;AS&quot; identifier .

back_ref         = ( policy_name &quot;.:MEASUREMENT&quot; ) |
( db_name &quot;.&quot; [ policy_name ] &quot;.:MEASUREMENT&quot; ) .

db_name          = identifier .

dimension        = expr .

dimensions       = dimension { &quot;,&quot; dimension } .

field_key        = identifier .

field            = expr [ alias ] .

fields           = field { &quot;,&quot; field } .

fill_option      = &quot;null&quot; | &quot;none&quot; | &quot;previous&quot; | int_lit | float_lit | &quot;linear&quot; .

host             = string_lit .

measurement      = measurement_name |
( policy_name &quot;.&quot; measurement_name ) |
( db_name &quot;.&quot; [ policy_name ] &quot;.&quot; measurement_name ) .

measurements     = measurement { &quot;,&quot; measurement } .

measurement_name = identifier | regex_lit .

password         = string_lit .

policy_name      = identifier .

privilege        = &quot;ALL&quot; [ &quot;PRIVILEGES&quot; ] | &quot;READ&quot; | &quot;WRITE&quot; .

query_id         = int_lit .

query_name       = identifier .

retention_policy = identifier .

retention_policy_option      = retention_policy_duration |
retention_policy_replication |
retention_policy_shard_group_duration |
&quot;DEFAULT&quot; .

retention_policy_duration    = &quot;DURATION&quot; duration_lit .

retention_policy_replication = &quot;REPLICATION&quot; int_lit .

retention_policy_shard_group_duration = &quot;SHARD DURATION&quot; duration_lit .

retention_policy_name = &quot;NAME&quot; identifier .

series_id        = int_lit .

shard_id         = int_lit .

sort_field       = field_key [ ASC | DESC ] .

sort_fields      = sort_field { &quot;,&quot; sort_field } .

subscription_name = identifier .

tag_key          = identifier .

tag_keys         = tag_key { &quot;,&quot; tag_key } .

user_name        = identifier .

var_ref          = measurement .
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="å¸¸è§é—®é¢˜-2"><a class="header" href="#å¸¸è§é—®é¢˜-2">å¸¸è§é—®é¢˜</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
